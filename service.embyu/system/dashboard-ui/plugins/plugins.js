define(["../list/list","cardBuilder","loading","mainTabsManager","dom","globalize","layoutManager","cardStyle","emby-linkbutton"],function(ListPage,cardBuilder,loading,mainTabsManager,dom,globalize,layoutManager){"use strict";function getTabs(){return[{href:"plugins/plugins.html",name:globalize.translate("TabMyPlugins")},{href:"plugins/plugincatalog.html",name:globalize.translate("TabCatalog")}]}function sortPlugins(plugin1,plugin2){return plugin1.Name>plugin2.Name?1:-1}function setPluginProperies(plugin,pluginConfigurationPages){plugin.ServerId=ApiClient.serverId(),plugin.Type="Plugin",plugin.PrimaryImageAspectRatio=16/9;var configPage=pluginConfigurationPages.filter(function(pluginConfigurationPage){return pluginConfigurationPage.PluginId===plugin.Id})[0];plugin.ConfigPageUrl=configPage?Dashboard.getConfigurationPageUrl(configPage.Name):null}function PluginsPage(view,params){params.serverId=ApiClient.serverId(),ListPage.call(this,view,params),view.addEventListener("viewshow",function(){mainTabsManager.setTabs(this,0,getTabs)})}return Object.assign(PluginsPage.prototype,ListPage.prototype),PluginsPage.prototype.getItems=function(sortBy,startIndex,limit){return ApiClient.getInstalledPlugins().then(function(plugins){return ApiClient.getJSON(ApiClient.getUrl("web/configurationpages")+"?pageType=PluginConfiguration").then(function(configPages){for(var i=0,length=plugins.length;i<length;i++)setPluginProperies(plugins[i],configPages);return plugins=plugins.sort(sortPlugins)})})},PluginsPage.prototype.setTitle=function(){},PluginsPage.prototype.getItemsHtml=function(items){return cardBuilder.getCardsHtml({items:items,shape:"auto",showTitle:!0,centerText:!0,overlayText:!1,multiSelect:!1,showVersion:!0,cardLayout:!0})},PluginsPage});