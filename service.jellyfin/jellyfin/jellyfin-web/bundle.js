require([],function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){"use strict";var n,i="object"==typeof Reflect?Reflect:null,a=i&&"function"==typeof i.apply?i.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var l=10;function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var i,a,s,o;if("function"!=typeof r)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r);if(void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]),void 0===s)s=a[t]=r,++e._eventsCount;else if("function"==typeof s?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=u(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,o=l,console&&console.warn&&console.warn(o)}return e}function d(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,a(this.listener,this.target,e))}.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)a(l,this,t);else{var u=l.length,c=p(l,u);for(r=0;r<u;++r)a(c[r],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,d(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,d(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,i,a,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){s=r[a].listener,i=a;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,a=Object.keys(r);for(n=0;n<a.length;++n)"removeListener"!==(i=a[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r=function(e,t){var r=e[1]||"",n=e[3];if(!n)return r;if(t&&"function"==typeof btoa){var i=(s=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),a=n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"});return[r].concat(a).concat([i]).join("\n")}var s;return[r].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r}).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var a=this[i][0];null!=a&&(n[a]=!0)}for(i=0;i<e.length;i++){var s=e[i];null!=s[0]&&n[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="("+s[2]+") and ("+r+")"),t.push(s))}},t}},function(e,t,r){var n,i,a={},s=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=n.apply(this,arguments)),i}),o=function(e){var t={};return function(e,r){if("function"==typeof e)return e();if(void 0===t[e]){var n=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,r);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),l=null,u=0,c=[],d=r(16);function h(e,t){for(var r=0;r<e.length;r++){var n=e[r],i=a[n.id];if(i){i.refs++;for(var s=0;s<i.parts.length;s++)i.parts[s](n.parts[s]);for(;s<n.parts.length;s++)i.parts.push(_(n.parts[s],t))}else{var o=[];for(s=0;s<n.parts.length;s++)o.push(_(n.parts[s],t));a[n.id]={id:n.id,refs:1,parts:o}}}}function f(e,t){for(var r=[],n={},i=0;i<e.length;i++){var a=e[i],s=t.base?a[0]+t.base:a[0],o={css:a[1],media:a[2],sourceMap:a[3]};n[s]?n[s].parts.push(o):r.push(n[s]={id:s,parts:[o]})}return r}function p(e,t){var r=o(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=c[c.length-1];if("top"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),c.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=o(e.insertAt.before,r);r.insertBefore(t,i)}}function g(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function m(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=function(){0;return r.nc}();n&&(e.attrs.nonce=n)}return v(t,e.attrs),p(e,t),t}function v(e,t){Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})}function _(e,t){var r,n,i,a;if(t.transform&&e.css){if(!(a="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=a}if(t.singleton){var s=u++;r=l||(l=m(t)),n=w.bind(null,r,s,!1),i=w.bind(null,r,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",v(t,e.attrs),p(e,t),t}(t),n=function(e,t,r){var n=r.css,i=r.sourceMap,a=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||a)&&(n=d(n));i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var s=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(s),o&&URL.revokeObjectURL(o)}.bind(null,r,t),i=function(){g(r),r.href&&URL.revokeObjectURL(r.href)}):(r=m(t),n=function(e,t){var r=t.css,n=t.media;n&&e.setAttribute("media",n);if(e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,r),i=function(){g(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=f(e,t);return h(r,t),function(e){for(var n=[],i=0;i<r.length;i++){var s=r[i];(o=a[s.id]).refs--,n.push(o)}e&&h(f(e,t),t);for(i=0;i<n.length;i++){var o;if(0===(o=n[i]).refs){for(var l=0;l<o.parts.length;l++)o.parts[l]();delete a[o.id]}}}};var y,b=(y=[],function(e,t){return y[e]=t,y.filter(Boolean).join("\n")});function w(e,t,r,n){var i=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=b(t,i);else{var a=document.createTextNode(i),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(a,s[t]):e.appendChild(a)}}},function(e,t,r){var n;
/*!
 * jQuery JavaScript Library v3.4.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2019-05-01T21:04Z
 */
/*!
 * jQuery JavaScript Library v3.4.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2019-05-01T21:04Z
 */
!function(t,r){"use strict";"object"==typeof e.exports?e.exports=t.document?r(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return r(e)}:r(t)}("undefined"!=typeof window?window:this,function(r,i){"use strict";var a=[],s=r.document,o=Object.getPrototypeOf,l=a.slice,u=a.concat,c=a.push,d=a.indexOf,h={},f=h.toString,p=h.hasOwnProperty,g=p.toString,m=g.call(Object),v={},_=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},y=function(e){return null!=e&&e===e.window},b={type:!0,src:!0,nonce:!0,noModule:!0};function w(e,t,r){var n,i,a=(r=r||s).createElement("script");if(a.text=e,t)for(n in b)(i=t[n]||t.getAttribute&&t.getAttribute(n))&&a.setAttribute(n,i);r.head.appendChild(a).parentNode.removeChild(a)}function S(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?h[f.call(e)]||"object":typeof e}var E=function(e,t){return new E.fn.init(e,t)},x=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function T(e){var t=!!e&&"length"in e&&e.length,r=S(e);return!_(e)&&!y(e)&&("array"===r||0===t||"number"==typeof t&&t>0&&t-1 in e)}E.fn=E.prototype={jquery:"3.4.1",constructor:E,length:0,toArray:function(){return l.call(this)},get:function(e){return null==e?l.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=E.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return E.each(this,e)},map:function(e){return this.pushStack(E.map(this,function(t,r){return e.call(t,r,t)}))},slice:function(){return this.pushStack(l.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,r=+e+(e<0?t:0);return this.pushStack(r>=0&&r<t?[this[r]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:a.sort,splice:a.splice},E.extend=E.fn.extend=function(){var e,t,r,n,i,a,s=arguments[0]||{},o=1,l=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[o]||{},o++),"object"==typeof s||_(s)||(s={}),o===l&&(s=this,o--);o<l;o++)if(null!=(e=arguments[o]))for(t in e)n=e[t],"__proto__"!==t&&s!==n&&(u&&n&&(E.isPlainObject(n)||(i=Array.isArray(n)))?(r=s[t],a=i&&!Array.isArray(r)?[]:i||E.isPlainObject(r)?r:{},i=!1,s[t]=E.extend(u,a,n)):void 0!==n&&(s[t]=n));return s},E.extend({expando:"jQuery"+("3.4.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,r;return!(!e||"[object Object]"!==f.call(e))&&(!(t=o(e))||"function"==typeof(r=p.call(t,"constructor")&&t.constructor)&&g.call(r)===m)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t){w(e,{nonce:t&&t.nonce})},each:function(e,t){var r,n=0;if(T(e))for(r=e.length;n<r&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:function(e){return null==e?"":(e+"").replace(x,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(T(Object(e))?E.merge(r,"string"==typeof e?[e]:e):c.call(r,e)),r},inArray:function(e,t,r){return null==t?-1:d.call(t,e,r)},merge:function(e,t){for(var r=+t.length,n=0,i=e.length;n<r;n++)e[i++]=t[n];return e.length=i,e},grep:function(e,t,r){for(var n=[],i=0,a=e.length,s=!r;i<a;i++)!t(e[i],i)!==s&&n.push(e[i]);return n},map:function(e,t,r){var n,i,a=0,s=[];if(T(e))for(n=e.length;a<n;a++)null!=(i=t(e[a],a,r))&&s.push(i);else for(a in e)null!=(i=t(e[a],a,r))&&s.push(i);return u.apply([],s)},guid:1,support:v}),"function"==typeof Symbol&&(E.fn[Symbol.iterator]=a[Symbol.iterator]),E.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){h["[object "+t+"]"]=t.toLowerCase()});var k=
/*!
 * Sizzle CSS Selector Engine v2.3.4
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2019-04-08
 */
function(e){var t,r,n,i,a,s,o,l,u,c,d,h,f,p,g,m,v,_,y,b="sizzle"+1*new Date,w=e.document,S=0,E=0,x=le(),T=le(),k=le(),A=le(),C=function(e,t){return e===t&&(d=!0),0},j={}.hasOwnProperty,D=[],R=D.pop,L=D.push,I=D.push,O=D.slice,P=function(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1},M="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",B="\\["+N+"*("+F+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+N+"*\\]",U=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",G=new RegExp(N+"+","g"),z=new RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g"),H=new RegExp("^"+N+"*,"+N+"*"),V=new RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),K=new RegExp(N+"|>"),W=new RegExp(U),q=new RegExp("^"+F+"$"),X={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:new RegExp("^(?:"+M+")$","i"),needsContext:new RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,$=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\([\\da-f]{1,6}"+N+"?|("+N+")|.)","ig"),re=function(e,t,r){var n="0x"+t-65536;return n!=n||r?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},ne=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ae=function(){h()},se=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{I.apply(D=O.call(w.childNodes),w.childNodes),D[w.childNodes.length].nodeType}catch(e){I={apply:D.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){for(var r=e.length,n=0;e[r++]=t[n++];);e.length=r-1}}}function oe(e,t,n,i){var a,o,u,c,d,p,v,_=t&&t.ownerDocument,S=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==S&&9!==S&&11!==S)return n;if(!i&&((t?t.ownerDocument||t:w)!==f&&h(t),t=t||f,g)){if(11!==S&&(d=Z.exec(e)))if(a=d[1]){if(9===S){if(!(u=t.getElementById(a)))return n;if(u.id===a)return n.push(u),n}else if(_&&(u=_.getElementById(a))&&y(t,u)&&u.id===a)return n.push(u),n}else{if(d[2])return I.apply(n,t.getElementsByTagName(e)),n;if((a=d[3])&&r.getElementsByClassName&&t.getElementsByClassName)return I.apply(n,t.getElementsByClassName(a)),n}if(r.qsa&&!A[e+" "]&&(!m||!m.test(e))&&(1!==S||"object"!==t.nodeName.toLowerCase())){if(v=e,_=t,1===S&&K.test(e)){for((c=t.getAttribute("id"))?c=c.replace(ne,ie):t.setAttribute("id",c=b),o=(p=s(e)).length;o--;)p[o]="#"+c+" "+ye(p[o]);v=p.join(","),_=ee.test(e)&&ve(t.parentNode)||t}try{return I.apply(n,_.querySelectorAll(v)),n}catch(t){A(e,!0)}finally{c===b&&t.removeAttribute("id")}}}return l(e.replace(z,"$1"),t,n,i)}function le(){var e=[];return function t(r,i){return e.push(r+" ")>n.cacheLength&&delete t[e.shift()],t[r+" "]=i}}function ue(e){return e[b]=!0,e}function ce(e){var t=f.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function de(e,t){for(var r=e.split("|"),i=r.length;i--;)n.attrHandle[r[i]]=t}function he(e,t){var r=t&&e,n=r&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(n)return n;if(r)for(;r=r.nextSibling;)if(r===t)return-1;return e?1:-1}function fe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pe(e){return function(t){var r=t.nodeName.toLowerCase();return("input"===r||"button"===r)&&t.type===e}}function ge(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&se(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function me(e){return ue(function(t){return t=+t,ue(function(r,n){for(var i,a=e([],r.length,t),s=a.length;s--;)r[i=a[s]]&&(r[i]=!(n[i]=r[i]))})})}function ve(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in r=oe.support={},a=oe.isXML=function(e){var t=e.namespaceURI,r=(e.ownerDocument||e).documentElement;return!Y.test(t||r&&r.nodeName||"HTML")},h=oe.setDocument=function(e){var t,i,s=e?e.ownerDocument||e:w;return s!==f&&9===s.nodeType&&s.documentElement?(p=(f=s).documentElement,g=!a(f),w!==f&&(i=f.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",ae,!1):i.attachEvent&&i.attachEvent("onunload",ae)),r.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ce(function(e){return e.appendChild(f.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=Q.test(f.getElementsByClassName),r.getById=ce(function(e){return p.appendChild(e).id=b,!f.getElementsByName||!f.getElementsByName(b).length}),r.getById?(n.filter.ID=function(e){var t=e.replace(te,re);return function(e){return e.getAttribute("id")===t}},n.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var r=t.getElementById(e);return r?[r]:[]}}):(n.filter.ID=function(e){var t=e.replace(te,re);return function(e){var r=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return r&&r.value===t}},n.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var r,n,i,a=t.getElementById(e);if(a){if((r=a.getAttributeNode("id"))&&r.value===e)return[a];for(i=t.getElementsByName(e),n=0;a=i[n++];)if((r=a.getAttributeNode("id"))&&r.value===e)return[a]}return[]}}),n.find.TAG=r.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):r.qsa?t.querySelectorAll(e):void 0}:function(e,t){var r,n=[],i=0,a=t.getElementsByTagName(e);if("*"===e){for(;r=a[i++];)1===r.nodeType&&n.push(r);return n}return a},n.find.CLASS=r.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},v=[],m=[],(r.qsa=Q.test(f.querySelectorAll))&&(ce(function(e){p.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+N+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+N+"*(?:value|"+M+")"),e.querySelectorAll("[id~="+b+"-]").length||m.push("~="),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||m.push(".#.+[+~]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=f.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+N+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),p.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")})),(r.matchesSelector=Q.test(_=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ce(function(e){r.disconnectedMatch=_.call(e,"*"),_.call(e,"[s!='']:x"),v.push("!=",U)}),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),t=Q.test(p.compareDocumentPosition),y=t||Q.test(p.contains)?function(e,t){var r=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(r.contains?r.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},C=t?function(e,t){if(e===t)return d=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!r.sortDetached&&t.compareDocumentPosition(e)===n?e===f||e.ownerDocument===w&&y(w,e)?-1:t===f||t.ownerDocument===w&&y(w,t)?1:c?P(c,e)-P(c,t):0:4&n?-1:1)}:function(e,t){if(e===t)return d=!0,0;var r,n=0,i=e.parentNode,a=t.parentNode,s=[e],o=[t];if(!i||!a)return e===f?-1:t===f?1:i?-1:a?1:c?P(c,e)-P(c,t):0;if(i===a)return he(e,t);for(r=e;r=r.parentNode;)s.unshift(r);for(r=t;r=r.parentNode;)o.unshift(r);for(;s[n]===o[n];)n++;return n?he(s[n],o[n]):s[n]===w?-1:o[n]===w?1:0},f):f},oe.matches=function(e,t){return oe(e,null,null,t)},oe.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f&&h(e),r.matchesSelector&&g&&!A[t+" "]&&(!v||!v.test(t))&&(!m||!m.test(t)))try{var n=_.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){A(t,!0)}return oe(t,f,null,[e]).length>0},oe.contains=function(e,t){return(e.ownerDocument||e)!==f&&h(e),y(e,t)},oe.attr=function(e,t){(e.ownerDocument||e)!==f&&h(e);var i=n.attrHandle[t.toLowerCase()],a=i&&j.call(n.attrHandle,t.toLowerCase())?i(e,t,!g):void 0;return void 0!==a?a:r.attributes||!g?e.getAttribute(t):(a=e.getAttributeNode(t))&&a.specified?a.value:null},oe.escape=function(e){return(e+"").replace(ne,ie)},oe.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},oe.uniqueSort=function(e){var t,n=[],i=0,a=0;if(d=!r.detectDuplicates,c=!r.sortStable&&e.slice(0),e.sort(C),d){for(;t=e[a++];)t===e[a]&&(i=n.push(a));for(;i--;)e.splice(n[i],1)}return c=null,e},i=oe.getText=function(e){var t,r="",n=0,a=e.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)r+=i(e)}else if(3===a||4===a)return e.nodeValue}else for(;t=e[n++];)r+=i(t);return r},(n=oe.selectors={cacheLength:50,createPseudo:ue,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,re),e[3]=(e[3]||e[4]||e[5]||"").replace(te,re),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||oe.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&oe.error(e[0]),e},PSEUDO:function(e){var t,r=!e[6]&&e[2];return X.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":r&&W.test(r)&&(t=s(r,!0))&&(t=r.indexOf(")",r.length-t)-r.length)&&(e[0]=e[0].slice(0,t),e[2]=r.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,re).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=x[e+" "];return t||(t=new RegExp("(^|"+N+")"+e+"("+N+"|$)"))&&x(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,r){return function(n){var i=oe.attr(n,e);return null==i?"!="===t:!t||(i+="","="===t?i===r:"!="===t?i!==r:"^="===t?r&&0===i.indexOf(r):"*="===t?r&&i.indexOf(r)>-1:"$="===t?r&&i.slice(-r.length)===r:"~="===t?(" "+i.replace(G," ")+" ").indexOf(r)>-1:"|="===t&&(i===r||i.slice(0,r.length+1)===r+"-"))}},CHILD:function(e,t,r,n,i){var a="nth"!==e.slice(0,3),s="last"!==e.slice(-4),o="of-type"===t;return 1===n&&0===i?function(e){return!!e.parentNode}:function(t,r,l){var u,c,d,h,f,p,g=a!==s?"nextSibling":"previousSibling",m=t.parentNode,v=o&&t.nodeName.toLowerCase(),_=!l&&!o,y=!1;if(m){if(a){for(;g;){for(h=t;h=h[g];)if(o?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[s?m.firstChild:m.lastChild],s&&_){for(y=(f=(u=(c=(d=(h=m)[b]||(h[b]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]||[])[0]===S&&u[1])&&u[2],h=f&&m.childNodes[f];h=++f&&h&&h[g]||(y=f=0)||p.pop();)if(1===h.nodeType&&++y&&h===t){c[e]=[S,f,y];break}}else if(_&&(y=f=(u=(c=(d=(h=t)[b]||(h[b]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]||[])[0]===S&&u[1]),!1===y)for(;(h=++f&&h&&h[g]||(y=f=0)||p.pop())&&((o?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++y||(_&&((c=(d=h[b]||(h[b]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]=[S,y]),h!==t)););return(y-=i)===n||y%n==0&&y/n>=0}}},PSEUDO:function(e,t){var r,i=n.pseudos[e]||n.setFilters[e.toLowerCase()]||oe.error("unsupported pseudo: "+e);return i[b]?i(t):i.length>1?(r=[e,e,"",t],n.setFilters.hasOwnProperty(e.toLowerCase())?ue(function(e,r){for(var n,a=i(e,t),s=a.length;s--;)e[n=P(e,a[s])]=!(r[n]=a[s])}):function(e){return i(e,0,r)}):i}},pseudos:{not:ue(function(e){var t=[],r=[],n=o(e.replace(z,"$1"));return n[b]?ue(function(e,t,r,i){for(var a,s=n(e,null,i,[]),o=e.length;o--;)(a=s[o])&&(e[o]=!(t[o]=a))}):function(e,i,a){return t[0]=e,n(t,null,a,r),t[0]=null,!r.pop()}}),has:ue(function(e){return function(t){return oe(e,t).length>0}}),contains:ue(function(e){return e=e.replace(te,re),function(t){return(t.textContent||i(t)).indexOf(e)>-1}}),lang:ue(function(e){return q.test(e||"")||oe.error("unsupported lang: "+e),e=e.replace(te,re).toLowerCase(),function(t){var r;do{if(r=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(r=r.toLowerCase())===e||0===r.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var r=e.location&&e.location.hash;return r&&r.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!n.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return $.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:me(function(){return[0]}),last:me(function(e,t){return[t-1]}),eq:me(function(e,t,r){return[r<0?r+t:r]}),even:me(function(e,t){for(var r=0;r<t;r+=2)e.push(r);return e}),odd:me(function(e,t){for(var r=1;r<t;r+=2)e.push(r);return e}),lt:me(function(e,t,r){for(var n=r<0?r+t:r>t?t:r;--n>=0;)e.push(n);return e}),gt:me(function(e,t,r){for(var n=r<0?r+t:r;++n<t;)e.push(n);return e})}}).pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[t]=fe(t);for(t in{submit:!0,reset:!0})n.pseudos[t]=pe(t);function _e(){}function ye(e){for(var t=0,r=e.length,n="";t<r;t++)n+=e[t].value;return n}function be(e,t,r){var n=t.dir,i=t.next,a=i||n,s=r&&"parentNode"===a,o=E++;return t.first?function(t,r,i){for(;t=t[n];)if(1===t.nodeType||s)return e(t,r,i);return!1}:function(t,r,l){var u,c,d,h=[S,o];if(l){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,r,l))return!0}else for(;t=t[n];)if(1===t.nodeType||s)if(c=(d=t[b]||(t[b]={}))[t.uniqueID]||(d[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[n]||t;else{if((u=c[a])&&u[0]===S&&u[1]===o)return h[2]=u[2];if(c[a]=h,h[2]=e(t,r,l))return!0}return!1}}function we(e){return e.length>1?function(t,r,n){for(var i=e.length;i--;)if(!e[i](t,r,n))return!1;return!0}:e[0]}function Se(e,t,r,n,i){for(var a,s=[],o=0,l=e.length,u=null!=t;o<l;o++)(a=e[o])&&(r&&!r(a,n,i)||(s.push(a),u&&t.push(o)));return s}function Ee(e,t,r,n,i,a){return n&&!n[b]&&(n=Ee(n)),i&&!i[b]&&(i=Ee(i,a)),ue(function(a,s,o,l){var u,c,d,h=[],f=[],p=s.length,g=a||function(e,t,r){for(var n=0,i=t.length;n<i;n++)oe(e,t[n],r);return r}(t||"*",o.nodeType?[o]:o,[]),m=!e||!a&&t?g:Se(g,h,e,o,l),v=r?i||(a?e:p||n)?[]:s:m;if(r&&r(m,v,o,l),n)for(u=Se(v,f),n(u,[],o,l),c=u.length;c--;)(d=u[c])&&(v[f[c]]=!(m[f[c]]=d));if(a){if(i||e){if(i){for(u=[],c=v.length;c--;)(d=v[c])&&u.push(m[c]=d);i(null,v=[],u,l)}for(c=v.length;c--;)(d=v[c])&&(u=i?P(a,d):h[c])>-1&&(a[u]=!(s[u]=d))}}else v=Se(v===s?v.splice(p,v.length):v),i?i(null,s,v,l):I.apply(s,v)})}function xe(e){for(var t,r,i,a=e.length,s=n.relative[e[0].type],o=s||n.relative[" "],l=s?1:0,c=be(function(e){return e===t},o,!0),d=be(function(e){return P(t,e)>-1},o,!0),h=[function(e,r,n){var i=!s&&(n||r!==u)||((t=r).nodeType?c(e,r,n):d(e,r,n));return t=null,i}];l<a;l++)if(r=n.relative[e[l].type])h=[be(we(h),r)];else{if((r=n.filter[e[l].type].apply(null,e[l].matches))[b]){for(i=++l;i<a&&!n.relative[e[i].type];i++);return Ee(l>1&&we(h),l>1&&ye(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),r,l<i&&xe(e.slice(l,i)),i<a&&xe(e=e.slice(i)),i<a&&ye(e))}h.push(r)}return we(h)}return _e.prototype=n.filters=n.pseudos,n.setFilters=new _e,s=oe.tokenize=function(e,t){var r,i,a,s,o,l,u,c=T[e+" "];if(c)return t?0:c.slice(0);for(o=e,l=[],u=n.preFilter;o;){for(s in r&&!(i=H.exec(o))||(i&&(o=o.slice(i[0].length)||o),l.push(a=[])),r=!1,(i=V.exec(o))&&(r=i.shift(),a.push({value:r,type:i[0].replace(z," ")}),o=o.slice(r.length)),n.filter)!(i=X[s].exec(o))||u[s]&&!(i=u[s](i))||(r=i.shift(),a.push({value:r,type:s,matches:i}),o=o.slice(r.length));if(!r)break}return t?o.length:o?oe.error(e):T(e,l).slice(0)},o=oe.compile=function(e,t){var r,i=[],a=[],o=k[e+" "];if(!o){for(t||(t=s(e)),r=t.length;r--;)(o=xe(t[r]))[b]?i.push(o):a.push(o);(o=k(e,function(e,t){var r=t.length>0,i=e.length>0,a=function(a,s,o,l,c){var d,p,m,v=0,_="0",y=a&&[],b=[],w=u,E=a||i&&n.find.TAG("*",c),x=S+=null==w?1:Math.random()||.1,T=E.length;for(c&&(u=s===f||s||c);_!==T&&null!=(d=E[_]);_++){if(i&&d){for(p=0,s||d.ownerDocument===f||(h(d),o=!g);m=e[p++];)if(m(d,s||f,o)){l.push(d);break}c&&(S=x)}r&&((d=!m&&d)&&v--,a&&y.push(d))}if(v+=_,r&&_!==v){for(p=0;m=t[p++];)m(y,b,s,o);if(a){if(v>0)for(;_--;)y[_]||b[_]||(b[_]=R.call(l));b=Se(b)}I.apply(l,b),c&&!a&&b.length>0&&v+t.length>1&&oe.uniqueSort(l)}return c&&(S=x,u=w),y};return r?ue(a):a}(a,i))).selector=e}return o},l=oe.select=function(e,t,r,i){var a,l,u,c,d,h="function"==typeof e&&e,f=!i&&s(e=h.selector||e);if(r=r||[],1===f.length){if((l=f[0]=f[0].slice(0)).length>2&&"ID"===(u=l[0]).type&&9===t.nodeType&&g&&n.relative[l[1].type]){if(!(t=(n.find.ID(u.matches[0].replace(te,re),t)||[])[0]))return r;h&&(t=t.parentNode),e=e.slice(l.shift().value.length)}for(a=X.needsContext.test(e)?0:l.length;a--&&(u=l[a],!n.relative[c=u.type]);)if((d=n.find[c])&&(i=d(u.matches[0].replace(te,re),ee.test(l[0].type)&&ve(t.parentNode)||t))){if(l.splice(a,1),!(e=i.length&&ye(l)))return I.apply(r,i),r;break}}return(h||o(e,f))(i,t,!g,r,!t||ee.test(e)&&ve(t.parentNode)||t),r},r.sortStable=b.split("").sort(C).join("")===b,r.detectDuplicates=!!d,h(),r.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(f.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||de("type|href|height|width",function(e,t,r){if(!r)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),r.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||de("value",function(e,t,r){if(!r&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||de(M,function(e,t,r){var n;if(!r)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),oe}(r);E.find=k,E.expr=k.selectors,E.expr[":"]=E.expr.pseudos,E.uniqueSort=E.unique=k.uniqueSort,E.text=k.getText,E.isXMLDoc=k.isXML,E.contains=k.contains,E.escapeSelector=k.escape;var A=function(e,t,r){for(var n=[],i=void 0!==r;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&E(e).is(r))break;n.push(e)}return n},C=function(e,t){for(var r=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&r.push(e);return r},j=E.expr.match.needsContext;function D(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var R=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function L(e,t,r){return _(t)?E.grep(e,function(e,n){return!!t.call(e,n,e)!==r}):t.nodeType?E.grep(e,function(e){return e===t!==r}):"string"!=typeof t?E.grep(e,function(e){return d.call(t,e)>-1!==r}):E.filter(t,e,r)}E.filter=function(e,t,r){var n=t[0];return r&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?E.find.matchesSelector(n,e)?[n]:[]:E.find.matches(e,E.grep(t,function(e){return 1===e.nodeType}))},E.fn.extend({find:function(e){var t,r,n=this.length,i=this;if("string"!=typeof e)return this.pushStack(E(e).filter(function(){for(t=0;t<n;t++)if(E.contains(i[t],this))return!0}));for(r=this.pushStack([]),t=0;t<n;t++)E.find(e,i[t],r);return n>1?E.uniqueSort(r):r},filter:function(e){return this.pushStack(L(this,e||[],!1))},not:function(e){return this.pushStack(L(this,e||[],!0))},is:function(e){return!!L(this,"string"==typeof e&&j.test(e)?E(e):e||[],!1).length}});var I,O=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(E.fn.init=function(e,t,r){var n,i;if(!e)return this;if(r=r||I,"string"==typeof e){if(!(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:O.exec(e))||!n[1]&&t)return!t||t.jquery?(t||r).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof E?t[0]:t,E.merge(this,E.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:s,!0)),R.test(n[1])&&E.isPlainObject(t))for(n in t)_(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return(i=s.getElementById(n[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):_(e)?void 0!==r.ready?r.ready(e):e(E):E.makeArray(e,this)}).prototype=E.fn,I=E(s);var P=/^(?:parents|prev(?:Until|All))/,M={children:!0,contents:!0,next:!0,prev:!0};function N(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}E.fn.extend({has:function(e){var t=E(e,this),r=t.length;return this.filter(function(){for(var e=0;e<r;e++)if(E.contains(this,t[e]))return!0})},closest:function(e,t){var r,n=0,i=this.length,a=[],s="string"!=typeof e&&E(e);if(!j.test(e))for(;n<i;n++)for(r=this[n];r&&r!==t;r=r.parentNode)if(r.nodeType<11&&(s?s.index(r)>-1:1===r.nodeType&&E.find.matchesSelector(r,e))){a.push(r);break}return this.pushStack(a.length>1?E.uniqueSort(a):a)},index:function(e){return e?"string"==typeof e?d.call(E(e),this[0]):d.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(E.uniqueSort(E.merge(this.get(),E(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),E.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return A(e,"parentNode")},parentsUntil:function(e,t,r){return A(e,"parentNode",r)},next:function(e){return N(e,"nextSibling")},prev:function(e){return N(e,"previousSibling")},nextAll:function(e){return A(e,"nextSibling")},prevAll:function(e){return A(e,"previousSibling")},nextUntil:function(e,t,r){return A(e,"nextSibling",r)},prevUntil:function(e,t,r){return A(e,"previousSibling",r)},siblings:function(e){return C((e.parentNode||{}).firstChild,e)},children:function(e){return C(e.firstChild)},contents:function(e){return void 0!==e.contentDocument?e.contentDocument:(D(e,"template")&&(e=e.content||e),E.merge([],e.childNodes))}},function(e,t){E.fn[e]=function(r,n){var i=E.map(this,t,r);return"Until"!==e.slice(-5)&&(n=r),n&&"string"==typeof n&&(i=E.filter(n,i)),this.length>1&&(M[e]||E.uniqueSort(i),P.test(e)&&i.reverse()),this.pushStack(i)}});var F=/[^\x20\t\r\n\f]+/g;function B(e){return e}function U(e){throw e}function G(e,t,r,n){var i;try{e&&_(i=e.promise)?i.call(e).done(t).fail(r):e&&_(i=e.then)?i.call(e,t,r):t.apply(void 0,[e].slice(n))}catch(e){r.apply(void 0,[e])}}E.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return E.each(e.match(F)||[],function(e,r){t[r]=!0}),t}(e):E.extend({},e);var t,r,n,i,a=[],s=[],o=-1,l=function(){for(i=i||e.once,n=t=!0;s.length;o=-1)for(r=s.shift();++o<a.length;)!1===a[o].apply(r[0],r[1])&&e.stopOnFalse&&(o=a.length,r=!1);e.memory||(r=!1),t=!1,i&&(a=r?[]:"")},u={add:function(){return a&&(r&&!t&&(o=a.length-1,s.push(r)),function t(r){E.each(r,function(r,n){_(n)?e.unique&&u.has(n)||a.push(n):n&&n.length&&"string"!==S(n)&&t(n)})}(arguments),r&&!t&&l()),this},remove:function(){return E.each(arguments,function(e,t){for(var r;(r=E.inArray(t,a,r))>-1;)a.splice(r,1),r<=o&&o--}),this},has:function(e){return e?E.inArray(e,a)>-1:a.length>0},empty:function(){return a&&(a=[]),this},disable:function(){return i=s=[],a=r="",this},disabled:function(){return!a},lock:function(){return i=s=[],r||t||(a=r=""),this},locked:function(){return!!i},fireWith:function(e,r){return i||(r=[e,(r=r||[]).slice?r.slice():r],s.push(r),t||l()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!n}};return u},E.extend({Deferred:function(e){var t=[["notify","progress",E.Callbacks("memory"),E.Callbacks("memory"),2],["resolve","done",E.Callbacks("once memory"),E.Callbacks("once memory"),0,"resolved"],["reject","fail",E.Callbacks("once memory"),E.Callbacks("once memory"),1,"rejected"]],n="pending",i={state:function(){return n},always:function(){return a.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return E.Deferred(function(r){E.each(t,function(t,n){var i=_(e[n[4]])&&e[n[4]];a[n[1]](function(){var e=i&&i.apply(this,arguments);e&&_(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[n[0]+"With"](this,i?[e]:arguments)})}),e=null}).promise()},then:function(e,n,i){var a=0;function s(e,t,n,i){return function(){var o=this,l=arguments,u=function(){var r,u;if(!(e<a)){if((r=n.apply(o,l))===t.promise())throw new TypeError("Thenable self-resolution");u=r&&("object"==typeof r||"function"==typeof r)&&r.then,_(u)?i?u.call(r,s(a,t,B,i),s(a,t,U,i)):(a++,u.call(r,s(a,t,B,i),s(a,t,U,i),s(a,t,B,t.notifyWith))):(n!==B&&(o=void 0,l=[r]),(i||t.resolveWith)(o,l))}},c=i?u:function(){try{u()}catch(r){E.Deferred.exceptionHook&&E.Deferred.exceptionHook(r,c.stackTrace),e+1>=a&&(n!==U&&(o=void 0,l=[r]),t.rejectWith(o,l))}};e?c():(E.Deferred.getStackHook&&(c.stackTrace=E.Deferred.getStackHook()),r.setTimeout(c))}}return E.Deferred(function(r){t[0][3].add(s(0,r,_(i)?i:B,r.notifyWith)),t[1][3].add(s(0,r,_(e)?e:B)),t[2][3].add(s(0,r,_(n)?n:U))}).promise()},promise:function(e){return null!=e?E.extend(e,i):i}},a={};return E.each(t,function(e,r){var s=r[2],o=r[5];i[r[1]]=s.add,o&&s.add(function(){n=o},t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),s.add(r[3].fire),a[r[0]]=function(){return a[r[0]+"With"](this===a?void 0:this,arguments),this},a[r[0]+"With"]=s.fireWith}),i.promise(a),e&&e.call(a,a),a},when:function(e){var t=arguments.length,r=t,n=Array(r),i=l.call(arguments),a=E.Deferred(),s=function(e){return function(r){n[e]=this,i[e]=arguments.length>1?l.call(arguments):r,--t||a.resolveWith(n,i)}};if(t<=1&&(G(e,a.done(s(r)).resolve,a.reject,!t),"pending"===a.state()||_(i[r]&&i[r].then)))return a.then();for(;r--;)G(i[r],s(r),a.reject);return a.promise()}});var z=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;E.Deferred.exceptionHook=function(e,t){r.console&&r.console.warn&&e&&z.test(e.name)&&r.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},E.readyException=function(e){r.setTimeout(function(){throw e})};var H=E.Deferred();function V(){s.removeEventListener("DOMContentLoaded",V),r.removeEventListener("load",V),E.ready()}E.fn.ready=function(e){return H.then(e).catch(function(e){E.readyException(e)}),this},E.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--E.readyWait:E.isReady)||(E.isReady=!0,!0!==e&&--E.readyWait>0||H.resolveWith(s,[E]))}}),E.ready.then=H.then,"complete"===s.readyState||"loading"!==s.readyState&&!s.documentElement.doScroll?r.setTimeout(E.ready):(s.addEventListener("DOMContentLoaded",V),r.addEventListener("load",V));var K=function(e,t,r,n,i,a,s){var o=0,l=e.length,u=null==r;if("object"===S(r))for(o in i=!0,r)K(e,t,o,r[o],!0,a,s);else if(void 0!==n&&(i=!0,_(n)||(s=!0),u&&(s?(t.call(e,n),t=null):(u=t,t=function(e,t,r){return u.call(E(e),r)})),t))for(;o<l;o++)t(e[o],r,s?n:n.call(e[o],o,t(e[o],r)));return i?e:u?t.call(e):l?t(e[0],r):a},W=/^-ms-/,q=/-([a-z])/g;function X(e,t){return t.toUpperCase()}function Y(e){return e.replace(W,"ms-").replace(q,X)}var $=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function J(){this.expando=E.expando+J.uid++}J.uid=1,J.prototype={cache:function(e){var t=e[this.expando];return t||(t={},$(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,r){var n,i=this.cache(e);if("string"==typeof t)i[Y(t)]=r;else for(n in t)i[Y(n)]=t[n];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][Y(t)]},access:function(e,t,r){return void 0===t||t&&"string"==typeof t&&void 0===r?this.get(e,t):(this.set(e,t,r),void 0!==r?r:t)},remove:function(e,t){var r,n=e[this.expando];if(void 0!==n){if(void 0!==t){r=(t=Array.isArray(t)?t.map(Y):(t=Y(t))in n?[t]:t.match(F)||[]).length;for(;r--;)delete n[t[r]]}(void 0===t||E.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!E.isEmptyObject(t)}};var Q=new J,Z=new J,ee=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,te=/[A-Z]/g;function re(e,t,r){var n;if(void 0===r&&1===e.nodeType)if(n="data-"+t.replace(te,"-$&").toLowerCase(),"string"==typeof(r=e.getAttribute(n))){try{r=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ee.test(e)?JSON.parse(e):e)}(r)}catch(e){}Z.set(e,t,r)}else r=void 0;return r}E.extend({hasData:function(e){return Z.hasData(e)||Q.hasData(e)},data:function(e,t,r){return Z.access(e,t,r)},removeData:function(e,t){Z.remove(e,t)},_data:function(e,t,r){return Q.access(e,t,r)},_removeData:function(e,t){Q.remove(e,t)}}),E.fn.extend({data:function(e,t){var r,n,i,a=this[0],s=a&&a.attributes;if(void 0===e){if(this.length&&(i=Z.get(a),1===a.nodeType&&!Q.get(a,"hasDataAttrs"))){for(r=s.length;r--;)s[r]&&0===(n=s[r].name).indexOf("data-")&&(n=Y(n.slice(5)),re(a,n,i[n]));Q.set(a,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){Z.set(this,e)}):K(this,function(t){var r;if(a&&void 0===t)return void 0!==(r=Z.get(a,e))?r:void 0!==(r=re(a,e))?r:void 0;this.each(function(){Z.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Z.remove(this,e)})}}),E.extend({queue:function(e,t,r){var n;if(e)return t=(t||"fx")+"queue",n=Q.get(e,t),r&&(!n||Array.isArray(r)?n=Q.access(e,t,E.makeArray(r)):n.push(r)),n||[]},dequeue:function(e,t){t=t||"fx";var r=E.queue(e,t),n=r.length,i=r.shift(),a=E._queueHooks(e,t);"inprogress"===i&&(i=r.shift(),n--),i&&("fx"===t&&r.unshift("inprogress"),delete a.stop,i.call(e,function(){E.dequeue(e,t)},a)),!n&&a&&a.empty.fire()},_queueHooks:function(e,t){var r=t+"queueHooks";return Q.get(e,r)||Q.access(e,r,{empty:E.Callbacks("once memory").add(function(){Q.remove(e,[t+"queue",r])})})}}),E.fn.extend({queue:function(e,t){var r=2;return"string"!=typeof e&&(t=e,e="fx",r--),arguments.length<r?E.queue(this[0],e):void 0===t?this:this.each(function(){var r=E.queue(this,e,t);E._queueHooks(this,e),"fx"===e&&"inprogress"!==r[0]&&E.dequeue(this,e)})},dequeue:function(e){return this.each(function(){E.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var r,n=1,i=E.Deferred(),a=this,s=this.length,o=function(){--n||i.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(r=Q.get(a[s],e+"queueHooks"))&&r.empty&&(n++,r.empty.add(o));return o(),i.promise(t)}});var ne=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ie=new RegExp("^(?:([+-])=|)("+ne+")([a-z%]*)$","i"),ae=["Top","Right","Bottom","Left"],se=s.documentElement,oe=function(e){return E.contains(e.ownerDocument,e)},le={composed:!0};se.getRootNode&&(oe=function(e){return E.contains(e.ownerDocument,e)||e.getRootNode(le)===e.ownerDocument});var ue=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&oe(e)&&"none"===E.css(e,"display")},ce=function(e,t,r,n){var i,a,s={};for(a in t)s[a]=e.style[a],e.style[a]=t[a];for(a in i=r.apply(e,n||[]),t)e.style[a]=s[a];return i};function de(e,t,r,n){var i,a,s=20,o=n?function(){return n.cur()}:function(){return E.css(e,t,"")},l=o(),u=r&&r[3]||(E.cssNumber[t]?"":"px"),c=e.nodeType&&(E.cssNumber[t]||"px"!==u&&+l)&&ie.exec(E.css(e,t));if(c&&c[3]!==u){for(l/=2,u=u||c[3],c=+l||1;s--;)E.style(e,t,c+u),(1-a)*(1-(a=o()/l||.5))<=0&&(s=0),c/=a;c*=2,E.style(e,t,c+u),r=r||[]}return r&&(c=+c||+l||0,i=r[1]?c+(r[1]+1)*r[2]:+r[2],n&&(n.unit=u,n.start=c,n.end=i)),i}var he={};function fe(e){var t,r=e.ownerDocument,n=e.nodeName,i=he[n];return i||(t=r.body.appendChild(r.createElement(n)),i=E.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),he[n]=i,i)}function pe(e,t){for(var r,n,i=[],a=0,s=e.length;a<s;a++)(n=e[a]).style&&(r=n.style.display,t?("none"===r&&(i[a]=Q.get(n,"display")||null,i[a]||(n.style.display="")),""===n.style.display&&ue(n)&&(i[a]=fe(n))):"none"!==r&&(i[a]="none",Q.set(n,"display",r)));for(a=0;a<s;a++)null!=i[a]&&(e[a].style.display=i[a]);return e}E.fn.extend({show:function(){return pe(this,!0)},hide:function(){return pe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ue(this)?E(this).show():E(this).hide()})}});var ge=/^(?:checkbox|radio)$/i,me=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ve=/^$|^module$|\/(?:java|ecma)script/i,_e={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ye(e,t){var r;return r=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&D(e,t)?E.merge([e],r):r}function be(e,t){for(var r=0,n=e.length;r<n;r++)Q.set(e[r],"globalEval",!t||Q.get(t[r],"globalEval"))}_e.optgroup=_e.option,_e.tbody=_e.tfoot=_e.colgroup=_e.caption=_e.thead,_e.th=_e.td;var we,Se,Ee=/<|&#?\w+;/;function xe(e,t,r,n,i){for(var a,s,o,l,u,c,d=t.createDocumentFragment(),h=[],f=0,p=e.length;f<p;f++)if((a=e[f])||0===a)if("object"===S(a))E.merge(h,a.nodeType?[a]:a);else if(Ee.test(a)){for(s=s||d.appendChild(t.createElement("div")),o=(me.exec(a)||["",""])[1].toLowerCase(),l=_e[o]||_e._default,s.innerHTML=l[1]+E.htmlPrefilter(a)+l[2],c=l[0];c--;)s=s.lastChild;E.merge(h,s.childNodes),(s=d.firstChild).textContent=""}else h.push(t.createTextNode(a));for(d.textContent="",f=0;a=h[f++];)if(n&&E.inArray(a,n)>-1)i&&i.push(a);else if(u=oe(a),s=ye(d.appendChild(a),"script"),u&&be(s),r)for(c=0;a=s[c++];)ve.test(a.type||"")&&r.push(a);return d}we=s.createDocumentFragment().appendChild(s.createElement("div")),(Se=s.createElement("input")).setAttribute("type","radio"),Se.setAttribute("checked","checked"),Se.setAttribute("name","t"),we.appendChild(Se),v.checkClone=we.cloneNode(!0).cloneNode(!0).lastChild.checked,we.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!we.cloneNode(!0).lastChild.defaultValue;var Te=/^key/,ke=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ae=/^([^.]*)(?:\.(.+)|)/;function Ce(){return!0}function je(){return!1}function De(e,t){return e===function(){try{return s.activeElement}catch(e){}}()==("focus"===t)}function Re(e,t,r,n,i,a){var s,o;if("object"==typeof t){for(o in"string"!=typeof r&&(n=n||r,r=void 0),t)Re(e,o,r,n,t[o],a);return e}if(null==n&&null==i?(i=r,n=r=void 0):null==i&&("string"==typeof r?(i=n,n=void 0):(i=n,n=r,r=void 0)),!1===i)i=je;else if(!i)return e;return 1===a&&(s=i,(i=function(e){return E().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=E.guid++)),e.each(function(){E.event.add(this,t,i,n,r)})}function Le(e,t,r){r?(Q.set(e,t,!1),E.event.add(e,t,{namespace:!1,handler:function(e){var n,i,a=Q.get(this,t);if(1&e.isTrigger&&this[t]){if(a.length)(E.event.special[t]||{}).delegateType&&e.stopPropagation();else if(a=l.call(arguments),Q.set(this,t,a),n=r(this,t),this[t](),a!==(i=Q.get(this,t))||n?Q.set(this,t,!1):i={},a!==i)return e.stopImmediatePropagation(),e.preventDefault(),i.value}else a.length&&(Q.set(this,t,{value:E.event.trigger(E.extend(a[0],E.Event.prototype),a.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Q.get(e,t)&&E.event.add(e,t,Ce)}E.event={global:{},add:function(e,t,r,n,i){var a,s,o,l,u,c,d,h,f,p,g,m=Q.get(e);if(m)for(r.handler&&(r=(a=r).handler,i=a.selector),i&&E.find.matchesSelector(se,i),r.guid||(r.guid=E.guid++),(l=m.events)||(l=m.events={}),(s=m.handle)||(s=m.handle=function(t){return void 0!==E&&E.event.triggered!==t.type?E.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match(F)||[""]).length;u--;)f=g=(o=Ae.exec(t[u])||[])[1],p=(o[2]||"").split(".").sort(),f&&(d=E.event.special[f]||{},f=(i?d.delegateType:d.bindType)||f,d=E.event.special[f]||{},c=E.extend({type:f,origType:g,data:n,handler:r,guid:r.guid,selector:i,needsContext:i&&E.expr.match.needsContext.test(i),namespace:p.join(".")},a),(h=l[f])||((h=l[f]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,n,p,s)||e.addEventListener&&e.addEventListener(f,s)),d.add&&(d.add.call(e,c),c.handler.guid||(c.handler.guid=r.guid)),i?h.splice(h.delegateCount++,0,c):h.push(c),E.event.global[f]=!0)},remove:function(e,t,r,n,i){var a,s,o,l,u,c,d,h,f,p,g,m=Q.hasData(e)&&Q.get(e);if(m&&(l=m.events)){for(u=(t=(t||"").match(F)||[""]).length;u--;)if(f=g=(o=Ae.exec(t[u])||[])[1],p=(o[2]||"").split(".").sort(),f){for(d=E.event.special[f]||{},h=l[f=(n?d.delegateType:d.bindType)||f]||[],o=o[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=a=h.length;a--;)c=h[a],!i&&g!==c.origType||r&&r.guid!==c.guid||o&&!o.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(h.splice(a,1),c.selector&&h.delegateCount--,d.remove&&d.remove.call(e,c));s&&!h.length&&(d.teardown&&!1!==d.teardown.call(e,p,m.handle)||E.removeEvent(e,f,m.handle),delete l[f])}else for(f in l)E.event.remove(e,f+t[u],r,n,!0);E.isEmptyObject(l)&&Q.remove(e,"handle events")}},dispatch:function(e){var t,r,n,i,a,s,o=E.event.fix(e),l=new Array(arguments.length),u=(Q.get(this,"events")||{})[o.type]||[],c=E.event.special[o.type]||{};for(l[0]=o,t=1;t<arguments.length;t++)l[t]=arguments[t];if(o.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,o)){for(s=E.event.handlers.call(this,o,u),t=0;(i=s[t++])&&!o.isPropagationStopped();)for(o.currentTarget=i.elem,r=0;(a=i.handlers[r++])&&!o.isImmediatePropagationStopped();)o.rnamespace&&!1!==a.namespace&&!o.rnamespace.test(a.namespace)||(o.handleObj=a,o.data=a.data,void 0!==(n=((E.event.special[a.origType]||{}).handle||a.handler).apply(i.elem,l))&&!1===(o.result=n)&&(o.preventDefault(),o.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,o),o.result}},handlers:function(e,t){var r,n,i,a,s,o=[],l=t.delegateCount,u=e.target;if(l&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(a=[],s={},r=0;r<l;r++)void 0===s[i=(n=t[r]).selector+" "]&&(s[i]=n.needsContext?E(i,this).index(u)>-1:E.find(i,this,null,[u]).length),s[i]&&a.push(n);a.length&&o.push({elem:u,handlers:a})}return u=this,l<t.length&&o.push({elem:u,handlers:t.slice(l)}),o},addProp:function(e,t){Object.defineProperty(E.Event.prototype,e,{enumerable:!0,configurable:!0,get:_(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[E.expando]?e:new E.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return ge.test(t.type)&&t.click&&D(t,"input")&&Le(t,"click",Ce),!1},trigger:function(e){var t=this||e;return ge.test(t.type)&&t.click&&D(t,"input")&&Le(t,"click"),!0},_default:function(e){var t=e.target;return ge.test(t.type)&&t.click&&D(t,"input")&&Q.get(t,"click")||D(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},E.removeEvent=function(e,t,r){e.removeEventListener&&e.removeEventListener(t,r)},E.Event=function(e,t){if(!(this instanceof E.Event))return new E.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ce:je,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&E.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[E.expando]=!0},E.Event.prototype={constructor:E.Event,isDefaultPrevented:je,isPropagationStopped:je,isImmediatePropagationStopped:je,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ce,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ce,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ce,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},E.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&Te.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&ke.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},E.event.addProp),E.each({focus:"focusin",blur:"focusout"},function(e,t){E.event.special[e]={setup:function(){return Le(this,e,De),!1},trigger:function(){return Le(this,e),!0},delegateType:t}}),E.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){E.event.special[e]={delegateType:t,bindType:t,handle:function(e){var r,n=this,i=e.relatedTarget,a=e.handleObj;return i&&(i===n||E.contains(n,i))||(e.type=a.origType,r=a.handler.apply(this,arguments),e.type=t),r}}}),E.fn.extend({on:function(e,t,r,n){return Re(this,e,t,r,n)},one:function(e,t,r,n){return Re(this,e,t,r,n,1)},off:function(e,t,r){var n,i;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,E(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(r=t,t=void 0),!1===r&&(r=je),this.each(function(){E.event.remove(this,e,r,t)})}});var Ie=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Oe=/<script|<style|<link/i,Pe=/checked\s*(?:[^=]|=\s*.checked.)/i,Me=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ne(e,t){return D(e,"table")&&D(11!==t.nodeType?t:t.firstChild,"tr")&&E(e).children("tbody")[0]||e}function Fe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Be(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Ue(e,t){var r,n,i,a,s,o,l,u;if(1===t.nodeType){if(Q.hasData(e)&&(a=Q.access(e),s=Q.set(t,a),u=a.events))for(i in delete s.handle,s.events={},u)for(r=0,n=u[i].length;r<n;r++)E.event.add(t,i,u[i][r]);Z.hasData(e)&&(o=Z.access(e),l=E.extend({},o),Z.set(t,l))}}function Ge(e,t){var r=t.nodeName.toLowerCase();"input"===r&&ge.test(e.type)?t.checked=e.checked:"input"!==r&&"textarea"!==r||(t.defaultValue=e.defaultValue)}function ze(e,t,r,n){t=u.apply([],t);var i,a,s,o,l,c,d=0,h=e.length,f=h-1,p=t[0],g=_(p);if(g||h>1&&"string"==typeof p&&!v.checkClone&&Pe.test(p))return e.each(function(i){var a=e.eq(i);g&&(t[0]=p.call(this,i,a.html())),ze(a,t,r,n)});if(h&&(a=(i=xe(t,e[0].ownerDocument,!1,e,n)).firstChild,1===i.childNodes.length&&(i=a),a||n)){for(o=(s=E.map(ye(i,"script"),Fe)).length;d<h;d++)l=i,d!==f&&(l=E.clone(l,!0,!0),o&&E.merge(s,ye(l,"script"))),r.call(e[d],l,d);if(o)for(c=s[s.length-1].ownerDocument,E.map(s,Be),d=0;d<o;d++)l=s[d],ve.test(l.type||"")&&!Q.access(l,"globalEval")&&E.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?E._evalUrl&&!l.noModule&&E._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")}):w(l.textContent.replace(Me,""),l,c))}return e}function He(e,t,r){for(var n,i=t?E.filter(t,e):e,a=0;null!=(n=i[a]);a++)r||1!==n.nodeType||E.cleanData(ye(n)),n.parentNode&&(r&&oe(n)&&be(ye(n,"script")),n.parentNode.removeChild(n));return e}E.extend({htmlPrefilter:function(e){return e.replace(Ie,"<$1></$2>")},clone:function(e,t,r){var n,i,a,s,o=e.cloneNode(!0),l=oe(e);if(!(v.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||E.isXMLDoc(e)))for(s=ye(o),n=0,i=(a=ye(e)).length;n<i;n++)Ge(a[n],s[n]);if(t)if(r)for(a=a||ye(e),s=s||ye(o),n=0,i=a.length;n<i;n++)Ue(a[n],s[n]);else Ue(e,o);return(s=ye(o,"script")).length>0&&be(s,!l&&ye(e,"script")),o},cleanData:function(e){for(var t,r,n,i=E.event.special,a=0;void 0!==(r=e[a]);a++)if($(r)){if(t=r[Q.expando]){if(t.events)for(n in t.events)i[n]?E.event.remove(r,n):E.removeEvent(r,n,t.handle);r[Q.expando]=void 0}r[Z.expando]&&(r[Z.expando]=void 0)}}}),E.fn.extend({detach:function(e){return He(this,e,!0)},remove:function(e){return He(this,e)},text:function(e){return K(this,function(e){return void 0===e?E.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return ze(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ne(this,e).appendChild(e)})},prepend:function(){return ze(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ne(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return ze(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return ze(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(E.cleanData(ye(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return E.clone(this,e,t)})},html:function(e){return K(this,function(e){var t=this[0]||{},r=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Oe.test(e)&&!_e[(me.exec(e)||["",""])[1].toLowerCase()]){e=E.htmlPrefilter(e);try{for(;r<n;r++)1===(t=this[r]||{}).nodeType&&(E.cleanData(ye(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return ze(this,arguments,function(t){var r=this.parentNode;E.inArray(this,e)<0&&(E.cleanData(ye(this)),r&&r.replaceChild(t,this))},e)}}),E.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){E.fn[e]=function(e){for(var r,n=[],i=E(e),a=i.length-1,s=0;s<=a;s++)r=s===a?this:this.clone(!0),E(i[s])[t](r),c.apply(n,r.get());return this.pushStack(n)}});var Ve=new RegExp("^("+ne+")(?!px)[a-z%]+$","i"),Ke=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=r),t.getComputedStyle(e)},We=new RegExp(ae.join("|"),"i");function qe(e,t,r){var n,i,a,s,o=e.style;return(r=r||Ke(e))&&(""!==(s=r.getPropertyValue(t)||r[t])||oe(e)||(s=E.style(e,t)),!v.pixelBoxStyles()&&Ve.test(s)&&We.test(t)&&(n=o.width,i=o.minWidth,a=o.maxWidth,o.minWidth=o.maxWidth=o.width=s,s=r.width,o.width=n,o.minWidth=i,o.maxWidth=a)),void 0!==s?s+"":s}function Xe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(c){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",se.appendChild(u).appendChild(c);var e=r.getComputedStyle(c);n="1%"!==e.top,l=12===t(e.marginLeft),c.style.right="60%",o=36===t(e.right),i=36===t(e.width),c.style.position="absolute",a=12===t(c.offsetWidth/3),se.removeChild(u),c=null}}function t(e){return Math.round(parseFloat(e))}var n,i,a,o,l,u=s.createElement("div"),c=s.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===c.style.backgroundClip,E.extend(v,{boxSizingReliable:function(){return e(),i},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),a}}))}();var Ye=["Webkit","Moz","ms"],$e=s.createElement("div").style,Je={};function Qe(e){var t=E.cssProps[e]||Je[e];return t||(e in $e?e:Je[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),r=Ye.length;r--;)if((e=Ye[r]+t)in $e)return e}(e)||e)}var Ze=/^(none|table(?!-c[ea]).+)/,et=/^--/,tt={position:"absolute",visibility:"hidden",display:"block"},rt={letterSpacing:"0",fontWeight:"400"};function nt(e,t,r){var n=ie.exec(t);return n?Math.max(0,n[2]-(r||0))+(n[3]||"px"):t}function it(e,t,r,n,i,a){var s="width"===t?1:0,o=0,l=0;if(r===(n?"border":"content"))return 0;for(;s<4;s+=2)"margin"===r&&(l+=E.css(e,r+ae[s],!0,i)),n?("content"===r&&(l-=E.css(e,"padding"+ae[s],!0,i)),"margin"!==r&&(l-=E.css(e,"border"+ae[s]+"Width",!0,i))):(l+=E.css(e,"padding"+ae[s],!0,i),"padding"!==r?l+=E.css(e,"border"+ae[s]+"Width",!0,i):o+=E.css(e,"border"+ae[s]+"Width",!0,i));return!n&&a>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-a-l-o-.5))||0),l}function at(e,t,r){var n=Ke(e),i=(!v.boxSizingReliable()||r)&&"border-box"===E.css(e,"boxSizing",!1,n),a=i,s=qe(e,t,n),o="offset"+t[0].toUpperCase()+t.slice(1);if(Ve.test(s)){if(!r)return s;s="auto"}return(!v.boxSizingReliable()&&i||"auto"===s||!parseFloat(s)&&"inline"===E.css(e,"display",!1,n))&&e.getClientRects().length&&(i="border-box"===E.css(e,"boxSizing",!1,n),(a=o in e)&&(s=e[o])),(s=parseFloat(s)||0)+it(e,t,r||(i?"border":"content"),a,n,s)+"px"}function st(e,t,r,n,i){return new st.prototype.init(e,t,r,n,i)}E.extend({cssHooks:{opacity:{get:function(e,t){if(t){var r=qe(e,"opacity");return""===r?"1":r}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,r,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,a,s,o=Y(t),l=et.test(t),u=e.style;if(l||(t=Qe(o)),s=E.cssHooks[t]||E.cssHooks[o],void 0===r)return s&&"get"in s&&void 0!==(i=s.get(e,!1,n))?i:u[t];"string"===(a=typeof r)&&(i=ie.exec(r))&&i[1]&&(r=de(e,t,i),a="number"),null!=r&&r==r&&("number"!==a||l||(r+=i&&i[3]||(E.cssNumber[o]?"":"px")),v.clearCloneStyle||""!==r||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&void 0===(r=s.set(e,r,n))||(l?u.setProperty(t,r):u[t]=r))}},css:function(e,t,r,n){var i,a,s,o=Y(t);return et.test(t)||(t=Qe(o)),(s=E.cssHooks[t]||E.cssHooks[o])&&"get"in s&&(i=s.get(e,!0,r)),void 0===i&&(i=qe(e,t,n)),"normal"===i&&t in rt&&(i=rt[t]),""===r||r?(a=parseFloat(i),!0===r||isFinite(a)?a||0:i):i}}),E.each(["height","width"],function(e,t){E.cssHooks[t]={get:function(e,r,n){if(r)return!Ze.test(E.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?at(e,t,n):ce(e,tt,function(){return at(e,t,n)})},set:function(e,r,n){var i,a=Ke(e),s=!v.scrollboxSize()&&"absolute"===a.position,o=(s||n)&&"border-box"===E.css(e,"boxSizing",!1,a),l=n?it(e,t,n,o,a):0;return o&&s&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(a[t])-it(e,t,"border",!1,a)-.5)),l&&(i=ie.exec(r))&&"px"!==(i[3]||"px")&&(e.style[t]=r,r=E.css(e,t)),nt(0,r,l)}}}),E.cssHooks.marginLeft=Xe(v.reliableMarginLeft,function(e,t){if(t)return(parseFloat(qe(e,"marginLeft"))||e.getBoundingClientRect().left-ce(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),E.each({margin:"",padding:"",border:"Width"},function(e,t){E.cssHooks[e+t]={expand:function(r){for(var n=0,i={},a="string"==typeof r?r.split(" "):[r];n<4;n++)i[e+ae[n]+t]=a[n]||a[n-2]||a[0];return i}},"margin"!==e&&(E.cssHooks[e+t].set=nt)}),E.fn.extend({css:function(e,t){return K(this,function(e,t,r){var n,i,a={},s=0;if(Array.isArray(t)){for(n=Ke(e),i=t.length;s<i;s++)a[t[s]]=E.css(e,t[s],!1,n);return a}return void 0!==r?E.style(e,t,r):E.css(e,t)},e,t,arguments.length>1)}}),E.Tween=st,st.prototype={constructor:st,init:function(e,t,r,n,i,a){this.elem=e,this.prop=r,this.easing=i||E.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=a||(E.cssNumber[r]?"":"px")},cur:function(){var e=st.propHooks[this.prop];return e&&e.get?e.get(this):st.propHooks._default.get(this)},run:function(e){var t,r=st.propHooks[this.prop];return this.options.duration?this.pos=t=E.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),r&&r.set?r.set(this):st.propHooks._default.set(this),this}},st.prototype.init.prototype=st.prototype,st.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=E.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){E.fx.step[e.prop]?E.fx.step[e.prop](e):1!==e.elem.nodeType||!E.cssHooks[e.prop]&&null==e.elem.style[Qe(e.prop)]?e.elem[e.prop]=e.now:E.style(e.elem,e.prop,e.now+e.unit)}}},st.propHooks.scrollTop=st.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},E.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},E.fx=st.prototype.init,E.fx.step={};var ot,lt,ut=/^(?:toggle|show|hide)$/,ct=/queueHooks$/;function dt(){lt&&(!1===s.hidden&&r.requestAnimationFrame?r.requestAnimationFrame(dt):r.setTimeout(dt,E.fx.interval),E.fx.tick())}function ht(){return r.setTimeout(function(){ot=void 0}),ot=Date.now()}function ft(e,t){var r,n=0,i={height:e};for(t=t?1:0;n<4;n+=2-t)i["margin"+(r=ae[n])]=i["padding"+r]=e;return t&&(i.opacity=i.width=e),i}function pt(e,t,r){for(var n,i=(gt.tweeners[t]||[]).concat(gt.tweeners["*"]),a=0,s=i.length;a<s;a++)if(n=i[a].call(r,t,e))return n}function gt(e,t,r){var n,i,a=0,s=gt.prefilters.length,o=E.Deferred().always(function(){delete l.elem}),l=function(){if(i)return!1;for(var t=ot||ht(),r=Math.max(0,u.startTime+u.duration-t),n=1-(r/u.duration||0),a=0,s=u.tweens.length;a<s;a++)u.tweens[a].run(n);return o.notifyWith(e,[u,n,r]),n<1&&s?r:(s||o.notifyWith(e,[u,1,0]),o.resolveWith(e,[u]),!1)},u=o.promise({elem:e,props:E.extend({},t),opts:E.extend(!0,{specialEasing:{},easing:E.easing._default},r),originalProperties:t,originalOptions:r,startTime:ot||ht(),duration:r.duration,tweens:[],createTween:function(t,r){var n=E.Tween(e,u.opts,t,r,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(n),n},stop:function(t){var r=0,n=t?u.tweens.length:0;if(i)return this;for(i=!0;r<n;r++)u.tweens[r].run(1);return t?(o.notifyWith(e,[u,1,0]),o.resolveWith(e,[u,t])):o.rejectWith(e,[u,t]),this}}),c=u.props;for(!function(e,t){var r,n,i,a,s;for(r in e)if(i=t[n=Y(r)],a=e[r],Array.isArray(a)&&(i=a[1],a=e[r]=a[0]),r!==n&&(e[n]=a,delete e[r]),(s=E.cssHooks[n])&&"expand"in s)for(r in a=s.expand(a),delete e[n],a)r in e||(e[r]=a[r],t[r]=i);else t[n]=i}(c,u.opts.specialEasing);a<s;a++)if(n=gt.prefilters[a].call(u,e,c,u.opts))return _(n.stop)&&(E._queueHooks(u.elem,u.opts.queue).stop=n.stop.bind(n)),n;return E.map(c,pt,u),_(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),E.fx.timer(E.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u}E.Animation=E.extend(gt,{tweeners:{"*":[function(e,t){var r=this.createTween(e,t);return de(r.elem,e,ie.exec(t),r),r}]},tweener:function(e,t){_(e)?(t=e,e=["*"]):e=e.match(F);for(var r,n=0,i=e.length;n<i;n++)r=e[n],gt.tweeners[r]=gt.tweeners[r]||[],gt.tweeners[r].unshift(t)},prefilters:[function(e,t,r){var n,i,a,s,o,l,u,c,d="width"in t||"height"in t,h=this,f={},p=e.style,g=e.nodeType&&ue(e),m=Q.get(e,"fxshow");for(n in r.queue||(null==(s=E._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,o=s.empty.fire,s.empty.fire=function(){s.unqueued||o()}),s.unqueued++,h.always(function(){h.always(function(){s.unqueued--,E.queue(e,"fx").length||s.empty.fire()})})),t)if(i=t[n],ut.test(i)){if(delete t[n],a=a||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!m||void 0===m[n])continue;g=!0}f[n]=m&&m[n]||E.style(e,n)}if((l=!E.isEmptyObject(t))||!E.isEmptyObject(f))for(n in d&&1===e.nodeType&&(r.overflow=[p.overflow,p.overflowX,p.overflowY],null==(u=m&&m.display)&&(u=Q.get(e,"display")),"none"===(c=E.css(e,"display"))&&(u?c=u:(pe([e],!0),u=e.style.display||u,c=E.css(e,"display"),pe([e]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===E.css(e,"float")&&(l||(h.done(function(){p.display=u}),null==u&&(c=p.display,u="none"===c?"":c)),p.display="inline-block")),r.overflow&&(p.overflow="hidden",h.always(function(){p.overflow=r.overflow[0],p.overflowX=r.overflow[1],p.overflowY=r.overflow[2]})),l=!1,f)l||(m?"hidden"in m&&(g=m.hidden):m=Q.access(e,"fxshow",{display:u}),a&&(m.hidden=!g),g&&pe([e],!0),h.done(function(){for(n in g||pe([e]),Q.remove(e,"fxshow"),f)E.style(e,n,f[n])})),l=pt(g?m[n]:0,n,h),n in m||(m[n]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?gt.prefilters.unshift(e):gt.prefilters.push(e)}}),E.speed=function(e,t,r){var n=e&&"object"==typeof e?E.extend({},e):{complete:r||!r&&t||_(e)&&e,duration:e,easing:r&&t||t&&!_(t)&&t};return E.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in E.fx.speeds?n.duration=E.fx.speeds[n.duration]:n.duration=E.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){_(n.old)&&n.old.call(this),n.queue&&E.dequeue(this,n.queue)},n},E.fn.extend({fadeTo:function(e,t,r,n){return this.filter(ue).css("opacity",0).show().end().animate({opacity:t},e,r,n)},animate:function(e,t,r,n){var i=E.isEmptyObject(e),a=E.speed(t,r,n),s=function(){var t=gt(this,E.extend({},e),a);(i||Q.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||!1===a.queue?this.each(s):this.queue(a.queue,s)},stop:function(e,t,r){var n=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",a=E.timers,s=Q.get(this);if(i)s[i]&&s[i].stop&&n(s[i]);else for(i in s)s[i]&&s[i].stop&&ct.test(i)&&n(s[i]);for(i=a.length;i--;)a[i].elem!==this||null!=e&&a[i].queue!==e||(a[i].anim.stop(r),t=!1,a.splice(i,1));!t&&r||E.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,r=Q.get(this),n=r[e+"queue"],i=r[e+"queueHooks"],a=E.timers,s=n?n.length:0;for(r.finish=!0,E.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=a.length;t--;)a[t].elem===this&&a[t].queue===e&&(a[t].anim.stop(!0),a.splice(t,1));for(t=0;t<s;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete r.finish})}}),E.each(["toggle","show","hide"],function(e,t){var r=E.fn[t];E.fn[t]=function(e,n,i){return null==e||"boolean"==typeof e?r.apply(this,arguments):this.animate(ft(t,!0),e,n,i)}}),E.each({slideDown:ft("show"),slideUp:ft("hide"),slideToggle:ft("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){E.fn[e]=function(e,r,n){return this.animate(t,e,r,n)}}),E.timers=[],E.fx.tick=function(){var e,t=0,r=E.timers;for(ot=Date.now();t<r.length;t++)(e=r[t])()||r[t]!==e||r.splice(t--,1);r.length||E.fx.stop(),ot=void 0},E.fx.timer=function(e){E.timers.push(e),E.fx.start()},E.fx.interval=13,E.fx.start=function(){lt||(lt=!0,dt())},E.fx.stop=function(){lt=null},E.fx.speeds={slow:600,fast:200,_default:400},E.fn.delay=function(e,t){return e=E.fx&&E.fx.speeds[e]||e,t=t||"fx",this.queue(t,function(t,n){var i=r.setTimeout(t,e);n.stop=function(){r.clearTimeout(i)}})},function(){var e=s.createElement("input"),t=s.createElement("select").appendChild(s.createElement("option"));e.type="checkbox",v.checkOn=""!==e.value,v.optSelected=t.selected,(e=s.createElement("input")).value="t",e.type="radio",v.radioValue="t"===e.value}();var mt,vt=E.expr.attrHandle;E.fn.extend({attr:function(e,t){return K(this,E.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){E.removeAttr(this,e)})}}),E.extend({attr:function(e,t,r){var n,i,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return void 0===e.getAttribute?E.prop(e,t,r):(1===a&&E.isXMLDoc(e)||(i=E.attrHooks[t.toLowerCase()]||(E.expr.match.bool.test(t)?mt:void 0)),void 0!==r?null===r?void E.removeAttr(e,t):i&&"set"in i&&void 0!==(n=i.set(e,r,t))?n:(e.setAttribute(t,r+""),r):i&&"get"in i&&null!==(n=i.get(e,t))?n:null==(n=E.find.attr(e,t))?void 0:n)},attrHooks:{type:{set:function(e,t){if(!v.radioValue&&"radio"===t&&D(e,"input")){var r=e.value;return e.setAttribute("type",t),r&&(e.value=r),t}}}},removeAttr:function(e,t){var r,n=0,i=t&&t.match(F);if(i&&1===e.nodeType)for(;r=i[n++];)e.removeAttribute(r)}}),mt={set:function(e,t,r){return!1===t?E.removeAttr(e,r):e.setAttribute(r,r),r}},E.each(E.expr.match.bool.source.match(/\w+/g),function(e,t){var r=vt[t]||E.find.attr;vt[t]=function(e,t,n){var i,a,s=t.toLowerCase();return n||(a=vt[s],vt[s]=i,i=null!=r(e,t,n)?s:null,vt[s]=a),i}});var _t=/^(?:input|select|textarea|button)$/i,yt=/^(?:a|area)$/i;function bt(e){return(e.match(F)||[]).join(" ")}function wt(e){return e.getAttribute&&e.getAttribute("class")||""}function St(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(F)||[]}E.fn.extend({prop:function(e,t){return K(this,E.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[E.propFix[e]||e]})}}),E.extend({prop:function(e,t,r){var n,i,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&E.isXMLDoc(e)||(t=E.propFix[t]||t,i=E.propHooks[t]),void 0!==r?i&&"set"in i&&void 0!==(n=i.set(e,r,t))?n:e[t]=r:i&&"get"in i&&null!==(n=i.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=E.find.attr(e,"tabindex");return t?parseInt(t,10):_t.test(e.nodeName)||yt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),v.optSelected||(E.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),E.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){E.propFix[this.toLowerCase()]=this}),E.fn.extend({addClass:function(e){var t,r,n,i,a,s,o,l=0;if(_(e))return this.each(function(t){E(this).addClass(e.call(this,t,wt(this)))});if((t=St(e)).length)for(;r=this[l++];)if(i=wt(r),n=1===r.nodeType&&" "+bt(i)+" "){for(s=0;a=t[s++];)n.indexOf(" "+a+" ")<0&&(n+=a+" ");i!==(o=bt(n))&&r.setAttribute("class",o)}return this},removeClass:function(e){var t,r,n,i,a,s,o,l=0;if(_(e))return this.each(function(t){E(this).removeClass(e.call(this,t,wt(this)))});if(!arguments.length)return this.attr("class","");if((t=St(e)).length)for(;r=this[l++];)if(i=wt(r),n=1===r.nodeType&&" "+bt(i)+" "){for(s=0;a=t[s++];)for(;n.indexOf(" "+a+" ")>-1;)n=n.replace(" "+a+" "," ");i!==(o=bt(n))&&r.setAttribute("class",o)}return this},toggleClass:function(e,t){var r=typeof e,n="string"===r||Array.isArray(e);return"boolean"==typeof t&&n?t?this.addClass(e):this.removeClass(e):_(e)?this.each(function(r){E(this).toggleClass(e.call(this,r,wt(this),t),t)}):this.each(function(){var t,i,a,s;if(n)for(i=0,a=E(this),s=St(e);t=s[i++];)a.hasClass(t)?a.removeClass(t):a.addClass(t);else void 0!==e&&"boolean"!==r||((t=wt(this))&&Q.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":Q.get(this,"__className__")||""))})},hasClass:function(e){var t,r,n=0;for(t=" "+e+" ";r=this[n++];)if(1===r.nodeType&&(" "+bt(wt(r))+" ").indexOf(t)>-1)return!0;return!1}});var Et=/\r/g;E.fn.extend({val:function(e){var t,r,n,i=this[0];return arguments.length?(n=_(e),this.each(function(r){var i;1===this.nodeType&&(null==(i=n?e.call(this,r,E(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=E.map(i,function(e){return null==e?"":e+""})),(t=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))})):i?(t=E.valHooks[i.type]||E.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(r=t.get(i,"value"))?r:"string"==typeof(r=i.value)?r.replace(Et,""):null==r?"":r:void 0}}),E.extend({valHooks:{option:{get:function(e){var t=E.find.attr(e,"value");return null!=t?t:bt(E.text(e))}},select:{get:function(e){var t,r,n,i=e.options,a=e.selectedIndex,s="select-one"===e.type,o=s?null:[],l=s?a+1:i.length;for(n=a<0?l:s?a:0;n<l;n++)if(((r=i[n]).selected||n===a)&&!r.disabled&&(!r.parentNode.disabled||!D(r.parentNode,"optgroup"))){if(t=E(r).val(),s)return t;o.push(t)}return o},set:function(e,t){for(var r,n,i=e.options,a=E.makeArray(t),s=i.length;s--;)((n=i[s]).selected=E.inArray(E.valHooks.option.get(n),a)>-1)&&(r=!0);return r||(e.selectedIndex=-1),a}}}}),E.each(["radio","checkbox"],function(){E.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=E.inArray(E(e).val(),t)>-1}},v.checkOn||(E.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),v.focusin="onfocusin"in r;var xt=/^(?:focusinfocus|focusoutblur)$/,Tt=function(e){e.stopPropagation()};E.extend(E.event,{trigger:function(e,t,n,i){var a,o,l,u,c,d,h,f,g=[n||s],m=p.call(e,"type")?e.type:e,v=p.call(e,"namespace")?e.namespace.split("."):[];if(o=f=l=n=n||s,3!==n.nodeType&&8!==n.nodeType&&!xt.test(m+E.event.triggered)&&(m.indexOf(".")>-1&&(v=m.split("."),m=v.shift(),v.sort()),c=m.indexOf(":")<0&&"on"+m,(e=e[E.expando]?e:new E.Event(m,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=v.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:E.makeArray(t,[e]),h=E.event.special[m]||{},i||!h.trigger||!1!==h.trigger.apply(n,t))){if(!i&&!h.noBubble&&!y(n)){for(u=h.delegateType||m,xt.test(u+m)||(o=o.parentNode);o;o=o.parentNode)g.push(o),l=o;l===(n.ownerDocument||s)&&g.push(l.defaultView||l.parentWindow||r)}for(a=0;(o=g[a++])&&!e.isPropagationStopped();)f=o,e.type=a>1?u:h.bindType||m,(d=(Q.get(o,"events")||{})[e.type]&&Q.get(o,"handle"))&&d.apply(o,t),(d=c&&o[c])&&d.apply&&$(o)&&(e.result=d.apply(o,t),!1===e.result&&e.preventDefault());return e.type=m,i||e.isDefaultPrevented()||h._default&&!1!==h._default.apply(g.pop(),t)||!$(n)||c&&_(n[m])&&!y(n)&&((l=n[c])&&(n[c]=null),E.event.triggered=m,e.isPropagationStopped()&&f.addEventListener(m,Tt),n[m](),e.isPropagationStopped()&&f.removeEventListener(m,Tt),E.event.triggered=void 0,l&&(n[c]=l)),e.result}},simulate:function(e,t,r){var n=E.extend(new E.Event,r,{type:e,isSimulated:!0});E.event.trigger(n,null,t)}}),E.fn.extend({trigger:function(e,t){return this.each(function(){E.event.trigger(e,t,this)})},triggerHandler:function(e,t){var r=this[0];if(r)return E.event.trigger(e,t,r,!0)}}),v.focusin||E.each({focus:"focusin",blur:"focusout"},function(e,t){var r=function(e){E.event.simulate(t,e.target,E.event.fix(e))};E.event.special[t]={setup:function(){var n=this.ownerDocument||this,i=Q.access(n,t);i||n.addEventListener(e,r,!0),Q.access(n,t,(i||0)+1)},teardown:function(){var n=this.ownerDocument||this,i=Q.access(n,t)-1;i?Q.access(n,t,i):(n.removeEventListener(e,r,!0),Q.remove(n,t))}}});var kt=r.location,At=Date.now(),Ct=/\?/;E.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new r.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||E.error("Invalid XML: "+e),t};var jt=/\[\]$/,Dt=/\r?\n/g,Rt=/^(?:submit|button|image|reset|file)$/i,Lt=/^(?:input|select|textarea|keygen)/i;function It(e,t,r,n){var i;if(Array.isArray(t))E.each(t,function(t,i){r||jt.test(e)?n(e,i):It(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,r,n)});else if(r||"object"!==S(t))n(e,t);else for(i in t)It(e+"["+i+"]",t[i],r,n)}E.param=function(e,t){var r,n=[],i=function(e,t){var r=_(t)?t():t;n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==r?"":r)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!E.isPlainObject(e))E.each(e,function(){i(this.name,this.value)});else for(r in e)It(r,e[r],t,i);return n.join("&")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=E.prop(this,"elements");return e?E.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!E(this).is(":disabled")&&Lt.test(this.nodeName)&&!Rt.test(e)&&(this.checked||!ge.test(e))}).map(function(e,t){var r=E(this).val();return null==r?null:Array.isArray(r)?E.map(r,function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}}):{name:t.name,value:r.replace(Dt,"\r\n")}}).get()}});var Ot=/%20/g,Pt=/#.*$/,Mt=/([?&])_=[^&]*/,Nt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ft=/^(?:GET|HEAD)$/,Bt=/^\/\//,Ut={},Gt={},zt="*/".concat("*"),Ht=s.createElement("a");function Vt(e){return function(t,r){"string"!=typeof t&&(r=t,t="*");var n,i=0,a=t.toLowerCase().match(F)||[];if(_(r))for(;n=a[i++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(r)):(e[n]=e[n]||[]).push(r)}}function Kt(e,t,r,n){var i={},a=e===Gt;function s(o){var l;return i[o]=!0,E.each(e[o]||[],function(e,o){var u=o(t,r,n);return"string"!=typeof u||a||i[u]?a?!(l=u):void 0:(t.dataTypes.unshift(u),s(u),!1)}),l}return s(t.dataTypes[0])||!i["*"]&&s("*")}function Wt(e,t){var r,n,i=E.ajaxSettings.flatOptions||{};for(r in t)void 0!==t[r]&&((i[r]?e:n||(n={}))[r]=t[r]);return n&&E.extend(!0,e,n),e}Ht.href=kt.href,E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:kt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(kt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Wt(Wt(e,E.ajaxSettings),t):Wt(E.ajaxSettings,e)},ajaxPrefilter:Vt(Ut),ajaxTransport:Vt(Gt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i,a,o,l,u,c,d,h,f,p=E.ajaxSetup({},t),g=p.context||p,m=p.context&&(g.nodeType||g.jquery)?E(g):E.event,v=E.Deferred(),_=E.Callbacks("once memory"),y=p.statusCode||{},b={},w={},S="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(c){if(!o)for(o={};t=Nt.exec(a);)o[t[1].toLowerCase()+" "]=(o[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=o[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return c?a:null},setRequestHeader:function(e,t){return null==c&&(e=w[e.toLowerCase()]=w[e.toLowerCase()]||e,b[e]=t),this},overrideMimeType:function(e){return null==c&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)x.always(e[x.status]);else for(t in e)y[t]=[y[t],e[t]];return this},abort:function(e){var t=e||S;return n&&n.abort(t),T(0,t),this}};if(v.promise(x),p.url=((e||p.url||kt.href)+"").replace(Bt,kt.protocol+"//"),p.type=t.method||t.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(F)||[""],null==p.crossDomain){u=s.createElement("a");try{u.href=p.url,u.href=u.href,p.crossDomain=Ht.protocol+"//"+Ht.host!=u.protocol+"//"+u.host}catch(e){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=E.param(p.data,p.traditional)),Kt(Ut,p,t,x),c)return x;for(h in(d=E.event&&p.global)&&0==E.active++&&E.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Ft.test(p.type),i=p.url.replace(Pt,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Ot,"+")):(f=p.url.slice(i.length),p.data&&(p.processData||"string"==typeof p.data)&&(i+=(Ct.test(i)?"&":"?")+p.data,delete p.data),!1===p.cache&&(i=i.replace(Mt,"$1"),f=(Ct.test(i)?"&":"?")+"_="+At+++f),p.url=i+f),p.ifModified&&(E.lastModified[i]&&x.setRequestHeader("If-Modified-Since",E.lastModified[i]),E.etag[i]&&x.setRequestHeader("If-None-Match",E.etag[i])),(p.data&&p.hasContent&&!1!==p.contentType||t.contentType)&&x.setRequestHeader("Content-Type",p.contentType),x.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+zt+"; q=0.01":""):p.accepts["*"]),p.headers)x.setRequestHeader(h,p.headers[h]);if(p.beforeSend&&(!1===p.beforeSend.call(g,x,p)||c))return x.abort();if(S="abort",_.add(p.complete),x.done(p.success),x.fail(p.error),n=Kt(Gt,p,t,x)){if(x.readyState=1,d&&m.trigger("ajaxSend",[x,p]),c)return x;p.async&&p.timeout>0&&(l=r.setTimeout(function(){x.abort("timeout")},p.timeout));try{c=!1,n.send(b,T)}catch(e){if(c)throw e;T(-1,e)}}else T(-1,"No Transport");function T(e,t,s,o){var u,h,f,b,w,S=t;c||(c=!0,l&&r.clearTimeout(l),n=void 0,a=o||"",x.readyState=e>0?4:0,u=e>=200&&e<300||304===e,s&&(b=function(e,t,r){for(var n,i,a,s,o=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(i in o)if(o[i]&&o[i].test(n)){l.unshift(i);break}if(l[0]in r)a=l[0];else{for(i in r){if(!l[0]||e.converters[i+" "+l[0]]){a=i;break}s||(s=i)}a=a||s}if(a)return a!==l[0]&&l.unshift(a),r[a]}(p,x,s)),b=function(e,t,r,n){var i,a,s,o,l,u={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)u[s.toLowerCase()]=e.converters[s];for(a=c.shift();a;)if(e.responseFields[a]&&(r[e.responseFields[a]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=a,a=c.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(!(s=u[l+" "+a]||u["* "+a]))for(i in u)if((o=i.split(" "))[1]===a&&(s=u[l+" "+o[0]]||u["* "+o[0]])){!0===s?s=u[i]:!0!==u[i]&&(a=o[0],c.unshift(o[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+l+" to "+a}}}return{state:"success",data:t}}(p,b,x,u),u?(p.ifModified&&((w=x.getResponseHeader("Last-Modified"))&&(E.lastModified[i]=w),(w=x.getResponseHeader("etag"))&&(E.etag[i]=w)),204===e||"HEAD"===p.type?S="nocontent":304===e?S="notmodified":(S=b.state,h=b.data,u=!(f=b.error))):(f=S,!e&&S||(S="error",e<0&&(e=0))),x.status=e,x.statusText=(t||S)+"",u?v.resolveWith(g,[h,S,x]):v.rejectWith(g,[x,S,f]),x.statusCode(y),y=void 0,d&&m.trigger(u?"ajaxSuccess":"ajaxError",[x,p,u?h:f]),_.fireWith(g,[x,S]),d&&(m.trigger("ajaxComplete",[x,p]),--E.active||E.event.trigger("ajaxStop")))}return x},getJSON:function(e,t,r){return E.get(e,t,r,"json")},getScript:function(e,t){return E.get(e,void 0,t,"script")}}),E.each(["get","post"],function(e,t){E[t]=function(e,r,n,i){return _(r)&&(i=i||n,n=r,r=void 0),E.ajax(E.extend({url:e,type:t,dataType:i,data:r,success:n},E.isPlainObject(e)&&e))}}),E._evalUrl=function(e,t){return E.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){E.globalEval(e,t)}})},E.fn.extend({wrapAll:function(e){var t;return this[0]&&(_(e)&&(e=e.call(this[0])),t=E(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return _(e)?this.each(function(t){E(this).wrapInner(e.call(this,t))}):this.each(function(){var t=E(this),r=t.contents();r.length?r.wrapAll(e):t.append(e)})},wrap:function(e){var t=_(e);return this.each(function(r){E(this).wrapAll(t?e.call(this,r):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){E(this).replaceWith(this.childNodes)}),this}}),E.expr.pseudos.hidden=function(e){return!E.expr.pseudos.visible(e)},E.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},E.ajaxSettings.xhr=function(){try{return new r.XMLHttpRequest}catch(e){}};var qt={0:200,1223:204},Xt=E.ajaxSettings.xhr();v.cors=!!Xt&&"withCredentials"in Xt,v.ajax=Xt=!!Xt,E.ajaxTransport(function(e){var t,n;if(v.cors||Xt&&!e.crossDomain)return{send:function(i,a){var s,o=e.xhr();if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)o[s]=e.xhrFields[s];for(s in e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)o.setRequestHeader(s,i[s]);t=function(e){return function(){t&&(t=n=o.onload=o.onerror=o.onabort=o.ontimeout=o.onreadystatechange=null,"abort"===e?o.abort():"error"===e?"number"!=typeof o.status?a(0,"error"):a(o.status,o.statusText):a(qt[o.status]||o.status,o.statusText,"text"!==(o.responseType||"text")||"string"!=typeof o.responseText?{binary:o.response}:{text:o.responseText},o.getAllResponseHeaders()))}},o.onload=t(),n=o.onerror=o.ontimeout=t("error"),void 0!==o.onabort?o.onabort=n:o.onreadystatechange=function(){4===o.readyState&&r.setTimeout(function(){t&&n()})},t=t("abort");try{o.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}}),E.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return E.globalEval(e),e}}}),E.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),E.ajaxTransport("script",function(e){var t,r;if(e.crossDomain||e.scriptAttrs)return{send:function(n,i){t=E("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",r=function(e){t.remove(),r=null,e&&i("error"===e.type?404:200,e.type)}),s.head.appendChild(t[0])},abort:function(){r&&r()}}});var Yt,$t=[],Jt=/(=)\?(?=&|$)|\?\?/;E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=$t.pop()||E.expando+"_"+At++;return this[e]=!0,e}}),E.ajaxPrefilter("json jsonp",function(e,t,n){var i,a,s,o=!1!==e.jsonp&&(Jt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Jt.test(e.data)&&"data");if(o||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=_(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,o?e[o]=e[o].replace(Jt,"$1"+i):!1!==e.jsonp&&(e.url+=(Ct.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return s||E.error(i+" was not called"),s[0]},e.dataTypes[0]="json",a=r[i],r[i]=function(){s=arguments},n.always(function(){void 0===a?E(r).removeProp(i):r[i]=a,e[i]&&(e.jsonpCallback=t.jsonpCallback,$t.push(i)),s&&_(a)&&a(s[0]),s=a=void 0}),"script"}),v.createHTMLDocument=((Yt=s.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Yt.childNodes.length),E.parseHTML=function(e,t,r){return"string"!=typeof e?[]:("boolean"==typeof t&&(r=t,t=!1),t||(v.createHTMLDocument?((n=(t=s.implementation.createHTMLDocument("")).createElement("base")).href=s.location.href,t.head.appendChild(n)):t=s),a=!r&&[],(i=R.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,a),a&&a.length&&E(a).remove(),E.merge([],i.childNodes)));var n,i,a},E.fn.load=function(e,t,r){var n,i,a,s=this,o=e.indexOf(" ");return o>-1&&(n=bt(e.slice(o)),e=e.slice(0,o)),_(t)?(r=t,t=void 0):t&&"object"==typeof t&&(i="POST"),s.length>0&&E.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){a=arguments,s.html(n?E("<div>").append(E.parseHTML(e)).find(n):e)}).always(r&&function(e,t){s.each(function(){r.apply(this,a||[e.responseText,t,e])})}),this},E.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){E.fn[t]=function(e){return this.on(t,e)}}),E.expr.pseudos.animated=function(e){return E.grep(E.timers,function(t){return e===t.elem}).length},E.offset={setOffset:function(e,t,r){var n,i,a,s,o,l,u=E.css(e,"position"),c=E(e),d={};"static"===u&&(e.style.position="relative"),o=c.offset(),a=E.css(e,"top"),l=E.css(e,"left"),("absolute"===u||"fixed"===u)&&(a+l).indexOf("auto")>-1?(s=(n=c.position()).top,i=n.left):(s=parseFloat(a)||0,i=parseFloat(l)||0),_(t)&&(t=t.call(e,r,E.extend({},o))),null!=t.top&&(d.top=t.top-o.top+s),null!=t.left&&(d.left=t.left-o.left+i),"using"in t?t.using.call(e,d):c.css(d)}},E.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){E.offset.setOffset(this,e,t)});var t,r,n=this[0];return n?n.getClientRects().length?(t=n.getBoundingClientRect(),r=n.ownerDocument.defaultView,{top:t.top+r.pageYOffset,left:t.left+r.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,r,n=this[0],i={top:0,left:0};if("fixed"===E.css(n,"position"))t=n.getBoundingClientRect();else{for(t=this.offset(),r=n.ownerDocument,e=n.offsetParent||r.documentElement;e&&(e===r.body||e===r.documentElement)&&"static"===E.css(e,"position");)e=e.parentNode;e&&e!==n&&1===e.nodeType&&((i=E(e).offset()).top+=E.css(e,"borderTopWidth",!0),i.left+=E.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-E.css(n,"marginTop",!0),left:t.left-i.left-E.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===E.css(e,"position");)e=e.offsetParent;return e||se})}}),E.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var r="pageYOffset"===t;E.fn[e]=function(n){return K(this,function(e,n,i){var a;if(y(e)?a=e:9===e.nodeType&&(a=e.defaultView),void 0===i)return a?a[t]:e[n];a?a.scrollTo(r?a.pageXOffset:i,r?i:a.pageYOffset):e[n]=i},e,n,arguments.length)}}),E.each(["top","left"],function(e,t){E.cssHooks[t]=Xe(v.pixelPosition,function(e,r){if(r)return r=qe(e,t),Ve.test(r)?E(e).position()[t]+"px":r})}),E.each({Height:"height",Width:"width"},function(e,t){E.each({padding:"inner"+e,content:t,"":"outer"+e},function(r,n){E.fn[n]=function(i,a){var s=arguments.length&&(r||"boolean"!=typeof i),o=r||(!0===i||!0===a?"margin":"border");return K(this,function(t,r,i){var a;return y(t)?0===n.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(a=t.documentElement,Math.max(t.body["scroll"+e],a["scroll"+e],t.body["offset"+e],a["offset"+e],a["client"+e])):void 0===i?E.css(t,r,o):E.style(t,r,i,o)},t,s?i:void 0,s)}})}),E.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){E.fn[t]=function(e,r){return arguments.length>0?this.on(t,null,e,r):this.trigger(t)}}),E.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),E.fn.extend({bind:function(e,t,r){return this.on(e,null,t,r)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,r,n){return this.on(t,e,r,n)},undelegate:function(e,t,r){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",r)}}),E.proxy=function(e,t){var r,n,i;if("string"==typeof t&&(r=e[t],t=e,e=r),_(e))return n=l.call(arguments,2),(i=function(){return e.apply(t||this,n.concat(l.call(arguments)))}).guid=e.guid=e.guid||E.guid++,i},E.holdReady=function(e){e?E.readyWait++:E.ready(!0)},E.isArray=Array.isArray,E.parseJSON=JSON.parse,E.nodeName=D,E.isFunction=_,E.isWindow=y,E.camelCase=Y,E.type=S,E.now=Date.now,E.isNumeric=function(e){var t=E.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},void 0===(n=function(){return E}.apply(t,[]))||(e.exports=n);var Qt=r.jQuery,Zt=r.$;return E.noConflict=function(e){return r.$===E&&(r.$=Zt),e&&r.jQuery===E&&(r.jQuery=Qt),E},i||(r.jQuery=r.$=E),E})},function(e,t,r){var n=window.define,i=r(27);n("flvjs",function(){return i});var a=r(9);r(10),n("jstree",function(){return a});var s=r(4);n("jQuery",function(){return s});var o=r(17);n("hlsjs",function(){return o});var l=r(18);n("howler",function(){return l});var u=r(19);n("shaka",function(){return u});var c=r(20);r(21),n("swiper",function(){return c});var d=r(23);n("sortable",function(){return d});var h=r(24);r(25),n("libjass",function(){return h})},function(e,t,r){(function(t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,a=void 0,s=void 0,o=function(e,t){p[i]=e,p[i+1]=t,2===(i+=2)&&(s?s(g):b())},l="undefined"!=typeof window?window:void 0,u=l||{},c=u.MutationObserver||u.WebKitMutationObserver,d="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(g,1)}}var p=new Array(1e3);function g(){for(var e=0;e<i;e+=2){(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0}i=0}var m,v,_,y,b=void 0;function w(e,t){var r=this,n=new this.constructor(x);void 0===n[E]&&N(n);var i=r._state;if(i){var a=arguments[i-1];o(function(){return P(i,n,a,r._result)})}else I(r,n,e,t);return n}function S(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(x);return j(t,e),t}d?b=function(){return t.nextTick(g)}:c?(v=0,_=new c(g),y=document.createTextNode(""),_.observe(y,{characterData:!0}),b=function(){y.data=v=++v%2}):h?((m=new MessageChannel).port1.onmessage=g,b=function(){return m.port2.postMessage(0)}):b=void 0===l?function(){try{var e=Function("return this")().require("vertx");return void 0!==(a=e.runOnLoop||e.runOnContext)?function(){a(g)}:f()}catch(e){return f()}}():f();var E=Math.random().toString(36).substring(2);function x(){}var T=void 0,k=1,A=2;function C(t,r,n){r.constructor===t.constructor&&n===w&&r.constructor.resolve===S?function(e,t){t._state===k?R(e,t._result):t._state===A?L(e,t._result):I(t,void 0,function(t){return j(e,t)},function(t){return L(e,t)})}(t,r):void 0===n?R(t,r):e(n)?function(e,t,r){o(function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,function(r){n||(n=!0,t!==r?j(e,r):R(e,r))},function(t){n||(n=!0,L(e,t))},e._label);!n&&i&&(n=!0,L(e,i))},e)}(t,r,n):R(t,r)}function j(e,t){if(e===t)L(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(n=t),null===n||"object"!==i&&"function"!==i)R(e,t);else{var r=void 0;try{r=t.then}catch(t){return void L(e,t)}C(e,t,r)}var n,i}function D(e){e._onerror&&e._onerror(e._result),O(e)}function R(e,t){e._state===T&&(e._result=t,e._state=k,0!==e._subscribers.length&&o(O,e))}function L(e,t){e._state===T&&(e._state=A,e._result=t,o(D,e))}function I(e,t,r,n){var i=e._subscribers,a=i.length;e._onerror=null,i[a]=t,i[a+k]=r,i[a+A]=n,0===a&&e._state&&o(O,e)}function O(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,a=e._result,s=0;s<t.length;s+=3)n=t[s],i=t[s+r],n?P(r,n,i,a):i(a);e._subscribers.length=0}}function P(t,r,n,i){var a=e(n),s=void 0,o=void 0,l=!0;if(a){try{s=n(i)}catch(e){l=!1,o=e}if(r===s)return void L(r,new TypeError("A promises callback cannot return that same promise."))}else s=i;r._state!==T||(a&&l?j(r,s):!1===l?L(r,o):t===k?R(r,s):t===A&&L(r,s))}var M=0;function N(e){e[E]=M++,e._state=void 0,e._result=void 0,e._subscribers=[]}var F=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(x),this.promise[E]||N(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?R(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&R(this.promise,this._result))):L(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===T&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===S){var i=void 0,a=void 0,s=!1;try{i=e.then}catch(e){s=!0,a=e}if(i===w&&e._state!==T)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===B){var o=new r(x);s?L(o,a):C(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===T&&(this._remaining--,e===A?L(n,r):this._result[t]=r),0===this._remaining&&R(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;I(e,void 0,function(e){return r._settledAt(k,t,e)},function(e){return r._settledAt(A,t,e)})},e}(),B=function(){function t(e){this[E]=M++,this._result=this._state=void 0,this._subscribers=[],x!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t(function(t){j(e,t)},function(t){L(e,t)})}catch(t){L(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})}):this.then(t,t)},t}();return B.prototype.then=w,B.all=function(e){return new F(this,e).promise},B.race=function(e){var t=this;return n(e)?new t(function(r,n){for(var i=e.length,a=0;a<i;a++)t.resolve(e[a]).then(r,n)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},B.resolve=S,B.reject=function(e){var t=new this(x);return L(t,e),t},B._setScheduler=function(e){s=e},B._setAsap=function(e){o=e},B._asap=o,B.polyfill=function(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=B},B.Promise=B,B},e.exports=n()}).call(this,r(7),r(1))},function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var l,u=[],c=!1,d=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&f())}function f(){if(!c){var e=o(h);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),1!==u.length||c||o(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var r=arguments[3],n=arguments[4],i=arguments[5],a=JSON.stringify;e.exports=function(e,t){for(var s,o=Object.keys(i),l=0,u=o.length;l<u;l++){var c=o[l],d=i[c].exports;if(d===e||d&&d.default===e){s=c;break}}if(!s){s=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var h={};for(l=0,u=o.length;l<u;l++){h[c=o[l]]=c}n[s]=["function(require,module,exports){"+e+"(self); }",h]}var f=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[s]=s,n[f]=["function(require,module,exports){var f = require("+a(s)+");(f.default ? f.default : f)(self);}",p];var g={};!function e(t){g[t]=!0;for(var r in n[t][1]){var i=n[t][1][r];g[i]||e(i)}}(f);var m="("+r+")({"+Object.keys(g).map(function(e){return a(e)+":["+n[e][0]+","+a(n[e][1])+"]"}).join(",")+"},{},["+a(f)+"])",v=window.URL||window.webkitURL||window.mozURL||window.msURL,_=new Blob([m],{type:"text/javascript"});if(t&&t.bare)return _;var y=v.createObjectURL(_),b=new Worker(y);return b.objectURL=y,b}},function(e,t,r){var n,i,a;!function(s){"use strict";i=[r(4)],void 0===(a="function"==typeof(n=function(e,t){
/*!
 * jsTree 3.3.8
 * http://jstree.com/
 *
 * Copyright (c) 2014 Ivan Bozhanov (http://vakata.com)
 *
 * Licensed same as jquery - under the terms of the MIT License
 *   http://www.opensource.org/licenses/mit-license.php
 */
/*!
 * if using jslint please allow for the jQuery global and use following options:
 * jslint: loopfunc: true, browser: true, ass: true, bitwise: true, continue: true, nomen: true, plusplus: true, regexp: true, unparam: true, todo: true, white: true
 */
if(e.jstree)return;var r=0,n=!1,i=!1,a=!1,s=[],o=e("script:last").attr("src"),l=window.document;e.jstree={version:"3.3.8",defaults:{plugins:[]},plugins:{},path:o&&-1!==o.indexOf("/")?o.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,n){var i=new e.jstree.core(++r),a=n;return n=e.extend(!0,{},e.jstree.defaults,n),a&&a.plugins&&(n.plugins=a.plugins),e.each(n.plugins,function(e,t){"core"!==e&&(i=i.plugin(t,n[t]))}),e(t).data("jstree",i),i.init(t,n),i},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(l).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var r=null,n=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!n||!n.length)try{n=e(t)}catch(e){}if(!n||!n.length)try{n=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(e){}return n&&n.length&&(n=n.closest(".jstree")).length&&(n=n.data("jstree"))?r=n:e(".jstree").each(function(){var n=e(this).data("jstree");if(n&&n._model.data[t])return r=n,!1}),r},e.fn.jstree=function(r){var n="string"==typeof r,i=Array.prototype.slice.call(arguments,1),a=null;return!(!0===r&&!this.length)&&(this.each(function(){var s=e.jstree.reference(this),o=n&&s?s[r]:null;if(a=n&&o?o.apply(s,i):null,s||n||r!==t&&!e.isPlainObject(r)||e.jstree.create(this,r),(s&&!n||!0===r)&&(a=s||!1),null!==a&&a!==t)return!1}),null!==a&&a!==t?a:this)},e.expr.pseudos.jstree=e.expr.createPseudo(function(r){return function(r){return e(r).hasClass("jstree")&&e(r).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,keyboard:{"ctrl-space":function(t){t.type="click",e(t.currentTarget).trigger(t)},enter:function(t){t.type="click",e(t.currentTarget).trigger(t)},left:function(t){if(t.preventDefault(),this.is_open(t.currentTarget))this.close_node(t.currentTarget);else{var r=this.get_parent(t.currentTarget);r&&r.id!==e.jstree.root&&this.get_node(r,!0).children(".jstree-anchor").focus()}},up:function(e){e.preventDefault();var t=this.get_prev_dom(e.currentTarget);t&&t.length&&t.children(".jstree-anchor").focus()},right:function(t){if(t.preventDefault(),this.is_closed(t.currentTarget))this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()});else if(this.is_open(t.currentTarget)){var r=this.get_node(t.currentTarget,!0).children(".jstree-children")[0];r&&e(this._firstChild(r)).children(".jstree-anchor").focus()}},down:function(e){e.preventDefault();var t=this.get_next_dom(e.currentTarget);t&&t.length&&t.children(".jstree-anchor").focus()},"*":function(e){this.open_all()},home:function(t){t.preventDefault();var r=this._firstChild(this.get_container_ul()[0]);r&&e(r).children(".jstree-anchor").filter(":visible").focus()},end:function(e){e.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()},f2:function(e){e.preventDefault(),this.edit(e.currentTarget)}}},e.jstree.core.prototype={plugin:function(t,r){var n=e.jstree.plugins[t];return n?(this._data[t]={},n.prototype=this,new n(r,this)):this},init:function(t,r){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=r,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node(e.jstree.root)},destroy:function(e){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.teardown()},_create_prototype_node:function(){var e,t,r=l.createElement("LI");return r.setAttribute("role","treeitem"),(e=l.createElement("I")).className="jstree-icon jstree-ocl",e.setAttribute("role","presentation"),r.appendChild(e),(e=l.createElement("A")).className="jstree-anchor",e.setAttribute("href","#"),e.setAttribute("tabindex","-1"),(t=l.createElement("I")).className="jstree-icon jstree-themeicon",t.setAttribute("role","presentation"),e.appendChild(t),r.appendChild(e),e=t=null,r},_kbevent_to_func:function(e){var t=[];e.ctrlKey&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&t.push("shift"),t.push({8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"}[e.which]||e.which),t=t.sort().join("-").toLowerCase();var r,n,i=this.settings.core.keyboard;for(r in i)if(i.hasOwnProperty(r)&&("-"!==(n=r)&&"+"!==n&&(n=(n=n.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS")).split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase()),n===t))return i[r];return null},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",r=null,n=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(l.selection&&l.selection.empty)l.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(e){}}}).on("mousedown.jstree",e.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),n=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this.settings.core.dblclick_toggle&&this.toggle_node(e.target)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),t.currentTarget!==l.activeElement&&e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this._data.core.rtl&&(37===e.which?e.which=39:39===e.which&&(e.which=37));var t=this._kbevent_to_func(e);if(t){var r=t.call(this,e);if(!1===r||!0===r)return r}},this)).on("load_node.jstree",e.proxy(function(t,r){r.status&&(r.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t,r,n=[];for(t=0,r=this._data.core.selected.length;t<r;t++)n=n.concat(this._model.data[this._data.core.selected[t]].parents);for(t=0,r=(n=e.vakata.array_unique(n)).length;t<r;t++)this.open_node(n[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",e.proxy(function(n){if(n.target.tagName&&"input"===n.target.tagName.toLowerCase())return!0;r&&clearTimeout(r),r=setTimeout(function(){t=""},500);var i=String.fromCharCode(n.which).toLowerCase(),a=this.element.find(".jstree-anchor").filter(":visible"),s=a.index(l.activeElement)||0,o=!1;if((t+=i).length>1){if(a.slice(s).each(e.proxy(function(r,n){if(0===e(n).text().toLowerCase().indexOf(t))return e(n).focus(),o=!0,!1},this)),o)return;if(a.slice(0,s).each(e.proxy(function(r,n){if(0===e(n).text().toLowerCase().indexOf(t))return e(n).focus(),o=!0,!1},this)),o)return}if(new RegExp("^"+i.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(a.slice(s+1).each(e.proxy(function(t,r){if(e(r).text().toLowerCase().charAt(0)===i)return e(r).focus(),o=!0,!1},this)),o)return;if(a.slice(0,s+1).each(e.proxy(function(t,r){if(e(r).text().toLowerCase().charAt(0)===i)return e(r).focus(),o=!0,!1},this)),o)return}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this._data.core.themes.ellipsis=e.ellipsis,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").trigger("mouseleave"),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var r=this.get_node(t.currentTarget);r&&r.id&&(this._data.core.focused=r.id),this.element.find(".jstree-hovered").not(t.currentTarget).trigger("mouseleave"),e(t.currentTarget).trigger("mouseenter"),this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-n>500&&!this._data.core.focused&&this.settings.core.restore_focus){n=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);e&&e.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(l).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var r=this.settings.core.strings;return e.isFunction(r)?r.call(this,t):r&&r[t]?r[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,r){var n;t&&t.id&&(t=t.id),t instanceof e&&t.length&&t[0].id&&(t=t[0].id);try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(n=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[n.closest(".jstree-node").attr("id")])t=this._model.data[n.closest(".jstree-node").attr("id")];else if((n=this.element.find(t)).length&&this._model.data[n.closest(".jstree-node").attr("id")])t=this._model.data[n.closest(".jstree-node").attr("id")];else{if(!(n=this.element.find(t)).length||!n.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return r&&(t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(e){return!1}},get_path:function(t,r,n){if(!(t=t.parents?t:this.get_node(t))||t.id===e.jstree.root||!t.parents)return!1;var i,a,s=[];for(s.push(n?t.id:t.text),i=0,a=t.parents.length;i<a;i++)s.push(n?t.parents[i]:this.get_text(t.parents[i]));return s=s.reverse().slice(1),r?s.join(r):s},get_next_dom:function(t,r){var n;if((t=this.get_node(t,!0))[0]===this.element[0]){for(n=this._firstChild(this.get_container_ul()[0]);n&&0===n.offsetHeight;)n=this._nextSibling(n);return!!n&&e(n)}if(!t||!t.length)return!1;if(r){n=t[0];do{n=this._nextSibling(n)}while(n&&0===n.offsetHeight);return!!n&&e(n)}if(t.hasClass("jstree-open")){for(n=this._firstChild(t.children(".jstree-children")[0]);n&&0===n.offsetHeight;)n=this._nextSibling(n);if(null!==n)return e(n)}n=t[0];do{n=this._nextSibling(n)}while(n&&0===n.offsetHeight);return null!==n?e(n):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,r){var n;if((t=this.get_node(t,!0))[0]===this.element[0]){for(n=this.get_container_ul()[0].lastChild;n&&0===n.offsetHeight;)n=this._previousSibling(n);return!!n&&e(n)}if(!t||!t.length)return!1;if(r){n=t[0];do{n=this._previousSibling(n)}while(n&&0===n.offsetHeight);return!!n&&e(n)}n=t[0];do{n=this._previousSibling(n)}while(n&&0===n.offsetHeight);if(null!==n){for(t=e(n);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return!(!(n=t[0].parentNode.parentNode)||!n.className||-1===n.className.indexOf("jstree-node"))&&e(n)},get_parent:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.parent},get_children_dom:function(e){return(e=this.get_node(e,!0))[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return(e=this.get_node(e))&&(!1===e.state.loaded||e.children.length>0)},is_loaded:function(e){return(e=this.get_node(e))&&e.state.loaded},is_loading:function(e){return(e=this.get_node(e))&&e.state&&e.state.loading},is_open:function(e){return(e=this.get_node(e))&&e.state.opened},is_closed:function(e){return(e=this.get_node(e))&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,r){var n,i,a,s,o;if(e.isArray(t))return this._load_nodes(t.slice(),r),!0;if(!(t=this.get_node(t)))return r&&r.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,a=0,s=t.parents.length;a<s;a++)this._model.data[t.parents[a]].children_d=e.vakata.array_filter(this._model.data[t.parents[a]].children_d,function(r){return-1===e.inArray(r,t.children_d)});for(n=0,i=t.children_d.length;n<i;n++)this._model.data[t.children_d[n]].state.selected&&(o=!0),delete this._model.data[t.children_d[n]];o&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(r){return-1===e.inArray(r,t.children_d)})),t.children=[],t.children_d=[],o&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,e.proxy(function(e){(t=this._model.data[t.id]).state.loading=!1,t.state.loaded=e,t.state.failed=!t.state.loaded;var n,i=this.get_node(t,!0),a=0,s=this._model.data,o=!1;for(a=0,n=t.children.length;a<n;a++)if(s[t.children[a]]&&!s[t.children[a]].state.hidden){o=!0;break}t.state.loaded&&i&&i.length&&(i.removeClass("jstree-closed jstree-open jstree-leaf"),o?"#"!==t.id&&i.addClass(t.state.opened?"jstree-open":"jstree-closed"):i.addClass("jstree-leaf")),i.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:t,status:e}),r&&r.call(this,t,e)},this)),!0},_load_nodes:function(e,t,r,n){var i,a,s=!0,o=function(){this._load_nodes(e,t,!0)},l=this._model.data,u=[];for(i=0,a=e.length;i<a;i++)l[e[i]]&&(!l[e[i]].state.loaded&&!l[e[i]].state.failed||!r&&n)&&(this.is_loading(e[i])||this.load_node(e[i],o),s=!1);if(s){for(i=0,a=e.length;i<a;i++)l[e[i]]&&l[e[i]].state.loaded&&u.push(e[i]);t&&!t.done&&(t.call(this,u),t.done=!0)}},load_all:function(t,r){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var n,i,a=[],s=this._model.data,o=s[t.id].children_d;for(t.state&&!t.state.loaded&&a.push(t.id),n=0,i=o.length;n<i;n++)s[o[n]]&&s[o[n]].state&&!s[o[n]].state.loaded&&a.push(o[n]);a.length?this._load_nodes(a,function(){this.load_all(t,r)}):(r&&r.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,r){var n,i=this.settings.core.data,a=function(){return 3!==this.nodeType&&8!==this.nodeType};return i?e.isFunction(i)?i.call(this,t,e.proxy(function(n){!1===n?r.call(this,!1):this["string"==typeof n?"_append_html_data":"_append_json_data"](t,"string"==typeof n?e(e.parseHTML(n)).filter(a):n,function(e){r.call(this,e)})},this)):"object"==typeof i?i.url?(i=e.extend(!0,{},i),e.isFunction(i.url)&&(i.url=i.url.call(this,t)),e.isFunction(i.data)&&(i.data=i.data.call(this,t)),e.ajax(i).done(e.proxy(function(n,i,s){var o=s.getResponseHeader("Content-Type");return o&&-1!==o.indexOf("json")||"object"==typeof n?this._append_json_data(t,n,function(e){r.call(this,e)}):o&&-1!==o.indexOf("html")||"string"==typeof n?this._append_html_data(t,e(e.parseHTML(n)).filter(a),function(e){r.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:s})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1))},this)).fail(e.proxy(function(e){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},r.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)},this))):(n=e.isArray(i)?e.extend(!0,[],i):e.isPlainObject(i)?e.extend(!0,{},i):i,t.id===e.jstree.root?this._append_json_data(t,n,function(e){r.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1))):"string"==typeof i?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(i)).filter(a),function(e){r.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1)):r.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){r.call(this,e)}):r.call(this,!1)},_node_changed:function(t){(t=this.get_node(t))&&-1===e.inArray(t.id,this._model.changed)&&this._model.changed.push(t.id)},_append_html_data:function(t,r,n){(t=this.get_node(t)).children=[],t.children_d=[];var i,a,s,o=r.is("ul")?r.children():r,l=t.id,u=[],c=[],d=this._model.data,h=d[l],f=this._data.core.selected.length;for(o.each(e.proxy(function(t,r){(i=this._parse_model_from_html(e(r),l,h.parents.concat()))&&(u.push(i),c.push(i),d[i].children_d.length&&(c=c.concat(d[i].children_d)))},this)),h.children=u,h.children_d=c,a=0,s=h.parents.length;a<s;a++)d[h.parents[a]].children_d=d[h.parents[a]].children_d.concat(c);this.trigger("model",{nodes:c,parent:l}),l!==e.jstree.root?(this._node_changed(l),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==f&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),n.call(this,!0)},_append_json_data:function(t,r,n,i){if(null!==this.element){(t=this.get_node(t)).children=[],t.children_d=[],r.d&&"string"==typeof(r=r.d)&&(r=JSON.parse(r)),e.isArray(r)||(r=[r]);var a=null,s={df:this._model.default_state,dat:r,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},o=this,l=function(e,t){e.data&&(e=e.data);var r,n,i,a,s=e.dat,l=e.par,u=[],c=[],d=[],h=e.df,f=e.t_id,p=e.t_cnt,g=e.m,m=g[l],v=e.sel,_=function(e,r,n){n=n?n.concat():[],r&&n.unshift(r);var i,a,s,o,l=e.id.toString(),u={id:l,text:e.text||"",icon:e.icon===t||e.icon,parent:r,parents:n,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in h)h.hasOwnProperty(i)&&(u.state[i]=h[i]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(u.icon=e.data.jstree.icon),u.icon!==t&&null!==u.icon&&""!==u.icon||(u.icon=!0),e&&e.data&&(u.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(u.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(u.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(u.li_attr[i]=e.li_attr[i]);if(u.li_attr.id||(u.li_attr.id=l),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(u.a_attr[i]=e.a_attr[i]);for(e&&e.children&&!0===e.children&&(u.state.loaded=!1,u.children=[],u.children_d=[]),g[u.id]=u,i=0,a=u.children.length;i<a;i++)s=_(g[u.children[i]],u.id,n),o=g[s],u.children_d.push(s),o.children_d.length&&(u.children_d=u.children_d.concat(o.children_d));return delete e.data,delete e.children,g[u.id].original=e,u.state.selected&&d.push(u.id),u.id},y=function(e,r,n){n=n?n.concat():[],r&&n.unshift(r);var i,a,s,o,l,u=!1;do{u="j"+f+"_"+ ++p}while(g[u]);for(i in l={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:r,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},h)h.hasOwnProperty(i)&&(l.state[i]=h[i]);if(e&&e.id&&(l.id=e.id.toString()),e&&e.text&&(l.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==t&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(l.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(l.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(l.li_attr[i]=e.li_attr[i]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=u),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(l.a_attr[i]=e.a_attr[i]);if(e&&e.children&&e.children.length){for(i=0,a=e.children.length;i<a;i++)s=y(e.children[i],l.id,n),o=g[s],l.children.push(s),o.children_d.length&&(l.children_d=l.children_d.concat(o.children_d));l.children_d=l.children_d.concat(l.children)}return e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,g[l.id]=l,l.state.selected&&d.push(l.id),l.id};if(s.length&&s[0].id!==t&&s[0].parent!==t){for(n=0,i=s.length;n<i;n++)s[n].children||(s[n].children=[]),s[n].state||(s[n].state={}),g[s[n].id.toString()]=s[n];for(n=0,i=s.length;n<i;n++)g[s[n].parent.toString()]?(g[s[n].parent.toString()].children.push(s[n].id.toString()),m.children_d.push(s[n].id.toString())):void 0!==o&&(o._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:s[n].id.toString(),parent:s[n].parent.toString()})},o.settings.core.error.call(o,o._data.core.last_error));for(n=0,i=m.children.length;n<i;n++)r=_(g[m.children[n]],l,m.parents.concat()),c.push(r),g[r].children_d.length&&(c=c.concat(g[r].children_d));for(n=0,i=m.parents.length;n<i;n++)g[m.parents[n]].children_d=g[m.parents[n]].children_d.concat(c);a={cnt:p,mod:g,sel:v,par:l,dpc:c,add:d}}else{for(n=0,i=s.length;n<i;n++)(r=y(s[n],l,m.parents.concat()))&&(u.push(r),c.push(r),g[r].children_d.length&&(c=c.concat(g[r].children_d)));for(m.children=u,m.children_d=c,n=0,i=m.parents.length;n<i;n++)g[m.parents[n]].children_d=g[m.parents[n]].children_d.concat(c);a={cnt:p,mod:g,sel:v,par:l,dpc:c,add:d}}if("undefined"!=typeof window&&void 0!==window.document)return a;postMessage(a)},u=function(t,r){if(null!==this.element){this._cnt=t.cnt;var i,a=this._model.data;for(i in a)a.hasOwnProperty(i)&&a[i].state&&a[i].state.loading&&t.mod[i]&&(t.mod[i].state.loading=!0);if(this._model.data=t.mod,r){var s,o=t.add,l=t.sel,u=this._data.core.selected.slice();if(a=this._model.data,l.length!==u.length||e.vakata.array_unique(l.concat(u)).length!==l.length){for(i=0,s=l.length;i<s;i++)-1===e.inArray(l[i],o)&&-1===e.inArray(l[i],u)&&(a[l[i]].state.selected=!1);for(i=0,s=u.length;i<s;i++)-1===e.inArray(u[i],l)&&(a[u[i]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),n.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+l.toString()],{type:"text/javascript"}))),!this._data.core.working||i?(this._data.core.working=!0,(a=new window.Worker(this._wrk)).onmessage=e.proxy(function(e){u.call(this,e.data,!0);try{a.terminate(),a=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),s.par?a.postMessage(s):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,r,n,!0])}catch(e){u.call(this,l(s),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else u.call(this,l(s),!1)}},_parse_model_from_html:function(r,n,i){i=i?[].concat(i):[],n&&i.unshift(n);var a,s,o,l,u,c=this._model.data,d={id:!1,text:!1,icon:!0,parent:n,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(d.state[o]=this._model.default_state[o]);if(l=e.vakata.attributes(r,!0),e.each(l,function(t,r){if(!(r=e.trim(r)).length)return!0;d.li_attr[t]=r,"id"===t&&(d.id=r.toString())}),(l=r.children("a").first()).length&&(l=e.vakata.attributes(l,!0),e.each(l,function(t,r){(r=e.trim(r)).length&&(d.a_attr[t]=r)})),(l=r.children("a").first().length?r.children("a").first().clone():r.clone()).children("ins, i, ul").remove(),l=l.html(),l=e("<div />").html(l),d.text=this.settings.core.force_text?l.text():l.html(),l=r.data(),d.data=l?e.extend(!0,{},l):null,d.state.opened=r.hasClass("jstree-open"),d.state.selected=r.children("a").hasClass("jstree-clicked"),d.state.disabled=r.children("a").hasClass("jstree-disabled"),d.data&&d.data.jstree)for(o in d.data.jstree)d.data.jstree.hasOwnProperty(o)&&(d.state[o]=d.data.jstree[o]);(l=r.children("a").children(".jstree-themeicon")).length&&(d.icon=!l.hasClass("jstree-themeicon-hidden")&&l.attr("rel")),d.state.icon!==t&&(d.icon=d.state.icon),d.icon!==t&&null!==d.icon&&""!==d.icon||(d.icon=!0),l=r.children("ul").children("li");do{u="j"+this._id+"_"+ ++this._cnt}while(c[u]);return d.id=d.li_attr.id?d.li_attr.id.toString():u,l.length?(l.each(e.proxy(function(t,r){a=this._parse_model_from_html(e(r),d.id,i),s=this._model.data[a],d.children.push(a),s.children_d.length&&(d.children_d=d.children_d.concat(s.children_d))},this)),d.children_d=d.children_d.concat(d.children)):r.hasClass("jstree-closed")&&(d.state.loaded=!1),d.li_attr.class&&(d.li_attr.class=d.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),d.a_attr.class&&(d.a_attr.class=d.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),c[d.id]=d,d.state.selected&&this._data.core.selected.push(d.id),d.id},_parse_model_from_flat_json:function(e,r,n){n=n?n.concat():[],r&&n.unshift(r);var i,a,s,o,l=e.id.toString(),u=this._model.data,c=this._model.default_state,d={id:l,text:e.text||"",icon:e.icon===t||e.icon,parent:r,parents:n,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in c)c.hasOwnProperty(i)&&(d.state[i]=c[i]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==t&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(d.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(d.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(d.li_attr[i]=e.li_attr[i]);if(d.li_attr.id||(d.li_attr.id=l),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(d.a_attr[i]=e.a_attr[i]);for(e&&e.children&&!0===e.children&&(d.state.loaded=!1,d.children=[],d.children_d=[]),u[d.id]=d,i=0,a=d.children.length;i<a;i++)o=u[s=this._parse_model_from_flat_json(u[d.children[i]],d.id,n)],d.children_d.push(s),o.children_d.length&&(d.children_d=d.children_d.concat(o.children_d));return delete e.data,delete e.children,u[d.id].original=e,d.state.selected&&this._data.core.selected.push(d.id),d.id},_parse_model_from_json:function(e,r,n){n=n?n.concat():[],r&&n.unshift(r);var i,a,s,o,l,u=!1,c=this._model.data,d=this._model.default_state;do{u="j"+this._id+"_"+ ++this._cnt}while(c[u]);for(i in l={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:r,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},d)d.hasOwnProperty(i)&&(l.state[i]=d[i]);if(e&&e.id&&(l.id=e.id.toString()),e&&e.text&&(l.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==t&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(l.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(l.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(l.li_attr[i]=e.li_attr[i]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=u),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(l.a_attr[i]=e.a_attr[i]);if(e&&e.children&&e.children.length){for(i=0,a=e.children.length;i<a;i++)o=c[s=this._parse_model_from_json(e.children[i],l.id,n)],l.children.push(s),o.children_d.length&&(l.children_d=l.children_d.concat(o.children_d));l.children_d=l.children.concat(l.children_d)}return e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,c[l.id]=l,l.state.selected&&this._data.core.selected.push(l.id),l.id},_redraw:function(){var t,r,n,i=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),a=l.createElement("UL"),s=this._data.core.focused;for(r=0,n=i.length;r<n;r++)(t=this.redraw_node(i[r],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&a.appendChild(t);this._model.force_full_redraw&&(a.className=this.get_container_ul()[0].className,a.setAttribute("role","group"),this.element.empty().append(a)),null!==s&&this.settings.core.restore_focus&&((t=this.get_node(s,!0))&&t.length&&t.children(".jstree-anchor")[0]!==l.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:i})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var r=this.get_node(t),n=!1,i=!1,a=!1,s=l;if(!r)return!1;if(r.id===e.jstree.root)return this.redraw(!0);if(!(t=this.get_node(t,!0))||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],r.children.length&&r.state.loaded){for((a=s.createElement("UL")).setAttribute("role","group"),a.className="jstree-children",n=0,i=r.children.length;n<i;n++)a.appendChild(this.redraw_node(r.children[n],!0,!0));t.appendChild(a)}},redraw_node:function(t,r,n,i){var a=this.get_node(t),s=!1,o=!1,u=!1,c=!1,d=!1,h=!1,f="",p=l,g=this._model.data,m=!1,v=null,_=0,y=0,b=!1,w=!1;if(!a)return!1;if(a.id===e.jstree.root)return this.redraw(!0);if(r=r||0===a.children.length,t=l.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(a.id[0])?"\\3"+a.id[0]+" "+a.id.substr(1).replace(e.jstree.idregex,"\\$&"):a.id.replace(e.jstree.idregex,"\\$&"))):l.getElementById(a.id))t=e(t),n||((s=t.parent().parent()[0])===this.element[0]&&(s=null),o=t.index()),r||!a.children.length||t.children(".jstree-children").length||(r=!0),r||(u=t.children(".jstree-children")[0]),m=t.children(".jstree-anchor")[0]===l.activeElement,t.remove();else if(r=!0,!n){if(!(null===(s=a.parent!==e.jstree.root?e("#"+a.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null)||s&&g[a.parent].state.opened))return!1;o=e.inArray(a.id,null===s?g[e.jstree.root].children:g[a.parent].children)}for(c in t=this._data.core.node.cloneNode(!0),f="jstree-node ",a.li_attr)if(a.li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"!==c?t.setAttribute(c,a.li_attr[c]):f+=a.li_attr[c]}for(a.a_attr.id||(a.a_attr.id=a.id+"_anchor"),t.setAttribute("aria-selected",!!a.state.selected),t.setAttribute("aria-level",a.parents.length),t.setAttribute("aria-labelledby",a.a_attr.id),a.state.disabled&&t.setAttribute("aria-disabled",!0),c=0,d=a.children.length;c<d;c++)if(!g[a.children[c]].state.hidden){b=!0;break}if(null!==a.parent&&g[a.parent]&&!a.state.hidden&&(c=e.inArray(a.id,g[a.parent].children),w=a.id,-1!==c))for(c++,d=g[a.parent].children.length;c<d&&(g[g[a.parent].children[c]].state.hidden||(w=g[a.parent].children[c]),w===a.id);c++);for(d in a.state.hidden&&(f+=" jstree-hidden"),a.state.loading&&(f+=" jstree-loading"),a.state.loaded&&!b?f+=" jstree-leaf":(f+=a.state.opened&&a.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",a.state.opened&&a.state.loaded)),w===a.id&&(f+=" jstree-last"),t.id=a.id,t.className=f,f=(a.state.selected?" jstree-clicked":"")+(a.state.disabled?" jstree-disabled":""),a.a_attr)if(a.a_attr.hasOwnProperty(d)){if("href"===d&&"#"===a.a_attr[d])continue;"class"!==d?t.childNodes[1].setAttribute(d,a.a_attr[d]):f+=" "+a.a_attr[d]}if(f.length&&(t.childNodes[1].className="jstree-anchor "+f),(a.icon&&!0!==a.icon||!1===a.icon)&&(!1===a.icon?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===a.icon.indexOf("/")&&-1===a.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+a.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage='url("'+a.icon+'")',t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(p.createTextNode(a.text)):t.childNodes[1].innerHTML+=a.text,r&&a.children.length&&(a.state.opened||i)&&a.state.loaded){for((h=p.createElement("UL")).setAttribute("role","group"),h.className="jstree-children",c=0,d=a.children.length;c<d;c++)h.appendChild(this.redraw_node(a.children[c],r,!0));t.appendChild(h)}if(u&&t.appendChild(u),!n){for(s||(s=this.element[0]),c=0,d=s.childNodes.length;c<d;c++)if(s.childNodes[c]&&s.childNodes[c].className&&-1!==s.childNodes[c].className.indexOf("jstree-children")){v=s.childNodes[c];break}v||((v=p.createElement("UL")).setAttribute("role","group"),v.className="jstree-children",s.appendChild(v)),o<(s=v).childNodes.length?s.insertBefore(t,s.childNodes[o]):s.appendChild(t),m&&(_=this.element[0].scrollTop,y=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=_,this.element[0].scrollLeft=y)}return a.state.opened&&!a.state.loaded&&(a.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(a.id,!1,0)},this),0)),t},open_node:function(r,n,i){var a,s,o,l;if(e.isArray(r)){for(a=0,s=(r=r.slice()).length;a<s;a++)this.open_node(r[a],n,i);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root)&&(i=i===t?this.settings.core.animation:i,this.is_closed(r)?this.is_loaded(r)?(o=this.get_node(r,!0),l=this,o.length&&(i&&o.children(".jstree-children").length&&o.children(".jstree-children").stop(!0,!0),r.children.length&&!this._firstChild(o.children(".jstree-children")[0])&&this.draw_children(r),i?(this.trigger("before_open",{node:r}),o.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(i,function(){this.style.display="",l.element&&l.trigger("after_open",{node:r})})):(this.trigger("before_open",{node:r}),o[0].className=o[0].className.replace("jstree-closed","jstree-open"),o[0].setAttribute("aria-expanded",!0))),r.state.opened=!0,n&&n.call(this,r,!0),o.length||this.trigger("before_open",{node:r}),this.trigger("open_node",{node:r}),i&&o.length||this.trigger("after_open",{node:r}),!0):this.is_loading(r)?setTimeout(e.proxy(function(){this.open_node(r,n,i)},this),500):void this.load_node(r,function(e,t){return t?this.open_node(e,n,i):!!n&&n.call(this,e,!1)}):(n&&n.call(this,r,!1),!1))},_open_to:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var r,n,i=t.parents;for(r=0,n=i.length;r<n;r+=1)r!==e.jstree.root&&this.open_node(i[r],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(r,n){var i,a,s,o;if(e.isArray(r)){for(i=0,a=(r=r.slice()).length;i<a;i++)this.close_node(r[i],n);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root)&&(!this.is_closed(r)&&(n=n===t?this.settings.core.animation:n,s=this,o=this.get_node(r,!0),r.state.opened=!1,this.trigger("close_node",{node:r}),void(o.length?n?o.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(n,function(){this.style.display="",o.children(".jstree-children").remove(),s.element&&s.trigger("after_close",{node:r})}):(o[0].className=o[0].className.replace("jstree-open","jstree-closed"),o.attr("aria-expanded",!1).children(".jstree-children").remove(),this.trigger("after_close",{node:r})):this.trigger("after_close",{node:r}))))},toggle_node:function(t){var r,n;if(e.isArray(t)){for(r=0,n=(t=t.slice()).length;r<n;r++)this.toggle_node(t[r]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,r,n){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var i,a,s,o=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!o.length){for(i=0,a=t.children_d.length;i<a;i++)this.is_closed(this._model.data[t.children_d[i]])&&(this._model.data[t.children_d[i]].state.opened=!0);return this.trigger("open_all",{node:t})}n=n||o,s=this,(o=this.is_closed(t)?o.find(".jstree-closed").addBack():o.find(".jstree-closed")).each(function(){s.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,r,n)},r||0)}),0===n.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(n)})},close_all:function(t,r){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var n,i,a=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),s=this;for(a.length&&(a=this.is_open(t)?a.find(".jstree-open").addBack():a.find(".jstree-open"),e(a.get().reverse()).each(function(){s.close_node(this,r||0)})),n=0,i=t.children_d.length;n<i;n++)this._model.data[t.children_d[n]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return(e=this.get_node(e))&&e.state&&e.state.disabled},enable_node:function(t){var r,n;if(e.isArray(t)){for(r=0,n=(t=t.slice()).length;r<n;r++)this.enable_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),this.trigger("enable_node",{node:t})},disable_node:function(t){var r,n;if(e.isArray(t)){for(r=0,n=(t=t.slice()).length;r<n;r++)this.disable_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),this.trigger("disable_node",{node:t})},is_hidden:function(e){return!0===(e=this.get_node(e)).state.hidden},hide_node:function(t,r){var n,i;if(e.isArray(t)){for(n=0,i=(t=t.slice()).length;n<i;n++)this.hide_node(t[n],!0);return r||this.redraw(),!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),r||this.redraw(),this.trigger("hide_node",{node:t}))},show_node:function(t,r){var n,i;if(e.isArray(t)){for(n=0,i=(t=t.slice()).length;n<i;n++)this.show_node(t[n],!0);return r||this.redraw(),!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),r||this.redraw(),this.trigger("show_node",{node:t}))},hide_all:function(t){var r,n=this._model.data,i=[];for(r in n)n.hasOwnProperty(r)&&r!==e.jstree.root&&!n[r].state.hidden&&(n[r].state.hidden=!0,i.push(r));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:i}),i},show_all:function(t){var r,n=this._model.data,i=[];for(r in n)n.hasOwnProperty(r)&&r!==e.jstree.root&&n[r].state.hidden&&(n[r].state.hidden=!1,i.push(r));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:i}),i},activate_node:function(e,r){if(this.is_disabled(e))return!1;if(r&&"object"==typeof r||(r={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(r.metaKey||r.ctrlKey||r.shiftKey)&&(!r.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(r.shiftKey){var n,i,a=this.get_node(e).id,s=this._data.core.last_clicked.id,o=this.get_node(this._data.core.last_clicked.parent).children,l=!1;for(n=0,i=o.length;n<i;n+=1)o[n]===a&&(l=!l),o[n]===s&&(l=!l),this.is_disabled(o[n])||!l&&o[n]!==a&&o[n]!==s?this.deselect_node(o[n],!0,r):this.is_hidden(o[n])||this.select_node(o[n],!0,!1,r);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:r})}else this.is_selected(e)?this.deselect_node(e,!1,r):this.select_node(e,!1,!1,r);else!this.settings.core.multiple&&(r.metaKey||r.ctrlKey||r.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,r):(this.deselect_all(!0),this.select_node(e,!1,!1,r),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:r})},hover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),r=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){r.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||!e.children(".jstree-hovered").length)return!1;e.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(e)})},select_node:function(t,r,n,i){var a,s,o;if(e.isArray(t)){for(s=0,o=(t=t.slice()).length;s<o;s++)this.select_node(t[s],r,n,i);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;a=this.get_node(t,!0),t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),n||(a=this._open_to(t)),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:i}),r||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:i}))},deselect_node:function(t,r,n){var i,a,s;if(e.isArray(t)){for(i=0,a=(t=t.slice()).length;i<a;i++)this.deselect_node(t[i],r,n);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;s=this.get_node(t,!0),t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),s.length&&s.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:n}),r||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:n}))},select_all:function(t){var r,n,i=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),r=0,n=this._data.core.selected.length;r<n;r++)this._model.data[this._data.core.selected[r]]&&(this._model.data[this._data.core.selected[r]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:i})},deselect_all:function(e){var t,r,n=this._data.core.selected.concat([]);for(t=0,r=this._data.core.selected.length;t<r;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:n}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:n})},is_selected:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var r,n,i,a,s=this.get_selected(!0),o={};for(r=0,n=s.length;r<n;r++)o[s[r].id]=s[r];for(r=0,n=s.length;r<n;r++)for(i=0,a=s[r].children_d.length;i<a;i++)o[s[r].children_d[i]]&&delete o[s[r].children_d[i]];for(r in s=[],o)o.hasOwnProperty(r)&&s.push(r);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},get_bottom_selected:function(t){var r,n,i=this.get_selected(!0),a=[];for(r=0,n=i.length;r<n;r++)i[r].children.length||a.push(i[r].id);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},get_state:function(){var t,r={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},
/*!
					'themes' : {
						'name' : this.get_theme(),
						'icons' : this._data.core.themes.icons,
						'dots' : this._data.core.themes.dots
					},
					*/
selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.loaded&&this.settings.core.loaded_state&&r.core.loaded.push(t),this._model.data[t].state.opened&&r.core.open.push(t),this._model.data[t].state.selected&&r.core.selected.push(t));return r},set_state:function(r,n){if(r){if(r.core&&r.core.selected&&r.core.initial_selection===t&&(r.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),r.core){var i,a;if(r.core.loaded)return this.settings.core.loaded_state&&e.isArray(r.core.loaded)&&r.core.loaded.length?this._load_nodes(r.core.loaded,function(e){delete r.core.loaded,this.set_state(r,n)}):(delete r.core.loaded,this.set_state(r,n)),!1;if(r.core.open)return e.isArray(r.core.open)&&r.core.open.length?this._load_nodes(r.core.open,function(e){this.open_node(e,!1,0),delete r.core.open,this.set_state(r,n)}):(delete r.core.open,this.set_state(r,n)),!1;if(r.core.scroll)return r.core.scroll&&r.core.scroll.left!==t&&this.element.scrollLeft(r.core.scroll.left),r.core.scroll&&r.core.scroll.top!==t&&this.element.scrollTop(r.core.scroll.top),delete r.core.scroll,this.set_state(r,n),!1;if(r.core.selected)return i=this,r.core.initial_selection!==t&&r.core.initial_selection!==this._data.core.selected.concat([]).sort().join(",")||(this.deselect_all(),e.each(r.core.selected,function(e,t){i.select_node(t,!1,!0)})),delete r.core.initial_selection,delete r.core.selected,this.set_state(r,n),!1;for(a in r)r.hasOwnProperty(a)&&"core"!==a&&-1===e.inArray(a,this.settings.plugins)&&delete r[a];if(e.isEmptyObject(r.core))return delete r.core,this.set_state(r,n),!1}return!e.isEmptyObject(r)||(r=null,n&&n.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(t,r){this._data.core.state=!0===r?{}:this.get_state(),r&&e.isFunction(r)&&(this._data.core.state=r.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var n=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+n+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,r){r&&(this.get_container_ul()[0].className=n,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var r=[],n=[],i=this._data.core.selected.concat([]);n.push(t.id),!0===t.state.opened&&r.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){n.push(this.id),r.push(this.id)}),this._load_nodes(n,e.proxy(function(e){this.open_node(r,!1,0),this.select_node(i),this.trigger("refresh_node",{node:t,nodes:e})},this),!1,!0)},set_id:function(t,r){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var n,i,a=this._model.data,s=t.id;for(r=r.toString(),a[t.parent].children[e.inArray(t.id,a[t.parent].children)]=r,n=0,i=t.parents.length;n<i;n++)a[t.parents[n]].children_d[e.inArray(t.id,a[t.parents[n]].children_d)]=r;for(n=0,i=t.children.length;n<i;n++)a[t.children[n]].parent=r;for(n=0,i=t.children_d.length;n<i;n++)a[t.children_d[n]].parents[e.inArray(t.id,a[t.children_d[n]].parents)]=r;return-1!==(n=e.inArray(t.id,this._data.core.selected))&&(this._data.core.selected[n]=r),(n=this.get_node(t.id,!0))&&(n.attr("id",r),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",r)),delete a[t.id],t.id=r,t.li_attr.id=r,a[r]=t,this.trigger("set_id",{node:t,new:t.id,old:s}),!0},get_text:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.text},set_text:function(t,r){var n,i;if(e.isArray(t)){for(n=0,i=(t=t.slice()).length;n<i;n++)this.set_text(t[n],r);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(t.text=r,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:r}),!0)},get_json:function(t,r,n){if(!(t=this.get_node(t||e.jstree.root)))return!1;r&&r.flat&&!n&&(n=[]);var i,a,s={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:(!r||!r.no_data)&&e.extend(!0,e.isArray(t.data)?[]:{},t.data)};if(r&&r.flat?s.parent=t.parent:s.children=[],r&&r.no_state)delete s.state;else for(i in t.state)t.state.hasOwnProperty(i)&&(s.state[i]=t.state[i]);if(r&&r.no_li_attr&&delete s.li_attr,r&&r.no_a_attr&&delete s.a_attr,r&&r.no_id&&(delete s.id,s.li_attr&&s.li_attr.id&&delete s.li_attr.id,s.a_attr&&s.a_attr.id&&delete s.a_attr.id),r&&r.flat&&t.id!==e.jstree.root&&n.push(s),!r||!r.no_children)for(i=0,a=t.children.length;i<a;i++)r&&r.flat?this.get_json(t.children[i],r,n):s.children.push(this.get_json(t.children[i],r));return r&&r.flat?n:t.id===e.jstree.root?s.children:s},create_node:function(r,n,i,a,s){if(null===r&&(r=e.jstree.root),!(r=this.get_node(r)))return!1;if(!(i=i===t?"last":i).toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(r))return this.load_node(r,function(){this.create_node(r,n,i,a,!0)});var o,l,u,c;switch(n||(n={text:this.get_string("New node")}),(n="string"==typeof n?{text:n}:e.extend(!0,{},n)).text===t&&(n.text=this.get_string("New node")),r.id===e.jstree.root&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":o=this.get_node(r.parent),i=e.inArray(r.id,o.children),r=o;break;case"after":o=this.get_node(r.parent),i=e.inArray(r.id,o.children)+1,r=o;break;case"inside":case"first":i=0;break;case"last":i=r.children.length;break;default:i||(i=0)}if(i>r.children.length&&(i=r.children.length),n.id||(n.id=!0),!this.check("create_node",n,r,i))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===n.id&&delete n.id,!(n=this._parse_model_from_json(n,r.id,r.parents.concat())))return!1;for(o=this.get_node(n),(l=[]).push(n),l=l.concat(o.children_d),this.trigger("model",{nodes:l,parent:r.id}),r.children_d=r.children_d.concat(l),u=0,c=r.parents.length;u<c;u++)this._model.data[r.parents[u]].children_d=this._model.data[r.parents[u]].children_d.concat(l);for(n=o,o=[],u=0,c=r.children.length;u<c;u++)o[u>=i?u+1:u]=r.children[u];return o[i]=n.id,r.children=o,this.redraw_node(r,!0),this.trigger("create_node",{node:this.get_node(n),parent:r.id,position:i}),a&&a.call(this,this.get_node(n)),n.id},rename_node:function(t,r){var n,i,a;if(e.isArray(t)){for(n=0,i=(t=t.slice()).length;n<i;n++)this.rename_node(t[n],r);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(a=t.text,this.check("rename_node",t,this.get_parent(t),r)?(this.set_text(t,r),this.trigger("rename_node",{node:t,text:r,old:a}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(t){var r,n,i,a,s,o,l,u,c,d,h,f;if(e.isArray(t)){for(r=0,n=(t=t.slice()).length;r<n;r++)this.delete_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;if(i=this.get_node(t.parent),a=e.inArray(t.id,i.children),d=!1,!this.check("delete_node",t,i,a))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==a&&(i.children=e.vakata.array_remove(i.children,a)),(s=t.children_d.concat([])).push(t.id),o=0,l=t.parents.length;o<l;o++)this._model.data[t.parents[o]].children_d=e.vakata.array_filter(this._model.data[t.parents[o]].children_d,function(t){return-1===e.inArray(t,s)});for(u=0,c=s.length;u<c;u++)if(this._model.data[s[u]].state.selected){d=!0;break}for(d&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(t){return-1===e.inArray(t,s)})),this.trigger("delete_node",{node:t,parent:i.id}),d&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:i.id}),u=0,c=s.length;u<c;u++)delete this._model.data[s[u]];return-1!==e.inArray(this._data.core.focused,s)&&(this._data.core.focused=null,h=this.element[0].scrollTop,f=this.element[0].scrollLeft,i.id===e.jstree.root?this._model.data[e.jstree.root].children[0]&&this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(i,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=h,this.element[0].scrollLeft=f),this.redraw_node(i,!0),!0},check:function(t,r,n,i,a){r=r&&r.id?r:this.get_node(r),n=n&&n.id?n:this.get_node(n);var s=t.match(/^move_node|copy_node|create_node$/i)?n:r,o=this.settings.core.check_callback;if("move_node"===t||"copy_node"===t){if(!(a&&a.is_multi||"move_node"!==t||e.inArray(r.id,n.children)!==i))return this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:t,pos:i,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})},!1;if(!(a&&a.is_multi||r.id!==n.id&&("move_node"!==t||e.inArray(r.id,n.children)!==i)&&-1===e.inArray(n.id,r.children_d)))return this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:i,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})},!1}return s&&s.data&&(s=s.data),s&&s.functions&&(!1===s.functions[t]||!0===s.functions[t])?(!1===s.functions[t]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:i,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})}),s.functions[t]):!(!1===o||e.isFunction(o)&&!1===o.call(this,t,r,n,i,a)||o&&!1===o[t])||(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:i,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(r,n,i,a,s,o,l){var u,c,d,h,f,p,g,m,v,_,y,b,w,S;if(n=this.get_node(n),i=i===t?0:i,!n)return!1;if(!i.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(n))return this.load_node(n,function(){this.move_node(r,n,i,a,!0,!1,l)});if(e.isArray(r)){if(1!==r.length){for(u=0,c=r.length;u<c;u++)(v=this.move_node(r[u],n,i,a,s,!1,l))&&(n=v,i="after");return this.redraw(),!0}r=r[0]}if(!(r=r&&r.id?r:this.get_node(r))||r.id===e.jstree.root)return!1;if(d=(r.parent||e.jstree.root).toString(),f=i.toString().match(/^(before|after)$/)&&n.id!==e.jstree.root?this.get_node(n.parent):n,g=!(p=l||(this._model.data[r.id]?this:e.jstree.reference(r.id)))||!p._id||this._id!==p._id,h=p&&p._id&&d&&p._model.data[d]&&p._model.data[d].children?e.inArray(r.id,p._model.data[d].children):-1,p&&p._id&&(r=p._model.data[r.id]),g)return!!(v=this.copy_node(r,n,i,a,s,!1,l))&&(p&&p.delete_node(r),v);switch(n.id===e.jstree.root&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":i=e.inArray(n.id,f.children);break;case"after":i=e.inArray(n.id,f.children)+1;break;case"inside":case"first":i=0;break;case"last":i=f.children.length;break;default:i||(i=0)}if(i>f.children.length&&(i=f.children.length),!this.check("move_node",r,f,i,{core:!0,origin:l,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(r.parent===f.id){for(m=f.children.concat(),-1!==(v=e.inArray(r.id,m))&&(m=e.vakata.array_remove(m,v),i>v&&i--),v=[],_=0,y=m.length;_<y;_++)v[_>=i?_+1:_]=m[_];v[i]=r.id,f.children=v,this._node_changed(f.id),this.redraw(f.id===e.jstree.root)}else{for((v=r.children_d.concat()).push(r.id),_=0,y=r.parents.length;_<y;_++){for(m=[],b=0,w=(S=p._model.data[r.parents[_]].children_d).length;b<w;b++)-1===e.inArray(S[b],v)&&m.push(S[b]);p._model.data[r.parents[_]].children_d=m}for(p._model.data[d].children=e.vakata.array_remove_item(p._model.data[d].children,r.id),_=0,y=f.parents.length;_<y;_++)this._model.data[f.parents[_]].children_d=this._model.data[f.parents[_]].children_d.concat(v);for(m=[],_=0,y=f.children.length;_<y;_++)m[_>=i?_+1:_]=f.children[_];for(m[i]=r.id,f.children=m,f.children_d.push(r.id),f.children_d=f.children_d.concat(r.children_d),r.parent=f.id,(v=f.parents.concat()).unshift(f.id),S=r.parents.length,r.parents=v,v=v.concat(),_=0,y=r.children_d.length;_<y;_++)this._model.data[r.children_d[_]].parents=this._model.data[r.children_d[_]].parents.slice(0,-1*S),Array.prototype.push.apply(this._model.data[r.children_d[_]].parents,v);d!==e.jstree.root&&f.id!==e.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(d),this._node_changed(f.id)),o||this.redraw()}return a&&a.call(this,r,f,i),this.trigger("move_node",{node:r,parent:f.id,position:i,old_parent:d,old_position:h,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id,old_instance:p,new_instance:this}),r.id},copy_node:function(r,n,i,a,s,o,l){var u,c,d,h,f,p,g,m,v,_;if(n=this.get_node(n),i=i===t?0:i,!n)return!1;if(!i.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(n))return this.load_node(n,function(){this.copy_node(r,n,i,a,!0,!1,l)});if(e.isArray(r)){if(1!==r.length){for(u=0,c=r.length;u<c;u++)(h=this.copy_node(r[u],n,i,a,s,!0,l))&&(n=h,i="after");return this.redraw(),!0}r=r[0]}if(!(r=r&&r.id?r:this.get_node(r))||r.id===e.jstree.root)return!1;switch(m=(r.parent||e.jstree.root).toString(),v=i.toString().match(/^(before|after)$/)&&n.id!==e.jstree.root?this.get_node(n.parent):n,!(_=l||(this._model.data[r.id]?this:e.jstree.reference(r.id)))||!_._id||this._id!==_._id,_&&_._id&&(r=_._model.data[r.id]),n.id===e.jstree.root&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":i=e.inArray(n.id,v.children);break;case"after":i=e.inArray(n.id,v.children)+1;break;case"inside":case"first":i=0;break;case"last":i=v.children.length;break;default:i||(i=0)}if(i>v.children.length&&(i=v.children.length),!this.check("copy_node",r,v,i,{core:!0,origin:l,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(g=_?_.get_json(r,{no_id:!0,no_data:!0,no_state:!0}):r))return!1;if(!0===g.id&&delete g.id,!(g=this._parse_model_from_json(g,v.id,v.parents.concat())))return!1;for(h=this.get_node(g),r&&r.state&&!1===r.state.loaded&&(h.state.loaded=!1),(d=[]).push(g),d=d.concat(h.children_d),this.trigger("model",{nodes:d,parent:v.id}),f=0,p=v.parents.length;f<p;f++)this._model.data[v.parents[f]].children_d=this._model.data[v.parents[f]].children_d.concat(d);for(d=[],f=0,p=v.children.length;f<p;f++)d[f>=i?f+1:f]=v.children[f];return d[i]=h.id,v.children=d,v.children_d.push(h.id),v.children_d=v.children_d.concat(h.children_d),v.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(v.id),o||this.redraw(v.id===e.jstree.root),a&&a.call(this,h,v,i),this.trigger("copy_node",{node:h,original:r,parent:v.id,position:i,old_parent:m,old_position:_&&_._id&&m&&_._model.data[m]&&_._model.data[m].children?e.inArray(r.id,_._model.data[m].children):-1,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id,old_instance:_,new_instance:this}),h.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var r,s,o,l=[];for(s=0,o=t.length;s<o;s++)(r=this.get_node(t[s]))&&r.id&&r.id!==e.jstree.root&&l.push(r);if(!l.length)return!1;n=l,a=this,i="move_node",this.trigger("cut",{node:t})},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var r,s,o,l=[];for(s=0,o=t.length;s<o;s++)(r=this.get_node(t[s]))&&r.id&&r.id!==e.jstree.root&&l.push(r);if(!l.length)return!1;n=l,a=this,i="copy_node",this.trigger("copy",{node:t})},get_buffer:function(){return{mode:i,node:n,inst:a}},can_paste:function(){return!1!==i&&!1!==n},paste:function(e,t){if(!((e=this.get_node(e))&&i&&i.match(/^(copy_node|move_node)$/)&&n))return!1;this[i](n,e,t,!1,!1,!1,a)&&this.trigger("paste",{parent:e.id,node:n,mode:i}),n=!1,i=!1,a=!1},clear_buffer:function(){n=!1,i=!1,a=!1,this.trigger("clear_buffer")},edit:function(t,r,n){var i,a,s,o,u,c,d,h,f,p=!1;return!!(t=this.get_node(t))&&(this.check("edit",t,this.get_parent(t))?(f=t,r="string"==typeof r?r:t.text,this.set_text(t,""),t=this._open_to(t),f.text=r,i=this._data.core.rtl,a=this.element.width(),this._data.core.focused=f.id,s=t.children(".jstree-anchor").focus(),o=e("<span>"),
/*!
			oi = obj.children("i:visible"),
			ai = a.children("i:visible"),
			w1 = oi.width() * oi.length,
			w2 = ai.width() * ai.length,
			*/
u=r,c=e("<div />",{css:{position:"absolute",top:"-200px",left:i?"0px":"-1000px",visibility:"hidden"}}).appendTo(l.body),d=e("<input />",{value:u,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(r){r.stopImmediatePropagation(),r.preventDefault();var i,a=o.children(".jstree-rename-input").val(),l=this.settings.core.force_text;""===a&&(a=u),c.remove(),o.replaceWith(s),o.remove(),u=l?u:e("<div></div>").append(e.parseHTML(u)).html(),t=this.get_node(t),this.set_text(t,u),(i=!!this.rename_node(t,l?e("<div></div>").text(a).text():e("<div></div>").append(e.parseHTML(a)).html()))||this.set_text(t,u),this._data.core.focused=f.id,setTimeout(e.proxy(function(){var e=this.get_node(f.id,!0);e.length&&(this._data.core.focused=f.id,e.children(".jstree-anchor").focus())},this),0),n&&n.call(this,f,i,p),d=null},this),keydown:function(e){var t=e.which;27===t&&(p=!0,this.value=u),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){d.width(Math.min(c.text("pW"+this.value).width(),a))},keypress:function(e){if(13===e.which)return!1}}),h={fontFamily:s.css("fontFamily")||"",fontSize:s.css("fontSize")||"",fontWeight:s.css("fontWeight")||"",fontStyle:s.css("fontStyle")||"",fontStretch:s.css("fontStretch")||"",fontVariant:s.css("fontVariant")||"",letterSpacing:s.css("letterSpacing")||"",wordSpacing:s.css("wordSpacing")||""},o.attr("class",s.attr("class")).append(s.contents().clone()).append(d),s.replaceWith(o),c.css(h),d.css(h).width(Math.min(c.text("pW"+d[0].value).width(),a))[0].select(),void e(l).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){d&&t.target!==d&&e(d).blur()})):(this.settings.core.error.call(this,this._data.core.last_error),!1))},set_theme:function(t,r){if(!t)return!1;if(!0===r){var n=this.settings.core.themes.dir;n||(n=e.jstree.path+"/themes"),r=n+"/"+t+"/style.css"}r&&-1===e.inArray(r,s)&&(e("head").append('<link rel="stylesheet" href="'+r+'" type="text/css" />'),s.push(r)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(r,n){var i,a,s,o;if(e.isArray(r)){for(i=0,a=(r=r.slice()).length;i<a;i++)this.set_icon(r[i],n);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root)&&(o=r.icon,r.icon=!0===n||null===n||n===t||""===n||n,s=this.get_node(r,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===n?(s.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"),this.hide_icon(r)):!0===n||null===n||n===t||""===n?(s.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"),!1===o&&this.show_icon(r)):-1===n.indexOf("/")&&-1===n.indexOf(".")?(s.removeClass(o).css("background",""),s.addClass(n+" jstree-themeicon-custom").attr("rel",n),!1===o&&this.show_icon(r)):(s.removeClass(o).css("background",""),s.addClass("jstree-themeicon-custom").css("background","url('"+n+"') center center no-repeat").attr("rel",n),!1===o&&this.show_icon(r)),!0)},get_icon:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.icon},hide_icon:function(t){var r,n;if(e.isArray(t)){for(r=0,n=(t=t.slice()).length;r<n;r++)this.hide_icon(t[r]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root)&&(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(t){var r,n,i;if(e.isArray(t)){for(r=0,n=(t=t.slice()).length;r<n;r++)this.show_icon(t[r]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root)&&(i=this.get_node(t,!0),t.icon=!i.length||i.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),t.icon||(t.icon=!0),i.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},e.vakata={},e.vakata.attributes=function(t,r){t=e(t)[0];var n=r?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,i){-1===e.inArray(i.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==i.value&&""!==e.trim(i.value)&&(r?n[i.name]=i.value:n.push(i.name))}),n},e.vakata.array_unique=function(e){var r,n,i=[],a={};for(r=0,n=e.length;r<n;r++)a[e[r]]===t&&(i.push(e[r]),a[e[r]]=!0);return i},e.vakata.array_remove=function(e,t){return e.splice(t,1),e},e.vakata.array_remove_item=function(t,r){var n=e.inArray(r,t);return-1!==n?e.vakata.array_remove(t,n):t},e.vakata.array_filter=function(e,t,r,n,i){if(e.filter)return e.filter(t,r);for(i in n=[],e)~~i+""==i+""&&i>=0&&t.call(r,e[i],+i,e)&&n.push(e[i]);return n},e.jstree.plugins.changed=function(e,t){var r=[];this.trigger=function(e,n){var i,a;if(n||(n={}),"changed"===e.replace(".jstree","")){n.changed={selected:[],deselected:[]};var s={};for(i=0,a=r.length;i<a;i++)s[r[i]]=1;for(i=0,a=n.selected.length;i<a;i++)s[n.selected[i]]?s[n.selected[i]]=2:n.changed.selected.push(n.selected[i]);for(i=0,a=r.length;i<a;i++)1===s[r[i]]&&n.changed.deselected.push(r[i]);r=n.selected.slice()}t.trigger.call(this,e,n)},this.refresh=function(e,n){return r=[],t.refresh.apply(this,arguments)}};var u,c,d=l.createElement("I");d.className="jstree-icon jstree-checkbox",d.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},e.jstree.plugins.checkbox=function(r,n){this.bind=function(){n.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){var r,n,i=this._model.data,a=(i[t.parent],t.nodes);for(r=0,n=a.length;r<n;r++)i[a[r]].state.checked=i[a[r]].state.checked||i[a[r]].original&&i[a[r]].original.state&&i[a[r]].original.state.checked,i[a[r]].state.checked&&this._data.checkbox.selected.push(a[r])},this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",e.proxy(function(t,r){var n,i,a,s,o,l,u=this._model.data,c=u[r.parent],d=r.nodes,h=[],f=this.settings.checkbox.cascade,p=this.settings.checkbox.tie_selection;if(-1!==f.indexOf("down"))if(c.state[p?"selected":"checked"]){for(i=0,a=d.length;i<a;i++)u[d[i]].state[p?"selected":"checked"]=!0;this._data[p?"core":"checkbox"].selected=this._data[p?"core":"checkbox"].selected.concat(d)}else for(i=0,a=d.length;i<a;i++)if(u[d[i]].state[p?"selected":"checked"]){for(s=0,o=u[d[i]].children_d.length;s<o;s++)u[u[d[i]].children_d[s]].state[p?"selected":"checked"]=!0;this._data[p?"core":"checkbox"].selected=this._data[p?"core":"checkbox"].selected.concat(u[d[i]].children_d)}if(-1!==f.indexOf("up")){for(i=0,a=c.children_d.length;i<a;i++)u[c.children_d[i]].children.length||h.push(u[c.children_d[i]].parent);for(s=0,o=(h=e.vakata.array_unique(h)).length;s<o;s++)for(c=u[h[s]];c&&c.id!==e.jstree.root;){for(n=0,i=0,a=c.children.length;i<a;i++)n+=u[c.children[i]].state[p?"selected":"checked"];if(n!==a)break;c.state[p?"selected":"checked"]=!0,this._data[p?"core":"checkbox"].selected.push(c.id),(l=this.get_node(c,!0))&&l.length&&l.attr("aria-selected",!0).children(".jstree-anchor").addClass(p?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}}this._data[p?"core":"checkbox"].selected=e.vakata.array_unique(this._data[p?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,r){var n,i,a,s,o=r.node,l=this._model.data,u=this.get_node(o.parent),c=this.settings.checkbox.cascade,d=this.settings.checkbox.tie_selection,h={},f=this._data[d?"core":"checkbox"].selected;for(n=0,i=f.length;n<i;n++)h[f[n]]=!0;if(-1!==c.indexOf("down")){var p=this._cascade_new_checked_state(o.id,!0),g=o.children_d.concat(o.id);for(n=0,i=g.length;n<i;n++)p.indexOf(g[n])>-1?h[g[n]]=!0:delete h[g[n]]}if(-1!==c.indexOf("up"))for(;u&&u.id!==e.jstree.root;){for(a=0,n=0,i=u.children.length;n<i;n++)a+=l[u.children[n]].state[d?"selected":"checked"];if(a!==i)break;u.state[d?"selected":"checked"]=!0,h[u.id]=!0,(s=this.get_node(u,!0))&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass(d?"jstree-clicked":"jstree-checked"),u=this.get_node(u.parent)}for(n in f=[],h)h.hasOwnProperty(n)&&f.push(n);this._data[d?"core":"checkbox"].selected=f},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(t,r){var n,i,a,s=this.get_node(e.jstree.root),o=this._model.data;for(n=0,i=s.children_d.length;n<i;n++)(a=o[s.children_d[n]])&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,r){var n,i,a,s=r.node,o=(this.get_node(s,!0),this.settings.checkbox.cascade),l=this.settings.checkbox.tie_selection,u=this._data[l?"core":"checkbox"].selected,c=s.children_d.concat(s.id);if(-1!==o.indexOf("down")){var d=this._cascade_new_checked_state(s.id,!1);u=e.vakata.array_filter(u,function(e){return-1===c.indexOf(e)||d.indexOf(e)>-1})}if(-1!==o.indexOf("up")&&-1===u.indexOf(s.id)){for(n=0,i=s.parents.length;n<i;n++)(a=this._model.data[s.parents[n]]).state[l?"selected":"checked"]=!1,a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1),(a=this.get_node(s.parents[n],!0))&&a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass(l?"jstree-clicked":"jstree-checked");u=e.vakata.array_filter(u,function(e){return-1===s.parents.indexOf(e)})}this._data[l?"core":"checkbox"].selected=u},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",e.proxy(function(t,r){for(var n,i,a,s,o=this.get_node(r.parent),l=this._model.data,u=this.settings.checkbox.tie_selection;o&&o.id!==e.jstree.root&&!o.state[u?"selected":"checked"];){for(a=0,n=0,i=o.children.length;n<i;n++)a+=l[o.children[n]].state[u?"selected":"checked"];if(!(i>0&&a===i))break;o.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(o.id),(s=this.get_node(o,!0))&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),o=this.get_node(o.parent)}},this)).on("move_node.jstree",e.proxy(function(t,r){var n,i,a,s,o,l=r.is_multi,u=r.old_parent,c=this.get_node(r.parent),d=this._model.data,h=this.settings.checkbox.tie_selection;if(!l)for(n=this.get_node(u);n&&n.id!==e.jstree.root&&!n.state[h?"selected":"checked"];){for(i=0,a=0,s=n.children.length;a<s;a++)i+=d[n.children[a]].state[h?"selected":"checked"];if(!(s>0&&i===s))break;n.state[h?"selected":"checked"]=!0,this._data[h?"core":"checkbox"].selected.push(n.id),(o=this.get_node(n,!0))&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(h?"jstree-clicked":"jstree-checked"),n=this.get_node(n.parent)}for(n=c;n&&n.id!==e.jstree.root;){for(i=0,a=0,s=n.children.length;a<s;a++)i+=d[n.children[a]].state[h?"selected":"checked"];if(i===s)n.state[h?"selected":"checked"]||(n.state[h?"selected":"checked"]=!0,this._data[h?"core":"checkbox"].selected.push(n.id),(o=this.get_node(n,!0))&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(h?"jstree-clicked":"jstree-checked"));else{if(!n.state[h?"selected":"checked"])break;n.state[h?"selected":"checked"]=!1,this._data[h?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[h?"core":"checkbox"].selected,n.id),(o=this.get_node(n,!0))&&o.length&&o.attr("aria-selected",!1).children(".jstree-anchor").removeClass(h?"jstree-clicked":"jstree-checked")}n=this.get_node(n.parent)}},this))},this.get_undetermined=function(r){if(-1===this.settings.checkbox.cascade.indexOf("undetermined"))return[];var n,i,a,s,o={},l=this._model.data,u=this.settings.checkbox.tie_selection,c=this._data[u?"core":"checkbox"].selected,d=[],h=this,f=[];for(n=0,i=c.length;n<i;n++)if(l[c[n]]&&l[c[n]].parents)for(a=0,s=l[c[n]].parents.length;a<s&&o[l[c[n]].parents[a]]===t;a++)l[c[n]].parents[a]!==e.jstree.root&&(o[l[c[n]].parents[a]]=!0,d.push(l[c[n]].parents[a]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var r,u=h.get_node(this);if(u)if(u.state.loaded){for(n=0,i=u.children_d.length;n<i;n++)if(!(r=l[u.children_d[n]]).state.loaded&&r.original&&r.original.state&&r.original.state.undetermined&&!0===r.original.state.undetermined)for(o[r.id]===t&&r.id!==e.jstree.root&&(o[r.id]=!0,d.push(r.id)),a=0,s=r.parents.length;a<s;a++)o[r.parents[a]]===t&&r.parents[a]!==e.jstree.root&&(o[r.parents[a]]=!0,d.push(r.parents[a]))}else if(u.original&&u.original.state&&u.original.state.undetermined&&!0===u.original.state.undetermined)for(o[u.id]===t&&u.id!==e.jstree.root&&(o[u.id]=!0,d.push(u.id)),a=0,s=u.parents.length;a<s;a++)o[u.parents[a]]===t&&u.parents[a]!==e.jstree.root&&(o[u.parents[a]]=!0,d.push(u.parents[a]))}),n=0,i=d.length;n<i;n++)l[d[n]].state[u?"selected":"checked"]||f.push(r?l[d[n]]:d[n]);return f},this._undetermined=function(){if(null!==this.element){var e,t,r,n=this.get_undetermined(!1);for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),e=0,t=n.length;e<t;e++)(r=this.get_node(n[e],!0))&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(t,r,i,a){if(t=n.redraw_node.apply(this,arguments)){var s,o,l=null,u=null;for(s=0,o=t.childNodes.length;s<o;s++)if(t.childNodes[s]&&t.childNodes[s].className&&-1!==t.childNodes[s].className.indexOf("jstree-anchor")){l=t.childNodes[s];break}l&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(l.className+=" jstree-checked"),u=d.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(u.className+=" jstree-checkbox-disabled"),l.insertBefore(u,l.childNodes[0]))}return i||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var r,n,i=this.settings.checkbox.cascade,a=this.settings.checkbox.tie_selection,s=this._data[a?"core":"checkbox"].selected,o=this._model.data;if(!t||!0===t.state[a?"selected":"checked"]||-1===i.indexOf("undetermined")||-1===i.indexOf("down")&&-1===i.indexOf("up"))return!1;if(!t.state.loaded&&!0===t.original.state.undetermined)return!0;for(r=0,n=t.children_d.length;r<n;r++)if(-1!==e.inArray(t.children_d[r],s)||!o[t.children_d[r]].state.loaded&&o[t.children_d[r]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var r,n,i;if(e.isArray(t)){for(r=0,n=(t=t.slice()).length;r<n;r++)this.disable_checkbox(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;i=this.get_node(t,!0),t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,i&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))},this.enable_checkbox=function(t){var r,n,i;if(e.isArray(t)){for(r=0,n=(t=t.slice()).length;r<n;r++)this.enable_checkbox(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;i=this.get_node(t,!0),t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,i&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))},this.activate_node=function(t,r){return!e(r.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(r.target).hasClass("jstree-checkbox"))&&(r.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(r.target).hasClass("jstree-checkbox")?n.activate_node.call(this,t,r):!this.is_disabled(t)&&(this.is_checked(t)?this.uncheck_node(t,r):this.check_node(t,r),void this.trigger("activate_node",{node:this.get_node(t)})))},this._cascade_new_checked_state=function(e,t){var r,n,i,a=this.settings.checkbox.tie_selection,s=this._model.data[e],o=[],l=[];if(!this.settings.checkbox.cascade_to_disabled&&s.state.disabled||!this.settings.checkbox.cascade_to_hidden&&s.state.hidden)i=this.get_checked_descendants(e),s.state[a?"selected":"checked"]&&i.push(s.id),o=o.concat(i);else{if(s.children)for(r=0,n=s.children.length;r<n;r++){var u=s.children[r];i=this._cascade_new_checked_state(u,t),o=o.concat(i),i.indexOf(u)>-1&&l.push(u)}var c=this.get_node(s,!0),d=l.length>0&&l.length<s.children.length;s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=d),d?(s.state[a?"selected":"checked"]=!1,c.attr("aria-selected",!1).children(".jstree-anchor").removeClass(a?"jstree-clicked":"jstree-checked")):t&&l.length===s.children.length?(s.state[a?"selected":"checked"]=t,o.push(s.id),c.attr("aria-selected",!0).children(".jstree-anchor").addClass(a?"jstree-clicked":"jstree-checked")):(s.state[a?"selected":"checked"]=!1,c.attr("aria-selected",!1).children(".jstree-anchor").removeClass(a?"jstree-clicked":"jstree-checked"))}return o},this.get_checked_descendants=function(t){var r=this,n=r.settings.checkbox.tie_selection,i=r._model.data[t];return e.vakata.array_filter(i.children_d,function(e){return r._model.data[e].state[n?"selected":"checked"]})},this.check_node=function(t,r){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,r);var n,i,a;if(e.isArray(t)){for(i=0,a=(t=t.slice()).length;i<a;i++)this.check_node(t[i],r);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;n=this.get_node(t,!0),t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),n&&n.length&&n.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:r}))},this.uncheck_node=function(t,r){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,r);var n,i,a;if(e.isArray(t)){for(n=0,i=(t=t.slice()).length;n<i;n++)this.uncheck_node(t[n],r);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;a=this.get_node(t,!0),t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),a.length&&a.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:r}))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,r;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,r=this._data.checkbox.selected.length;t<r;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var e,t,r=this._data.checkbox.selected.concat([]);for(e=0,t=this._data.checkbox.selected.length;e<t;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:r})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.checked},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected.slice()},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var r,n,i,a,s=this.get_checked(!0),o={};for(r=0,n=s.length;r<n;r++)o[s[r].id]=s[r];for(r=0,n=s.length;r<n;r++)for(i=0,a=s[r].children_d.length;i<a;i++)o[s[r].children_d[i]]&&delete o[s[r].children_d[i]];for(r in s=[],o)o.hasOwnProperty(r)&&s.push(r);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var r,n,i=this.get_checked(!0),a=[];for(r=0,n=i.length;r<n;r++)i[r].children.length||a.push(i[r].id);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},this.load_node=function(t,r){var i,a,s;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection&&(s=this.get_node(t))&&s.state.loaded)for(i=0,a=s.children_d.length;i<a;i++)this._model.data[s.children_d[i]].state.checked&&(!0,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,s.children_d[i]));return n.load_node.apply(this,arguments)},this.get_state=function(){var e=n.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?e:(e.checkbox=this._data.checkbox.selected.slice(),e)},this.set_state=function(t,r){var i=n.set_state.apply(this,arguments);if(i&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var a=this;e.each(t.checkbox,function(e,t){a.check_node(t)})}return delete t.checkbox,this.set_state(t,r),!1}return i},this.refresh=function(e,t){return this.settings.checkbox.tie_selection&&(this._data.checkbox.selected=[]),n.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,r){if(this.settings.conditionalselect.call(this,this.get_node(e),r))return t.activate_node.call(this,e,r)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,r){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var r=e.jstree.reference(t.reference),n=r.get_node(t.reference);r.create_node(n,{},"last",function(e){try{r.edit(e)}catch(t){setTimeout(function(){r.edit(e)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",
/*!
					"shortcut"			: 113,
					"shortcut_label"	: 'F2',
					"icon"				: "glyphicon glyphicon-leaf",
					*/
action:function(t){var r=e.jstree.reference(t.reference),n=r.get_node(t.reference);r.edit(n)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var r=e.jstree.reference(t.reference),n=r.get_node(t.reference);r.is_selected(n)?r.delete_node(r.get_selected()):r.delete_node(n)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var r=e.jstree.reference(t.reference),n=r.get_node(t.reference);r.is_selected(n)?r.cut(r.get_top_selected()):r.cut(n)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var r=e.jstree.reference(t.reference),n=r.get_node(t.reference);r.is_selected(n)?r.copy(r.get_top_selected()):r.copy(n)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var r=e.jstree.reference(t.reference),n=r.get_node(t.reference);r.paste(n)}}}}}}},e.jstree.plugins.contextmenu=function(r,n){this.bind=function(){n.bind.call(this);var t,r,i=0,a=null;this.element.on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-contextmenu")},this)).on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,t){"input"!==e.target.tagName.toLowerCase()&&(e.preventDefault(),i=e.ctrlKey?+new Date:0,(t||a)&&(i=+new Date+1e4),a&&clearTimeout(a),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){this._data.contextmenu.visible&&(!i||+new Date-i>250)&&e.vakata.context.hide(),i=0},this)).on("touchstart.jstree",".jstree-anchor",function(n){n.originalEvent&&n.originalEvent.changedTouches&&n.originalEvent.changedTouches[0]&&(t=n.originalEvent.changedTouches[0].clientX,r=n.originalEvent.changedTouches[0].clientY,a=setTimeout(function(){e(n.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(n){a&&n.originalEvent&&n.originalEvent.changedTouches&&n.originalEvent.changedTouches[0]&&(Math.abs(t-n.originalEvent.changedTouches[0].clientX)>10||Math.abs(r-n.originalEvent.changedTouches[0].clientY)>10)&&(clearTimeout(a),e.vakata.context.hide())}).on("touchend.vakata.jstree",function(e){a&&clearTimeout(a)}),
/*!
			if(!('oncontextmenu' in document.body) && ('ontouchstart' in document.body)) {
				var el = null, tm = null;
				this.element
					.on("touchstart", ".jstree-anchor", function (e) {
						el = e.currentTarget;
						tm = +new Date();
						$(document).one("touchend", function (e) {
							e.target = document.elementFromPoint(e.originalEvent.targetTouches[0].pageX - window.pageXOffset, e.originalEvent.targetTouches[0].pageY - window.pageYOffset);
							e.currentTarget = e.target;
							tm = ((+(new Date())) - tm);
							if(e.target === el && tm > 600 && tm < 1000) {
								e.preventDefault();
								$(el).trigger('contextmenu', e);
							}
							el = null;
							tm = null;
						});
					});
			}
			*/
e(l).on("context_hide.vakata.jstree",e.proxy(function(t,r){this._data.contextmenu.visible=!1,e(r.reference).removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),n.teardown.call(this)},this.show_contextmenu=function(r,n,i,a){if(!(r=this.get_node(r))||r.id===e.jstree.root)return!1;var s=this.settings.contextmenu,o=this.get_node(r,!0).children(".jstree-anchor"),l=!1,u=!1;(s.show_at_node||n===t||i===t)&&(l=o.offset(),n=l.left,i=l.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(r)&&this.activate_node(r,a),u=s.items,e.isFunction(u)&&(u=u.call(this,r,e.proxy(function(e){this._show_contextmenu(r,n,i,e)},this))),e.isPlainObject(u)&&this._show_contextmenu(r,n,i,u)},this._show_contextmenu=function(t,r,n,i){var a=this.get_node(t,!0).children(".jstree-anchor");e(l).one("context_show.vakata.jstree",e.proxy(function(t,r){var n="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(r.element).addClass(n),a.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(a,{x:r,y:n},i),this.trigger("show_contextmenu",{node:t,x:r,y:n})}},function(e){var t=!1,r={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(l).triggerHandler("context_"+t+".vakata",{reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}})},_execute:function(t){return!(!(t=r.items[t])||t._disabled&&(!e.isFunction(t._disabled)||t._disabled({item:t,reference:r.reference,element:r.element}))||!t.action)&&t.action.call(null,{item:t,reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}})},_parse:function(t,n){if(!t)return!1;n||(r.html="",r.items=[]);var i,a="",s=!1;return n&&(a+="<ul>"),e.each(t,function(t,n){if(!n)return!0;r.items.push(n),!s&&n.separator_before&&(a+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),s=!1,a+="<li class='"+(n._class||"")+(!0===n._disabled||e.isFunction(n._disabled)&&n._disabled({item:n,reference:r.reference,element:r.element})?" vakata-contextmenu-disabled ":"")+"' "+(n.shortcut?" data-shortcut='"+n.shortcut+"' ":"")+">",a+="<a href='#' rel='"+(r.items.length-1)+"' "+(n.title?"title='"+n.title+"'":"")+">",e.vakata.context.settings.icons&&(a+="<i ",n.icon&&(-1!==n.icon.indexOf("/")||-1!==n.icon.indexOf(".")?a+=" style='background:url(\""+n.icon+"\") center center no-repeat' ":a+=" class='"+n.icon+"' "),a+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),a+=(e.isFunction(n.label)?n.label({item:t,reference:r.reference,element:r.element}):n.label)+(n.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+n.shortcut+'">'+(n.shortcut_label||"")+"</span>":"")+"</a>",n.submenu&&(i=e.vakata.context._parse(n.submenu,!0))&&(a+=i),a+="</li>",n.separator_after&&(a+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",s=!0)}),a=a.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),n&&(a+="</ul>"),n||(r.html=a,e.vakata.context._trigger("parse")),a.length>10&&a},_show_submenu:function(r){if((r=e(r)).length&&r.children("ul").length){var n=r.children("ul"),i=r.offset().left,a=i+r.outerWidth(),s=r.offset().top,o=n.width(),l=n.height(),u=e(window).width()+e(window).scrollLeft(),c=e(window).height()+e(window).scrollTop();t?r[a-(o+10+r.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):r[a+o>u&&i>u-a?"addClass":"removeClass"]("vakata-context-right"),s+l+10>c&&n.css("bottom","-1px"),r.hasClass("vakata-context-right")?i<o&&n.css("margin-right",i-o):u-a<o&&n.css("margin-left",u-a-o),n.show()}},show:function(n,i,a){var s,o,u,c,d,h,f,p;switch(r.element&&r.element.length&&r.element.width(""),!0){case!i&&!n:return!1;case!!i&&!!n:r.reference=n,r.position_x=i.x,r.position_y=i.y;break;case!i&&!!n:r.reference=n,s=n.offset(),r.position_x=s.left+n.outerHeight(),r.position_y=s.top;break;case!!i&&!n:r.position_x=i.x,r.position_y=i.y}n&&!a&&e(n).data("vakata_contextmenu")&&(a=e(n).data("vakata_contextmenu")),e.vakata.context._parse(a)&&r.element.html(r.html),r.items.length&&(r.element.appendTo(l.body),o=r.element,u=r.position_x,c=r.position_y,d=o.width(),h=o.height(),f=e(window).width()+e(window).scrollLeft(),p=e(window).height()+e(window).scrollTop(),t&&(u-=o.outerWidth()-e(n).outerWidth())<e(window).scrollLeft()+20&&(u=e(window).scrollLeft()+20),u+d+20>f&&(u=f-(d+20)),c+h+20>p&&(c=p-(h+20)),r.element.css({left:u,top:c}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),r.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){r.is_visible&&(r.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),r.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e(l.body).css("direction");var n=!1;r.element=e("<ul class='vakata-context'></ul>"),r.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(n&&clearTimeout(n),r.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(n=setTimeout(function(){e.vakata.context.hide()},e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||!1===e.vakata.context._execute(e(this).attr("rel"))||e.vakata.context.hide()}).on("keydown","a",function(t){var n=null;switch(t.which){case 13:case 32:t.type="click",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:r.is_visible&&(r.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:r.is_visible&&((n=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first()).length||(n=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),n.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:r.is_visible&&(r.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:r.is_visible&&((n=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first()).length||(n=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),n.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=r.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.click()}),e(l).on("mousedown.vakata.jstree",function(t){r.is_visible&&r.element[0]!==t.target&&!e.contains(r.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,n){r.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&r.element.addClass("vakata-context-rtl").css("direction","rtl"),r.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1},e.jstree.plugins.dnd=function(t,r){this.init=function(e,t){r.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in l.createElement("span")},this.bind=function(){r.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var r=this.get_node(t.target),n=this.is_selected(r)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,i=n>1?n+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text&&(i=e.vakata.html.escape(i)),r&&r.id&&r.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type||"dragstart"===t.type)&&(!0===this.settings.dnd.is_draggable||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,n>1?this.get_top_selected(!0):[r],t))){if(u={jstree:!0,origin:this,obj:this.get_node(r,!0),nodes:n>1?this.get_top_selected():[r.id]},c=t.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,u,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+i+'<ins class="jstree-copy" style="display:none;">+</ins></div>');e.vakata.dnd._trigger("start",t,{helper:e(),element:c,data:u})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(t){return t.preventDefault(),e.vakata.dnd._trigger("move",t,{helper:e(),element:c,data:u}),!1}).on("drop.jstree",e.proxy(function(t){return t.preventDefault(),e.vakata.dnd._trigger("stop",t,{helper:e(),element:c,data:u}),!1},this))},this.redraw_node=function(e,t,n,i){if((e=r.redraw_node.apply(this,arguments))&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{var a,s,o=null;for(a=0,s=e.childNodes.length;a<s;a++)if(e.childNodes[a]&&e.childNodes[a].className&&-1!==e.childNodes[a].className.indexOf("jstree-anchor")){o=e.childNodes[a];break}o&&o.setAttribute("draggable",!0)}return e}},e(function(){var r=!1,n=!1,i=!1,a=!1,s=e('<div id="jstree-marker">&#160;</div>').hide();e(l).on("dragover.vakata.jstree",function(t){c&&e.vakata.dnd._trigger("move",t,{helper:e(),element:c,data:u})}).on("drop.vakata.jstree",function(t){c&&(e.vakata.dnd._trigger("stop",t,{helper:e(),element:c,data:u}),c=null,u=null)}).on("dnd_start.vakata.jstree",function(e,t){r=!1,i=!1,t&&t.data&&t.data.jstree&&s.appendTo(l.body)}).on("dnd_move.vakata.jstree",function(o,l){var u=l.event.target!==i.target;if(a&&(l.event&&"dragover"===l.event.type&&!u||clearTimeout(a)),l&&l.data&&l.data.jstree&&(!l.event.target.id||"jstree-marker"!==l.event.target.id)){i=l.event;var c,d,h,f,p,g,m,v,_,y,b,w,S,E,x,T,k=e.jstree.reference(l.event.target),A=!1,C=!1,j=!1;if(k&&k._data&&k._data.dnd)if(s.attr("class","jstree-"+k.get_theme()+(k.settings.core.themes.responsive?" jstree-dnd-responsive":"")),x=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey)),l.helper.children().attr("class","jstree-"+k.get_theme()+" jstree-"+k.get_theme()+"-"+k.get_theme_variant()+" "+(k.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[x?"show":"hide"](),l.event.target!==k.element[0]&&l.event.target!==k.get_container_ul()[0]||0!==k.get_container_ul().children().length){if((A=k.settings.dnd.large_drop_target?e(l.event.target).closest(".jstree-node").children(".jstree-anchor"):e(l.event.target).closest(".jstree-anchor"))&&A.length&&A.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(C=A.offset(),j=(l.event.pageY!==t?l.event.pageY:l.event.originalEvent.pageY)-C.top,h=A.outerHeight(),g=j<h/3?["b","i","a"]:j>h-h/3?["a","i","b"]:j>h/2?["i","a","b"]:["i","b","a"],e.each(g,function(t,i){switch(i){case"b":c=C.left-6,d=C.top,f=k.get_parent(A),p=A.parent().index();break;case"i":S=k.settings.dnd.inside_pos,E=k.get_node(A.parent()),c=C.left-2,d=C.top+h/2+1,f=E.id,p="first"===S?0:"last"===S?E.children.length:Math.min(S,E.children.length);break;case"a":c=C.left-6,d=C.top+h,f=k.get_parent(A),p=A.parent().index()+1}for(m=!0,v=0,_=l.data.nodes.length;v<_;v++)if(y=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",b=p,"move_node"===y&&"a"===i&&l.data.origin&&l.data.origin===k&&f===k.get_parent(l.data.nodes[v])&&(w=k.get_node(f),b>e.inArray(l.data.nodes[v],w.children)&&(b-=1)),!(m=m&&(k&&k.settings&&k.settings.dnd&&!1===k.settings.dnd.check_while_dragging||k.check(y,l.data.origin&&l.data.origin!==k?l.data.origin.get_node(l.data.nodes[v]):l.data.nodes[v],f,b,{dnd:!0,ref:k.get_node(A.parent()),pos:i,origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==k,is_foreign:!l.data.origin})))){k&&k.last_error&&(n=k.last_error());break}var o,j;if("i"===i&&A.parent().is(".jstree-closed")&&k.settings.dnd.open_timeout&&(l.event&&"dragover"===l.event.type&&!u||(a&&clearTimeout(a),a=setTimeout((o=k,j=A,function(){o.open_node(j)}),k.settings.dnd.open_timeout))),m)return(T=k.get_node(f,!0)).hasClass(".jstree-dnd-parent")||(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),T.addClass("jstree-dnd-parent")),r={ins:k,par:f,pos:"i"!==i||"last"!==S||0!==p||k.is_loaded(E)?p:"last"},s.css({left:c+"px",top:d+"px"}).show(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=x?"copy":"move"),n={},g=!0,!1}),!0===g))return}else{for(m=!0,v=0,_=l.data.nodes.length;v<_&&(m=m&&k.check(l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",l.data.origin&&l.data.origin!==k?l.data.origin.get_node(l.data.nodes[v]):l.data.nodes[v],e.jstree.root,"last",{dnd:!0,ref:k.get_node(e.jstree.root),pos:"i",origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==k,is_foreign:!l.data.origin}));v++);if(m)return r={ins:k,par:e.jstree.root,pos:"last"},s.hide(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=x?"copy":"move"))}e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),r=!1,l.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),l.event.originalEvent&&l.event.originalEvent.dataTransfer,s.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(s.hide(),r=!1,i=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(t,o){if(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),a&&clearTimeout(a),o&&o.data&&o.data.jstree){s.hide().detach();var l,u,c=[];if(r){for(l=0,u=o.data.nodes.length;l<u;l++)c[l]=o.data.origin?o.data.origin.get_node(o.data.nodes[l]):o.data.nodes[l];r.ins[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node"](c,r.par,r.pos,!1,!1,!1,o.data.origin)}else(l=e(o.event.target).closest(".jstree")).length&&n&&n.error&&"check"===n.error&&(l=l.jstree(!0))&&l.settings.core.error.call(this,n);i=!1,r=!1}}).on("keyup.jstree keydown.jstree",function(t,o){(o=e.vakata.dnd._get())&&o.data&&o.data.jstree&&("keyup"===t.type&&27===t.which?(a&&clearTimeout(a),r=!1,n=!1,i=!1,a=!1,s.hide().detach(),e.vakata.dnd._clean()):(o.helper.find(".jstree-copy").first()[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),i&&(i.metaKey=t.metaKey,i.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",i))))})}),function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(r,n,i){i===t&&(i=e.vakata.dnd._get()),i.event=n,e(l).triggerHandler("dnd_"+r+".vakata",i)},_get:function(){return{data:r.data,element:r.element,helper:r.helper}},_clean:function(){r.helper&&r.helper.remove(),r.scroll_i&&(clearInterval(r.scroll_i),r.scroll_i=!1),r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(l).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(l).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(t){if(!r.scroll_e||!r.scroll_l&&!r.scroll_t)return r.scroll_i&&(clearInterval(r.scroll_i),r.scroll_i=!1),!1;if(!r.scroll_i)return r.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(!0===t)return!1;var n=r.scroll_e.scrollTop(),i=r.scroll_e.scrollLeft();r.scroll_e.scrollTop(n+r.scroll_t*e.vakata.dnd.settings.scroll_speed),r.scroll_e.scrollLeft(i+r.scroll_l*e.vakata.dnd.settings.scroll_speed),n===r.scroll_e.scrollTop()&&i===r.scroll_e.scrollLeft()||e.vakata.dnd._trigger("scroll",r.scroll_e)},start:function(t,n,i){"touchstart"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=l.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_drag&&e.vakata.dnd.stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.touchAction="none",t.currentTarget.style.msTouchAction="none",t.currentTarget.style.MozUserSelect="none")}catch(e){}return r.init_x=t.pageX,r.init_y=t.pageY,r.data=n,r.is_down=!0,r.element=t.currentTarget,r.target=t.target,r.is_touch="touchstart"===t.type,!1!==i&&(r.helper=e("<div id='vakata-dnd'></div>").html(i).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(l).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(l).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(t){if("touchmove"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=l.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_down){if(!r.is_drag){if(!(Math.abs(t.pageX-r.init_x)>(r.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(t.pageY-r.init_y)>(r.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;r.helper&&(r.helper.appendTo(l.body),r.helper_w=r.helper.outerWidth()),r.is_drag=!0,e(r.target).one("click.vakata",!1),e.vakata.dnd._trigger("start",t)}var n=!1,i=!1,a=!1,s=!1,o=!1,u=!1,c=!1,d=!1,h=!1,f=!1;return r.scroll_t=0,r.scroll_l=0,r.scroll_e=!1,e(e(t.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var n=e(this),i=n.offset();if(this.scrollHeight>this.offsetHeight&&(i.top+n.height()-t.pageY<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=1),t.pageY-i.top<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(i.left+n.width()-t.pageX<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=1),t.pageX-i.left<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=-1)),r.scroll_t||r.scroll_l)return r.scroll_e=e(this),!1}),r.scroll_e||(n=e(l),i=e(window),a=n.height(),s=i.height(),o=n.width(),u=i.width(),c=n.scrollTop(),d=n.scrollLeft(),a>s&&t.pageY-c<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=-1),a>s&&s-(t.pageY-c)<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=1),o>u&&t.pageX-d<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=-1),o>u&&u-(t.pageX-d)<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=1),(r.scroll_t||r.scroll_l)&&(r.scroll_e=n)),r.scroll_e&&e.vakata.dnd._scroll(!0),r.helper&&(h=parseInt(t.pageY+e.vakata.dnd.settings.helper_top,10),f=parseInt(t.pageX+e.vakata.dnd.settings.helper_left,10),a&&h+25>a&&(h=a-50),o&&f+r.helper_w>o&&(f=o-(r.helper_w+2)),r.helper.css({left:f+"px",top:h+"px"})),e.vakata.dnd._trigger("move",t),!1}},stop:function(t){if("touchend"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=l.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_drag)t.target!==r.target&&e(r.target).off("click.vakata"),e.vakata.dnd._trigger("stop",t);else if("touchend"===t.type&&t.target===r.target){var n=setTimeout(function(){e(t.target).click()},100);e(t.target).one("click",function(){n&&clearTimeout(n)})}return e.vakata.dnd._clean(),!1}}}(e),e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,r){this.init=function(e,t){this._data.massload={},r.init.call(this,e,t)},this._load_nodes=function(t,n,i,a){var s,o,l,u=this.settings.massload,c=(JSON.stringify(t),[]),d=this._model.data;if(!i){for(s=0,o=t.length;s<o;s++)d[t[s]]&&(d[t[s]].state.loaded||d[t[s]].state.failed)&&!a||(c.push(t[s]),(l=this.get_node(t[s],!0))&&l.length&&l.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},c.length){if(e.isFunction(u))return u.call(this,c,e.proxy(function(e){var s,o;if(e)for(s in e)e.hasOwnProperty(s)&&(this._data.massload[s]=e[s]);for(s=0,o=t.length;s<o;s++)(l=this.get_node(t[s],!0))&&l.length&&l.removeClass("jstree-loading").attr("aria-busy",!1);r._load_nodes.call(this,t,n,i,a)},this));if("object"==typeof u&&u&&u.url)return u=e.extend(!0,{},u),e.isFunction(u.url)&&(u.url=u.url.call(this,c)),e.isFunction(u.data)&&(u.data=u.data.call(this,c)),e.ajax(u).done(e.proxy(function(e,s,o){var u,c;if(e)for(u in e)e.hasOwnProperty(u)&&(this._data.massload[u]=e[u]);for(u=0,c=t.length;u<c;u++)(l=this.get_node(t[u],!0))&&l.length&&l.removeClass("jstree-loading").attr("aria-busy",!1);r._load_nodes.call(this,t,n,i,a)},this)).fail(e.proxy(function(e){r._load_nodes.call(this,t,n,i,a)},this))}}return r._load_nodes.call(this,t,n,i,a)},this._load_node=function(t,n){var i,a=this._data.massload[t.id],s=null;return a?(s=this["string"==typeof a?"_append_html_data":"_append_json_data"](t,"string"==typeof a?e(e.parseHTML(a)).filter(function(){return 3!==this.nodeType}):a,function(e){n.call(this,e)}),(i=this.get_node(t.id,!0))&&i.length&&i.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[t.id],s):r._load_node.call(this,t,n)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(r,n){this.bind=function(){n.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(t,r){if(this._data.search.som&&r.res.length){var n,i,a,s,o=this._model.data,l=[];for(n=0,i=r.res.length;n<i;n++)if(o[r.res[n]]&&!o[r.res[n]].state.hidden&&(l.push(r.res[n]),l=l.concat(o[r.res[n]].parents),this._data.search.smc))for(a=0,s=o[r.res[n]].children_d.length;a<s;a++)o[o[r.res[n]].children_d[a]]&&!o[o[r.res[n]].children_d[a]].state.hidden&&l.push(o[r.res[n]].children_d[a]);l=e.vakata.array_remove_item(e.vakata.array_unique(l),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(l,!0),this.redraw(!0)}},this)).on("clear_search.jstree",e.proxy(function(e,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(r,n,i,a,s,o){if(!1===r||""===e.trim(r.toString()))return this.clear_search();a=(a=this.get_node(a))&&a.id?a.id:null,r=r.toString();var l,u,c=this.settings.search,d=!!c.ajax&&c.ajax,h=this._model.data,f=null,p=[],g=[];if(this._data.search.res.length&&!s&&this.clear_search(),i===t&&(i=c.show_only_matches),o===t&&(o=c.show_only_matches_children),!n&&!1!==d)return e.isFunction(d)?d.call(this,r,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(r,!0,i,a,s,o)})},this),a):((d=e.extend({},d)).data||(d.data={}),d.data.str=r,a&&(d.data.inside=a),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=e.ajax(d).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(d)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(r,!0,i,a,s,o)})},this)),this._data.search.lastRequest);if(s||(this._data.search.str=r,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=i,this._data.search.smc=o),f=new e.vakata.search(r,!0,{caseSensitive:c.case_sensitive,fuzzy:c.fuzzy}),e.each(h[a||e.jstree.root].children_d,function(e,t){var n=h[t];n.text&&!n.state.hidden&&(!c.search_leaves_only||n.state.loaded&&0===n.children.length)&&(c.search_callback&&c.search_callback.call(this,r,n)||!c.search_callback&&f.search(n.text).isMatch)&&(p.push(t),g=g.concat(n.parents))}),p.length){for(l=0,u=(g=e.vakata.array_unique(g)).length;l<u;l++)g[l]!==e.jstree.root&&h[g[l]]&&!0===this.open_node(g[l],null,0)&&this._data.search.opn.push(g[l]);s?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(p,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(p))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(p,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=p),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:r,res:this._data.search.res,show_only_matches:i})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t,r,i,a){if((t=n.redraw_node.apply(this,arguments))&&-1!==e.inArray(t.id,this._data.search.res)){var s,o,l=null;for(s=0,o=t.childNodes.length;s<o;s++)if(t.childNodes[s]&&t.childNodes[s].className&&-1!==t.childNodes[s].className.indexOf("jstree-anchor")){l=t.childNodes[s];break}l&&(l.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(t,r,n){n=n||{},!1!==(n=e.extend({},e.vakata.search.defaults,n)).fuzzy&&(n.fuzzy=!0),t=n.caseSensitive?t:t.toLowerCase();var i,a,s,o,l=n.location,u=n.distance,c=n.threshold,d=t.length;return d>32&&(n.fuzzy=!1),n.fuzzy&&(i=1<<d-1,a=function(){var e={},r=0;for(r=0;r<d;r++)e[t.charAt(r)]=0;for(r=0;r<d;r++)e[t.charAt(r)]|=1<<d-r-1;return e}(),s=function(e,t){var r=e/d,n=Math.abs(l-t);return u?r+n/u:n?1:r}),o=function(e){if(e=n.caseSensitive?e:e.toLowerCase(),t===e||-1!==e.indexOf(t))return{isMatch:!0,score:0};if(!n.fuzzy)return{isMatch:!1,score:1};var r,o,u,h,f,p,g,m,v,_=e.length,y=c,b=e.indexOf(t,l),w=d+_,S=1,E=[];for(-1!==b&&(y=Math.min(s(0,b),y),-1!==(b=e.lastIndexOf(t,l+d))&&(y=Math.min(s(0,b),y))),b=-1,r=0;r<d;r++){for(u=0,h=w;u<h;)s(r,l+h)<=y?u=h:w=h,h=Math.floor((w-u)/2+u);for(w=h,p=Math.max(1,l-h+1),g=Math.min(l+h,_)+d,(m=new Array(g+2))[g+1]=(1<<r)-1,o=g;o>=p;o--)if(v=a[e.charAt(o-1)],m[o]=0===r?(m[o+1]<<1|1)&v:(m[o+1]<<1|1)&v|(f[o+1]|f[o])<<1|1|f[o+1],m[o]&i&&(S=s(r,o-1))<=y){if(y=S,b=o-1,E.push(b),!(b>l))break;p=Math.max(1,2*l-b)}if(s(r+1,l)>y)break;f=m}return{isMatch:b>=0,score:S}},!0===r?{search:o}:o(r)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,r){this.bind=function(){r.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,r){var n,i;if((t=this.get_node(t))&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),r))for(n=0,i=t.children_d.length;n<i;n++)this.sort(t.children_d[n],!1)}};var h=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1},e.jstree.plugins.state=function(t,r){this.bind=function(){r.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){h&&clearTimeout(h),h=setTimeout(e.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(e,r){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t=this.get_state();this.settings.state.preserve_loaded||delete t.core.loaded;var r={state:t,ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(r))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(e){return!1}return!(t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl)&&(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),!!t&&(this.settings.state.preserve_loaded||delete t.core.loaded,this.element.one("set_state.jstree",function(r,n){n.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0))},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e,t){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(e),e.jstree.defaults.types={default:{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(r,n){this.init=function(r,i){var a,s;if(i&&i.types&&i.types.default)for(a in i.types)if("default"!==a&&a!==e.jstree.root&&i.types.hasOwnProperty(a))for(s in i.types.default)i.types.default.hasOwnProperty(s)&&i.types[a][s]===t&&(i.types[a][s]=i.types.default[s]);n.init.call(this,r,i),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,r){n.refresh.call(this,t,r),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",e.proxy(function(r,n){var i,a,s,o=this._model.data,l=n.nodes,u=this.settings.types,c="default";for(i=0,a=l.length;i<a;i++){if(c="default",o[l[i]].original&&o[l[i]].original.type&&u[o[l[i]].original.type]&&(c=o[l[i]].original.type),o[l[i]].data&&o[l[i]].data.jstree&&o[l[i]].data.jstree.type&&u[o[l[i]].data.jstree.type]&&(c=o[l[i]].data.jstree.type),o[l[i]].type=c,!0===o[l[i]].icon&&u[c].icon!==t&&(o[l[i]].icon=u[c].icon),u[c].li_attr!==t&&"object"==typeof u[c].li_attr)for(s in u[c].li_attr)if(u[c].li_attr.hasOwnProperty(s)){if("id"===s)continue;o[l[i]].li_attr[s]===t?o[l[i]].li_attr[s]=u[c].li_attr[s]:"class"===s&&(o[l[i]].li_attr.class=u[c].li_attr.class+" "+o[l[i]].li_attr.class)}if(u[c].a_attr!==t&&"object"==typeof u[c].a_attr)for(s in u[c].a_attr)if(u[c].a_attr.hasOwnProperty(s)){if("id"===s)continue;o[l[i]].a_attr[s]===t?o[l[i]].a_attr[s]=u[c].a_attr[s]:"href"===s&&"#"===o[l[i]].a_attr[s]?o[l[i]].a_attr.href=u[c].a_attr.href:"class"===s&&(o[l[i]].a_attr.class=u[c].a_attr.class+" "+o[l[i]].a_attr.class)}}o[e.jstree.root].type=e.jstree.root},this)),n.bind.call(this)},this.get_json=function(t,r,i){var a,s,o=this._model.data,l=r?e.extend(!0,{},r,{no_id:!1}):{},u=n.get_json.call(this,t,l,i);if(!1===u)return!1;if(e.isArray(u))for(a=0,s=u.length;a<s;a++)u[a].type=u[a].id&&o[u[a].id]&&o[u[a].id].type?o[u[a].id].type:"default",r&&r.no_id&&(delete u[a].id,u[a].li_attr&&u[a].li_attr.id&&delete u[a].li_attr.id,u[a].a_attr&&u[a].a_attr.id&&delete u[a].a_attr.id);else u.type=u.id&&o[u.id]&&o[u.id].type?o[u.id].type:"default",r&&r.no_id&&(u=this._delete_ids(u));return u},this._delete_ids=function(t){if(e.isArray(t)){for(var r=0,n=t.length;r<n;r++)t[r]=this._delete_ids(t[r]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(r,i,a,s,o){if(!1===n.check.call(this,r,i,a,s,o))return!1;i=i&&i.id?i:this.get_node(i),a=a&&a.id?a:this.get_node(a);var l,u,c,d,h=i&&i.id?o&&o.origin?o.origin:e.jstree.reference(i.id):null;switch(h=h&&h._model&&h._model.data?h._model.data:null,r){case"create_node":case"move_node":case"copy_node":if("move_node"!==r||-1===e.inArray(i.id,a.children)){if((l=this.get_rules(a)).max_children!==t&&-1!==l.max_children&&l.max_children===a.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+r,data:JSON.stringify({chk:r,pos:s,obj:!(!i||!i.id)&&i.id,par:!(!a||!a.id)&&a.id})},!1;if(l.valid_children!==t&&-1!==l.valid_children&&-1===e.inArray(i.type||"default",l.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+r,data:JSON.stringify({chk:r,pos:s,obj:!(!i||!i.id)&&i.id,par:!(!a||!a.id)&&a.id})},!1;if(h&&i.children_d&&i.parents){for(u=0,c=0,d=i.children_d.length;c<d;c++)u=Math.max(u,h[i.children_d[c]].parents.length);u=u-i.parents.length+1}(u<=0||u===t)&&(u=1);do{if(l.max_depth!==t&&-1!==l.max_depth&&l.max_depth<u)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+r,data:JSON.stringify({chk:r,pos:s,obj:!(!i||!i.id)&&i.id,par:!(!a||!a.id)&&a.id})},!1;a=this.get_node(a.parent),l=this.get_rules(a),u++}while(a)}}return!0},this.get_rules=function(e){if(!(e=this.get_node(e)))return!1;var r=this.get_type(e,!0);return r.max_depth===t&&(r.max_depth=-1),r.max_children===t&&(r.max_children=-1),r.valid_children===t&&(r.valid_children=-1),r},this.get_type=function(t,r){return!!(t=this.get_node(t))&&(r?e.extend({type:t.type},this.settings.types[t.type]):t.type)},this.set_type=function(r,n){var i,a,s,o,l,u,c,d,h=this._model.data;if(e.isArray(r)){for(a=0,s=(r=r.slice()).length;a<s;a++)this.set_type(r[a],n);return!0}if(i=this.settings.types,r=this.get_node(r),!i[n]||!r)return!1;if((c=this.get_node(r,!0))&&c.length&&(d=c.children(".jstree-anchor")),o=r.type,l=this.get_icon(r),r.type=n,(!0===l||!i[o]||i[o].icon!==t&&l===i[o].icon)&&this.set_icon(r,i[n].icon===t||i[n].icon),i[o]&&i[o].li_attr!==t&&"object"==typeof i[o].li_attr)for(u in i[o].li_attr)if(i[o].li_attr.hasOwnProperty(u)){if("id"===u)continue;"class"===u?(h[r.id].li_attr.class=(h[r.id].li_attr.class||"").replace(i[o].li_attr[u],""),c&&c.removeClass(i[o].li_attr[u])):h[r.id].li_attr[u]===i[o].li_attr[u]&&(h[r.id].li_attr[u]=null,c&&c.removeAttr(u))}if(i[o]&&i[o].a_attr!==t&&"object"==typeof i[o].a_attr)for(u in i[o].a_attr)if(i[o].a_attr.hasOwnProperty(u)){if("id"===u)continue;"class"===u?(h[r.id].a_attr.class=(h[r.id].a_attr.class||"").replace(i[o].a_attr[u],""),d&&d.removeClass(i[o].a_attr[u])):h[r.id].a_attr[u]===i[o].a_attr[u]&&("href"===u?(h[r.id].a_attr[u]="#",d&&d.attr("href","#")):(delete h[r.id].a_attr[u],d&&d.removeAttr(u)))}if(i[n].li_attr!==t&&"object"==typeof i[n].li_attr)for(u in i[n].li_attr)if(i[n].li_attr.hasOwnProperty(u)){if("id"===u)continue;h[r.id].li_attr[u]===t?(h[r.id].li_attr[u]=i[n].li_attr[u],c&&("class"===u?c.addClass(i[n].li_attr[u]):c.attr(u,i[n].li_attr[u]))):"class"===u&&(h[r.id].li_attr.class=i[n].li_attr[u]+" "+h[r.id].li_attr.class,c&&c.addClass(i[n].li_attr[u]))}if(i[n].a_attr!==t&&"object"==typeof i[n].a_attr)for(u in i[n].a_attr)if(i[n].a_attr.hasOwnProperty(u)){if("id"===u)continue;h[r.id].a_attr[u]===t?(h[r.id].a_attr[u]=i[n].a_attr[u],d&&("class"===u?d.addClass(i[n].a_attr[u]):d.attr(u,i[n].a_attr[u]))):"href"===u&&"#"===h[r.id].a_attr[u]?(h[r.id].a_attr.href=i[n].a_attr.href,d&&d.attr("href",i[n].a_attr.href)):"class"===u&&(h[r.id].a_attr.class=i[n].a_attr.class+" "+h[r.id].a_attr.class,d&&d.addClass(i[n].a_attr[u]))}return!0}},e.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(r,n){this.check=function(t,r,i,a,s){if(!1===n.check.call(this,t,r,i,a,s))return!1;if(r=r&&r.id?r:this.get_node(r),!(i=i&&i.id?i:this.get_node(i))||!i.children)return!0;var o,l,u,c="rename_node"===t?a:r.text,d=[],h=this.settings.unique.case_sensitive,f=this.settings.unique.trim_whitespace,p=this._model.data;for(o=0,l=i.children.length;o<l;o++)u=p[i.children[o]].text,h||(u=u.toLowerCase()),f&&(u=u.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),d.push(u);switch(h||(c=c.toLowerCase()),f&&(c=c.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),t){case"delete_node":return!0;case"rename_node":return u=r.text||"",h||(u=u.toLowerCase()),f&&(u=u.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),(o=-1===e.inArray(c,d)||r.text&&u===c)||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})}),o;case"create_node":return(o=-1===e.inArray(c,d))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})}),o;case"copy_node":return(o=-1===e.inArray(c,d))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})}),o;case"move_node":return(o=r.parent===i.id&&(!s||!s.is_multi)||-1===e.inArray(c,d))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})}),o}return!0},this.create_node=function(r,i,a,s,o){if(!i||i.text===t){if(null===r&&(r=e.jstree.root),!(r=this.get_node(r)))return n.create_node.call(this,r,i,a,s,o);if(!(a=a===t?"last":a).toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(r))return n.create_node.call(this,r,i,a,s,o);i||(i={});var l,u,c,d,h,f,p=this._model.data,g=this.settings.unique.case_sensitive,m=this.settings.unique.trim_whitespace,v=this.settings.unique.duplicate;for(u=l=this.get_string("New node"),c=[],d=0,h=r.children.length;d<h;d++)f=p[r.children[d]].text,g||(f=f.toLowerCase()),m&&(f=f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),c.push(f);for(d=1,f=u,g||(f=f.toLowerCase()),m&&(f=f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));-1!==e.inArray(f,c);)f=u=v.call(this,l,++d).toString(),g||(f=f.toLowerCase()),m&&(f=f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));i.text=u}return n.create_node.call(this,r,i,a,s,o)}};var f=l.createElement("DIV");if(f.setAttribute("unselectable","on"),f.setAttribute("role","presentation"),f.className="jstree-wholerow",f.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,r){this.bind=function(){r.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var r,n,i=!1;for(r=0,n=t.selected.length;r<n;r++)(i=this.get_node(t.selected[r],!0))&&i.length&&i.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){if(this._data.contextmenu){t.preventDefault();var r=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r)}},this))
/*!
				.on("mousedown.jstree touchstart.jstree", ".jstree-wholerow", function (e) {
						if(e.target === e.currentTarget) {
							var a = $(e.currentTarget).closest(".jstree-node").children(".jstree-anchor");
							e.target = a[0];
							a.trigger(e);
						}
					})
				*/.on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var r=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).focus()}).on("dblclick.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var r=e.Event("dblclick",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var r=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),r.teardown.call(this)},this.redraw_node=function(t,n,i,a){if(t=r.redraw_node.apply(this,arguments)){var s=f.cloneNode(!0);-1!==e.inArray(t.id,this._data.core.selected)&&(s.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(s.className+=" jstree-wholerow-hovered"),t.insertBefore(s,t.childNodes[0])}return t}},window.customElements&&Object&&Object.create){var p=Object.create(HTMLElement.prototype);p.createdCallback=function(){var t,r={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(r.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(r[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(r.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(r)};try{window.customElements.define("vakata-jstree",function(){},{prototype:p})}catch(e){}}})?n.apply(t,i):n)||(e.exports=a)}()},function(e,t,r){var n=r(11);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r(3)(n,i);n.locals&&(e.exports=n.locals)},function(e,t,r){t=e.exports=r(2)(!1);var n=r(12),i=n(r(13)),a=n(r(14)),s=n(r(15));t.push([e.i,"/* jsTree default theme */\n.jstree-node,\n.jstree-children,\n.jstree-container-ul {\n  display: block;\n  margin: 0;\n  padding: 0;\n  list-style-type: none;\n  list-style-image: none;\n}\n.jstree-node {\n  white-space: nowrap;\n}\n.jstree-anchor {\n  display: inline-block;\n  color: black;\n  white-space: nowrap;\n  padding: 0 4px 0 1px;\n  margin: 0;\n  vertical-align: top;\n}\n.jstree-anchor:focus {\n  outline: 0;\n}\n.jstree-anchor,\n.jstree-anchor:link,\n.jstree-anchor:visited,\n.jstree-anchor:hover,\n.jstree-anchor:active {\n  text-decoration: none;\n  color: inherit;\n}\n.jstree-icon {\n  display: inline-block;\n  text-decoration: none;\n  margin: 0;\n  padding: 0;\n  vertical-align: top;\n  text-align: center;\n}\n.jstree-icon:empty {\n  display: inline-block;\n  text-decoration: none;\n  margin: 0;\n  padding: 0;\n  vertical-align: top;\n  text-align: center;\n}\n.jstree-ocl {\n  cursor: pointer;\n}\n.jstree-leaf > .jstree-ocl {\n  cursor: default;\n}\n.jstree .jstree-open > .jstree-children {\n  display: block;\n}\n.jstree .jstree-closed > .jstree-children,\n.jstree .jstree-leaf > .jstree-children {\n  display: none;\n}\n.jstree-anchor > .jstree-themeicon {\n  margin-right: 2px;\n}\n.jstree-no-icons .jstree-themeicon,\n.jstree-anchor > .jstree-themeicon-hidden {\n  display: none;\n}\n.jstree-hidden,\n.jstree-node.jstree-hidden {\n  display: none;\n}\n.jstree-rtl .jstree-anchor {\n  padding: 0 1px 0 4px;\n}\n.jstree-rtl .jstree-anchor > .jstree-themeicon {\n  margin-left: 2px;\n  margin-right: 0;\n}\n.jstree-rtl .jstree-node {\n  margin-left: 0;\n}\n.jstree-rtl .jstree-container-ul > .jstree-node {\n  margin-right: 0;\n}\n.jstree-wholerow-ul {\n  position: relative;\n  display: inline-block;\n  min-width: 100%;\n}\n.jstree-wholerow-ul .jstree-leaf > .jstree-ocl {\n  cursor: pointer;\n}\n.jstree-wholerow-ul .jstree-anchor,\n.jstree-wholerow-ul .jstree-icon {\n  position: relative;\n}\n.jstree-wholerow-ul .jstree-wholerow {\n  width: 100%;\n  cursor: pointer;\n  position: absolute;\n  left: 0;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.jstree-contextmenu .jstree-anchor {\n  -webkit-user-select: none;\n  /* disable selection/Copy of UIWebView */\n  -webkit-touch-callout: none;\n  /* disable the IOS popup when long-press on a link */\n}\n.vakata-context {\n  display: none;\n}\n.vakata-context,\n.vakata-context ul {\n  margin: 0;\n  padding: 2px;\n  position: absolute;\n  background: #f5f5f5;\n  border: 1px solid #979797;\n  box-shadow: 2px 2px 2px #999999;\n}\n.vakata-context ul {\n  list-style: none;\n  left: 100%;\n  margin-top: -2.7em;\n  margin-left: -4px;\n}\n.vakata-context .vakata-context-right ul {\n  left: auto;\n  right: 100%;\n  margin-left: auto;\n  margin-right: -4px;\n}\n.vakata-context li {\n  list-style: none;\n}\n.vakata-context li > a {\n  display: block;\n  padding: 0 2em 0 2em;\n  text-decoration: none;\n  width: auto;\n  color: black;\n  white-space: nowrap;\n  line-height: 2.4em;\n  text-shadow: 1px 1px 0 white;\n  border-radius: 1px;\n}\n.vakata-context li > a:hover {\n  position: relative;\n  background-color: #e8eff7;\n  box-shadow: 0 0 2px #0a6aa1;\n}\n.vakata-context li > a.vakata-context-parent {\n  background-image: url(\"data:image/gif;base64,R0lGODlhCwAHAIAAACgoKP///yH5BAEAAAEALAAAAAALAAcAAAIORI4JlrqN1oMSnmmZDQUAOw==\");\n  background-position: right center;\n  background-repeat: no-repeat;\n}\n.vakata-context li > a:focus {\n  outline: 0;\n}\n.vakata-context .vakata-context-hover > a {\n  position: relative;\n  background-color: #e8eff7;\n  box-shadow: 0 0 2px #0a6aa1;\n}\n.vakata-context .vakata-context-separator > a,\n.vakata-context .vakata-context-separator > a:hover {\n  background: white;\n  border: 0;\n  border-top: 1px solid #e2e3e3;\n  height: 1px;\n  min-height: 1px;\n  max-height: 1px;\n  padding: 0;\n  margin: 0 0 0 2.4em;\n  border-left: 1px solid #e0e0e0;\n  text-shadow: 0 0 0 transparent;\n  box-shadow: 0 0 0 transparent;\n  border-radius: 0;\n}\n.vakata-context .vakata-contextmenu-disabled a,\n.vakata-context .vakata-contextmenu-disabled a:hover {\n  color: silver;\n  background-color: transparent;\n  border: 0;\n  box-shadow: 0 0 0;\n}\n.vakata-context .vakata-contextmenu-disabled > a > i {\n  filter: grayscale(100%);\n}\n.vakata-context li > a > i {\n  text-decoration: none;\n  display: inline-block;\n  width: 2.4em;\n  height: 2.4em;\n  background: transparent;\n  margin: 0 0 0 -2em;\n  vertical-align: top;\n  text-align: center;\n  line-height: 2.4em;\n}\n.vakata-context li > a > i:empty {\n  width: 2.4em;\n  line-height: 2.4em;\n}\n.vakata-context li > a .vakata-contextmenu-sep {\n  display: inline-block;\n  width: 1px;\n  height: 2.4em;\n  background: white;\n  margin: 0 0.5em 0 0;\n  border-left: 1px solid #e2e3e3;\n}\n.vakata-context .vakata-contextmenu-shortcut {\n  font-size: 0.8em;\n  color: silver;\n  opacity: 0.5;\n  display: none;\n}\n.vakata-context-rtl ul {\n  left: auto;\n  right: 100%;\n  margin-left: auto;\n  margin-right: -4px;\n}\n.vakata-context-rtl li > a.vakata-context-parent {\n  background-image: url(\"data:image/gif;base64,R0lGODlhCwAHAIAAACgoKP///yH5BAEAAAEALAAAAAALAAcAAAINjI+AC7rWHIsPtmoxLAA7\");\n  background-position: left center;\n  background-repeat: no-repeat;\n}\n.vakata-context-rtl .vakata-context-separator > a {\n  margin: 0 2.4em 0 0;\n  border-left: 0;\n  border-right: 1px solid #e2e3e3;\n}\n.vakata-context-rtl .vakata-context-left ul {\n  right: auto;\n  left: 100%;\n  margin-left: -4px;\n  margin-right: auto;\n}\n.vakata-context-rtl li > a > i {\n  margin: 0 -2em 0 0;\n}\n.vakata-context-rtl li > a .vakata-contextmenu-sep {\n  margin: 0 0 0 0.5em;\n  border-left-color: white;\n  background: #e2e3e3;\n}\n#jstree-marker {\n  position: absolute;\n  top: 0;\n  left: 0;\n  margin: -5px 0 0 0;\n  padding: 0;\n  border-right: 0;\n  border-top: 5px solid transparent;\n  border-bottom: 5px solid transparent;\n  border-left: 5px solid;\n  width: 0;\n  height: 0;\n  font-size: 0;\n  line-height: 0;\n}\n#jstree-dnd {\n  line-height: 16px;\n  margin: 0;\n  padding: 4px;\n}\n#jstree-dnd .jstree-icon,\n#jstree-dnd .jstree-copy {\n  display: inline-block;\n  text-decoration: none;\n  margin: 0 2px 0 0;\n  padding: 0;\n  width: 16px;\n  height: 16px;\n}\n#jstree-dnd .jstree-ok {\n  background: green;\n}\n#jstree-dnd .jstree-er {\n  background: red;\n}\n#jstree-dnd .jstree-copy {\n  margin: 0 2px 0 2px;\n}\n.jstree-default .jstree-node,\n.jstree-default .jstree-icon {\n  background-repeat: no-repeat;\n  background-color: transparent;\n}\n.jstree-default .jstree-anchor,\n.jstree-default .jstree-animated,\n.jstree-default .jstree-wholerow {\n  transition: background-color 0.15s, box-shadow 0.15s;\n}\n.jstree-default .jstree-hovered {\n  background: #e7f4f9;\n  border-radius: 2px;\n  box-shadow: inset 0 0 1px #cccccc;\n}\n.jstree-default .jstree-context {\n  background: #e7f4f9;\n  border-radius: 2px;\n  box-shadow: inset 0 0 1px #cccccc;\n}\n.jstree-default .jstree-clicked {\n  background: #beebff;\n  border-radius: 2px;\n  box-shadow: inset 0 0 1px #999999;\n}\n.jstree-default .jstree-no-icons .jstree-anchor > .jstree-themeicon {\n  display: none;\n}\n.jstree-default .jstree-disabled {\n  background: transparent;\n  color: #666666;\n}\n.jstree-default .jstree-disabled.jstree-hovered {\n  background: transparent;\n  box-shadow: none;\n}\n.jstree-default .jstree-disabled.jstree-clicked {\n  background: #efefef;\n}\n.jstree-default .jstree-disabled > .jstree-icon {\n  opacity: 0.8;\n  filter: url(\"data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\'><filter id=\\'jstree-grayscale\\'><feColorMatrix type=\\'matrix\\' values=\\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\\'/></filter></svg>#jstree-grayscale\");\n  /* Firefox 10+ */\n  filter: gray;\n  /* IE6-9 */\n  -webkit-filter: grayscale(100%);\n  /* Chrome 19+ & Safari 6+ */\n}\n.jstree-default .jstree-search {\n  font-style: italic;\n  color: #8b0000;\n  font-weight: bold;\n}\n.jstree-default .jstree-no-checkboxes .jstree-checkbox {\n  display: none !important;\n}\n.jstree-default.jstree-checkbox-no-clicked .jstree-clicked {\n  background: transparent;\n  box-shadow: none;\n}\n.jstree-default.jstree-checkbox-no-clicked .jstree-clicked.jstree-hovered {\n  background: #e7f4f9;\n}\n.jstree-default.jstree-checkbox-no-clicked > .jstree-wholerow-ul .jstree-wholerow-clicked {\n  background: transparent;\n}\n.jstree-default.jstree-checkbox-no-clicked > .jstree-wholerow-ul .jstree-wholerow-clicked.jstree-wholerow-hovered {\n  background: #e7f4f9;\n}\n.jstree-default > .jstree-striped {\n  min-width: 100%;\n  display: inline-block;\n  background: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAMAAAB/qqA+AAAABlBMVEUAAAAAAAClZ7nPAAAAAnRSTlMNAMM9s3UAAAAXSURBVHjajcEBAQAAAIKg/H/aCQZ70AUBjAATb6YPDgAAAABJRU5ErkJggg==\") left top repeat;\n}\n.jstree-default > .jstree-wholerow-ul .jstree-hovered,\n.jstree-default > .jstree-wholerow-ul .jstree-clicked {\n  background: transparent;\n  box-shadow: none;\n  border-radius: 0;\n}\n.jstree-default .jstree-wholerow {\n  -moz-box-sizing: border-box;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n.jstree-default .jstree-wholerow-hovered {\n  background: #e7f4f9;\n}\n.jstree-default .jstree-wholerow-clicked {\n  background: #beebff;\n  background: -webkit-linear-gradient(top, #beebff 0%, #a8e4ff 100%);\n  background: linear-gradient(to bottom, #beebff 0%, #a8e4ff 100%);\n}\n.jstree-default .jstree-node {\n  min-height: 24px;\n  line-height: 24px;\n  margin-left: 24px;\n  min-width: 24px;\n}\n.jstree-default .jstree-anchor {\n  line-height: 24px;\n  height: 24px;\n}\n.jstree-default .jstree-icon {\n  width: 24px;\n  height: 24px;\n  line-height: 24px;\n}\n.jstree-default .jstree-icon:empty {\n  width: 24px;\n  height: 24px;\n  line-height: 24px;\n}\n.jstree-default.jstree-rtl .jstree-node {\n  margin-right: 24px;\n}\n.jstree-default .jstree-wholerow {\n  height: 24px;\n}\n.jstree-default .jstree-node,\n.jstree-default .jstree-icon {\n  background-image: url("+i+");\n}\n.jstree-default .jstree-node {\n  background-position: -292px -4px;\n  background-repeat: repeat-y;\n}\n.jstree-default .jstree-last {\n  background: transparent;\n}\n.jstree-default .jstree-open > .jstree-ocl {\n  background-position: -132px -4px;\n}\n.jstree-default .jstree-closed > .jstree-ocl {\n  background-position: -100px -4px;\n}\n.jstree-default .jstree-leaf > .jstree-ocl {\n  background-position: -68px -4px;\n}\n.jstree-default .jstree-themeicon {\n  background-position: -260px -4px;\n}\n.jstree-default > .jstree-no-dots .jstree-node,\n.jstree-default > .jstree-no-dots .jstree-leaf > .jstree-ocl {\n  background: transparent;\n}\n.jstree-default > .jstree-no-dots .jstree-open > .jstree-ocl {\n  background-position: -36px -4px;\n}\n.jstree-default > .jstree-no-dots .jstree-closed > .jstree-ocl {\n  background-position: -4px -4px;\n}\n.jstree-default .jstree-disabled {\n  background: transparent;\n}\n.jstree-default .jstree-disabled.jstree-hovered {\n  background: transparent;\n}\n.jstree-default .jstree-disabled.jstree-clicked {\n  background: #efefef;\n}\n.jstree-default .jstree-checkbox {\n  background-position: -164px -4px;\n}\n.jstree-default .jstree-checkbox:hover {\n  background-position: -164px -36px;\n}\n.jstree-default.jstree-checkbox-selection .jstree-clicked > .jstree-checkbox,\n.jstree-default .jstree-checked > .jstree-checkbox {\n  background-position: -228px -4px;\n}\n.jstree-default.jstree-checkbox-selection .jstree-clicked > .jstree-checkbox:hover,\n.jstree-default .jstree-checked > .jstree-checkbox:hover {\n  background-position: -228px -36px;\n}\n.jstree-default .jstree-anchor > .jstree-undetermined {\n  background-position: -196px -4px;\n}\n.jstree-default .jstree-anchor > .jstree-undetermined:hover {\n  background-position: -196px -36px;\n}\n.jstree-default .jstree-checkbox-disabled {\n  opacity: 0.8;\n  filter: url(\"data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\'><filter id=\\'jstree-grayscale\\'><feColorMatrix type=\\'matrix\\' values=\\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\\'/></filter></svg>#jstree-grayscale\");\n  /* Firefox 10+ */\n  filter: gray;\n  /* IE6-9 */\n  -webkit-filter: grayscale(100%);\n  /* Chrome 19+ & Safari 6+ */\n}\n.jstree-default > .jstree-striped {\n  background-size: auto 48px;\n}\n.jstree-default.jstree-rtl .jstree-node {\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAACAQMAAAB49I5GAAAABlBMVEUAAAAdHRvEkCwcAAAAAXRSTlMAQObYZgAAAAxJREFUCNdjAAMOBgAAGAAJMwQHdQAAAABJRU5ErkJggg==\");\n  background-position: 100% 1px;\n  background-repeat: repeat-y;\n}\n.jstree-default.jstree-rtl .jstree-last {\n  background: transparent;\n}\n.jstree-default.jstree-rtl .jstree-open > .jstree-ocl {\n  background-position: -132px -36px;\n}\n.jstree-default.jstree-rtl .jstree-closed > .jstree-ocl {\n  background-position: -100px -36px;\n}\n.jstree-default.jstree-rtl .jstree-leaf > .jstree-ocl {\n  background-position: -68px -36px;\n}\n.jstree-default.jstree-rtl > .jstree-no-dots .jstree-node,\n.jstree-default.jstree-rtl > .jstree-no-dots .jstree-leaf > .jstree-ocl {\n  background: transparent;\n}\n.jstree-default.jstree-rtl > .jstree-no-dots .jstree-open > .jstree-ocl {\n  background-position: -36px -36px;\n}\n.jstree-default.jstree-rtl > .jstree-no-dots .jstree-closed > .jstree-ocl {\n  background-position: -4px -36px;\n}\n.jstree-default .jstree-themeicon-custom {\n  background-color: transparent;\n  background-image: none;\n  background-position: 0 0;\n}\n.jstree-default > .jstree-container-ul .jstree-loading > .jstree-ocl {\n  background: url("+a+") center center no-repeat;\n}\n.jstree-default .jstree-file {\n  background: url("+i+") -100px -68px no-repeat;\n}\n.jstree-default .jstree-folder {\n  background: url("+i+") -260px -4px no-repeat;\n}\n.jstree-default > .jstree-container-ul > .jstree-node {\n  margin-left: 0;\n  margin-right: 0;\n}\n#jstree-dnd.jstree-default {\n  line-height: 24px;\n  padding: 0 4px;\n}\n#jstree-dnd.jstree-default .jstree-ok,\n#jstree-dnd.jstree-default .jstree-er {\n  background-image: url("+i+');\n  background-repeat: no-repeat;\n  background-color: transparent;\n}\n#jstree-dnd.jstree-default i {\n  background: transparent;\n  width: 24px;\n  height: 24px;\n  line-height: 24px;\n}\n#jstree-dnd.jstree-default .jstree-ok {\n  background-position: -4px -68px;\n}\n#jstree-dnd.jstree-default .jstree-er {\n  background-position: -36px -68px;\n}\n.jstree-default .jstree-ellipsis {\n  overflow: hidden;\n}\n.jstree-default .jstree-ellipsis .jstree-anchor {\n  width: calc(100% - 29px);\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n.jstree-default.jstree-rtl .jstree-node {\n  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAACAQMAAAB49I5GAAAABlBMVEUAAAAdHRvEkCwcAAAAAXRSTlMAQObYZgAAAAxJREFUCNdjAAMOBgAAGAAJMwQHdQAAAABJRU5ErkJggg==");\n}\n.jstree-default.jstree-rtl .jstree-last {\n  background: transparent;\n}\n.jstree-default-small .jstree-node {\n  min-height: 18px;\n  line-height: 18px;\n  margin-left: 18px;\n  min-width: 18px;\n}\n.jstree-default-small .jstree-anchor {\n  line-height: 18px;\n  height: 18px;\n}\n.jstree-default-small .jstree-icon {\n  width: 18px;\n  height: 18px;\n  line-height: 18px;\n}\n.jstree-default-small .jstree-icon:empty {\n  width: 18px;\n  height: 18px;\n  line-height: 18px;\n}\n.jstree-default-small.jstree-rtl .jstree-node {\n  margin-right: 18px;\n}\n.jstree-default-small .jstree-wholerow {\n  height: 18px;\n}\n.jstree-default-small .jstree-node,\n.jstree-default-small .jstree-icon {\n  background-image: url('+i+");\n}\n.jstree-default-small .jstree-node {\n  background-position: -295px -7px;\n  background-repeat: repeat-y;\n}\n.jstree-default-small .jstree-last {\n  background: transparent;\n}\n.jstree-default-small .jstree-open > .jstree-ocl {\n  background-position: -135px -7px;\n}\n.jstree-default-small .jstree-closed > .jstree-ocl {\n  background-position: -103px -7px;\n}\n.jstree-default-small .jstree-leaf > .jstree-ocl {\n  background-position: -71px -7px;\n}\n.jstree-default-small .jstree-themeicon {\n  background-position: -263px -7px;\n}\n.jstree-default-small > .jstree-no-dots .jstree-node,\n.jstree-default-small > .jstree-no-dots .jstree-leaf > .jstree-ocl {\n  background: transparent;\n}\n.jstree-default-small > .jstree-no-dots .jstree-open > .jstree-ocl {\n  background-position: -39px -7px;\n}\n.jstree-default-small > .jstree-no-dots .jstree-closed > .jstree-ocl {\n  background-position: -7px -7px;\n}\n.jstree-default-small .jstree-disabled {\n  background: transparent;\n}\n.jstree-default-small .jstree-disabled.jstree-hovered {\n  background: transparent;\n}\n.jstree-default-small .jstree-disabled.jstree-clicked {\n  background: #efefef;\n}\n.jstree-default-small .jstree-checkbox {\n  background-position: -167px -7px;\n}\n.jstree-default-small .jstree-checkbox:hover {\n  background-position: -167px -39px;\n}\n.jstree-default-small.jstree-checkbox-selection .jstree-clicked > .jstree-checkbox,\n.jstree-default-small .jstree-checked > .jstree-checkbox {\n  background-position: -231px -7px;\n}\n.jstree-default-small.jstree-checkbox-selection .jstree-clicked > .jstree-checkbox:hover,\n.jstree-default-small .jstree-checked > .jstree-checkbox:hover {\n  background-position: -231px -39px;\n}\n.jstree-default-small .jstree-anchor > .jstree-undetermined {\n  background-position: -199px -7px;\n}\n.jstree-default-small .jstree-anchor > .jstree-undetermined:hover {\n  background-position: -199px -39px;\n}\n.jstree-default-small .jstree-checkbox-disabled {\n  opacity: 0.8;\n  filter: url(\"data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\'><filter id=\\'jstree-grayscale\\'><feColorMatrix type=\\'matrix\\' values=\\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\\'/></filter></svg>#jstree-grayscale\");\n  /* Firefox 10+ */\n  filter: gray;\n  /* IE6-9 */\n  -webkit-filter: grayscale(100%);\n  /* Chrome 19+ & Safari 6+ */\n}\n.jstree-default-small > .jstree-striped {\n  background-size: auto 36px;\n}\n.jstree-default-small.jstree-rtl .jstree-node {\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAACAQMAAAB49I5GAAAABlBMVEUAAAAdHRvEkCwcAAAAAXRSTlMAQObYZgAAAAxJREFUCNdjAAMOBgAAGAAJMwQHdQAAAABJRU5ErkJggg==\");\n  background-position: 100% 1px;\n  background-repeat: repeat-y;\n}\n.jstree-default-small.jstree-rtl .jstree-last {\n  background: transparent;\n}\n.jstree-default-small.jstree-rtl .jstree-open > .jstree-ocl {\n  background-position: -135px -39px;\n}\n.jstree-default-small.jstree-rtl .jstree-closed > .jstree-ocl {\n  background-position: -103px -39px;\n}\n.jstree-default-small.jstree-rtl .jstree-leaf > .jstree-ocl {\n  background-position: -71px -39px;\n}\n.jstree-default-small.jstree-rtl > .jstree-no-dots .jstree-node,\n.jstree-default-small.jstree-rtl > .jstree-no-dots .jstree-leaf > .jstree-ocl {\n  background: transparent;\n}\n.jstree-default-small.jstree-rtl > .jstree-no-dots .jstree-open > .jstree-ocl {\n  background-position: -39px -39px;\n}\n.jstree-default-small.jstree-rtl > .jstree-no-dots .jstree-closed > .jstree-ocl {\n  background-position: -7px -39px;\n}\n.jstree-default-small .jstree-themeicon-custom {\n  background-color: transparent;\n  background-image: none;\n  background-position: 0 0;\n}\n.jstree-default-small > .jstree-container-ul .jstree-loading > .jstree-ocl {\n  background: url("+a+") center center no-repeat;\n}\n.jstree-default-small .jstree-file {\n  background: url("+i+") -103px -71px no-repeat;\n}\n.jstree-default-small .jstree-folder {\n  background: url("+i+") -263px -7px no-repeat;\n}\n.jstree-default-small > .jstree-container-ul > .jstree-node {\n  margin-left: 0;\n  margin-right: 0;\n}\n#jstree-dnd.jstree-default-small {\n  line-height: 18px;\n  padding: 0 4px;\n}\n#jstree-dnd.jstree-default-small .jstree-ok,\n#jstree-dnd.jstree-default-small .jstree-er {\n  background-image: url("+i+');\n  background-repeat: no-repeat;\n  background-color: transparent;\n}\n#jstree-dnd.jstree-default-small i {\n  background: transparent;\n  width: 18px;\n  height: 18px;\n  line-height: 18px;\n}\n#jstree-dnd.jstree-default-small .jstree-ok {\n  background-position: -7px -71px;\n}\n#jstree-dnd.jstree-default-small .jstree-er {\n  background-position: -39px -71px;\n}\n.jstree-default-small .jstree-ellipsis {\n  overflow: hidden;\n}\n.jstree-default-small .jstree-ellipsis .jstree-anchor {\n  width: calc(100% - 23px);\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n.jstree-default-small.jstree-rtl .jstree-node {\n  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAACAQMAAABv1h6PAAAABlBMVEUAAAAdHRvEkCwcAAAAAXRSTlMAQObYZgAAAAxJREFUCNdjAAMHBgAAiABBI4gz9AAAAABJRU5ErkJggg==");\n}\n.jstree-default-small.jstree-rtl .jstree-last {\n  background: transparent;\n}\n.jstree-default-large .jstree-node {\n  min-height: 32px;\n  line-height: 32px;\n  margin-left: 32px;\n  min-width: 32px;\n}\n.jstree-default-large .jstree-anchor {\n  line-height: 32px;\n  height: 32px;\n}\n.jstree-default-large .jstree-icon {\n  width: 32px;\n  height: 32px;\n  line-height: 32px;\n}\n.jstree-default-large .jstree-icon:empty {\n  width: 32px;\n  height: 32px;\n  line-height: 32px;\n}\n.jstree-default-large.jstree-rtl .jstree-node {\n  margin-right: 32px;\n}\n.jstree-default-large .jstree-wholerow {\n  height: 32px;\n}\n.jstree-default-large .jstree-node,\n.jstree-default-large .jstree-icon {\n  background-image: url('+i+");\n}\n.jstree-default-large .jstree-node {\n  background-position: -288px 0px;\n  background-repeat: repeat-y;\n}\n.jstree-default-large .jstree-last {\n  background: transparent;\n}\n.jstree-default-large .jstree-open > .jstree-ocl {\n  background-position: -128px 0px;\n}\n.jstree-default-large .jstree-closed > .jstree-ocl {\n  background-position: -96px 0px;\n}\n.jstree-default-large .jstree-leaf > .jstree-ocl {\n  background-position: -64px 0px;\n}\n.jstree-default-large .jstree-themeicon {\n  background-position: -256px 0px;\n}\n.jstree-default-large > .jstree-no-dots .jstree-node,\n.jstree-default-large > .jstree-no-dots .jstree-leaf > .jstree-ocl {\n  background: transparent;\n}\n.jstree-default-large > .jstree-no-dots .jstree-open > .jstree-ocl {\n  background-position: -32px 0px;\n}\n.jstree-default-large > .jstree-no-dots .jstree-closed > .jstree-ocl {\n  background-position: 0px 0px;\n}\n.jstree-default-large .jstree-disabled {\n  background: transparent;\n}\n.jstree-default-large .jstree-disabled.jstree-hovered {\n  background: transparent;\n}\n.jstree-default-large .jstree-disabled.jstree-clicked {\n  background: #efefef;\n}\n.jstree-default-large .jstree-checkbox {\n  background-position: -160px 0px;\n}\n.jstree-default-large .jstree-checkbox:hover {\n  background-position: -160px -32px;\n}\n.jstree-default-large.jstree-checkbox-selection .jstree-clicked > .jstree-checkbox,\n.jstree-default-large .jstree-checked > .jstree-checkbox {\n  background-position: -224px 0px;\n}\n.jstree-default-large.jstree-checkbox-selection .jstree-clicked > .jstree-checkbox:hover,\n.jstree-default-large .jstree-checked > .jstree-checkbox:hover {\n  background-position: -224px -32px;\n}\n.jstree-default-large .jstree-anchor > .jstree-undetermined {\n  background-position: -192px 0px;\n}\n.jstree-default-large .jstree-anchor > .jstree-undetermined:hover {\n  background-position: -192px -32px;\n}\n.jstree-default-large .jstree-checkbox-disabled {\n  opacity: 0.8;\n  filter: url(\"data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\'><filter id=\\'jstree-grayscale\\'><feColorMatrix type=\\'matrix\\' values=\\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\\'/></filter></svg>#jstree-grayscale\");\n  /* Firefox 10+ */\n  filter: gray;\n  /* IE6-9 */\n  -webkit-filter: grayscale(100%);\n  /* Chrome 19+ & Safari 6+ */\n}\n.jstree-default-large > .jstree-striped {\n  background-size: auto 64px;\n}\n.jstree-default-large.jstree-rtl .jstree-node {\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAACAQMAAAB49I5GAAAABlBMVEUAAAAdHRvEkCwcAAAAAXRSTlMAQObYZgAAAAxJREFUCNdjAAMOBgAAGAAJMwQHdQAAAABJRU5ErkJggg==\");\n  background-position: 100% 1px;\n  background-repeat: repeat-y;\n}\n.jstree-default-large.jstree-rtl .jstree-last {\n  background: transparent;\n}\n.jstree-default-large.jstree-rtl .jstree-open > .jstree-ocl {\n  background-position: -128px -32px;\n}\n.jstree-default-large.jstree-rtl .jstree-closed > .jstree-ocl {\n  background-position: -96px -32px;\n}\n.jstree-default-large.jstree-rtl .jstree-leaf > .jstree-ocl {\n  background-position: -64px -32px;\n}\n.jstree-default-large.jstree-rtl > .jstree-no-dots .jstree-node,\n.jstree-default-large.jstree-rtl > .jstree-no-dots .jstree-leaf > .jstree-ocl {\n  background: transparent;\n}\n.jstree-default-large.jstree-rtl > .jstree-no-dots .jstree-open > .jstree-ocl {\n  background-position: -32px -32px;\n}\n.jstree-default-large.jstree-rtl > .jstree-no-dots .jstree-closed > .jstree-ocl {\n  background-position: 0px -32px;\n}\n.jstree-default-large .jstree-themeicon-custom {\n  background-color: transparent;\n  background-image: none;\n  background-position: 0 0;\n}\n.jstree-default-large > .jstree-container-ul .jstree-loading > .jstree-ocl {\n  background: url("+a+") center center no-repeat;\n}\n.jstree-default-large .jstree-file {\n  background: url("+i+") -96px -64px no-repeat;\n}\n.jstree-default-large .jstree-folder {\n  background: url("+i+") -256px 0px no-repeat;\n}\n.jstree-default-large > .jstree-container-ul > .jstree-node {\n  margin-left: 0;\n  margin-right: 0;\n}\n#jstree-dnd.jstree-default-large {\n  line-height: 32px;\n  padding: 0 4px;\n}\n#jstree-dnd.jstree-default-large .jstree-ok,\n#jstree-dnd.jstree-default-large .jstree-er {\n  background-image: url("+i+');\n  background-repeat: no-repeat;\n  background-color: transparent;\n}\n#jstree-dnd.jstree-default-large i {\n  background: transparent;\n  width: 32px;\n  height: 32px;\n  line-height: 32px;\n}\n#jstree-dnd.jstree-default-large .jstree-ok {\n  background-position: 0px -64px;\n}\n#jstree-dnd.jstree-default-large .jstree-er {\n  background-position: -32px -64px;\n}\n.jstree-default-large .jstree-ellipsis {\n  overflow: hidden;\n}\n.jstree-default-large .jstree-ellipsis .jstree-anchor {\n  width: calc(100% - 37px);\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n.jstree-default-large.jstree-rtl .jstree-node {\n  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAACAQMAAAAD0EyKAAAABlBMVEUAAAAdHRvEkCwcAAAAAXRSTlMAQObYZgAAAAxJREFUCNdjgIIGBgABCgCBvVLXcAAAAABJRU5ErkJggg==");\n}\n.jstree-default-large.jstree-rtl .jstree-last {\n  background: transparent;\n}\n@media (max-width: 768px) {\n  #jstree-dnd.jstree-dnd-responsive {\n    line-height: 40px;\n    font-weight: bold;\n    font-size: 1.1em;\n    text-shadow: 1px 1px white;\n  }\n  #jstree-dnd.jstree-dnd-responsive > i {\n    background: transparent;\n    width: 40px;\n    height: 40px;\n  }\n  #jstree-dnd.jstree-dnd-responsive > .jstree-ok {\n    background-image: url('+s+");\n    background-position: 0 -200px;\n    background-size: 120px 240px;\n  }\n  #jstree-dnd.jstree-dnd-responsive > .jstree-er {\n    background-image: url("+s+");\n    background-position: -40px -200px;\n    background-size: 120px 240px;\n  }\n  #jstree-marker.jstree-dnd-responsive {\n    border-left-width: 10px;\n    border-top-width: 10px;\n    border-bottom-width: 10px;\n    margin-top: -10px;\n  }\n}\n@media (max-width: 768px) {\n  .jstree-default-responsive {\n    /*\n\t.jstree-open > .jstree-ocl,\n\t.jstree-closed > .jstree-ocl { border-radius:20px; background-color:white; }\n\t*/\n  }\n  .jstree-default-responsive .jstree-icon {\n    background-image: url("+s+");\n  }\n  .jstree-default-responsive .jstree-node,\n  .jstree-default-responsive .jstree-leaf > .jstree-ocl {\n    background: transparent;\n  }\n  .jstree-default-responsive .jstree-node {\n    min-height: 40px;\n    line-height: 40px;\n    margin-left: 40px;\n    min-width: 40px;\n    white-space: nowrap;\n  }\n  .jstree-default-responsive .jstree-anchor {\n    line-height: 40px;\n    height: 40px;\n  }\n  .jstree-default-responsive .jstree-icon,\n  .jstree-default-responsive .jstree-icon:empty {\n    width: 40px;\n    height: 40px;\n    line-height: 40px;\n  }\n  .jstree-default-responsive > .jstree-container-ul > .jstree-node {\n    margin-left: 0;\n  }\n  .jstree-default-responsive.jstree-rtl .jstree-node {\n    margin-left: 0;\n    margin-right: 40px;\n    background: transparent;\n  }\n  .jstree-default-responsive.jstree-rtl .jstree-container-ul > .jstree-node {\n    margin-right: 0;\n  }\n  .jstree-default-responsive .jstree-ocl,\n  .jstree-default-responsive .jstree-themeicon,\n  .jstree-default-responsive .jstree-checkbox {\n    background-size: 120px 240px;\n  }\n  .jstree-default-responsive .jstree-leaf > .jstree-ocl,\n  .jstree-default-responsive.jstree-rtl .jstree-leaf > .jstree-ocl {\n    background: transparent;\n  }\n  .jstree-default-responsive .jstree-open > .jstree-ocl {\n    background-position: 0 0 !important;\n  }\n  .jstree-default-responsive .jstree-closed > .jstree-ocl {\n    background-position: 0 -40px !important;\n  }\n  .jstree-default-responsive.jstree-rtl .jstree-closed > .jstree-ocl {\n    background-position: -40px 0 !important;\n  }\n  .jstree-default-responsive .jstree-themeicon {\n    background-position: -40px -40px;\n  }\n  .jstree-default-responsive .jstree-checkbox,\n  .jstree-default-responsive .jstree-checkbox:hover {\n    background-position: -40px -80px;\n  }\n  .jstree-default-responsive.jstree-checkbox-selection .jstree-clicked > .jstree-checkbox,\n  .jstree-default-responsive.jstree-checkbox-selection .jstree-clicked > .jstree-checkbox:hover,\n  .jstree-default-responsive .jstree-checked > .jstree-checkbox,\n  .jstree-default-responsive .jstree-checked > .jstree-checkbox:hover {\n    background-position: 0 -80px;\n  }\n  .jstree-default-responsive .jstree-anchor > .jstree-undetermined,\n  .jstree-default-responsive .jstree-anchor > .jstree-undetermined:hover {\n    background-position: 0 -120px;\n  }\n  .jstree-default-responsive .jstree-anchor {\n    font-weight: bold;\n    font-size: 1.1em;\n    text-shadow: 1px 1px white;\n  }\n  .jstree-default-responsive > .jstree-striped {\n    background: transparent;\n  }\n  .jstree-default-responsive .jstree-wholerow {\n    border-top: 1px solid rgba(255, 255, 255, 0.7);\n    border-bottom: 1px solid rgba(64, 64, 64, 0.2);\n    background: #ebebeb;\n    height: 40px;\n  }\n  .jstree-default-responsive .jstree-wholerow-hovered {\n    background: #e7f4f9;\n  }\n  .jstree-default-responsive .jstree-wholerow-clicked {\n    background: #beebff;\n  }\n  .jstree-default-responsive .jstree-children .jstree-last > .jstree-wholerow {\n    box-shadow: inset 0 -6px 3px -5px #666666;\n  }\n  .jstree-default-responsive .jstree-children .jstree-open > .jstree-wholerow {\n    box-shadow: inset 0 6px 3px -5px #666666;\n    border-top: 0;\n  }\n  .jstree-default-responsive .jstree-children .jstree-open + .jstree-open {\n    box-shadow: none;\n  }\n  .jstree-default-responsive .jstree-node,\n  .jstree-default-responsive .jstree-icon,\n  .jstree-default-responsive .jstree-node > .jstree-ocl,\n  .jstree-default-responsive .jstree-themeicon,\n  .jstree-default-responsive .jstree-checkbox {\n    background-image: url("+s+");\n    background-size: 120px 240px;\n  }\n  .jstree-default-responsive .jstree-node {\n    background-position: -80px 0;\n    background-repeat: repeat-y;\n  }\n  .jstree-default-responsive .jstree-last {\n    background: transparent;\n  }\n  .jstree-default-responsive .jstree-leaf > .jstree-ocl {\n    background-position: -40px -120px;\n  }\n  .jstree-default-responsive .jstree-last > .jstree-ocl {\n    background-position: -40px -160px;\n  }\n  .jstree-default-responsive .jstree-themeicon-custom {\n    background-color: transparent;\n    background-image: none;\n    background-position: 0 0;\n  }\n  .jstree-default-responsive .jstree-file {\n    background: url("+s+") 0 -160px no-repeat;\n    background-size: 120px 240px;\n  }\n  .jstree-default-responsive .jstree-folder {\n    background: url("+s+") -40px -40px no-repeat;\n    background-size: 120px 240px;\n  }\n  .jstree-default-responsive > .jstree-container-ul > .jstree-node {\n    margin-left: 0;\n    margin-right: 0;\n  }\n}\n",""])},function(e,t,r){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},function(e,t,r){e.exports=r.p+"24806793015f983316cdcf4ba3eb64da.png"},function(e,t,r){e.exports=r.p+"5e55c38fe2e0190f5aaa9f6bc250e428.gif"},function(e,t,r){e.exports=r.p+"c5a5bf697ebf99eab983e336b4e2057d.png"},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,n=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var i,a=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(i=0===a.indexOf("//")?a:0===a.indexOf("/")?r+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(e,t,r){var n;"undefined"!=typeof window&&(n=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s="./src/hls.js")}({"./node_modules/eventemitter3/index.js":
/*!*********************************************!*\
  !*** ./node_modules/eventemitter3/index.js ***!
  \*********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,i="~";function a(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,r,n,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new s(r,n||e,a),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function u(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(i=!1)),u.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},u.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,a=r.length,s=new Array(a);n<a;n++)s[n]=r[n].fn;return s},u.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},u.prototype.emit=function(e,t,r,n,a,s){var o=i?i+e:e;if(!this._events[o])return!1;var l,u,c=this._events[o],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,n),!0;case 5:return c.fn.call(c.context,t,r,n,a),!0;case 6:return c.fn.call(c.context,t,r,n,a,s),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var h,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,n);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];c[u].fn.apply(c[u].context,l)}}return!0},u.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,r,n){var a=i?i+e:e;if(!this._events[a])return this;if(!t)return l(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||n&&!s.once||r&&s.context!==r||l(this,a);else{for(var o=0,u=[],c=s.length;o<c;o++)(s[o].fn!==t||n&&!s[o].once||r&&s[o].context!==r)&&u.push(s[o]);u.length?this._events[a]=1===u.length?u[0]:u:l(this,a)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&l(this,t)):(this._events=new a,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,e.exports=u},"./node_modules/node-libs-browser/node_modules/events/events.js":
/*!**********************************************************************!*\
  !*** ./node_modules/node-libs-browser/node_modules/events/events.js ***!
  \**********************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,s,o,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(a(r=this._events[e]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(i(r))for(o=Array.prototype.slice.call(arguments,1),s=(u=r.slice()).length,l=0;l<s;l++)u[l].apply(this,o);return!0},r.prototype.addListener=function(e,t){var s;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(s=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},r.prototype.removeListener=function(e,t){var r,a,s,o;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(r=this._events[e]).length,a=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(o=s;o-- >0;)if(r[o]===t||r[o].listener&&r[o].listener===t){a=o;break}if(a<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(a,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},"./node_modules/url-toolkit/src/url-toolkit.js":
/*!*****************************************************!*\
  !*** ./node_modules/url-toolkit/src/url-toolkit.js ***!
  \*****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){var n,i,a,s,o;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=o.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=o.normalizePath(n.path),o.buildURLFromParts(n)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return r.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=i.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=o.normalizePath(d)}else u.path=s.path,a.params||(u.params=s.params,a.query||(u.query=s.query));return null===u.path&&(u.path=r.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o},"./node_modules/webworkify-webpack/index.js":
/*!**************************************************!*\
  !*** ./node_modules/webworkify-webpack/index.js ***!
  \**************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){function n(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var n=r(r.s=ENTRY_MODULE);return n.default||n}var i="[\\.|\\-|\\+|\\w|/|@]+",a="\\((/\\*.*?\\*/)?s?.*?("+i+").*?\\)";function s(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(e,t,n){var o={};o[n]=[];var l=t.toString(),u=l.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!u)return o;for(var c,d=u[1],h=new RegExp("(\\\\n|\\W)"+s(d)+a,"g");c=h.exec(l);)"dll-reference"!==c[3]&&o[n].push(c[3]);for(h=new RegExp("\\("+s(d)+'\\("(dll-reference\\s('+i+'))"\\)\\)'+a,"g");c=h.exec(l);)e[c[2]]||(o[n].push(c[1]),e[c[2]]=r(c[1]).m),o[c[2]]=o[c[2]]||[],o[c[2]].push(c[4]);for(var f,p=Object.keys(o),g=0;g<p.length;g++)for(var m=0;m<o[p[g]].length;m++)f=o[p[g]][m],isNaN(1*f)||(o[p[g]][m]=1*o[p[g]][m]);return o}function l(e){return Object.keys(e).reduce(function(t,r){return t||e[r].length>0},!1)}e.exports=function(e,t){t=t||{};var i={main:r.m},a=t.all?{main:Object.keys(i.main)}:function(e,t){for(var r={main:[t]},n={main:[]},i={main:{}};l(r);)for(var a=Object.keys(r),s=0;s<a.length;s++){var u=a[s],c=r[u].pop();if(i[u]=i[u]||{},!i[u][c]&&e[u][c]){i[u][c]=!0,n[u]=n[u]||[],n[u].push(c);for(var d=o(e,e[u][c],u),h=Object.keys(d),f=0;f<h.length;f++)r[h[f]]=r[h[f]]||[],r[h[f]]=r[h[f]].concat(d[h[f]])}}return n}(i,e),s="";Object.keys(a).filter(function(e){return"main"!==e}).forEach(function(e){for(var t=0;a[e][t];)t++;a[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",s=s+"var "+e+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a[e].map(function(t){return JSON.stringify(t)+": "+i[e][t].toString()}).join(",")+"});\n"}),s=s+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a.main.map(function(e){return JSON.stringify(e)+": "+i.main[e].toString()}).join(",")+"}))(self);";var u=new window.Blob([s],{type:"text/javascript"});if(t.bare)return u;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),d=new window.Worker(c);return d.objectURL=c,d}},"./src/config.js":
/*!***********************!*\
  !*** ./src/config.js ***!
  \***********************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./controller/abr-controller */"./src/controller/abr-controller.js"),i=r(/*! ./controller/buffer-controller */"./src/controller/buffer-controller.js"),a=r(/*! ./controller/cap-level-controller */"./src/controller/cap-level-controller.js"),s=r(/*! ./controller/fps-controller */"./src/controller/fps-controller.js"),o=r(/*! ./utils/xhr-loader */"./src/utils/xhr-loader.js"),l=r(/*! ./controller/audio-track-controller */"./src/controller/audio-track-controller.js"),u=r(/*! ./controller/audio-stream-controller */"./src/controller/audio-stream-controller.js"),c=r(/*! ./utils/cues */"./src/utils/cues.js"),d=r(/*! ./controller/timeline-controller */"./src/controller/timeline-controller.js"),h=r(/*! ./controller/subtitle-track-controller */"./src/controller/subtitle-track-controller.js"),f=r(/*! ./controller/subtitle-stream-controller */"./src/controller/subtitle-stream-controller.js"),p=r(/*! ./controller/eme-controller */"./src/controller/eme-controller.js"),g=r(/*! ./utils/mediakeys-helper */"./src/utils/mediakeys-helper.js");t.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:o.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:n.default,bufferController:i.default,capLevelController:a.default,fpsController:s.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:g.requestMediaKeySystemAccess},t.hlsDefaultConfig.subtitleStreamController=f.SubtitleStreamController,t.hlsDefaultConfig.subtitleTrackController=h.default,t.hlsDefaultConfig.timelineController=d.default,t.hlsDefaultConfig.cueHandler=c,t.hlsDefaultConfig.enableCEA708Captions=!0,t.hlsDefaultConfig.enableWebVTT=!0,t.hlsDefaultConfig.captionsTextTrack1Label="English",t.hlsDefaultConfig.captionsTextTrack1LanguageCode="en",t.hlsDefaultConfig.captionsTextTrack2Label="Spanish",t.hlsDefaultConfig.captionsTextTrack2LanguageCode="es",t.hlsDefaultConfig.audioStreamController=u.default,t.hlsDefaultConfig.audioTrackController=l.default,t.hlsDefaultConfig.emeController=p.default},"./src/controller/abr-controller.js":
/*!******************************************!*\
  !*** ./src/controller/abr-controller.js ***!
  \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=r(/*! ../event-handler */"./src/event-handler.js"),o=r(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.js"),l=r(/*! ../errors */"./src/errors.js"),u=r(/*! ../utils/logger */"./src/utils/logger.js"),c=r(/*! ../utils/ewma-bandwidth-estimator */"./src/utils/ewma-bandwidth-estimator.js"),d=window.performance,h=function(t){function r(e){var r=t.call(this,e,a.default.FRAG_LOADING,a.default.FRAG_LOADED,a.default.FRAG_BUFFERED,a.default.ERROR)||this;return r.lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=e,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(r),r}return i(r,t),r.prototype.destroy=function(){this.clearTimer(),s.default.prototype.destroy.call(this)},r.prototype.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r=this.hls,n=r.config,i=t.level,a=void 0,s=void 0;r.levels[i].details.live?(a=n.abrEwmaFastLive,s=n.abrEwmaSlowLive):(a=n.abrEwmaFastVoD,s=n.abrEwmaSlowVoD),this._bwEstimator=new c.default(r,s,a,n.abrEwmaDefaultEstimate)}},r.prototype._abandonRulesCheck=function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(r){var n=r.loader,i=e.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return u.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var s=n.stats;if(t&&s&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var l=d.now()-s.trequest,c=Math.abs(t.playbackRate);if(l>500*r.duration/c){var h=e.levels,f=Math.max(1,s.bw?s.bw/8:1e3*s.loaded/l),p=h[r.level],g=p.realBitrate?Math.max(p.realBitrate,p.bitrate):p.bitrate,m=s.total?s.total:Math.max(s.loaded,Math.round(r.duration*g/8)),v=t.currentTime,_=(m-s.loaded)/f,y=(o.BufferHelper.bufferInfo(t,v,e.config.maxBufferHole).end-v)/c;if(y<2*r.duration/c&&_>y){var b=void 0,w=void 0;for(w=r.level-1;w>i;w--){var S=h[w].realBitrate?Math.max(h[w].realBitrate,h[w].bitrate):h[w].bitrate;if((b=r.duration*S/(6.4*f))<y)break}b<_&&(u.logger.warn("loading too slow, abort fragment loading and switch to level "+w+":fragLoadedDelay["+w+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+b.toFixed(1)+"<"+_.toFixed(1)+":"+y.toFixed(1)),e.nextLoadLevel=w,this._bwEstimator.sample(l,s.loaded),n.abort(),this.clearTimer(),e.trigger(a.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:s}))}}}}},r.prototype.onFragLoaded=function(t){var r=t.frag;if("main"===r.type&&e.isFinite(r.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=r.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var n=this.hls.levels[r.level],i=(n.loaded?n.loaded.bytes:0)+t.stats.loaded,a=(n.loaded?n.loaded.duration:0)+t.frag.duration;n.loaded={bytes:i,duration:a},n.realBitrate=Math.round(8*i/a)}if(t.frag.bitrateTest){var s=t.stats;s.tparsed=s.tbuffered=s.tload,this.onFragBuffered(t)}}},r.prototype.onFragBuffered=function(t){var r=t.stats,n=t.frag;if(!0!==r.aborted&&"main"===n.type&&e.isFinite(n.sn)&&(!n.bitrateTest||r.tload===r.tbuffered)){var i=r.tparsed-r.trequest;u.logger.log("latency/loading/parsing/append/kbps:"+Math.round(r.tfirst-r.trequest)+"/"+Math.round(r.tload-r.tfirst)+"/"+Math.round(r.tparsed-r.tload)+"/"+Math.round(r.tbuffered-r.tparsed)+"/"+Math.round(8*r.loaded/(r.tbuffered-r.trequest))),this._bwEstimator.sample(i,r.loaded),r.bwEstimate=this._bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}},r.prototype.onError=function(e){switch(e.details){case l.ErrorDetails.FRAG_LOAD_ERROR:case l.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},r.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},Object.defineProperty(r.prototype,"nextAutoLevel",{get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_nextABRAutoLevel",{get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,n=e.config,i=e.minAutoLevel,a=e.media,s=this.lastLoadedFragLevel,l=this.fragCurrent?this.fragCurrent.duration:0,c=a?a.currentTime:0,d=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,h=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,f=(o.BufferHelper.bufferInfo(a,c,n.maxBufferHole).end-c)/d,p=this._findBestLevel(s,l,h,i,t,f,n.abrBandWidthFactor,n.abrBandWidthUpFactor,r);if(p>=0)return p;u.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var g=l?Math.min(l,n.maxStarvationDelay):n.maxStarvationDelay,m=n.abrBandWidthFactor,v=n.abrBandWidthUpFactor;if(0===f){var _=this.bitrateTestDelay;if(_)g=(l?Math.min(l,n.maxLoadingDelay):n.maxLoadingDelay)-_,u.logger.trace("bitrate test took "+Math.round(1e3*_)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*g)+" ms"),m=v=1}return p=this._findBestLevel(s,l,h,i,t,f+g,m,v,r),Math.max(p,0)},enumerable:!0,configurable:!0}),r.prototype._findBestLevel=function(e,t,r,n,i,a,s,o,l){for(var c=i;c>=n;c--){var d=l[c];if(d){var h=d.details,f=h?h.totalduration/h.fragments.length:t,p=!!h&&h.live,g=void 0;g=c<=e?s*r:o*r;var m=l[c].realBitrate?Math.max(l[c].realBitrate,l[c].bitrate):l[c].bitrate,v=m*f/g;if(u.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+c+"/"+Math.round(g)+"/"+m+"/"+f+"/"+a+"/"+v),g>m&&(!v||p&&!this.bitrateTestDelay||v<a))return c}}return-1},r}(s.default);t.default=h}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/controller/audio-stream-controller.js":
/*!***************************************************!*\
  !*** ./src/controller/audio-stream-controller.js ***!
  \***************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../utils/binary-search */"./src/utils/binary-search.js"),s=r(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.js"),o=r(/*! ../demux/demuxer */"./src/demux/demuxer.js"),l=r(/*! ../events */"./src/events.js"),u=r(/*! ./level-helper */"./src/controller/level-helper.js"),c=r(/*! ../utils/time-ranges */"./src/utils/time-ranges.js"),d=r(/*! ../errors */"./src/errors.js"),h=r(/*! ../utils/logger */"./src/utils/logger.js"),f=r(/*! ../utils/discontinuities */"./src/utils/discontinuities.js"),p=r(/*! ./fragment-tracker */"./src/controller/fragment-tracker.js"),g=r(/*! ../loader/fragment */"./src/loader/fragment.js"),m=r(/*! ./base-stream-controller */"./src/controller/base-stream-controller.js"),v=window.performance,_=function(t){function r(e,r){var n=t.call(this,e,l.default.MEDIA_ATTACHED,l.default.MEDIA_DETACHING,l.default.AUDIO_TRACKS_UPDATED,l.default.AUDIO_TRACK_SWITCHING,l.default.AUDIO_TRACK_LOADED,l.default.KEY_LOADED,l.default.FRAG_LOADED,l.default.FRAG_PARSING_INIT_SEGMENT,l.default.FRAG_PARSING_DATA,l.default.FRAG_PARSED,l.default.ERROR,l.default.BUFFER_RESET,l.default.BUFFER_CREATED,l.default.BUFFER_APPENDED,l.default.BUFFER_FLUSHED,l.default.INIT_PTS_FOUND)||this;return n.fragmentTracker=r,n.config=e.config,n.audioCodecSwap=!1,n._state=m.State.STOPPED,n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n}return i(r,t),r.prototype.onInitPtsFound=function(e){var t=e.id,r=e.frag.cc,n=e.initPTS;"main"===t&&(this.initPTS[r]=n,this.videoTrackCC=r,h.logger.log("InitPTS for cc: "+r+" found from video track: "+n),this.state===m.State.WAITING_INIT_PTS&&this.tick())},r.prototype.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(h.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=m.State.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=m.State.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=m.State.STOPPED},Object.defineProperty(r.prototype,"state",{get:function(){return this._state},set:function(e){if(this.state!==e){var t=this.state;this._state=e,h.logger.log("audio stream:"+t+"->"+e)}},enumerable:!0,configurable:!0}),r.prototype.doTick=function(){var t,r,n,i=this.hls,o=i.config;switch(this.state){case m.State.ERROR:case m.State.PAUSED:case m.State.BUFFER_FLUSHING:break;case m.State.STARTING:this.state=m.State.WAITING_TRACK,this.loadedmetadata=!1;break;case m.State.IDLE:var u=this.tracks;if(!u)break;if(!this.media&&(this.startFragRequested||!o.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(void 0===(t=this.nextLoadPosition))break;var c=this.mediaBuffer?this.mediaBuffer:this.media,d=this.videoBuffer?this.videoBuffer:this.media,g=s.BufferHelper.bufferInfo(c,t,o.maxBufferHole),_=s.BufferHelper.bufferInfo(d,t,o.maxBufferHole),y=g.len,b=g.end,w=this.fragPrevious,S=Math.min(o.maxBufferLength,o.maxMaxBufferLength),E=Math.max(S,_.len),x=this.audioSwitch,T=this.trackId;if((y<E||x)&&T<u.length){if(void 0===(n=u[T].details)){this.state=m.State.WAITING_TRACK;break}if(!x&&this._streamEnded(g,n))return this.hls.trigger(l.default.BUFFER_EOS,{type:"audio"}),void(this.state=m.State.ENDED);var k=n.fragments,A=k.length,C=k[0].start,j=k[A-1].start+k[A-1].duration,D=void 0;if(x)if(n.live&&!n.PTSKnown)h.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),b=0;else if(b=t,n.PTSKnown&&t<C){if(!(g.end>C||g.nextStart))return;h.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=C+.05}if(n.initSegment&&!n.initSegment.data)D=n.initSegment;else if(b<=C){if(D=k[0],null!==this.videoTrackCC&&D.cc!==this.videoTrackCC&&(D=f.findFragWithCC(k,this.videoTrackCC)),n.live&&D.loadIdx&&D.loadIdx===this.fragLoadIdx){var R=g.nextStart?g.nextStart:C;return h.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(R+.05)),void(this.media.currentTime=R+.05)}}else{var L=void 0,I=o.maxFragLookUpTolerance,O=w?k[w.sn-k[0].sn+1]:void 0,P=function(e){var t=Math.min(I,e.duration);return e.start+e.duration-t<=b?1:e.start-t>b&&e.start?-1:0};b<j?(b>j-I&&(I=0),L=O&&!P(O)?O:a.default.search(k,P)):L=k[A-1],L&&(D=L,C=L.start,w&&D.level===w.level&&D.sn===w.sn&&(D.sn<n.endSN?(D=k[D.sn+1-n.startSN],h.logger.log("SN just loaded, load next one: "+D.sn)):D=null))}D&&(D.encrypted?(h.logger.log("Loading key for "+D.sn+" of ["+n.startSN+" ,"+n.endSN+"],track "+T),this.state=m.State.KEY_LOADING,i.trigger(l.default.KEY_LOADING,{frag:D})):(h.logger.log("Loading "+D.sn+", cc: "+D.cc+" of ["+n.startSN+" ,"+n.endSN+"],track "+T+", currentTime:"+t+",bufferEnd:"+b.toFixed(3)),this.fragCurrent=D,(x||this.fragmentTracker.getState(D)===p.FragmentState.NOT_LOADED)&&(this.startFragRequested=!0,e.isFinite(D.sn)&&(this.nextLoadPosition=D.start+D.duration),i.trigger(l.default.FRAG_LOADING,{frag:D}),this.state=m.State.FRAG_LOADING)))}break;case m.State.WAITING_TRACK:(r=this.tracks[this.trackId])&&r.details&&(this.state=m.State.IDLE);break;case m.State.FRAG_LOADING_WAITING_RETRY:var M=v.now(),N=this.retryDate,F=(c=this.media)&&c.seeking;(!N||M>=N||F)&&(h.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=m.State.IDLE);break;case m.State.WAITING_INIT_PTS:var B=this.videoTrackCC;if(void 0===this.initPTS[B])break;var U=this.waitingFragment;if(U){var G=U.frag.cc;B!==G?(r=this.tracks[this.trackId]).details&&r.details.live&&(h.logger.warn("Waiting fragment CC ("+G+") does not match video track CC ("+B+")"),this.waitingFragment=null,this.state=m.State.IDLE):(this.state=m.State.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=m.State.IDLE;break;case m.State.STOPPED:case m.State.FRAG_LOADING:case m.State.PARSING:case m.State.PARSED:case m.State.ENDED:}},r.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},r.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(h.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},r.prototype.onAudioTracksUpdated=function(e){h.logger.log("audio tracks updated"),this.tracks=e.audioTracks},r.prototype.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=m.State.PAUSED,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=m.State.IDLE),this.tick()},r.prototype.onAudioTrackLoaded=function(t){var r=t.details,n=t.id,i=this.tracks[n],a=r.totalduration,s=0;if(h.logger.log("track "+n+" loaded ["+r.startSN+","+r.endSN+"],duration:"+a),r.live){var o=i.details;o&&r.fragments.length>0?(u.mergeDetails(o,r),s=r.fragments[0].start,r.PTSKnown?h.logger.log("live audio playlist sliding:"+s.toFixed(3)):h.logger.log("live audio playlist - outdated PTS, unknown sliding")):(r.PTSKnown=!1,h.logger.log("live audio playlist - first load, unknown sliding"))}else r.PTSKnown=!1;if(i.details=r,!this.startFragRequested){if(-1===this.startPosition){var l=r.startTimeOffset;e.isFinite(l)?(h.logger.log("start time offset found in playlist, adjust startPosition to "+l),this.startPosition=l):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===m.State.WAITING_TRACK&&(this.state=m.State.IDLE),this.tick()},r.prototype.onKeyLoaded=function(){this.state===m.State.KEY_LOADING&&(this.state=m.State.IDLE,this.tick())},r.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag;if(this.state===m.State.FRAG_LOADING&&t&&"audio"===r.type&&r.level===t.level&&r.sn===t.sn){var n=this.tracks[this.trackId],i=n.details,a=i.totalduration,s=t.level,u=t.sn,c=t.cc,d=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",f=this.stats=e.stats;if("initSegment"===u)this.state=m.State.IDLE,f.tparsed=f.tbuffered=v.now(),i.initSegment.data=e.payload,this.hls.trigger(l.default.FRAG_BUFFERED,{stats:f,frag:t,id:"audio"}),this.tick();else{this.state=m.State.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new o.default(this.hls,"audio"));var p=this.initPTS[c],g=i.initSegment?i.initSegment.data:[];if(i.initSegment||void 0!==p){this.pendingBuffering=!0,h.logger.log("Demuxing "+u+" of ["+i.startSN+" ,"+i.endSN+"],track "+s);this.demuxer.push(e.payload,g,d,null,t,a,!1,p)}else h.logger.log("unknown video PTS for continuity counter "+c+", waiting for video PTS before demuxing audio frag "+u+" of ["+i.startSN+" ,"+i.endSN+"],track "+s),this.waitingFragment=e,this.state=m.State.WAITING_INIT_PTS}}this.fragLoadError=0},r.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===m.State.PARSING){var n=e.tracks,i=void 0;if(n.video&&delete n.video,i=n.audio){i.levelCodec=i.codec,i.id=e.id,this.hls.trigger(l.default.BUFFER_CODECS,n),h.logger.log("audio track:audio,container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var a=i.initSegment;if(a){var s={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(l.default.BUFFER_APPENDING,s))}this.tick()}}},r.prototype.onFragParsingData=function(t){var r=this,n=this.fragCurrent,i=t.frag;if(n&&"audio"===t.id&&"audio"===t.type&&i.sn===n.sn&&i.level===n.level&&this.state===m.State.PARSING){var a=this.trackId,s=this.tracks[a],o=this.hls;e.isFinite(t.endPTS)||(t.endPTS=t.startPTS+n.duration,t.endDTS=t.startDTS+n.duration),n.addElementaryStream(g.default.ElementaryStreamTypes.AUDIO),h.logger.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),u.updateFragPTSDTS(s.details,n,t.startPTS,t.endPTS);var c=this.audioSwitch,f=this.media,p=!1;if(c&&f)if(f.readyState){var v=f.currentTime;h.logger.log("switching audio track : currentTime:"+v),v>=t.startPTS&&(h.logger.log("switching audio track : flushing all audio"),this.state=m.State.BUFFER_FLUSHING,o.trigger(l.default.BUFFER_FLUSHING,{startOffset:0,endOffset:e.POSITIVE_INFINITY,type:"audio"}),p=!0,this.audioSwitch=!1,o.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:a}))}else this.audioSwitch=!1,o.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:a});var _=this.pendingData;if(!_)return h.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void o.trigger(l.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&_.push({type:t.type,data:e,parent:"audio",content:"data"})}),!p&&_.length&&(_.forEach(function(e){r.state===m.State.PARSING&&(r.pendingBuffering=!0,r.hls.trigger(l.default.BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}},r.prototype.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===m.State.PARSING&&(this.stats.tparsed=v.now(),this.state=m.State.PARSED,this._checkAppendedParsed())},r.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},r.prototype.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},r.prototype.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==m.State.PARSING&&t!==m.State.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},r.prototype._checkAppendedParsed=function(){if(!(this.state!==m.State.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,r=this.hls;if(e){this.fragPrevious=e,t.tbuffered=v.now(),r.trigger(l.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;h.logger.log("audio buffered : "+c.default.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=m.State.IDLE}this.tick()}},r.prototype.onError=function(t){var r=t.frag;if(!r||"audio"===r.type)switch(t.details){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:var n=t.frag;if(n&&"audio"!==n.type)break;if(!t.fatal){var i=this.fragLoadError;if(i?i++:i=1,i<=(o=this.config).fragLoadingMaxRetry){this.fragLoadError=i;var a=Math.min(Math.pow(2,i-1)*o.fragLoadingRetryDelay,o.fragLoadingMaxRetryTimeout);h.logger.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=v.now()+a,this.state=m.State.FRAG_LOADING_WAITING_RETRY}else h.logger.error("AudioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=m.State.ERROR}break;case d.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case d.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case d.ErrorDetails.KEY_LOAD_ERROR:case d.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==m.State.ERROR&&(this.state=t.fatal?m.State.ERROR:m.State.IDLE,h.logger.warn("AudioStreamController: "+t.details+" while loading frag, now switching to "+this.state+" state ..."));break;case d.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===t.parent&&(this.state===m.State.PARSING||this.state===m.State.PARSED)){var o,u=this.mediaBuffer,c=this.media.currentTime;if(u&&s.BufferHelper.isBuffered(u,c)&&s.BufferHelper.isBuffered(u,c+.5))(o=this.config).maxMaxBufferLength>=o.maxBufferLength&&(o.maxMaxBufferLength/=2,h.logger.warn("AudioStreamController: reduce max buffer length to "+o.maxMaxBufferLength+"s")),this.state=m.State.IDLE;else h.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=m.State.BUFFER_FLUSHING,this.hls.trigger(l.default.BUFFER_FLUSHING,{startOffset:0,endOffset:e.POSITIVE_INFINITY,type:"audio"})}}},r.prototype.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(h.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),t.forEach(function(t){e.hls.trigger(l.default.BUFFER_APPENDING,t)}),this.appended=!0,this.pendingData=[],this.state=m.State.PARSED):(this.state=m.State.IDLE,this.fragPrevious=null,this.tick())},r}(m.default);t.default=_}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/controller/audio-track-controller.js":
/*!**************************************************!*\
  !*** ./src/controller/audio-track-controller.js ***!
  \**************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=r(/*! ../task-loop */"./src/task-loop.js"),o=r(/*! ../utils/logger */"./src/utils/logger.js"),l=r(/*! ../errors */"./src/errors.js"),u=function(e){function t(t){var r=e.call(this,t,a.default.MANIFEST_LOADING,a.default.MANIFEST_PARSED,a.default.AUDIO_TRACK_LOADED,a.default.AUDIO_TRACK_SWITCHED,a.default.LEVEL_LOADED,a.default.ERROR)||this;return r._trackId=-1,r._selectDefaultTrack=!0,r.tracks=[],r.trackIdBlacklist=Object.create(null),r.audioGroupId=null,r}return i(t,e),t.prototype.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},t.prototype.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(a.default.AUDIO_TRACKS_UPDATED,{audioTracks:t})},t.prototype.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)o.logger.warn("Invalid audio track id:",e.id);else{if(o.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},t.prototype.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},t.prototype.onLevelLoaded=function(e){var t=this.hls.levels[e.level];if(t.audioGroupIds){var r=t.audioGroupIds[t.urlId];this.audioGroupId!==r&&(this.audioGroupId=r,this._selectInitialAudioTrack())}},t.prototype.onError=function(e){e.type===l.ErrorTypes.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===l.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(o.logger.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},Object.defineProperty(t.prototype,"audioTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTrack",{get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1},enumerable:!0,configurable:!0}),t.prototype._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)o.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)o.logger.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];o.logger.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var r=t.url,n=t.type,i=t.id;this.hls.trigger(a.default.AUDIO_TRACK_SWITCHING,{id:i,type:n,url:r}),this._loadTrackDetailsIfNeeded(t)}},t.prototype.doTick=function(){this._updateTrack(this._trackId)},t.prototype._selectInitialAudioTrack=function(){var e=this,t=this.tracks;if(t.length){var r=this.tracks[this._trackId],n=null;if(r&&(n=r.name),this._selectDefaultTrack){var i=t.filter(function(e){return e.default});i.length?t=i:o.logger.warn("No default audio tracks defined")}var s=!1,u=function(){t.forEach(function(t){s||e.audioGroupId&&t.groupId!==e.audioGroupId||n&&n!==t.name||(e._setAudioTrack(t.id),s=!0)})};u(),s||(n=null,u()),s||(o.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},t.prototype._needsTrackLoading=function(e){var t=e.details,r=e.url;return!(t&&!t.live)&&!!r},t.prototype._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,r=e.id;o.logger.log("loading audio-track playlist for id: "+r),this.hls.trigger(a.default.AUDIO_TRACK_LOADING,{url:t,id:r})}},t.prototype._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,o.logger.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},t.prototype._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],r=t.name,n=t.language,i=t.groupId;o.logger.warn("Loading failed on audio track id: "+e+", group-id: "+i+', name/language: "'+r+'" / "'+n+'"');for(var a=e,s=0;s<this.tracks.length;s++){if(!this.trackIdBlacklist[s])if(this.tracks[s].name===r){a=s;break}}a!==e?(o.logger.log("Attempting audio-track fallback id:",a,"group-id:",this.tracks[a].groupId),this._setAudioTrack(a)):o.logger.warn('No fallback audio-track found for name/language: "'+r+'" / "'+n+'"')},t}(s.default);t.default=u},"./src/controller/base-stream-controller.js":
/*!**************************************************!*\
  !*** ./src/controller/base-stream-controller.js ***!
  \**************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../task-loop */"./src/task-loop.js"),s=r(/*! ./fragment-tracker */"./src/controller/fragment-tracker.js"),o=r(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.js"),l=r(/*! ../utils/logger */"./src/utils/logger.js");t.State={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};var u=function(r){function n(){return null!==r&&r.apply(this,arguments)||this}return i(n,r),n.prototype.doTick=function(){},n.prototype.startLoad=function(){},n.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=t.State.STOPPED},n.prototype._streamEnded=function(e,t){var r=this.fragCurrent,n=this.fragmentTracker;if(!t.live&&r&&!r.backtracked&&r.sn===t.endSN&&!e.nextStart){var i=n.getState(r);return i===s.FragmentState.PARTIAL||i===s.FragmentState.OK}return!1},n.prototype.onMediaSeeking=function(){var r=this.config,n=this.media,i=this.mediaBuffer,a=this.state,s=n?n.currentTime:null,u=o.BufferHelper.bufferInfo(i||n,s,this.config.maxBufferHole);if(e.isFinite(s)&&l.logger.log("media seeking to "+s.toFixed(3)),a===t.State.FRAG_LOADING){var c=this.fragCurrent;if(0===u.len&&c){var d=r.maxFragLookUpTolerance,h=c.start-d,f=c.start+c.duration+d;s<h||s>f?(c.loader&&(l.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),c.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=t.State.IDLE):l.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else a===t.State.ENDED&&(0===u.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=t.State.IDLE);n&&(this.lastCurrentTime=s),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=s),this.tick()},n.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},n.prototype.onHandlerDestroying=function(){this.stopLoad(),r.prototype.onHandlerDestroying.call(this)},n.prototype.onHandlerDestroyed=function(){this.state=t.State.STOPPED,this.fragmentTracker=null},n}(a.default);t.default=u}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/controller/buffer-controller.js":
/*!*********************************************!*\
  !*** ./src/controller/buffer-controller.js ***!
  \*********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=r(/*! ../event-handler */"./src/event-handler.js"),o=r(/*! ../utils/logger */"./src/utils/logger.js"),l=r(/*! ../errors */"./src/errors.js"),u=r(/*! ../utils/mediasource-helper */"./src/utils/mediasource-helper.js").getMediaSource(),c=function(t){function r(e){var r=t.call(this,e,a.default.MEDIA_ATTACHING,a.default.MEDIA_DETACHING,a.default.MANIFEST_PARSED,a.default.BUFFER_RESET,a.default.BUFFER_APPENDING,a.default.BUFFER_CODECS,a.default.BUFFER_EOS,a.default.BUFFER_FLUSHING,a.default.LEVEL_PTS_UPDATED,a.default.LEVEL_UPDATED)||this;return r._msDuration=null,r._levelDuration=null,r._levelTargetDuration=10,r._live=null,r._objectUrl=null,r.bufferCodecEventsExpected=0,r.onsbue=r.onSBUpdateEnd.bind(r),r.onsbe=r.onSBUpdateError.bind(r),r.pendingTracks={},r.tracks={},r}return i(r,t),r.prototype.destroy=function(){s.default.prototype.destroy.call(this)},r.prototype.onLevelPtsUpdated=function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var n=this.sourceBuffer.audio;if(Math.abs(n.timestampOffset-e.start)>.1){var i=n.updating;try{n.abort()}catch(e){o.logger.warn("can not abort audio buffer: "+e)}i?this.audioTimestampOffset=e.start:(o.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}},r.prototype.onManifestParsed=function(e){this.bufferCodecEventsExpected=e.altAudio?2:1,o.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},r.prototype.onMediaAttaching=function(e){var t=this.media=e.media;if(t){var r=this.mediaSource=new u;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),t.src=window.URL.createObjectURL(r),this._objectUrl=t.src}},r.prototype.onMediaDetaching=function(){o.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){o.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):o.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(a.default.MEDIA_DETACHED)},r.prototype.onMediaSourceOpen=function(){o.logger.log("media source opened"),this.hls.trigger(a.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},r.prototype.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,r=Object.keys(t).length;(r&&!e||2===r)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},r.prototype.onMediaSourceClose=function(){o.logger.log("media source closed")},r.prototype.onMediaSourceEnded=function(){o.logger.log("media source ended")},r.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;o.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,r=this.segments.reduce(function(e,r){return r.parent===t?e+1:e},0),n={},i=this.sourceBuffer;for(var s in i)n[s]=i[s].buffered;this.hls.trigger(a.default.BUFFER_APPENDED,{parent:t,pending:r,timeRanges:n}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration(),0===r&&this.flushLiveBackBuffer()},r.prototype.onSBUpdateError=function(e){o.logger.error("sourceBuffer error:",e),this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},r.prototype.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},r.prototype.onBufferCodecs=function(e){var t=this;if(!Object.keys(this.sourceBuffer).length){Object.keys(e).forEach(function(r){t.pendingTracks[r]=e[r]});var r=this.mediaSource;this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),r&&"open"===r.readyState&&this.checkPendingTracks()}},r.prototype.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;for(var n in e)if(!t[n]){var i=e[n],s=i.levelCodec||i.codec,u=i.container+";codecs="+s;o.logger.log("creating sourceBuffer("+u+")");try{var c=t[n]=r.addSourceBuffer(u);c.addEventListener("updateend",this.onsbue),c.addEventListener("error",this.onsbe),this.tracks[n]={codec:s,container:i.container},i.buffer=c}catch(e){o.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:u})}}this.hls.trigger(a.default.BUFFER_CREATED,{tracks:e})},r.prototype.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},r.prototype.onBufferAppendFail=function(e){o.logger.error("sourceBuffer error:",e.event),this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},r.prototype.onBufferEos=function(e){var t=this.sourceBuffer,r=e.type;for(var n in t)r&&n!==r||t[n].ended||(t[n].ended=!0,o.logger.log(n+" sourceBuffer now EOS"));this.checkEos()},r.prototype.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var n=e[r];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}o.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){o.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},r.prototype.onBufferFlushing=function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()},r.prototype.flushLiveBackBuffer=function(){if(this._live){var e=this.hls.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))for(var t=this.media.currentTime,r=this.sourceBuffer,n=Object.keys(r),i=t-Math.max(e,this._levelTargetDuration),a=n.length-1;a>=0;a--){var s=n[a],o=r[s].buffered;o.length>0&&i>o.start(0)&&this.removeBufferRange(s,r[s],0,i)}}},r.prototype.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},r.prototype.updateMediaElementDuration=function(){var t,r=this.hls.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var n in this.sourceBuffer)if(!0===this.sourceBuffer[n].updating)return;t=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===r.liveDurationInfinity?(o.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>t||!e.isFinite(t))&&(o.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},r.prototype.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var n in r)t+=r[n].buffered.length}catch(e){o.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(a.default.BUFFER_FLUSHED)}},r.prototype.doAppending=function(){var e=this.hls,t=this.segments,r=this.sourceBuffer;if(Object.keys(r).length){if(this.media.error)return this.segments=[],void o.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(t&&t.length){var n=t.shift();try{var i=r[n.type];i?i.updating?t.unshift(n):(i.ended=!1,this.parent=n.parent,i.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(r){o.logger.error("error while trying to append buffer:"+r.message),t.unshift(n);var s={type:l.ErrorTypes.MEDIA_ERROR,parent:n.parent};22!==r.code?(this.appendError?this.appendError++:this.appendError=1,s.details=l.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry?(o.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],s.fatal=!0,e.trigger(a.default.ERROR,s)):(s.fatal=!1,e.trigger(a.default.ERROR,s))):(this.segments=[],s.details=l.ErrorDetails.BUFFER_FULL_ERROR,s.fatal=!1,e.trigger(a.default.ERROR,s))}}}},r.prototype.flushBuffer=function(e,t,r){var n,i=this.sourceBuffer;if(Object.keys(i).length){if(o.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var a in i)if(!r||a===r){if((n=i[a]).ended=!1,n.updating)return o.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(a,n,e,t))return this.flushBufferCounter++,!1}}else o.logger.warn("abort flushing too many retries");o.logger.log("buffer flushed")}return!0},r.prototype.removeBufferRange=function(e,t,r,n){try{for(var i=0;i<t.buffered.length;i++){var a=t.buffered.start(i),s=t.buffered.end(i),l=Math.max(a,r),u=Math.min(s,n);if(Math.min(u,s)-l>.5)return o.logger.log("sb remove "+e+" ["+l+","+u+"], of ["+a+","+s+"], pos:"+this.media.currentTime),t.remove(l,u),!0}}catch(e){o.logger.warn("removeBufferRange failed",e)}return!1},r}(s.default);t.default=c}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/controller/cap-level-controller.js":
/*!************************************************!*\
  !*** ./src/controller/cap-level-controller.js ***!
  \************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=function(t){function r(r){var n=t.call(this,r,a.default.FPS_DROP_LEVEL_CAPPING,a.default.MEDIA_ATTACHING,a.default.MANIFEST_PARSED,a.default.BUFFER_CODECS,a.default.MEDIA_DETACHING)||this;return n.autoLevelCapping=e.POSITIVE_INFINITY,n.firstLevel=null,n.levels=[],n.media=null,n.restrictedLevels=[],n.timer=null,n}return i(r,t),r.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this._stopCapping())},r.prototype.onFpsDropLevelCapping=function(e){r.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},r.prototype.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},r.prototype.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this._startCapping()},r.prototype.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this._startCapping()},r.prototype.onLevelsUpdated=function(e){this.levels=e.levels},r.prototype.onMediaDetaching=function(){this._stopCapping()},r.prototype.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},r.prototype.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var n=this.levels.filter(function(n,i){return r.isLevelAllowed(i,t.restrictedLevels)&&i<=e});return r.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)},r.prototype._startCapping=function(){this.timer||(this.autoLevelCapping=e.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},r.prototype._stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=e.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},Object.defineProperty(r.prototype,"mediaWidth",{get:function(){var e,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=r.contentScaleFactor),e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"mediaHeight",{get:function(){var e,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=r.contentScaleFactor),e},enumerable:!0,configurable:!0}),Object.defineProperty(r,"contentScaleFactor",{get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e},enumerable:!0,configurable:!0}),r.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},r.getMaxLevelByMediaSize=function(e,t,r){if(!e||e&&!e.length)return-1;for(var n,i,a=e.length-1,s=0;s<e.length;s+=1){var o=e[s];if((o.width>=t||o.height>=r)&&(n=o,!(i=e[s+1])||n.width!==i.width||n.height!==i.height)){a=s;break}}return a},r}(r(/*! ../event-handler */"./src/event-handler.js").default);t.default=s}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/controller/eme-controller.js":
/*!******************************************!*\
  !*** ./src/controller/eme-controller.js ***!
  \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../event-handler */"./src/event-handler.js"),s=r(/*! ../events */"./src/events.js"),o=r(/*! ../errors */"./src/errors.js"),l=r(/*! ../utils/logger */"./src/utils/logger.js"),u=window.XMLHttpRequest,c="com.widevine.alpha",d="com.microsoft.playready",h=function(e){function t(t){var r=e.call(this,t,s.default.MEDIA_ATTACHED,s.default.MANIFEST_PARSED)||this;return r._widevineLicenseUrl=t.config.widevineLicenseUrl,r._licenseXhrSetup=t.config.licenseXhrSetup,r._emeEnabled=t.config.emeEnabled,r._requestMediaKeySystemAccess=t.config.requestMediaKeySystemAccessFunc,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._isMediaEncrypted=!1,r._requestLicenseFailureCount=0,r}return i(t,e),t.prototype.getLicenseServerUrl=function(e){var t;switch(e){case c:t=this._widevineLicenseUrl;break;default:t=null}return t||(l.logger.error('No license server URL configured for key-system "'+e+'"'),this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),t},t.prototype._attemptKeySystemAccess=function(e,t,r){var n=this,i=function(e,t,r){switch(e){case c:return function(e,t,r){var n={videoCapabilities:[]};return t.forEach(function(e){n.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})}),[n]}(0,r);default:throw Error("Unknown key-system: "+e)}}(e,0,r);i?(l.logger.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(e,i).then(function(t){n._onMediaKeySystemAccessObtained(e,t)}).catch(function(t){l.logger.error('Failed to obtain key-system "'+e+'" access:',t)})):l.logger.warn("Can not create config for key-system (maybe because platform is not supported):",e)},Object.defineProperty(t.prototype,"requestMediaKeySystemAccess",{get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess},enumerable:!0,configurable:!0}),t.prototype._onMediaKeySystemAccessObtained=function(e,t){var r=this;l.logger.log('Access for key-system "'+e+'" obtained');var n={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(n),t.createMediaKeys().then(function(t){n.mediaKeys=t,l.logger.log('Media-keys created for key-system "'+e+'"'),r._onMediaKeysCreated()}).catch(function(e){l.logger.error("Failed to create media-keys:",e)})},t.prototype._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))})},t.prototype._onNewMediaKeySession=function(e){var t=this;l.logger.log("New key-system session "+e.sessionId),e.addEventListener("message",function(r){t._onKeySessionMessage(e,r.message)},!1)},t.prototype._onKeySessionMessage=function(e,t){l.logger.log("Got EME message event, creating license request"),this._requestLicense(t,function(t){l.logger.log("Received license data, updating key-session"),e.update(t)})},t.prototype._onMediaEncrypted=function(e,t){l.logger.log('Media is encrypted using "'+e+'" init data type'),this._isMediaEncrypted=!0,this._mediaEncryptionInitDataType=e,this._mediaEncryptionInitData=t,this._attemptSetMediaKeys(),this._generateRequestWithPreferredKeySession()},t.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return l.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});l.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},t.prototype._generateRequestWithPreferredKeySession=function(){var e=this,t=this._mediaKeysList[0];if(!t)return l.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(t.mediaKeysSessionInitialized)l.logger.warn("Key-Session already initialized but requested again");else{var r=t.mediaKeysSession;r||(l.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0}));var n=this._mediaEncryptionInitDataType,i=this._mediaEncryptionInitData;l.logger.log('Generating key-session request for "'+n+'" init data type'),t.mediaKeysSessionInitialized=!0,r.generateRequest(n,i).then(function(){l.logger.debug("Key-session generation succeeded")}).catch(function(t){l.logger.error("Error generating key-session request:",t),e.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},t.prototype._createLicenseXhr=function(e,t,r){var n=new u,i=this._licenseXhrSetup;try{if(i)try{i(n,e)}catch(t){n.open("POST",e,!0),i(n,e)}n.readyState||n.open("POST",e,!0)}catch(e){return l.logger.error("Error setting up key-system license XHR",e),void this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return n.responseType="arraybuffer",n.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,n,e,t,r),n},t.prototype._onLicenseRequestReadyStageChange=function(e,t,r,n){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,l.logger.log("License request succeeded"),n(e.response);else{if(l.logger.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount<=3){var i=3-this._requestLicenseFailureCount+1;return l.logger.warn("Retrying license request, "+i+" attempts left"),void this._requestLicense(r,n)}this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}},t.prototype._generateLicenseRequestChallenge=function(e,t){var r;return e.mediaKeySystemDomain===d?l.logger.error("PlayReady is not supported (yet)"):e.mediaKeySystemDomain===c?r=t:l.logger.error("Unsupported key-system:",e.mediaKeySystemDomain),r},t.prototype._requestLicense=function(e,t){l.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return l.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});var n=this.getLicenseServerUrl(r.mediaKeySystemDomain),i=this._createLicenseXhr(n,e,t);l.logger.log("Sending license request to URL: "+n),i.send(this._generateLicenseRequestChallenge(r,e))},t.prototype.onMediaAttached=function(e){var t=this;if(this._emeEnabled){var r=e.media;this._media=r,r.addEventListener("encrypted",function(e){t._onMediaEncrypted(e.initDataType,e.initData)})}},t.prototype.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map(function(e){return e.audioCodec}),r=e.levels.map(function(e){return e.videoCodec});this._attemptKeySystemAccess(c,t,r)}},t}(a.default);t.default=h},"./src/controller/fps-controller.js":
/*!******************************************!*\
  !*** ./src/controller/fps-controller.js ***!
  \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=r(/*! ../event-handler */"./src/event-handler.js"),o=r(/*! ../utils/logger */"./src/utils/logger.js"),l=window.performance,u=function(e){function t(t){return e.call(this,t,a.default.MEDIA_ATTACHING)||this}return i(t,e),t.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},t.prototype.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},t.prototype.checkFPS=function(e,t,r){var n=l.now();if(t){if(this.lastTime){var i=n-this.lastTime,s=r-this.lastDroppedFrames,u=t-this.lastDecodedFrames,c=1e3*s/i,d=this.hls;if(d.trigger(a.default.FPS_DROP,{currentDropped:s,currentDecoded:u,totalDroppedFrames:r}),c>0&&s>d.config.fpsDroppedMonitoringThreshold*u){var h=d.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(-1===d.autoLevelCapping||d.autoLevelCapping>=h)&&(h-=1,d.trigger(a.default.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:d.currentLevel}),d.autoLevelCapping=h,d.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},t.prototype.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},t}(s.default);t.default=u},"./src/controller/fragment-finders.js":
/*!********************************************!*\
  !*** ./src/controller/fragment-finders.js ***!
  \********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../utils/binary-search */"./src/utils/binary-search.js");function i(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0);var n=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=e?1:r.start-n>e&&r.start?-1:0}function a(e,t,r){var n=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.endProgramDateTime-n>e}t.findFragmentByPDT=function(t,r,n){if(!Array.isArray(t)||!t.length||!e.isFinite(r))return null;if(r<t[0].programDateTime)return null;if(r>=t[t.length-1].endProgramDateTime)return null;n=n||0;for(var i=0;i<t.length;++i){var s=t[i];if(a(r,n,s))return s}return null},t.findFragmentByPTS=function(e,t,r,a){void 0===r&&(r=0),void 0===a&&(a=0);var s=e?t[e.sn-t[0].sn+1]:null;return s&&!i(r,a,s)?s:n.default.search(t,i.bind(null,r,a))},t.fragmentWithinToleranceTest=i,t.pdtWithinToleranceTest=a}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/controller/fragment-tracker.js":
/*!********************************************!*\
  !*** ./src/controller/fragment-tracker.js ***!
  \********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../event-handler */"./src/event-handler.js"),s=r(/*! ../events */"./src/events.js");t.FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};var o=function(r){function n(e){var t=r.call(this,e,s.default.BUFFER_APPENDED,s.default.FRAG_BUFFERED,s.default.FRAG_LOADED)||this;return t.bufferPadding=.2,t.fragments=Object.create(null),t.timeRanges=Object.create(null),t.config=e.config,t}return i(n,r),n.prototype.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,a.default.prototype.destroy.call(this),r.prototype.destroy.call(this)},n.prototype.getBufferedFrag=function(e,t){var r=this.fragments,n=Object.keys(r).filter(function(n){var i=r[n];if(i.body.type!==t)return!1;if(!i.buffered)return!1;var a=i.body;return a.startPTS<=e&&e<=a.endPTS});if(0===n.length)return null;var i=n.pop();return r[i].body},n.prototype.detectEvictedFragments=function(e,t){var r,n,i=this;Object.keys(this.fragments).forEach(function(a){var s=i.fragments[a];if(!0===s.buffered){var o=s.range[e];if(o){r=o.time;for(var l=0;l<r.length;l++)if(n=r[l],!1===i.isTimeBuffered(n.startPTS,n.endPTS,t)){i.removeFragment(s.body);break}}}})},n.prototype.detectPartialFragments=function(e){var t=this,r=this.getFragmentKey(e),n=this.fragments[r];n&&(n.buffered=!0,Object.keys(this.timeRanges).forEach(function(r){if(e.hasElementaryStream(r)){var i=t.timeRanges[r];n.range[r]=t.getBufferedTimes(e.startPTS,e.endPTS,i)}}))},n.prototype.getBufferedTimes=function(e,t,r){for(var n,i,a=[],s=!1,o=0;o<r.length;o++){if(n=r.start(o)-this.bufferPadding,i=r.end(o)+this.bufferPadding,e>=n&&t<=i){a.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))});break}if(e<i&&t>n)a.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))}),s=!0;else if(t<=n)break}return{time:a,partial:s}},n.prototype.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},n.prototype.getPartialFragment=function(e){var t,r,n,i=this,a=null,s=0;return Object.keys(this.fragments).forEach(function(o){var l=i.fragments[o];i.isPartial(l)&&(r=l.body.startPTS-i.bufferPadding,n=l.body.endPTS+i.bufferPadding,e>=r&&e<=n&&(t=Math.min(e-r,n-e),s<=t&&(a=l.body,s=t)))}),a},n.prototype.getState=function(e){var r=this.getFragmentKey(e),n=this.fragments[r],i=t.FragmentState.NOT_LOADED;return void 0!==n&&(i=n.buffered?!0===this.isPartial(n)?t.FragmentState.PARTIAL:t.FragmentState.OK:t.FragmentState.APPENDING),i},n.prototype.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},n.prototype.isTimeBuffered=function(e,t,r){for(var n,i,a=0;a<r.length;a++){if(n=r.start(a)-this.bufferPadding,i=r.end(a)+this.bufferPadding,e>=n&&t<=i)return!0;if(t<=n)return!1}return!1},n.prototype.onFragLoaded=function(t){var r=t.frag;e.isFinite(r.sn)&&!r.bitrateTest&&(this.fragments[this.getFragmentKey(r)]={body:r,range:Object.create(null),buffered:!1})},n.prototype.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(e){var r=t.timeRanges[e];t.detectEvictedFragments(e,r)})},n.prototype.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},n.prototype.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},n.prototype.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},n.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},n}(a.default);t.FragmentTracker=o}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/controller/gap-controller.js":
/*!******************************************!*\
  !*** ./src/controller/gap-controller.js ***!
  \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.js"),i=r(/*! ../errors */"./src/errors.js"),a=r(/*! ../events */"./src/events.js"),s=r(/*! ../utils/logger */"./src/utils/logger.js"),o=function(){function e(e,t,r,n){this.config=e,this.media=t,this.fragmentTracker=r,this.hls=n,this.stallReported=!1}return e.prototype.poll=function(e,t){var r=this.config,i=this.media,a=i.currentTime,o=window.performance.now();if(a!==e)return this.stallReported&&(s.logger.warn("playback not stuck anymore @"+a+", after "+Math.round(o-this.stalled)+"ms"),this.stallReported=!1),this.stalled=null,void(this.nudgeRetry=0);if(!(i.ended||!i.buffered.length||i.readyState>2||i.seeking&&n.BufferHelper.isBuffered(i,a))){var l=o-this.stalled,u=n.BufferHelper.bufferInfo(i,a,r.maxBufferHole);this.stalled?(l>=1e3&&this._reportStall(u.len),this._tryFixBufferStall(u,l)):this.stalled=o}},e.prototype._tryFixBufferStall=function(e,t){var r=this.config,n=this.fragmentTracker,i=this.media.currentTime,a=n.getPartialFragment(i);a&&this._trySkipBufferHole(a),e.len>.5&&t>1e3*r.highBufferWatchdogPeriod&&(this.stalled=null,this._tryNudgeBuffer())},e.prototype._reportStall=function(e){var t=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,s.logger.warn("Playback stalling at @"+r.currentTime+" due to low buffer"),t.trigger(a.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},e.prototype._trySkipBufferHole=function(e){for(var t=this.hls,r=this.media,n=r.currentTime,o=0,l=0;l<r.buffered.length;l++){var u=r.buffered.start(l);if(n>=o&&n<u)return r.currentTime=Math.max(u,r.currentTime+.1),s.logger.warn("skipping hole, adjusting currentTime from "+n+" to "+r.currentTime),this.stalled=null,void t.trigger(a.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+n+" to "+r.currentTime,frag:e});o=r.buffered.end(l)}},e.prototype._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,n=r.currentTime,o=(this.nudgeRetry||0)+1;if(this.nudgeRetry=o,o<e.nudgeMaxRetry){var l=n+o*e.nudgeOffset;s.logger.log("adjust currentTime from "+n+" to "+l),r.currentTime=l,t.trigger(a.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else s.logger.error("still stuck in high buffer @"+n+" after "+e.nudgeMaxRetry+", raise fatal error"),t.trigger(a.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},e}();t.default=o},"./src/controller/id3-track-controller.js":
/*!************************************************!*\
  !*** ./src/controller/id3-track-controller.js ***!
  \************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=r(/*! ../event-handler */"./src/event-handler.js"),o=r(/*! ../demux/id3 */"./src/demux/id3.js"),l=r(/*! ../utils/texttrack-utils */"./src/utils/texttrack-utils.js"),u=function(e){function t(t){var r=e.call(this,t,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.FRAG_PARSING_METADATA)||this;return r.id3Track=void 0,r.media=void 0,r}return i(t,e),t.prototype.destroy=function(){s.default.prototype.destroy.call(this)},t.prototype.onMediaAttached=function(e){this.media=e.media,this.media},t.prototype.onMediaDetaching=function(){l.clearCurrentCues(this.id3Track),this.id3Track=void 0,this.media=void 0},t.prototype.getID3Track=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return l.sendAddTrackEvent(r,this.media),r}return this.media.addTextTrack("metadata","id3")},t.prototype.onFragParsingMetadata=function(e){var t=e.frag,r=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,i=0;i<r.length;i++){var a=o.default.getID3Frames(r[i].data);if(a){var s=r[i].pts,l=i<r.length-1?r[i+1].pts:t.endPTS;s===l&&(l+=1e-4);for(var u=0;u<a.length;u++){var c=a[u];if(!o.default.isTimeStampFrame(c)){var d=new n(s,l,"");d.value=c,this.id3Track.addCue(d)}}}}},t}(s.default);t.default=u},"./src/controller/level-controller.js":
/*!********************************************!*\
  !*** ./src/controller/level-controller.js ***!
  \********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a,s=r(/*! ../events */"./src/events.js"),o=r(/*! ../event-handler */"./src/event-handler.js"),l=r(/*! ../utils/logger */"./src/utils/logger.js"),u=r(/*! ../errors */"./src/errors.js"),c=r(/*! ../utils/codecs */"./src/utils/codecs.js"),d=r(/*! ./level-helper */"./src/controller/level-helper.js"),h=(window.performance,function(e){function t(t){var r=e.call(this,t,s.default.MANIFEST_LOADED,s.default.LEVEL_LOADED,s.default.AUDIO_TRACK_SWITCHED,s.default.FRAG_LOADED,s.default.ERROR)||this;return r.canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,a=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r}return i(t,e),t.prototype.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},t.prototype.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),null!==this.timer&&this.loadLevel()},t.prototype.stopLoad=function(){this.canload=!1},t.prototype.onManifestLoaded=function(e){var t,r=[],n=[],i={},o=null,h=!1,f=!1;if(e.levels.forEach(function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,h=h||!!e.videoCodec,f=f||!!e.audioCodec,a&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(o=i[e.bitrate])?o.url.push(e.url):(e.url=[e.url],e.urlId=0,i[e.bitrate]=e,r.push(e)),t&&(t.AUDIO&&(f=!0,d.addGroupId(o||e,"audio",t.AUDIO)),t.SUBTITLES&&d.addGroupId(o||e,"text",t.SUBTITLES))}),h&&f&&(r=r.filter(function(e){return!!e.videoCodec})),r=r.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||c.isCodecSupportedInMp4(t,"audio"))&&(!r||c.isCodecSupportedInMp4(r,"video"))}),e.audioTracks&&(n=e.audioTracks.filter(function(e){return!e.audioCodec||c.isCodecSupportedInMp4(e.audioCodec,"audio")})).forEach(function(e,t){e.id=t}),r.length>0){t=r[0].bitrate,r.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=r;for(var p=0;p<r.length;p++)if(r[p].bitrate===t){this._firstLevel=p,l.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+t);break}this.hls.trigger(s.default.MANIFEST_PARSED,{levels:r,audioTracks:n,firstLevel:this._firstLevel,stats:e.stats,audio:f,video:h,altAudio:n.some(function(e){return!!e.url})})}else this.hls.trigger(s.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},Object.defineProperty(t.prototype,"levels",{get:function(){return this._levels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))},enumerable:!0,configurable:!0}),t.prototype.setLevelInternal=function(e){var t=this._levels,r=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){l.logger.log("switching to level "+e),this.currentLevelIndex=e;var n=t[e];n.level=e,r.trigger(s.default.LEVEL_SWITCHING,n)}var i=t[e],a=i.details;if(!a||a.live){var o=i.urlId;r.trigger(s.default.LEVEL_LOADING,{url:i.url[o],level:e,id:o})}}else r.trigger(s.default.ERROR,{type:u.ErrorTypes.OTHER_ERROR,details:u.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},Object.defineProperty(t.prototype,"manualLevel",{get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstLevel",{get:function(){return this._firstLevel},set:function(e){this._firstLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startLevel",{get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e},enumerable:!0,configurable:!0}),t.prototype.onError=function(e){if(e.fatal)e.type===u.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,r=!1,n=!1;switch(e.details){case u.ErrorDetails.FRAG_LOAD_ERROR:case u.ErrorDetails.FRAG_LOAD_TIMEOUT:case u.ErrorDetails.KEY_LOAD_ERROR:case u.ErrorDetails.KEY_LOAD_TIMEOUT:t=e.frag.level,n=!0;break;case u.ErrorDetails.LEVEL_LOAD_ERROR:case u.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=e.context.level,r=!0;break;case u.ErrorDetails.REMUX_ALLOC_ERROR:t=e.level,r=!0}void 0!==t&&this.recoverLevel(e,t,r,n)}},t.prototype.recoverLevel=function(e,t,r,n){var i,a,s,o=this,u=this.hls.config,c=e.details,d=this._levels[t];if(d.loadError++,d.fragmentError=n,r){if(!(this.levelRetryCount+1<=u.levelLoadingMaxRetry))return l.logger.error("level controller, cannot recover from "+c+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);a=Math.min(Math.pow(2,this.levelRetryCount)*u.levelLoadingRetryDelay,u.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return o.loadLevel()},a),e.levelRetry=!0,this.levelRetryCount++,l.logger.warn("level controller, "+c+", retry in "+a+" ms, current retry count is "+this.levelRetryCount)}(r||n)&&((i=d.url.length)>1&&d.loadError<i?(d.urlId=(d.urlId+1)%i,d.details=void 0,l.logger.warn("level controller, "+c+" for level "+t+": switching to redundant URL-id "+d.urlId)):-1===this.manualLevelIndex?(s=0===t?this._levels.length-1:t-1,l.logger.warn("level controller, "+c+": switch to "+s),this.hls.nextAutoLevel=this.currentLevelIndex=s):n&&(l.logger.warn("level controller, "+c+": reload a fragment"),this.currentLevelIndex=null))},t.prototype.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var r=this._levels[t.level];void 0!==r&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},t.prototype.onLevelLoaded=function(e){var t=this,r=e.level,n=e.details;if(r===this.currentLevelIndex){var i=this._levels[r];if(i.fragmentError||(i.loadError=0,this.levelRetryCount=0),n.live){var a=d.computeReloadInterval(i.details,n,e.stats.trequest);l.logger.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout(function(){return t.loadLevel()},a)}else this.clearTimer()}},t.prototype.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var n=-1,i=0;i<r.audioGroupIds.length;i++)if(r.audioGroupIds[i]===t){n=i;break}n!==r.urlId&&(r.urlId=n,this.startLoad())}},t.prototype.loadLevel=function(){if(l.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&e.url.length>0){var t=this.currentLevelIndex,r=e.urlId,n=e.url[r];l.logger.log("Attempt loading level index "+t+" with URL-id "+r),this.hls.trigger(s.default.LEVEL_LOADING,{url:n,level:t,id:r})}}},Object.defineProperty(t.prototype,"nextLoadLevel",{get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)},enumerable:!0,configurable:!0}),t}(o.default));t.default=h},"./src/controller/level-helper.js":
/*!****************************************!*\
  !*** ./src/controller/level-helper.js ***!
  \****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../utils/logger */"./src/utils/logger.js");function i(t,r,i){var a=t[r],s=t[i],o=s.startPTS;e.isFinite(o)?i>r?(a.duration=o-a.start,a.duration<0&&n.logger.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!")):(s.duration=a.start-o,s.duration<0&&n.logger.warn("negative duration computed for frag "+s.sn+",level "+s.level+", there should be some duration drift between playlist and fragment!")):s.start=i>r?a.start+a.duration:Math.max(a.start-s.duration,0)}function a(t,r,n,a,s,o){var l=n;if(e.isFinite(r.startPTS)){var u=Math.abs(r.startPTS-n);e.isFinite(r.deltaPTS)?r.deltaPTS=Math.max(u,r.deltaPTS):r.deltaPTS=u,l=Math.max(n,r.startPTS),n=Math.min(n,r.startPTS),a=Math.max(a,r.endPTS),s=Math.min(s,r.startDTS),o=Math.max(o,r.endDTS)}var c=n-r.start;r.start=r.startPTS=n,r.maxStartPTS=l,r.endPTS=a,r.startDTS=s,r.endDTS=o,r.duration=a-n;var d,h,f,p=r.sn;if(!t||p<t.startSN||p>t.endSN)return 0;for(d=p-t.startSN,(h=t.fragments)[d]=r,f=d;f>0;f--)i(h,f,f-1);for(f=d;f<h.length-1;f++)i(h,f,f+1);return t.PTSKnown=!0,c}function s(e,t,r){if(e&&t)for(var n=Math.max(e.startSN,t.startSN)-t.startSN,i=Math.min(e.endSN,t.endSN)-t.startSN,a=t.startSN-e.startSN,s=n;s<=i;s++){var o=e.fragments[a+s],l=t.fragments[s];if(!o||!l)break;r(o,l,s)}}function o(e,t){var r=t.startSN-e.startSN,n=e.fragments,i=t.fragments;if(!(r<0||r>n.length))for(var a=0;a<i.length;a++)i[a].start+=n[r].start}t.addGroupId=function(e,t,r){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}},t.updatePTS=i,t.updateFragPTSDTS=a,t.mergeDetails=function(t,r){r.initSegment&&t.initSegment&&(r.initSegment=t.initSegment);var i,l=0;if(s(t,r,function(t,n){l=t.cc-n.cc,e.isFinite(t.startPTS)&&(n.start=n.startPTS=t.startPTS,n.endPTS=t.endPTS,n.duration=t.duration,n.backtracked=t.backtracked,n.dropped=t.dropped,i=n),r.PTSKnown=!0}),r.PTSKnown){if(l){n.logger.log("discontinuity sliding from playlist, take drift into account");for(var u=r.fragments,c=0;c<u.length;c++)u[c].cc+=l}i?a(r,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):o(t,r),r.PTSKnown=t.PTSKnown}},t.mergeSubtitlePlaylists=function(e,t,r){void 0===r&&(r=0);var n=-1;s(e,t,function(e,t,r){t.start=e.start,n=r});var i=t.fragments;if(n<0)i.forEach(function(e){e.start+=r});else for(var a=n+1;a<i.length;a++)i[a].start=i[a-1].start+i[a-1].duration},t.mapFragmentIntersection=s,t.adjustSliding=o,t.computeReloadInterval=function(e,t,r){var n=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),i=n/2;return e&&t.endSN===e.endSN&&(n=i),r&&(n=Math.max(i,n-(window.performance.now()-r))),Math.round(n)}}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/controller/stream-controller.js":
/*!*********************************************!*\
  !*** ./src/controller/stream-controller.js ***!
  \*********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../utils/binary-search */"./src/utils/binary-search.js"),s=r(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.js"),o=r(/*! ../demux/demuxer */"./src/demux/demuxer.js"),l=r(/*! ../events */"./src/events.js"),u=r(/*! ./fragment-tracker */"./src/controller/fragment-tracker.js"),c=r(/*! ../loader/fragment */"./src/loader/fragment.js"),d=r(/*! ../loader/playlist-loader */"./src/loader/playlist-loader.js"),h=r(/*! ./level-helper */"./src/controller/level-helper.js"),f=r(/*! ../utils/time-ranges */"./src/utils/time-ranges.js"),p=r(/*! ../errors */"./src/errors.js"),g=r(/*! ../utils/logger */"./src/utils/logger.js"),m=r(/*! ../utils/discontinuities */"./src/utils/discontinuities.js"),v=r(/*! ./fragment-finders */"./src/controller/fragment-finders.js"),_=r(/*! ./gap-controller */"./src/controller/gap-controller.js"),y=r(/*! ./base-stream-controller */"./src/controller/base-stream-controller.js"),b=function(t){function r(e,r){var n=t.call(this,e,l.default.MEDIA_ATTACHED,l.default.MEDIA_DETACHING,l.default.MANIFEST_LOADING,l.default.MANIFEST_PARSED,l.default.LEVEL_LOADED,l.default.KEY_LOADED,l.default.FRAG_LOADED,l.default.FRAG_LOAD_EMERGENCY_ABORTED,l.default.FRAG_PARSING_INIT_SEGMENT,l.default.FRAG_PARSING_DATA,l.default.FRAG_PARSED,l.default.ERROR,l.default.AUDIO_TRACK_SWITCHING,l.default.AUDIO_TRACK_SWITCHED,l.default.BUFFER_CREATED,l.default.BUFFER_APPENDED,l.default.BUFFER_FLUSHED)||this;return n.fragmentTracker=r,n.config=e.config,n.audioCodecSwap=!1,n._state=y.State.STOPPED,n.stallReported=!1,n.gapController=null,n}return i(r,t),r.prototype.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=r.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&-1===e&&(g.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=y.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=y.State.STOPPED},r.prototype.stopLoad=function(){this.forceStartLoad=!1,t.prototype.stopLoad.call(this)},r.prototype.doTick=function(){switch(this.state){case y.State.BUFFER_FLUSHING:this.fragLoadError=0;break;case y.State.IDLE:this._doTickIdle();break;case y.State.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=y.State.IDLE);break;case y.State.FRAG_LOADING_WAITING_RETRY:var t=window.performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(g.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=y.State.IDLE);break;case y.State.ERROR:case y.State.STOPPED:case y.State.FRAG_LOADING:case y.State.PARSING:case y.State.PARSED:case y.State.ENDED:}this._checkBuffer(),this._checkFragmentChanged()},r.prototype._doTickIdle=function(){var e=this.hls,t=e.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&t.startFragPrefetch)){var n;n=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var i=e.nextLoadLevel,a=this.levels[i];if(a){var o,u=a.bitrate;o=u?Math.max(8*t.maxBufferSize/u,t.maxBufferLength):t.maxBufferLength,o=Math.min(o,t.maxMaxBufferLength);var c=s.BufferHelper.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,n,t.maxBufferHole),d=c.len;if(!(d>=o)){g.logger.trace("buffer length of "+d.toFixed(3)+" is below max of "+o.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=i;var h=a.details;if(!h||h.live&&this.levelLastLoaded!==i)this.state=y.State.WAITING_LEVEL;else{if(this._streamEnded(c,h)){var f={};return this.altAudio&&(f.type="video"),this.hls.trigger(l.default.BUFFER_EOS,f),void(this.state=y.State.ENDED)}this._fetchPayloadOrEos(n,c,h)}}}}},r.prototype._fetchPayloadOrEos=function(e,t,r){var n=this.fragPrevious,i=this.level,a=r.fragments,s=a.length;if(0!==s){var o,l=a[0].start,u=a[s-1].start+a[s-1].duration,c=t.end;if(r.initSegment&&!r.initSegment.data)o=r.initSegment;else if(r.live){var d=this.config.initialLiveManifestSize;if(s<d)return void g.logger.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+d);if(null===(o=this._ensureFragmentAtLivePoint(r,c,l,u,n,a,s)))return}else c<l&&(o=a[0]);o||(o=this._findFragment(l,n,s,a,c,u,r)),o&&(o.encrypted?(g.logger.log("Loading key for "+o.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+i),this._loadKey(o)):(g.logger.log("Loading "+o.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+i+", currentTime:"+e.toFixed(3)+",bufferEnd:"+c.toFixed(3)),this._loadFragment(o)))}},r.prototype._ensureFragmentAtLivePoint=function(e,t,r,n,i,s,o){var l,u=this.hls.config,c=this.media,d=void 0!==u.liveMaxLatencyDuration?u.liveMaxLatencyDuration:u.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(r-u.maxFragLookUpTolerance,n-d)){var h=this.liveSyncPosition=this.computeLivePosition(r,e);g.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),t=h,c&&c.readyState&&c.duration>h&&(c.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&t>n&&c&&c.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(i)if(e.hasProgramDateTime)g.logger.log("live playlist, switching playlist, load frag with same PDT: "+i.programDateTime),l=v.findFragmentByPDT(s,i.endProgramDateTime,u.maxFragLookUpTolerance);else{var f=i.sn+1;if(f>=e.startSN&&f<=e.endSN){var p=s[f-e.startSN];i.cc===p.cc&&(l=p,g.logger.log("live playlist, switching playlist, load frag with next SN: "+l.sn))}l||(l=a.default.search(s,function(e){return i.cc-e.cc}))&&g.logger.log("live playlist, switching playlist, load frag with same CC: "+l.sn)}l||(l=s[Math.min(o-1,Math.round(o/2))],g.logger.log("live playlist, switching playlist, unknown, load middle frag : "+l.sn))}return l},r.prototype._findFragment=function(e,t,r,n,i,a,s){var o,l=this.hls.config;if(i<a){var u=i>a-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance;o=v.findFragmentByPTS(t,n,i,u)}else o=n[r-1];if(o){var c=o.sn-s.startSN,d=t&&o.level===t.level,h=n[c-1],f=n[c+1];if(t&&o.sn===t.sn)if(d&&!o.backtracked)if(o.sn<s.endSN){var p=t.deltaPTS;p&&p>l.maxBufferHole&&t.dropped&&c?(o=h,g.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):(o=f,g.logger.log("SN just loaded, load next one: "+o.sn,o))}else o=null;else o.backtracked&&(f&&f.backtracked?(g.logger.warn("Already backtracked from fragment "+f.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+f.sn),o=f):(g.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,h?(o=h).backtracked=!0:c&&(o=null)))}return o},r.prototype._loadKey=function(e){this.state=y.State.KEY_LOADING,this.hls.trigger(l.default.KEY_LOADING,{frag:e})},r.prototype._loadFragment=function(t){var r=this.fragmentTracker.getState(t);this.fragCurrent=t,this.startFragRequested=!0,e.isFinite(t.sn)&&!t.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),t.backtracked||r===u.FragmentState.NOT_LOADED||r===u.FragmentState.PARTIAL?(t.autoLevel=this.hls.autoLevelEnabled,t.bitrateTest=this.bitrateTest,this.hls.trigger(l.default.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new o.default(this.hls,"main")),this.state=y.State.FRAG_LOADING):r===u.FragmentState.APPENDING&&this._reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t)},Object.defineProperty(r.prototype,"state",{get:function(){return this._state},set:function(e){if(this.state!==e){var t=this.state;this._state=e,g.logger.log("main stream:"+t+"->"+e),this.hls.trigger(l.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},enumerable:!0,configurable:!0}),r.prototype.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,d.default.LevelType.MAIN)},Object.defineProperty(r.prototype,"currentLevel",{get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"nextBufferedFrag",{get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null},enumerable:!0,configurable:!0}),r.prototype.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},Object.defineProperty(r.prototype,"nextLevel",{get:function(){var e=this.nextBufferedFrag;return e?e.level:-1},enumerable:!0,configurable:!0}),r.prototype._checkFragmentChanged=function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),s.BufferHelper.isBuffered(r,t)?e=this.getBufferedFrag(t):s.BufferHelper.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var n=e;if(n!==this.fragPlaying){this.hls.trigger(l.default.FRAG_CHANGED,{frag:n});var i=n.level;this.fragPlaying&&this.fragPlaying.level===i||this.hls.trigger(l.default.LEVEL_SWITCHED,{level:i}),this.fragPlaying=n}}},r.prototype.immediateLevelSwitch=function(){if(g.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t=this.media,r=void 0;t?(r=t.paused,t.pause()):r=!0,this.previouslyPaused=r}var n=this.fragCurrent;n&&n.loader&&n.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,e.POSITIVE_INFINITY)},r.prototype.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,s.BufferHelper.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},r.prototype.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var r,n=void 0,i=void 0;if((r=this.getBufferedFrag(t.currentTime))&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),t.paused)n=0;else{var a=this.hls.nextLoadLevel,s=this.levels[a],o=this.fragLastKbps;n=o&&this.fragCurrent?this.fragCurrent.duration*s.bitrate/(1e3*o)+1:0}if((i=this.getBufferedFrag(t.currentTime+n))&&(i=this.followingBufferedFrag(i))){var l=this.fragCurrent;l&&l.loader&&l.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(i.maxStartPTS,e.POSITIVE_INFINITY)}}},r.prototype.flushMainBuffer=function(e,t){this.state=y.State.BUFFER_FLUSHING;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(l.default.BUFFER_FLUSHING,r)},r.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new _.default(r,t,this.fragmentTracker,this.hls)},r.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(g.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},r.prototype.onMediaSeeked=function(){var t=this.media,r=t?t.currentTime:void 0;e.isFinite(r)&&g.logger.log("media seeked to "+r.toFixed(3)),this.tick()},r.prototype.onManifestLoading=function(){g.logger.log("trigger BUFFER_RESET"),this.hls.trigger(l.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},r.prototype.onManifestParsed=function(e){var t,r=!1,n=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(n=!0))}),this.audioCodecSwitch=r&&n,this.audioCodecSwitch&&g.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1;var i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)},r.prototype.onLevelLoaded=function(t){var r=t.details,n=t.level,i=this.levels[this.levelLastLoaded],a=this.levels[n],s=r.totalduration,o=0;if(g.logger.log("level "+n+" loaded ["+r.startSN+","+r.endSN+"],duration:"+s),r.live){var u=a.details;u&&r.fragments.length>0?(h.mergeDetails(u,r),o=r.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(o,u),r.PTSKnown&&e.isFinite(o)?g.logger.log("live playlist sliding:"+o.toFixed(3)):(g.logger.log("live playlist - outdated PTS, unknown sliding"),m.alignStream(this.fragPrevious,i,r))):(g.logger.log("live playlist - first load, unknown sliding"),r.PTSKnown=!1,m.alignStream(this.fragPrevious,i,r))}else r.PTSKnown=!1;if(a.details=r,this.levelLastLoaded=n,this.hls.trigger(l.default.LEVEL_UPDATED,{details:r,level:n}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var c=r.startTimeOffset;e.isFinite(c)?(c<0&&(g.logger.log("negative start time offset "+c+", count from end of last fragment"),c=o+s+c),g.logger.log("start time offset found in playlist, adjust startPosition to "+c),this.startPosition=c):r.live?(this.startPosition=this.computeLivePosition(o,r),g.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===y.State.WAITING_LEVEL&&(this.state=y.State.IDLE),this.tick()},r.prototype.onKeyLoaded=function(){this.state===y.State.KEY_LOADING&&(this.state=y.State.IDLE,this.tick())},r.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=this.hls,n=this.levels,i=this.media,a=e.frag;if(this.state===y.State.FRAG_LOADING&&t&&"main"===a.type&&a.level===t.level&&a.sn===t.sn){var s=e.stats,u=n[t.level],c=u.details;if(this.bitrateTest=!1,this.stats=s,g.logger.log("Loaded "+t.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+t.level),a.bitrateTest&&r.nextLoadLevel)this.state=y.State.IDLE,this.startFragRequested=!1,s.tparsed=s.tbuffered=window.performance.now(),r.trigger(l.default.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else if("initSegment"===a.sn)this.state=y.State.IDLE,s.tparsed=s.tbuffered=window.performance.now(),c.initSegment.data=e.payload,r.trigger(l.default.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else{g.logger.log("Parsing "+t.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+t.level+", cc "+t.cc),this.state=y.State.PARSING,this.pendingBuffering=!0,this.appended=!1,a.bitrateTest&&(a.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:a}));var d=!(i&&i.seeking)&&(c.PTSKnown||!c.live),h=c.initSegment?c.initSegment.data:[],f=this._getAudioCodec(u);(this.demuxer=this.demuxer||new o.default(this.hls,"main")).push(e.payload,h,f,u.videoCodec,t,c.totalduration,d)}}this.fragLoadError=0},r.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===y.State.PARSING){var n=e.tracks,i=void 0,a=void 0;if(n.audio&&this.altAudio&&delete n.audio,a=n.audio){var s=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(g.logger.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==a.metadata.channelCount&&-1===o.indexOf("firefox")&&(s="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==a.container&&(s="mp4a.40.2",g.logger.log("Android: force audio codec to "+s)),a.levelCodec=s,a.id=e.id}for(i in(a=n.video)&&(a.levelCodec=this.levels[this.level].videoCodec,a.id=e.id),this.hls.trigger(l.default.BUFFER_CODECS,n),n){a=n[i],g.logger.log("main track:"+i+",container:"+a.container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var u=a.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(l.default.BUFFER_APPENDING,{type:i,data:u,parent:"main",content:"initSegment"}))}this.tick()}},r.prototype.onFragParsingData=function(t){var r=this,n=this.fragCurrent,i=t.frag;if(n&&"main"===t.id&&i.sn===n.sn&&i.level===n.level&&("audio"!==t.type||!this.altAudio)&&this.state===y.State.PARSING){var a=this.levels[this.level],s=n;if(e.isFinite(t.endPTS)||(t.endPTS=t.startPTS+n.duration,t.endDTS=t.startDTS+n.duration),!0===t.hasAudio&&s.addElementaryStream(c.default.ElementaryStreamTypes.AUDIO),!0===t.hasVideo&&s.addElementaryStream(c.default.ElementaryStreamTypes.VIDEO),g.logger.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(s.dropped=t.dropped,s.dropped)if(s.backtracked)g.logger.warn("Already backtracked on this fragment, appending with the gap",s.sn);else{var o=a.details;if(!o||s.sn!==o.startSN)return g.logger.warn("missing video frame(s), backtracking fragment",s.sn),this.fragmentTracker.removeFragment(s),s.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=y.State.IDLE,this.fragPrevious=s,void this.tick();g.logger.warn("missing video frame(s) on first frag, appending with gap",s.sn)}else s.backtracked=!1;var u=h.updateFragPTSDTS(a.details,s,t.startPTS,t.endPTS,t.startDTS,t.endDTS),d=this.hls;d.trigger(l.default.LEVEL_PTS_UPDATED,{details:a.details,level:this.level,drift:u,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(e){e&&e.length&&r.state===y.State.PARSING&&(r.appended=!0,r.pendingBuffering=!0,d.trigger(l.default.BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"}))}),this.tick()}},r.prototype.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===y.State.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=y.State.PARSED,this._checkAppendedParsed())},r.prototype.onAudioTrackSwitching=function(t){var r=!!t.url,n=t.id;if(!r){if(this.mediaBuffer!==this.media){g.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var i=this.fragCurrent;i.loader&&(g.logger.log("switching to main audio track, cancel main fragment load"),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=y.State.IDLE}var a=this.hls;a.trigger(l.default.BUFFER_FLUSHING,{startOffset:0,endOffset:e.POSITIVE_INFINITY,type:"audio"}),a.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:n}),this.altAudio=!1}},r.prototype.onAudioTrackSwitched=function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(g.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r,this.tick()},r.prototype.onBufferCreated=function(e){var t,r,n=e.tracks,i=!1;for(var a in n){var s=n[a];"main"===s.id?(r=a,t=s,"video"===a&&(this.videoBuffer=n[a].buffer)):i=!0}i&&t?(g.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},r.prototype.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==y.State.PARSING&&t!==y.State.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},r.prototype._checkAppendedParsed=function(){if(!(this.state!==y.State.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;g.logger.log("main buffered : "+f.default.toString(t.buffered)),this.fragPrevious=e;var r=this.stats;r.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(l.default.FRAG_BUFFERED,{stats:r,frag:e,id:"main"}),this.state=y.State.IDLE}this.tick()}},r.prototype.onError=function(t){var r=t.frag||this.fragCurrent;if(!r||"main"===r.type){var n=!!this.media&&s.BufferHelper.isBuffered(this.media,this.media.currentTime)&&s.BufferHelper.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case p.ErrorDetails.FRAG_LOAD_ERROR:case p.ErrorDetails.FRAG_LOAD_TIMEOUT:case p.ErrorDetails.KEY_LOAD_ERROR:case p.ErrorDetails.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var i=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);g.logger.warn("mediaController: frag loading failed, retry in "+i+" ms"),this.retryDate=window.performance.now()+i,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=y.State.FRAG_LOADING_WAITING_RETRY}else g.logger.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=y.State.ERROR;break;case p.ErrorDetails.LEVEL_LOAD_ERROR:case p.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==y.State.ERROR&&(t.fatal?(this.state=y.State.ERROR,g.logger.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):t.levelRetry||this.state!==y.State.WAITING_LEVEL||(this.state=y.State.IDLE));break;case p.ErrorDetails.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==y.State.PARSING&&this.state!==y.State.PARSED||(n?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=y.State.IDLE):(g.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,e.POSITIVE_INFINITY)))}}},r.prototype._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,g.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},r.prototype._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},r.prototype.onFragLoadEmergencyAborted=function(){this.state=y.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},r.prototype.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(c.default.ElementaryStreamTypes.VIDEO,e.buffered),this.state=y.State.IDLE,this.fragPrevious=null},r.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},r.prototype.computeLivePosition=function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)},r.prototype._seekToStartPos=function(){var e=this.media,t=e.currentTime,r=e.seeking?t:this.startPosition;t!==r&&(g.logger.log("target start position not buffered, seek to buffered.start(0) "+r+" from current time "+t+" "),e.currentTime=r)},r.prototype._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(g.logger.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},Object.defineProperty(r.prototype,"liveSyncPosition",{get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e},enumerable:!0,configurable:!0}),r}(y.default);t.default=b}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/controller/subtitle-stream-controller.js":
/*!******************************************************!*\
  !*** ./src/controller/subtitle-stream-controller.js ***!
  \******************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=r(/*! ../utils/logger */"./src/utils/logger.js"),o=r(/*! ../crypt/decrypter */"./src/crypt/decrypter.js"),l=r(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.js"),u=r(/*! ./fragment-finders */"./src/controller/fragment-finders.js"),c=r(/*! ./fragment-tracker */"./src/controller/fragment-tracker.js"),d=r(/*! ./base-stream-controller */"./src/controller/base-stream-controller.js"),h=r(/*! ./level-helper */"./src/controller/level-helper.js"),f=window.performance,p=function(e){function t(t,r){var n=e.call(this,t,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.ERROR,a.default.KEY_LOADED,a.default.FRAG_LOADED,a.default.SUBTITLE_TRACKS_UPDATED,a.default.SUBTITLE_TRACK_SWITCH,a.default.SUBTITLE_TRACK_LOADED,a.default.SUBTITLE_FRAG_PROCESSED,a.default.LEVEL_UPDATED)||this;return n.fragmentTracker=r,n.config=t.config,n.state=d.State.STOPPED,n.tracks=[],n.tracksBuffered=[],n.currentTrackId=-1,n.decrypter=new o.default(t,t.config),n.lastAVStart=0,n._onMediaSeeking=n.onMediaSeeking.bind(n),n}return i(t,e),t.prototype.onSubtitleFragProcessed=function(e){var t=e.frag,r=e.success;if(this.fragPrevious=t,this.state=d.State.IDLE,r){var n=this.tracksBuffered[this.currentTrackId];if(n){for(var i,a=t.start,s=0;s<n.length;s++)if(a>=n[s].start&&a<=n[s].end){i=n[s];break}var o=t.start+t.duration;i?i.end=o:(i={start:a,end:o},n.push(i))}}},t.prototype.onMediaAttached=function(e){var t=e.media;this.media=t,t.addEventListener("seeking",this._onMediaSeeking),this.state=d.State.IDLE},t.prototype.onMediaDetaching=function(){this.media.removeEventListener("seeking",this._onMediaSeeking),this.media=null,this.state=d.State.STOPPED},t.prototype.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.state=d.State.IDLE)},t.prototype.onSubtitleTracksUpdated=function(e){var t=this;s.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach(function(e){t.tracksBuffered[e.id]=[]})},t.prototype.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},t.prototype.onSubtitleTrackLoaded=function(e){var t=e.id,r=e.details,n=this.currentTrackId,i=this.tracks,a=i[n];t>=i.length||t!==n||!a||(r.live&&h.mergeSubtitlePlaylists(a.details,r,this.lastAVStart),a.details=r,this.setInterval(500))},t.prototype.onKeyLoaded=function(){this.state===d.State.KEY_LOADING&&(this.state=d.State.IDLE)},t.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag.decryptdata,n=e.frag,i=this.hls;if(this.state===d.State.FRAG_LOADING&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&r&&r.key&&"AES-128"===r.method){var s=f.now();this.decrypter.decrypt(e.payload,r.key.buffer,r.iv.buffer,function(e){var t=f.now();i.trigger(a.default.FRAG_DECRYPTED,{frag:n,payload:e,stats:{tstart:s,tdecrypt:t}})})}},t.prototype.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},t.prototype.doTick=function(){if(this.media)switch(this.state){case d.State.IDLE:var e=this,t=e.config,r=e.currentTrackId,n=e.fragmentTracker,i=e.media,o=e.tracks;if(!o||!o[r]||!o[r].details)break;var h=t.maxBufferHole,f=t.maxFragLookUpTolerance,p=Math.min(t.maxBufferLength,t.maxMaxBufferLength),g=l.BufferHelper.bufferedInfo(this._getBuffered(),i.currentTime,h),m=g.end,v=g.len,_=o[r].details,y=_.fragments,b=y.length,w=y[b-1].start+y[b-1].duration;if(v>p)return;var S=void 0,E=this.fragPrevious;m<w?(E&&_.hasProgramDateTime&&(S=u.findFragmentByPDT(y,E.endProgramDateTime,f)),S||(S=u.findFragmentByPTS(E,y,m,f))):S=y[b-1],S&&S.encrypted?(s.logger.log("Loading key for "+S.sn),this.state=d.State.KEY_LOADING,this.hls.trigger(a.default.KEY_LOADING,{frag:S})):S&&n.getState(S)===c.FragmentState.NOT_LOADED&&(this.fragCurrent=S,this.state=d.State.FRAG_LOADING,this.hls.trigger(a.default.FRAG_LOADING,{frag:S}))}else this.state=d.State.IDLE},t.prototype.stopLoad=function(){this.lastAVStart=0,e.prototype.stopLoad.call(this)},t.prototype._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},t.prototype.onMediaSeeking=function(){this.fragPrevious=null},t}(d.default);t.SubtitleStreamController=p},"./src/controller/subtitle-track-controller.js":
/*!*****************************************************!*\
  !*** ./src/controller/subtitle-track-controller.js ***!
  \*****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=r(/*! ../event-handler */"./src/event-handler.js"),o=r(/*! ../utils/logger */"./src/utils/logger.js"),l=r(/*! ./level-helper */"./src/controller/level-helper.js"),u=function(t){function r(e){var r=t.call(this,e,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.MANIFEST_LOADED,a.default.SUBTITLE_TRACK_LOADED)||this;return r.tracks=[],r.trackId=-1,r.media=null,r.stopped=!0,r.subtitleDisplay=!0,r}return i(r,t),r.prototype.destroy=function(){s.default.prototype.destroy.call(this)},r.prototype.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},r.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=null)},r.prototype.onManifestLoaded=function(e){var t=this,r=e.subtitles||[];this.tracks=r,this.hls.trigger(a.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach(function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)})},r.prototype.onSubtitleTrackLoaded=function(e){var t=this,r=e.id,n=e.details,i=this.trackId,a=this.tracks,s=a[i];if(r>=a.length||r!==i||!s||this.stopped)this._clearReloadTimer();else if(o.logger.log("subtitle track "+r+" loaded"),n.live){var u=l.computeReloadInterval(s.details,n,e.stats.trequest);o.logger.log("Reloading live subtitle playlist in "+u+"ms"),this.timer=setTimeout(function(){t._loadCurrentTrack()},u)}else this._clearReloadTimer()},r.prototype.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},r.prototype.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},Object.defineProperty(r.prototype,"subtitleTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subtitleTrack",{get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))},enumerable:!0,configurable:!0}),r.prototype._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},r.prototype._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,r=this.hls,n=t[e];e<0||!n||n.details&&!n.details.live||(o.logger.log("Loading subtitle track "+e),r.trigger(a.default.SUBTITLE_TRACK_LOADING,{url:n.url,id:e}))},r.prototype._toggleTrackModes=function(e){var t=this.media,r=this.subtitleDisplay,n=this.trackId;if(t){var i=c(t.textTracks);if(-1===e)[].slice.call(i).forEach(function(e){e.mode="disabled"});else{var a=i[n];a&&(a.mode="disabled")}var s=i[e];s&&(s.mode=r?"showing":"hidden")}},r.prototype._setSubtitleTrackInternal=function(t){var r=this.hls,n=this.tracks;!e.isFinite(t)||t<-1||t>=n.length||(this.trackId=t,o.logger.log("Switching to subtitle track "+t),r.trigger(a.default.SUBTITLE_TRACK_SWITCH,{id:t}),this._loadCurrentTrack())},r.prototype._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=c(this.media.textTracks),r=0;r<t.length;r++)if("hidden"===t[r].mode)e=r;else if("showing"===t[r].mode){e=r;break}this.subtitleTrack=e}},r}(s.default);function c(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];"subtitles"===n.kind&&n.label&&t.push(e[r])}return t}t.default=u}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/controller/timeline-controller.js":
/*!***********************************************!*\
  !*** ./src/controller/timeline-controller.js ***!
  \***********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=r(/*! ../event-handler */"./src/event-handler.js"),o=r(/*! ../utils/cea-608-parser */"./src/utils/cea-608-parser.js"),l=r(/*! ../utils/output-filter */"./src/utils/output-filter.js"),u=r(/*! ../utils/webvtt-parser */"./src/utils/webvtt-parser.js"),c=r(/*! ../utils/logger */"./src/utils/logger.js"),d=r(/*! ../utils/texttrack-utils */"./src/utils/texttrack-utils.js");function h(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}var f=function(t){function r(e){var r=t.call(this,e,a.default.MEDIA_ATTACHING,a.default.MEDIA_DETACHING,a.default.FRAG_PARSING_USERDATA,a.default.FRAG_DECRYPTED,a.default.MANIFEST_LOADING,a.default.MANIFEST_LOADED,a.default.FRAG_LOADED,a.default.LEVEL_SWITCHING,a.default.INIT_PTS_FOUND)||this;if(r.hls=e,r.config=e.config,r.enabled=!0,r.Cues=e.config.cueHandler,r.textTracks=[],r.tracks=[],r.unparsedVttFrags=[],r.initPTS=[],r.cueRanges=[],r.captionsTracks={},r.captionsProperties={textTrack1:{label:r.config.captionsTextTrack1Label,languageCode:r.config.captionsTextTrack1LanguageCode},textTrack2:{label:r.config.captionsTextTrack2Label,languageCode:r.config.captionsTextTrack2LanguageCode}},r.config.enableCEA708Captions){var n=new l.default(r,"textTrack1"),i=new l.default(r,"textTrack2");r.cea608Parser=new o.default(0,n,i)}return r}return i(r,t),r.prototype.addCues=function(e,t,r,n){for(var i,a,s,o,l=this.cueRanges,u=!1,c=l.length;c--;){var d=l[c],h=(i=d[0],a=d[1],s=t,o=r,Math.min(a,o)-Math.max(i,s));if(h>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],r),u=!0,h/(r-t)>.5))return}u||l.push([t,r]),this.Cues.newCue(this.captionsTracks[e],t,r,n)},r.prototype.onInitPtsFound=function(e){var t=this;if("main"===e.id&&(this.initPTS[e.frag.cc]=e.initPTS),this.unparsedVttFrags.length){var r=this.unparsedVttFrags;this.unparsedVttFrags=[],r.forEach(function(e){t.onFragLoaded(e)})}},r.prototype.getExistingTrack=function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var n=t.textTracks[r];if(n[e])return n}return null},r.prototype.createCaptionsTrack=function(e){var t=this.captionsProperties[e],r=t.label,n=t.languageCode,i=this.captionsTracks;if(!i[e]){var a=this.getExistingTrack(e);if(a)i[e]=a,d.clearCurrentCues(i[e]),d.sendAddTrackEvent(i[e],this.media);else{var s=this.createTextTrack("captions",r,n);s&&(s[e]=!0,i[e]=s)}}},r.prototype.createTextTrack=function(e,t,r){var n=this.media;if(n)return n.addTextTrack(e,t,r)},r.prototype.destroy=function(){s.default.prototype.destroy.call(this)},r.prototype.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},r.prototype.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach(function(t){d.clearCurrentCues(e[t]),delete e[t]})},r.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks()},r.prototype._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)d.clearCurrentCues(t[r])}},r.prototype.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var r=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,n){var i;if(n<r.length){for(var a=null,s=0;s<r.length;s++)if(h(r[s],e)){a=r[s];break}a&&(i=a)}i||(i=t.createTextTrack("subtitles",e.name,e.lang)),e.default?i.mode=t.hls.subtitleDisplay?"showing":"hidden":i.mode="disabled",t.textTracks.push(i)})}},r.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},r.prototype.onFragLoaded=function(t){var r=t.frag,n=t.payload;if("main"===r.type){var i=r.sn;if(i!==this.lastSn+1){var s=this.cea608Parser;s&&s.reset()}this.lastSn=i}else if("subtitle"===r.type)if(n.byteLength){if(!e.isFinite(this.initPTS[r.cc]))return this.unparsedVttFrags.push(t),void(this.initPTS.length&&this.hls.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r}));var o=r.decryptdata;null!=o&&null!=o.key&&"AES-128"===o.method||this._parseVTTs(r,n)}else this.hls.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r})},r.prototype._parseVTTs=function(e,t){var r=this.vttCCs;r[e.cc]||(r[e.cc]={start:e.start,prevCC:this.prevCC,new:!0},this.prevCC=e.cc);var n=this.textTracks,i=this.hls;u.default.parse(t,this.initPTS[e.cc],r,e.cc,function(t){var r=n[e.level];"disabled"!==r.mode?(t.forEach(function(e){if(!r.cues.getCueById(e.id))try{r.addCue(e)}catch(n){var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,r.addCue(t)}}),i.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})):i.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})},function(t){c.logger.log("Failed to parse VTT cue: "+t),i.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})})},r.prototype.onFragDecrypted=function(t){var r=t.payload,n=t.frag;if("subtitle"===n.type){if(!e.isFinite(this.initPTS[n.cc]))return void this.unparsedVttFrags.push(t);this._parseVTTs(n,r)}},r.prototype.onFragParsingUserdata=function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var r=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,r)}},r.prototype.extractCea608Data=function(e){for(var t,r,n,i=31&e[0],a=2,s=[],o=0;o<i;o++)t=e[a++],r=127&e[a++],n=127&e[a++],0===r&&0===n||0!=(4&t)&&0===(3&t)&&(s.push(r),s.push(n));return s},r}(s.default);t.default=f}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/crypt/aes-crypto.js":
/*!*********************************!*\
  !*** ./src/crypt/aes-crypto.js ***!
  \*********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}();t.default=n},"./src/crypt/aes-decryptor.js":
/*!************************************!*\
  !*** ./src/crypt/aes-decryptor.js ***!
  \************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";function n(e){var t=e.byteLength,r=t&&new DataView(e).getUint8(t-1);return r?e.slice(0,t-r):e}Object.defineProperty(t,"__esModule",{value:!0}),t.removePadding=n;var i=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return e.prototype.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=t.getUint32(4*n);return r},e.prototype.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],i=r[1],a=r[2],s=r[3],o=this.invSubMix,l=o[0],u=o[1],c=o[2],d=o[3],h=new Uint32Array(256),f=0,p=0,g=0;for(g=0;g<256;g++)h[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var m=p^p<<1^p<<2^p<<3^p<<4;m=m>>>8^255&m^99,e[f]=m,t[m]=f;var v=h[f],_=h[v],y=h[_],b=257*h[m]^16843008*m;n[f]=b<<24|b>>>8,i[f]=b<<16|b>>>16,a[f]=b<<8|b>>>24,s[f]=b,b=16843009*y^65537*_^257*v^16843008*f,l[m]=b<<24|b>>>8,u[m]=b<<16|b>>>16,c[m]=b<<8|b>>>24,d[m]=b,f?(f=v^h[h[h[y^v]]],p^=h[h[p]]):f=p=1}},e.prototype.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var a,s,o,l,u=this.ksRows=4*(i+6+1),c=this.keySchedule=new Uint32Array(u),d=this.invKeySchedule=new Uint32Array(u),h=this.sBox,f=this.rcon,p=this.invSubMix,g=p[0],m=p[1],v=p[2],_=p[3];for(a=0;a<u;a++)a<i?o=c[a]=t[a]:(l=o,a%i==0?(l=h[(l=l<<8|l>>>24)>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l],l^=f[a/i|0]<<24):i>6&&a%i==4&&(l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l]),c[a]=o=(c[a-i]^l)>>>0);for(s=0;s<u;s++)a=u-s,l=3&s?c[a]:c[a-4],d[s]=s<4||a<=4?l:g[h[l>>>24]]^m[h[l>>>16&255]]^v[h[l>>>8&255]]^_[h[255&l]],d[s]=d[s]>>>0}},e.prototype.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},e.prototype.decrypt=function(e,t,r,i){for(var a,s,o,l,u,c,d,h,f,p,g,m,v,_,y=this.keySize+6,b=this.invKeySchedule,w=this.invSBox,S=this.invSubMix,E=S[0],x=S[1],T=S[2],k=S[3],A=this.uint8ArrayToUint32Array_(r),C=A[0],j=A[1],D=A[2],R=A[3],L=new Int32Array(e),I=new Int32Array(L.length),O=this.networkToHostOrderSwap;t<L.length;){for(f=O(L[t]),p=O(L[t+1]),g=O(L[t+2]),m=O(L[t+3]),u=f^b[0],c=m^b[1],d=g^b[2],h=p^b[3],v=4,_=1;_<y;_++)a=E[u>>>24]^x[c>>16&255]^T[d>>8&255]^k[255&h]^b[v],s=E[c>>>24]^x[d>>16&255]^T[h>>8&255]^k[255&u]^b[v+1],o=E[d>>>24]^x[h>>16&255]^T[u>>8&255]^k[255&c]^b[v+2],l=E[h>>>24]^x[u>>16&255]^T[c>>8&255]^k[255&d]^b[v+3],u=a,c=s,d=o,h=l,v+=4;a=w[u>>>24]<<24^w[c>>16&255]<<16^w[d>>8&255]<<8^w[255&h]^b[v],s=w[c>>>24]<<24^w[d>>16&255]<<16^w[h>>8&255]<<8^w[255&u]^b[v+1],o=w[d>>>24]<<24^w[h>>16&255]<<16^w[u>>8&255]<<8^w[255&c]^b[v+2],l=w[h>>>24]<<24^w[u>>16&255]<<16^w[c>>8&255]<<8^w[255&d]^b[v+3],v+=3,I[t]=O(a^C),I[t+1]=O(l^j),I[t+2]=O(o^D),I[t+3]=O(s^R),C=f,j=p,D=g,R=m,t+=4}return i?n(I.buffer):I.buffer},e.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}();t.default=i},"./src/crypt/decrypter.js":
/*!********************************!*\
  !*** ./src/crypt/decrypter.js ***!
  \********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./aes-crypto */"./src/crypt/aes-crypto.js"),i=r(/*! ./fast-aes-key */"./src/crypt/fast-aes-key.js"),a=r(/*! ./aes-decryptor */"./src/crypt/aes-decryptor.js"),s=r(/*! ../errors */"./src/errors.js"),o=r(/*! ../utils/logger */"./src/utils/logger.js"),l=r(/*! ../events */"./src/events.js"),u=r(/*! ../utils/get-self-scope */"./src/utils/get-self-scope.js").getSelfScope(),c=function(){function e(e,t,r){var n=(void 0===r?{}:r).removePKCS7Padding,i=void 0===n||n;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=i,i)try{var a=u.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}return e.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},e.prototype.decrypt=function(e,t,r,s){var l=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(o.logger.log("JS AES decrypt"),this.logEnabled=!1);var u=this.decryptor;u||(this.decryptor=u=new a.default),u.expandKey(t),s(u.decrypt(e,0,r,this.removePKCS7Padding))}else{this.logEnabled&&(o.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var c=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new i.default(c,t)),this.fastAesKey.expandKey().then(function(i){new n.default(c,r).decrypt(e,i).catch(function(n){l.onWebCryptoError(n,e,t,r,s)}).then(function(e){s(e)})}).catch(function(n){l.onWebCryptoError(n,e,t,r,s)})}},e.prototype.onWebCryptoError=function(e,t,r,n,i){this.config.enableSoftwareAES?(o.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,n,i)):(o.logger.error("decrypting error : "+e.message),this.observer.trigger(l.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},e.prototype.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.default=c},"./src/crypt/fast-aes-key.js":
/*!***********************************!*\
  !*** ./src/crypt/fast-aes-key.js ***!
  \***********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}();t.default=n},"./src/demux/aacdemuxer.js":
/*!*********************************!*\
  !*** ./src/demux/aacdemuxer.js ***!
  \*********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./adts */"./src/demux/adts.js"),i=r(/*! ../utils/logger */"./src/utils/logger.js"),a=r(/*! ../demux/id3 */"./src/demux/id3.js"),s=function(){function t(e,t,r){this.observer=e,this.config=r,this.remuxer=t}return t.prototype.resetInitSegment=function(e,t,r,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},t.prototype.resetTimeStamp=function(){},t.probe=function(e){if(!e)return!1;for(var t=(a.default.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(n.probe(e,t))return i.logger.log("ADTS sync word found !"),!0;return!1},t.prototype.append=function(t,r,s,o){for(var l=this._audioTrack,u=a.default.getID3Data(t,0)||[],c=a.default.getTimeStamp(u),d=e.isFinite(c)?90*c:9e4*r,h=0,f=d,p=t.length,g=u.length,m=[{pts:f,dts:f,data:u}];g<p-1;)if(n.isHeader(t,g)&&g+5<p){n.initTrackConfig(l,this.observer,t,g,l.manifestCodec);var v=n.appendFrame(l,t,g,d,h);if(!v){i.logger.log("Unable to parse AAC frame");break}g+=v.length,f=v.sample.pts,h++}else a.default.isHeader(t,g)?(u=a.default.getID3Data(t,g),m.push({pts:f,dts:f,data:u}),g+=u.length):g++;this.remuxer.remux(l,{samples:[]},{samples:m,inputTimeScale:9e4},{samples:[]},r,s,o)},t.prototype.destroy=function(){},t}();t.default=s}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/demux/adts.js":
/*!***************************!*\
  !*** ./src/demux/adts.js ***!
  \***************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../utils/logger */"./src/utils/logger.js"),i=r(/*! ../errors */"./src/errors.js"),a=r(/*! ../events */"./src/events.js");function s(e,t,r,s){var o,l,u,c,d,h=navigator.userAgent.toLowerCase(),f=s,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(o=1+((192&t[r+2])>>>6),!((l=(60&t[r+2])>>>2)>p.length-1))return c=(1&t[r+2])<<2,c|=(192&t[r+3])>>>6,n.logger.log("manifest codec:"+s+",ADTS data:type:"+o+",sampleingIndex:"+l+"["+p[l]+"Hz],channelConfig:"+c),/firefox/i.test(h)?l>=6?(o=5,d=new Array(4),u=l-3):(o=2,d=new Array(2),u=l):-1!==h.indexOf("android")?(o=2,d=new Array(2),u=l):(o=5,d=new Array(4),s&&(-1!==s.indexOf("mp4a.40.29")||-1!==s.indexOf("mp4a.40.5"))||!s&&l>=6?u=l-3:((s&&-1!==s.indexOf("mp4a.40.2")&&(l>=6&&1===c||/vivaldi/i.test(h))||!s&&1===c)&&(o=2,d=new Array(2)),u=l)),d[0]=o<<3,d[0]|=(14&l)>>1,d[1]|=(1&l)<<7,d[1]|=c<<3,5===o&&(d[1]|=(14&u)>>1,d[2]=(1&u)<<7,d[2]|=8,d[3]=0),{config:d,samplerate:p[l],channelCount:c,codec:"mp4a.40."+o,manifestCodec:f};e.trigger(a.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+l})}function o(e,t){return 255===e[t]&&240==(246&e[t+1])}function l(e,t){return 1&e[t+1]?7:9}function u(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function c(e){return 9216e4/e}function d(e,t,r,n,i){var a,s,o=e.length;if(a=l(e,t),s=u(e,t),(s-=a)>0&&t+a+s<=o)return{headerLength:a,frameLength:s,stamp:r+n*i}}t.getAudioConfig=s,t.isHeaderPattern=o,t.getHeaderLength=l,t.getFullFrameLength=u,t.isHeader=function(e,t){return!!(t+1<e.length&&o(e,t))},t.probe=function(e,t){if(t+1<e.length&&o(e,t)){var r=l(e,t);t+5<e.length&&(r=u(e,t));var n=t+r;if(n===e.length||n+1<e.length&&o(e,n))return!0}return!1},t.initTrackConfig=function(e,t,r,i,a){if(!e.samplerate){var o=s(t,r,i,a);e.config=o.config,e.samplerate=o.samplerate,e.channelCount=o.channelCount,e.codec=o.codec,e.manifestCodec=o.manifestCodec,n.logger.log("parsed codec:"+e.codec+",rate:"+o.samplerate+",nb channel:"+o.channelCount)}},t.getFrameDuration=c,t.parseFrameHeader=d,t.appendFrame=function(e,t,r,n,i){var a=d(t,r,n,i,c(e.samplerate));if(a){var s=a.stamp,o=a.headerLength,l=a.frameLength,u={unit:t.subarray(r+o,r+o+l),pts:s,dts:s};return e.samples.push(u),e.len+=l,{sample:u,length:l+o}}}},"./src/demux/demuxer-inline.js":
/*!*************************************!*\
  !*** ./src/demux/demuxer-inline.js ***!
  \*************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(/*! ../events */"./src/events.js"),a=r(/*! ../errors */"./src/errors.js"),s=r(/*! ../crypt/decrypter */"./src/crypt/decrypter.js"),o=r(/*! ../demux/aacdemuxer */"./src/demux/aacdemuxer.js"),l=r(/*! ../demux/mp4demuxer */"./src/demux/mp4demuxer.js"),u=r(/*! ../demux/tsdemuxer */"./src/demux/tsdemuxer.js"),c=r(/*! ../demux/mp3demuxer */"./src/demux/mp3demuxer.js"),d=r(/*! ../remux/mp4-remuxer */"./src/remux/mp4-remuxer.js"),h=r(/*! ../remux/passthrough-remuxer */"./src/remux/passthrough-remuxer.js"),f=r(/*! ../utils/get-self-scope */"./src/utils/get-self-scope.js"),p=r(/*! ../utils/logger */"./src/utils/logger.js"),g=f.getSelfScope();try{n=g.performance.now.bind(g.performance)}catch(e){p.logger.debug("Unable to use Performance API on this environment"),n=g.Date.now}var m=function(){function e(e,t,r,n){this.observer=e,this.typeSupported=t,this.config=r,this.vendor=n}return e.prototype.destroy=function(){var e=this.demuxer;e&&e.destroy()},e.prototype.push=function(e,t,r,a,o,l,u,c,d,h,f,p){var g=this;if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var m=this.decrypter;null==m&&(m=this.decrypter=new s.default(this.observer,this.config));var v=n();m.decrypt(e,t.key.buffer,t.iv.buffer,function(e){var s=n();g.observer.trigger(i.default.FRAG_DECRYPTED,{stats:{tstart:v,tdecrypt:s}}),g.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),a,o,l,u,c,d,h,f,p)})}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),a,o,l,u,c,d,h,f,p)},e.prototype.pushDecrypted=function(e,t,r,n,s,f,p,g,m,v,_,y){var b=this.demuxer;if(!b||(p||g)&&!this.probe(e)){for(var w=this.observer,S=this.typeSupported,E=this.config,x=[{demux:u.default,remux:d.default},{demux:l.default,remux:h.default},{demux:o.default,remux:d.default},{demux:c.default,remux:d.default}],T=0,k=x.length;T<k;T++){var A=x[T],C=A.demux.probe;if(C(e)){var j=this.remuxer=new A.remux(w,E,S,this.vendor);b=new A.demux(w,j,E,S),this.probe=C;break}}if(!b)return void w.trigger(i.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=b}var D=this.remuxer;(p||g)&&(b.resetInitSegment(r,n,s,v),D.resetInitSegment()),p&&(b.resetTimeStamp(y),D.resetTimeStamp(y)),"function"==typeof b.setDecryptData&&b.setDecryptData(t),b.append(e,f,m,_)},e}();t.default=m},"./src/demux/demuxer-worker.js":
/*!*************************************!*\
  !*** ./src/demux/demuxer-worker.js ***!
  \*************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../demux/demuxer-inline */"./src/demux/demuxer-inline.js"),i=r(/*! ../events */"./src/events.js"),a=r(/*! ../utils/logger */"./src/utils/logger.js"),s=r(/*! events */"./node_modules/node-libs-browser/node_modules/events/events.js");t.default=function(e){var t=new s.EventEmitter;t.trigger=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];t.emit.apply(t,[e,e].concat(r))},t.off=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];t.removeListener.apply(t,[e].concat(r))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",function(i){var s=i.data;switch(s.cmd){case"init":var o=JSON.parse(s.config);e.demuxer=new n.default(t,s.typeSupported,o,s.vendor),a.enableLogs(o.debug),r("init",null);break;case"demux":e.demuxer.push(s.data,s.decryptdata,s.initSegment,s.audioCodec,s.videoCodec,s.timeOffset,s.discontinuity,s.trackSwitch,s.contiguous,s.duration,s.accurateTimeOffset,s.defaultInitPTS)}}),t.on(i.default.FRAG_DECRYPTED,r),t.on(i.default.FRAG_PARSING_INIT_SEGMENT,r),t.on(i.default.FRAG_PARSED,r),t.on(i.default.ERROR,r),t.on(i.default.FRAG_PARSING_METADATA,r),t.on(i.default.FRAG_PARSING_USERDATA,r),t.on(i.default.INIT_PTS_FOUND,r),t.on(i.default.FRAG_PARSING_DATA,function(t,r){var n=[],i={event:t,data:r};r.data1&&(i.data1=r.data1.buffer,n.push(r.data1.buffer),delete r.data1),r.data2&&(i.data2=r.data2.buffer,n.push(r.data2.buffer),delete r.data2),e.postMessage(i,n)})}},"./src/demux/demuxer.js":
/*!******************************!*\
  !*** ./src/demux/demuxer.js ***!
  \******************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! webworkify-webpack */"./node_modules/webworkify-webpack/index.js"),i=r(/*! ../events */"./src/events.js"),a=r(/*! ../demux/demuxer-inline */"./src/demux/demuxer-inline.js"),s=r(/*! ../utils/logger */"./src/utils/logger.js"),o=r(/*! ../errors */"./src/errors.js"),l=r(/*! ../utils/mediasource-helper */"./src/utils/mediasource-helper.js"),u=r(/*! ../utils/get-self-scope */"./src/utils/get-self-scope.js"),c=r(/*! ../observer */"./src/observer.js"),d=u.getSelfScope(),h=l.getMediaSource(),f=function(){function t(e,t){var r=this;this.hls=e,this.id=t;var l=this.observer=new c.Observer,u=e.config,f=function(t,n){(n=n||{}).frag=r.frag,n.id=r.id,e.trigger(t,n)};l.on(i.default.FRAG_DECRYPTED,f),l.on(i.default.FRAG_PARSING_INIT_SEGMENT,f),l.on(i.default.FRAG_PARSING_DATA,f),l.on(i.default.FRAG_PARSED,f),l.on(i.default.ERROR,f),l.on(i.default.FRAG_PARSING_METADATA,f),l.on(i.default.FRAG_PARSING_USERDATA,f),l.on(i.default.INIT_PTS_FOUND,f);var p={mp4:h.isTypeSupported("video/mp4"),mpeg:h.isTypeSupported("audio/mpeg"),mp3:h.isTypeSupported('audio/mp4; codecs="mp3"')},g=navigator.vendor;if(u.enableWorker&&"undefined"!=typeof Worker){s.logger.log("demuxing in webworker");var m=void 0;try{m=this.w=n(/*! ../demux/demuxer-worker.js */"./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),m.addEventListener("message",this.onwmsg),m.onerror=function(t){e.trigger(i.default.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},m.postMessage({cmd:"init",typeSupported:p,vendor:g,id:t,config:JSON.stringify(u)})}catch(e){s.logger.warn("Error in worker:",e),s.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),m&&d.URL.revokeObjectURL(m.objectURL),this.demuxer=new a.default(l,p,u,g),this.w=void 0}}else this.demuxer=new a.default(l,p,u,g)}return t.prototype.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},t.prototype.push=function(t,r,n,i,a,o,l,u){var c=this.w,d=e.isFinite(a.startPTS)?a.startPTS:a.start,h=a.decryptdata,f=this.frag,p=!(f&&a.cc===f.cc),g=!(f&&a.level===f.level),m=f&&a.sn===f.sn+1,v=!g&&m;if(p&&s.logger.log(this.id+":discontinuity detected"),g&&s.logger.log(this.id+":switch detected"),this.frag=a,c)c.postMessage({cmd:"demux",data:t,decryptdata:h,initSegment:r,audioCodec:n,videoCodec:i,timeOffset:d,discontinuity:p,trackSwitch:g,contiguous:v,duration:o,accurateTimeOffset:l,defaultInitPTS:u},t instanceof ArrayBuffer?[t]:[]);else{var _=this.demuxer;_&&_.push(t,h,r,n,i,d,p,g,v,o,l,u)}},t.prototype.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":d.URL.revokeObjectURL(this.w.objectURL);break;case i.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},t}();t.default=f}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/demux/exp-golomb.js":
/*!*********************************!*\
  !*** ./src/demux/exp-golomb.js ***!
  \*********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../utils/logger */"./src/utils/logger.js"),i=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}return e.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");n.set(e.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},e.prototype.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},e.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&n.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},e.prototype.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},e.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},e.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},e.prototype.readBoolean=function(){return 1===this.readBits(1)},e.prototype.readUByte=function(){return this.readBits(8)},e.prototype.readUShort=function(){return this.readBits(16)},e.prototype.readUInt=function(){return this.readBits(32)},e.prototype.skipScalingList=function(e){var t,r=8,n=8;for(t=0;t<e;t++)0!==n&&(n=(r+this.readEG()+256)%256),r=0===n?r:n},e.prototype.readSPS=function(){var e,t,r,n,i,a,s,o=0,l=0,u=0,c=0,d=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),m=this.skipEG.bind(this),v=this.skipUEG.bind(this),_=this.skipScalingList.bind(this);if(d(),e=d(),h(5),g(3),d(),v(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var y=f();if(3===y&&g(1),v(),v(),g(1),p())for(a=3!==y?8:12,s=0;s<a;s++)p()&&_(s<6?16:64)}v();var b=f();if(0===b)f();else if(1===b)for(g(1),m(),m(),t=f(),s=0;s<t;s++)m();v(),g(1),r=f(),n=f(),0===(i=h(1))&&g(1),g(1),p()&&(o=f(),l=f(),u=f(),c=f());var w=[1,1];if(p()&&p())switch(d()){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:w=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(r+1)-2*o-2*l),height:(2-i)*(n+1)*16-(i?2:4)*(u+c),pixelRatio:w}},e.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}();t.default=i},"./src/demux/id3.js":
/*!**************************!*\
  !*** ./src/demux/id3.js ***!
  \**************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,r){for(var n=r,i=0;e.isHeader(t,r);){i+=10,i+=e._readSize(t,r+6),e.isFooter(t,r+10)&&(i+=10),r+=i}if(i>0)return t.subarray(n,n+i)},e._readSize=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]},e.getTimeStamp=function(t){for(var r=e.getID3Frames(t),n=0;n<r.length;n++){var i=r[n];if(e.isTimeStampFrame(i))return e._readTimeStamp(i)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),n=e._readSize(t,4);return{type:r,size:n,data:t.subarray(10,10+n)}},e.getID3Frames=function(t){for(var r=0,n=[];e.isHeader(t,r);){for(var i=e._readSize(t,r+6),a=(r+=10)+i;r+8<a;){var s=e._getFrameData(t.subarray(r)),o=e._decodeFrame(s);o&&n.push(o),r+=s.size+10}e.isFooter(t,r)&&(r+=10)}return n},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var r=e._utf8ArrayToStr(t.data,!0),n=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:n.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var r=1,n=e._utf8ArrayToStr(t.data.subarray(r));r+=n.length+1;var i=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:i}}var a=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:a}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var r=1,n=e._utf8ArrayToStr(t.data.subarray(r));r+=n.length+1;var i=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:i}}var a=e._utf8ArrayToStr(t.data);return{key:t.type,data:a}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);for(var r,n,i,a=e.length,s="",o=0;o<a;){if(0===(r=e[o++])&&t)return s;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:s+=String.fromCharCode(r);break;case 12:case 13:n=e[o++],s+=String.fromCharCode((31&r)<<6|63&n);break;case 14:n=e[o++],i=e[o++],s+=String.fromCharCode((15&r)<<12|(63&n)<<6|(63&i)<<0)}}return s},e}(),i=n._utf8ArrayToStr;t.utf8ArrayToStr=i,t.default=n},"./src/demux/mp3demuxer.js":
/*!*********************************!*\
  !*** ./src/demux/mp3demuxer.js ***!
  \*********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../demux/id3 */"./src/demux/id3.js"),i=r(/*! ../utils/logger */"./src/utils/logger.js"),a=r(/*! ./mpegaudio */"./src/demux/mpegaudio.js"),s=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}return e.prototype.resetInitSegment=function(e,t,r,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},e.prototype.resetTimeStamp=function(){},e.probe=function(e){var t,r,s=n.default.getID3Data(e,0);if(s&&void 0!==n.default.getTimeStamp(s))for(t=s.length,r=Math.min(e.length-1,t+100);t<r;t++)if(a.default.probe(e,t))return i.logger.log("MPEG Audio sync word found !"),!0;return!1},e.prototype.append=function(e,t,r,i){for(var s=n.default.getID3Data(e,0),o=n.default.getTimeStamp(s),l=o?90*o:9e4*t,u=s.length,c=e.length,d=0,h=0,f=this._audioTrack,p=[{pts:l,dts:l,data:s}];u<c;)if(a.default.isHeader(e,u)){var g=a.default.appendFrame(f,e,u,l,d);if(!g)break;u+=g.length,h=g.sample.pts,d++}else n.default.isHeader(e,u)?(s=n.default.getID3Data(e,u),p.push({pts:h,dts:h,data:s}),u+=s.length):u++;this.remuxer.remux(f,{samples:[]},{samples:p,inputTimeScale:9e4},{samples:[]},t,r,i)},e.prototype.destroy=function(){},e}();t.default=s},"./src/demux/mp4demuxer.js":
/*!*********************************!*\
  !*** ./src/demux/mp4demuxer.js ***!
  \*********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../utils/logger */"./src/utils/logger.js"),i=r(/*! ../events */"./src/events.js"),a=Math.pow(2,32)-1,s=function(){function e(e,t){this.observer=e,this.remuxer=t}return e.prototype.resetTimeStamp=function(e){this.initPTS=e},e.prototype.resetInitSegment=function(t,r,n,a){if(t&&t.byteLength){var s=this.initData=e.parseInitSegment(t);null==r&&(r="mp4a.40.5"),null==n&&(n="avc1.42e01e");var o={};s.audio&&s.video?o.audiovideo={container:"video/mp4",codec:r+","+n,initSegment:a?t:null}:(s.audio&&(o.audio={container:"audio/mp4",codec:r,initSegment:a?t:null}),s.video&&(o.video={container:"video/mp4",codec:n,initSegment:a?t:null})),this.observer.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,{tracks:o})}else r&&(this.audioCodec=r),n&&(this.videoCodec=n)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<8|e[t+1];return r<0?65536+r:r},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r},e.writeUint32=function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},e.findBox=function(t,r){var n,i,a,s,o,l,u=[];if(t.data?(o=t.start,a=t.end,t=t.data):(o=0,a=t.byteLength),!r.length)return null;for(n=o;n<a;)l=(i=e.readUint32(t,n))>1?n+i:a,e.bin2str(t.subarray(n+4,n+8))===r[0]&&(1===r.length?u.push({data:t,start:n+8,end:l}):(s=e.findBox({data:t,start:n+8,end:l},r.slice(1))).length&&(u=u.concat(s))),n=l;return u},e.parseSegmentIndex=function(t){var r,n=e.findBox(t,["moov"])[0],i=n?n.end:null,a=0,s=e.findBox(t,["sidx"]);if(!s||!s[0])return null;r=[];var o=(s=s[0]).data[0];a=0===o?8:16;var l=e.readUint32(s,a);a+=4;a+=0===o?8:16,a+=2;var u=s.end+0,c=e.readUint16(s,a);a+=2;for(var d=0;d<c;d++){var h=a,f=e.readUint32(s,h);h+=4;var p=2147483647&f;if(1===(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var g=e.readUint32(s,h);h+=4,r.push({referenceSize:p,subsegmentDuration:g,info:{duration:g/l,start:u,end:u+p-1}}),u+=p,a=h+=4}return{earliestPresentationTime:0,timescale:l,version:o,referencesCount:c,references:r,moovEndOffset:i}},e.parseInitSegment=function(t){var r=[];return e.findBox(t,["moov","trak"]).forEach(function(t){var i=e.findBox(t,["tkhd"])[0];if(i){var a=i.data[i.start],s=0===a?12:20,o=e.readUint32(i,s),l=e.findBox(t,["mdia","mdhd"])[0];if(l){s=0===(a=l.data[l.start])?12:20;var u=e.readUint32(l,s),c=e.findBox(t,["mdia","hdlr"])[0];if(c){var d={soun:"audio",vide:"video"}[e.bin2str(c.data.subarray(c.start+8,c.start+12))];if(d){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){h=h[0];var f=e.bin2str(h.data.subarray(h.start+12,h.start+16));n.logger.log("MP4Demuxer:"+d+":"+f+" found")}r[o]={timescale:u,type:d},r[d]={timescale:u,id:o}}}}}}),r},e.getStartDTS=function(t,r){var n,i,a;return n=e.findBox(r,["moof","traf"]),i=[].concat.apply([],n.map(function(r){return e.findBox(r,["tfhd"]).map(function(n){var i,a;return i=e.readUint32(n,4),a=t[i].timescale||9e4,e.findBox(r,["tfdt"]).map(function(t){var r,n;return r=t.data[t.start],n=e.readUint32(t,4),1===r&&(n*=Math.pow(2,32),n+=e.readUint32(t,8)),n})[0]/a})})),a=Math.min.apply(null,i),isFinite(a)?a:0},e.offsetStartDTS=function(t,r,n){e.findBox(r,["moof","traf"]).map(function(r){return e.findBox(r,["tfhd"]).map(function(i){var s=e.readUint32(i,4),o=t[s].timescale||9e4;e.findBox(r,["tfdt"]).map(function(t){var r=t.data[t.start],i=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,i-n*o);else{i*=Math.pow(2,32),i+=e.readUint32(t,8),i-=n*o,i=Math.max(i,0);var s=Math.floor(i/(a+1)),l=Math.floor(i%(a+1));e.writeUint32(t,4,s),e.writeUint32(t,8,l)}})})})},e.prototype.append=function(t,r,n,a){var s=this.initData;s||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),s=this.initData);var o,l=this.initPTS;if(void 0===l){var u=e.getStartDTS(s,t);this.initPTS=l=u-r,this.observer.trigger(i.default.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(s,t,l),o=e.getStartDTS(s,t),this.remuxer.remux(s.audio,s.video,null,null,o,n,a,t)},e.prototype.destroy=function(){},e}();t.default=s},"./src/demux/mpegaudio.js":
/*!********************************!*\
  !*** ./src/demux/mpegaudio.js ***!
  \********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,r,n,i){if(!(r+24>t.length)){var a=this.parseHeader(t,r);if(a&&r+a.frameLength<=t.length){var s=n+i*(9e4*a.samplesPerFrame/a.sampleRate),o={unit:t.subarray(r,r+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(o),e.len+=a.frameLength,{sample:o,length:a.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,i=e[t+1]>>1&3,a=e[t+2]>>4&15,s=e[t+2]>>2&3,o=e[t+2]>>1&1;if(1!==r&&0!==a&&15!==a&&3!==s){var l=3===r?3-i:3===i?3:4,u=1e3*n.BitratesMap[14*l+a-1],c=3===r?0:2===r?1:2,d=n.SamplingRateMap[3*c+s],h=e[t+3]>>6==3?1:2,f=n.SamplesCoefficients[r][i],p=n.BytesInSlot[i],g=8*f*p;return{sampleRate:d,channelCount:h,frameLength:parseInt(f*u/d+o,10)*p,samplesPerFrame:g}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),n=4;r&&r.frameLength&&(n=r.frameLength);var i=t+n;if(i===e.length||i+1<e.length&&this.isHeaderPattern(e,i))return!0}return!1}};t.default=n},"./src/demux/sample-aes.js":
/*!*********************************!*\
  !*** ./src/demux/sample-aes.js ***!
  \*********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../crypt/decrypter */"./src/crypt/decrypter.js"),i=function(){function e(e,t,r,i){this.decryptdata=r,this.discardEPB=i,this.decrypter=new n.default(e,t,{removePKCS7Padding:!1})}return e.prototype.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},e.prototype.decryptAacSample=function(e,t,r,n){var i=e[t].unit,a=i.subarray(16,i.length-i.length%16),s=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),o=this;this.decryptBuffer(s,function(a){a=new Uint8Array(a),i.set(a,16),n||o.decryptAacSamples(e,t+1,r)})},e.prototype.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,n),!n)return}}},e.prototype.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),n=0,i=32;i<=e.length-16;i+=160,n+=16)r.set(e.subarray(i,i+16),n);return r},e.prototype.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var r=0,n=32;n<=e.length-16;n+=160,r+=16)e.set(t.subarray(r,r+16),n);return e},e.prototype.decryptAvcSample=function(e,t,r,n,i,a){var s=this.discardEPB(i.data),o=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(o.buffer,function(o){i.data=l.getAvcDecryptedUnit(s,o),a||l.decryptAvcSamples(e,t,r+1,n)})},e.prototype.decryptAvcSamples=function(e,t,r,n){for(;;t++,r=0){if(t>=e.length)return void n();for(var i=e[t].units;!(r>=i.length);r++){var a=i[r];if(!(a.length<=48||1!==a.type&&5!==a.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,n,a,s),!s)return}}}},e}();t.default=i},"./src/demux/tsdemuxer.js":
/*!********************************!*\
  !*** ./src/demux/tsdemuxer.js ***!
  \********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./adts */"./src/demux/adts.js"),i=r(/*! ./mpegaudio */"./src/demux/mpegaudio.js"),a=r(/*! ../events */"./src/events.js"),s=r(/*! ./exp-golomb */"./src/demux/exp-golomb.js"),o=r(/*! ./sample-aes */"./src/demux/sample-aes.js"),l=r(/*! ../utils/logger */"./src/utils/logger.js"),u=r(/*! ../errors */"./src/errors.js"),c={video:1,audio:2,id3:3,text:4},d=function(){function e(e,t,r,n){this.observer=e,this.config=r,this.typeSupported=n,this.remuxer=t,this.sampleAes=null}return e.prototype.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new o.default(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var r=e._syncOffset(t);return!(r<0)&&(r&&l.logger.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),!0)},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),r=0;r<t;){if(71===e[r]&&71===e[r+188]&&71===e[r+376])return r;r++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:c[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},e.prototype.resetInitSegment=function(t,r,n,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video",i),this._audioTrack=e.createTrack("audio",i),this._id3Track=e.createTrack("id3",i),this._txtTrack=e.createTrack("text",i),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=n,this._duration=i},e.prototype.resetTimeStamp=function(){},e.prototype.append=function(t,r,n,i){var s,o,c,d,h,f=t.length,p=!1;this.contiguous=n;var g=this.pmtParsed,m=this._avcTrack,v=this._audioTrack,_=this._id3Track,y=m.pid,b=v.pid,w=_.pid,S=this._pmtId,E=m.pesData,x=v.pesData,T=_.pesData,k=this._parsePAT,A=this._parsePMT,C=this._parsePES,j=this._parseAVCPES.bind(this),D=this._parseAACPES.bind(this),R=this._parseMPEGPES.bind(this),L=this._parseID3PES.bind(this),I=e._syncOffset(t);for(f-=(f+I)%188,s=I;s<f;s+=188)if(71===t[s]){if(o=!!(64&t[s+1]),c=((31&t[s+1])<<8)+t[s+2],(48&t[s+3])>>4>1){if((d=s+5+t[s+4])===s+188)continue}else d=s+4;switch(c){case y:o&&(E&&(h=C(E))&&void 0!==h.pts&&j(h,!1),E={data:[],size:0}),E&&(E.data.push(t.subarray(d,s+188)),E.size+=s+188-d);break;case b:o&&(x&&(h=C(x))&&void 0!==h.pts&&(v.isAAC?D(h):R(h)),x={data:[],size:0}),x&&(x.data.push(t.subarray(d,s+188)),x.size+=s+188-d);break;case w:o&&(T&&(h=C(T))&&void 0!==h.pts&&L(h),T={data:[],size:0}),T&&(T.data.push(t.subarray(d,s+188)),T.size+=s+188-d);break;case 0:o&&(d+=t[d]+1),S=this._pmtId=k(t,d);break;case S:o&&(d+=t[d]+1);var O=A(t,d,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(y=O.avc)>0&&(m.pid=y),(b=O.audio)>0&&(v.pid=b,v.isAAC=O.isAAC),(w=O.id3)>0&&(_.pid=w),p&&!g&&(l.logger.log("reparse from beginning"),p=!1,s=I-188),g=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(a.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});E&&(h=C(E))&&void 0!==h.pts?(j(h,!0),m.pesData=null):m.pesData=E,x&&(h=C(x))&&void 0!==h.pts?(v.isAAC?D(h):R(h),v.pesData=null):(x&&x.size&&l.logger.log("last AAC PES packet truncated,might overlap between fragments"),v.pesData=x),T&&(h=C(T))&&void 0!==h.pts?(L(h),_.pesData=null):_.pesData=T,null==this.sampleAes?this.remuxer.remux(v,m,_,this._txtTrack,r,n,i):this.decryptAndRemux(v,m,_,this._txtTrack,r,n,i)},e.prototype.decryptAndRemux=function(e,t,r,n,i,a,s){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){o.decryptAndRemuxAvc(e,t,r,n,i,a,s)})}else this.decryptAndRemuxAvc(e,t,r,n,i,a,s)},e.prototype.decryptAndRemuxAvc=function(e,t,r,n,i,a,s){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){o.remuxer.remux(e,t,r,n,i,a,s)})}else this.remuxer.remux(e,t,r,n,i,a,s)},e.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},e.prototype._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},e.prototype._parsePMT=function(e,t,r,n){var i,a,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(i=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<i;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!n){l.logger.log("unkown stream type:"+e[t]);break}case 15:-1===s.audio&&(s.audio=a);break;case 21:-1===s.id3&&(s.id3=a);break;case 219:if(!n){l.logger.log("unkown stream type:"+e[t]);break}case 27:-1===s.avc&&(s.avc=a);break;case 3:case 4:r?-1===s.audio&&(s.audio=a,s.isAAC=!1):l.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:l.logger.warn("HEVC stream type found, not supported for now");break;default:l.logger.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return s},e.prototype._parsePES=function(e){var t,r,n,i,a,s,o,u,c=0,d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;){var h=new Uint8Array(d[0].length+d[1].length);h.set(d[0]),h.set(d[1],d[0].length),d[0]=h,d.splice(1,1)}if(1===((t=d[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;192&(r=t[7])&&((s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(s-=8589934592),64&r?((o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(o-=8589934592),s-o>54e5&&(l.logger.warn(Math.round((s-o)/9e4)+"s delta between PTS and DTS, align them"),s=o)):o=s),u=(i=t[8])+9,e.size-=u,a=new Uint8Array(e.size);for(var f=0,p=d.length;f<p;f++){var g=(t=d[f]).byteLength;if(u){if(u>g){u-=g;continue}t=t.subarray(u),g-=u,u=0}a.set(t,c),c+=g}return n&&(n-=i+3),{data:a,pts:s,dts:o,len:n}}return null},e.prototype.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var r=t.samples,n=r.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(n||this.contiguous)?(e.id=n,r.push(e)):t.dropped++}e.debug.length&&l.logger.log(e.pts+"/"+e.dts+":"+e.debug)},e.prototype._parseAVCPES=function(e,t){var r,n,i,a=this,o=this._avcTrack,l=this._parseAVCNALu(e.data),u=this.avcSample,c=!1,d=this.pushAccesUnit.bind(this),h=function(e,t,r,n){return{key:e,pts:t,dts:r,units:[],debug:n}};e.data=null,u&&l.length&&!o.audFound&&(d(u,o),u=this.avcSample=h(!1,e.pts,e.dts,"")),l.forEach(function(t){switch(t.type){case 1:n=!0,u||(u=a.avcSample=h(!0,e.pts,e.dts,"")),u.frame=!0;var l=t.data;if(c&&l.length>4){var f=new s.default(l).readSliceType();2!==f&&4!==f&&7!==f&&9!==f||(u.key=!0)}break;case 5:n=!0,u||(u=a.avcSample=h(!0,e.pts,e.dts,"")),u.key=!0,u.frame=!0;break;case 6:n=!0,(r=new s.default(a.discardEPB(t.data))).readUByte();for(var p=0,g=0,m=!1,v=0;!m&&r.bytesAvailable>1;){p=0;do{p+=v=r.readUByte()}while(255===v);g=0;do{g+=v=r.readUByte()}while(255===v);if(4===p&&0!==r.bytesAvailable){if(m=!0,181===r.readUByte())if(49===r.readUShort())if(1195456820===r.readUInt())if(3===r.readUByte()){var _=r.readUByte(),y=31&_,b=[_,r.readUByte()];for(i=0;i<y;i++)b.push(r.readUByte()),b.push(r.readUByte()),b.push(r.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:e.pts,bytes:b})}}else if(g<r.bytesAvailable)for(i=0;i<g;i++)r.readUByte()}break;case 7:if(n=!0,c=!0,!o.sps){var w=(r=new s.default(t.data)).readSPS();o.width=w.width,o.height=w.height,o.pixelRatio=w.pixelRatio,o.sps=[t.data],o.duration=a._duration;var S=t.data.subarray(1,4),E="avc1.";for(i=0;i<3;i++){var x=S[i].toString(16);x.length<2&&(x="0"+x),E+=x}o.codec=E}break;case 8:n=!0,o.pps||(o.pps=[t.data]);break;case 9:n=!1,o.audFound=!0,u&&d(u,o),u=a.avcSample=h(!1,e.pts,e.dts,"");break;case 12:n=!1;break;default:n=!1,u&&(u.debug+="unknown NAL "+t.type+" ")}u&&n&&u.units.push(t)}),t&&u&&(d(u,o),this.avcSample=null)},e.prototype._insertSampleInOrder=function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var n=r-1;n>=0;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)},e.prototype._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var r=this._avcTrack.samples;t=r[r.length-1]}if(t){var n=t.units;e=n[n.length-1]}return e},e.prototype._parseAVCNALu=function(e){var t,r,n,i,a=0,s=e.byteLength,o=this._avcTrack,l=o.naluState||0,u=l,c=[],d=-1;for(-1===l&&(d=0,i=31&e[0],l=0,a=1);a<s;)if(t=e[a++],l)if(1!==l)if(t)if(1===t){var h,f;if(d>=0)n={data:e.subarray(d,a-l-1),type:i},c.push(n);else if(h=this._getLastNalUnit())if(u&&a<=4-u&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-u)),(r=a-l-1)>0)(f=new Uint8Array(h.data.byteLength+r)).set(h.data,0),f.set(e.subarray(0,r),h.data.byteLength),h.data=f;a<s?(d=a,i=31&e[a],l=0):l=-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;(d>=0&&l>=0&&(n={data:e.subarray(d,s),type:i,state:l},c.push(n)),0===c.length)&&((h=this._getLastNalUnit())&&((f=new Uint8Array(h.data.byteLength+e.byteLength)).set(h.data,0),f.set(e,h.data.byteLength),h.data=f));return o.naluState=l,c},e.prototype.discardEPB=function(e){for(var t,r,n=e.byteLength,i=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=n-i.length,r=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===i[0]&&(s++,i.shift()),r[a]=e[s];return r},e.prototype._parseAACPES=function(e){var t,r,i,s,o,c=this._audioTrack,d=e.data,h=e.pts,f=this.aacOverFlow,p=this.aacLastPTS;if(f){var g=new Uint8Array(f.byteLength+d.byteLength);g.set(f,0),g.set(d,f.byteLength),d=g}for(i=0,o=d.length;i<o-1&&!n.isHeader(d,i);i++);if(i){var m=void 0,v=void 0;if(i<o-1?(m="AAC PES did not start with ADTS header,offset:"+i,v=!1):(m="no ADTS header found in AAC PES",v=!0),l.logger.warn("parsing error:"+m),this.observer.trigger(a.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_PARSING_ERROR,fatal:v,reason:m}),v)return}if(n.initTrackConfig(c,this.observer,d,i,this.audioCodec),r=0,t=n.getFrameDuration(c.samplerate),f&&p){var _=p+t;Math.abs(_-h)>1&&(l.logger.log("AAC: align PTS for overlapping frames by "+Math.round((_-h)/90)),h=_)}for(;i<o;)if(n.isHeader(d,i)&&i+5<o){var y=n.appendFrame(c,d,i,h,r);if(!y)break;i+=y.length,s=y.sample.pts,r++}else i++;f=i<o?d.subarray(i,o):null,this.aacOverFlow=f,this.aacLastPTS=s},e.prototype._parseMPEGPES=function(e){for(var t=e.data,r=t.length,n=0,a=0,s=e.pts;a<r;)if(i.default.isHeader(t,a)){var o=i.default.appendFrame(this._audioTrack,t,a,s,n);if(!o)break;a+=o.length,n++}else a++},e.prototype._parseID3PES=function(e){this._id3Track.samples.push(e)},e}();t.default=d},"./src/errors.js":
/*!***********************!*\
  !*** ./src/errors.js ***!
  \***********************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},t.ErrorDetails={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},"./src/event-handler.js":
/*!******************************!*\
  !*** ./src/event-handler.js ***!
  \******************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./utils/logger */"./src/utils/logger.js"),i=r(/*! ./errors */"./src/errors.js"),a=r(/*! ./events */"./src/events.js"),s={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},o=function(){function e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.hls=e,this.onEvent=this.onEvent.bind(this),this.handledEvents=t,this.useGenericHandler=!0,this.registerListeners()}return e.prototype.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},e.prototype.onHandlerDestroying=function(){},e.prototype.onHandlerDestroyed=function(){},e.prototype.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},e.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if(s[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)},e.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},e.prototype.onEvent=function(e,t){this.onEventGeneric(e,t)},e.prototype.onEventGeneric=function(e,t){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,e,t).call()}catch(t){n.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(a.default.ERROR,{type:i.ErrorTypes.OTHER_ERROR,details:i.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();t.default=o},"./src/events.js":
/*!***********************!*\
  !*** ./src/events.js ***!
  \***********************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},"./src/hls.js":
/*!********************!*\
  !*** ./src/hls.js ***!
  \********************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! url-toolkit */"./node_modules/url-toolkit/src/url-toolkit.js"),s=r(/*! ./errors */"./src/errors.js"),o=r(/*! ./loader/playlist-loader */"./src/loader/playlist-loader.js"),l=r(/*! ./loader/fragment-loader */"./src/loader/fragment-loader.js"),u=r(/*! ./loader/key-loader */"./src/loader/key-loader.js"),c=r(/*! ./controller/fragment-tracker */"./src/controller/fragment-tracker.js"),d=r(/*! ./controller/stream-controller */"./src/controller/stream-controller.js"),h=r(/*! ./controller/level-controller */"./src/controller/level-controller.js"),f=r(/*! ./controller/id3-track-controller */"./src/controller/id3-track-controller.js"),p=r(/*! ./is-supported */"./src/is-supported.js"),g=r(/*! ./utils/logger */"./src/utils/logger.js"),m=r(/*! ./config */"./src/config.js"),v=r(/*! ./events */"./src/events.js"),_=function(e){function t(r){void 0===r&&(r={});var n=e.call(this)||this,i=t.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var a in i)a in r||(r[a]=i[a]);if(void 0!==r.liveMaxLatencyDurationCount&&r.liveMaxLatencyDurationCount<=r.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==r.liveMaxLatencyDuration&&(r.liveMaxLatencyDuration<=r.liveSyncDuration||void 0===r.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');g.enableLogs(r.debug),n.config=r,n._autoLevelCapping=-1;var s=n.abrController=new r.abrController(n),p=new r.bufferController(n),m=new r.capLevelController(n),v=new r.fpsController(n),_=new o.default(n),y=new l.default(n),b=new u.default(n),w=new f.default(n),S=n.levelController=new h.default(n),E=new c.FragmentTracker(n),x=[S,n.streamController=new d.default(n,E)],T=r.audioStreamController;T&&x.push(new T(n,E)),n.networkControllers=x;var k=[_,y,b,s,p,m,v,w,E];if(T=r.audioTrackController){var A=new T(n);n.audioTrackController=A,k.push(A)}if(T=r.subtitleTrackController){var C=new T(n);n.subtitleTrackController=C,x.push(C)}if(T=r.emeController){var j=new T(n);n.emeController=j,k.push(j)}return(T=r.subtitleStreamController)&&x.push(new T(n,E)),(T=r.timelineController)&&k.push(new T(n)),n.coreComponents=k,n}return i(t,e),Object.defineProperty(t,"version",{get:function(){return"0.12.4"},enumerable:!0,configurable:!0}),t.isSupported=function(){return p.isSupported()},Object.defineProperty(t,"Events",{get:function(){return v.default},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ErrorTypes",{get:function(){return s.ErrorTypes},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ErrorDetails",{get:function(){return s.ErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DefaultConfig",{get:function(){return t.defaultConfig?t.defaultConfig:m.hlsDefaultConfig},set:function(e){t.defaultConfig=e},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){g.logger.log("destroy"),this.trigger(v.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},t.prototype.attachMedia=function(e){g.logger.log("attachMedia"),this.media=e,this.trigger(v.default.MEDIA_ATTACHING,{media:e})},t.prototype.detachMedia=function(){g.logger.log("detachMedia"),this.trigger(v.default.MEDIA_DETACHING),this.media=null},t.prototype.loadSource=function(e){e=a.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),g.logger.log("loadSource:"+e),this.url=e,this.trigger(v.default.MANIFEST_LOADING,{url:e})},t.prototype.startLoad=function(e){void 0===e&&(e=-1),g.logger.log("startLoad("+e+")"),this.networkControllers.forEach(function(t){t.startLoad(e)})},t.prototype.stopLoad=function(){g.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},t.prototype.swapAudioCodec=function(){g.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},t.prototype.recoverMediaError=function(){g.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)},Object.defineProperty(t.prototype,"levels",{get:function(){return this.levelController.levels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentLevel",{get:function(){return this.streamController.currentLevel},set:function(e){g.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextLevel",{get:function(){return this.streamController.nextLevel},set:function(e){g.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loadLevel",{get:function(){return this.levelController.level},set:function(e){g.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextLoadLevel",{get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstLevel",{get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){g.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startLevel",{get:function(){return this.levelController.startLevel},set:function(e){g.logger.log("set startLevel:"+e);-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoLevelCapping",{get:function(){return this._autoLevelCapping},set:function(e){g.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoLevelEnabled",{get:function(){return-1===this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"manualLevel",{get:function(){return this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minAutoLevel",{get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,n=0;n<r;n++){if((e[n].realBitrate?Math.max(e[n].realBitrate,e[n].bitrate):e[n].bitrate)>t)return n}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxAutoLevel",{get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextAutoLevel",{get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTracks",{get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTrack",{get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"liveSyncPosition",{get:function(){return this.streamController.liveSyncPosition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleTracks",{get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleTrack",{get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleDisplay",{get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)},enumerable:!0,configurable:!0}),t}(r(/*! ./observer */"./src/observer.js").Observer);t.default=_},"./src/is-supported.js":
/*!*****************************!*\
  !*** ./src/is-supported.js ***!
  \*****************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./utils/mediasource-helper */"./src/utils/mediasource-helper.js");t.isSupported=function(){var e=n.getMediaSource(),t=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!i}},"./src/loader/fragment-loader.js":
/*!***************************************!*\
  !*** ./src/loader/fragment-loader.js ***!
  \***************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=r(/*! ../event-handler */"./src/event-handler.js"),o=r(/*! ../errors */"./src/errors.js"),l=r(/*! ../utils/logger */"./src/utils/logger.js"),u=function(t){function r(e){var r=t.call(this,e,a.default.FRAG_LOADING)||this;return r.loaders={},r}return i(r,t),r.prototype.destroy=function(){var e=this.loaders;for(var r in e){var n=e[r];n&&n.destroy()}this.loaders={},t.prototype.destroy.call(this)},r.prototype.onFragLoading=function(t){var r=t.frag,n=r.type,i=this.loaders,a=this.hls.config,s=a.fLoader,o=a.loader;r.loaded=0;var u,c,d,h=i[n];h&&(l.logger.warn("abort previous fragment loader for type: "+n),h.abort()),h=i[n]=r.loader=a.fLoader?new s(a):new o(a),u={url:r.url,frag:r,responseType:"arraybuffer",progressData:!1};var f=r.byteRangeStartOffset,p=r.byteRangeEndOffset;e.isFinite(f)&&e.isFinite(p)&&(u.rangeStart=f,u.rangeEnd=p),c={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},h.load(u,c,d)},r.prototype.loadsuccess=function(e,t,r,n){void 0===n&&(n=null);var i=e.data,s=r.frag;s.loader=void 0,this.loaders[s.type]=void 0,this.hls.trigger(a.default.FRAG_LOADED,{payload:i,frag:s,stats:t,networkDetails:n})},r.prototype.loaderror=function(e,t,r){void 0===r&&(r=null);var n=t.frag,i=n.loader;i&&i.abort(),this.loaders[n.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})},r.prototype.loadtimeout=function(e,t,r){void 0===r&&(r=null);var n=t.frag,i=n.loader;i&&i.abort(),this.loaders[n.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})},r.prototype.loadprogress=function(e,t,r,n){void 0===n&&(n=null);var i=t.frag;i.loaded=e.loaded,this.hls.trigger(a.default.FRAG_LOAD_PROGRESS,{frag:i,stats:e,networkDetails:n})},r}(s.default);t.default=u}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/loader/fragment.js":
/*!********************************!*\
  !*** ./src/loader/fragment.js ***!
  \********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! url-toolkit */"./node_modules/url-toolkit/src/url-toolkit.js"),i=r(/*! ./level-key */"./src/loader/level-key.js"),a=function(){function t(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[],this.programDateTime=null,this.rawProgramDateTime=null,this._elementaryStreams=((e={})[t.ElementaryStreamTypes.AUDIO]=!1,e[t.ElementaryStreamTypes.VIDEO]=!1,e)}return Object.defineProperty(t,"ElementaryStreamTypes",{get:function(){return{AUDIO:"audio",VIDEO:"video"}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return!this._url&&this.relurl&&(this._url=n.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRange",{get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var e=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var r=this.lastByteRangeEndOffset;e[0]=r||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0],this._byteRange=e}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRangeStartOffset",{get:function(){return this.byteRange[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRangeEndOffset",{get:function(){return this.byteRange[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"decryptdata",{get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endProgramDateTime",{get:function(){if(!e.isFinite(this.programDateTime))return null;var t=e.isFinite(this.duration)?this.duration:0;return this.programDateTime+1e3*t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"encrypted",{get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)},enumerable:!0,configurable:!0}),t.prototype.addElementaryStream=function(e){this._elementaryStreams[e]=!0},t.prototype.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},t.prototype.createInitializationVector=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t},t.prototype.fragmentDecryptdataFromLevelkey=function(e,t){var r=e;return e&&e.method&&e.uri&&!e.iv&&((r=new i.default).method=e.method,r.baseuri=e.baseuri,r.reluri=e.reluri,r.iv=this.createInitializationVector(t)),r},t}();t.default=a}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/loader/key-loader.js":
/*!**********************************!*\
  !*** ./src/loader/key-loader.js ***!
  \**********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=r(/*! ../event-handler */"./src/event-handler.js"),o=r(/*! ../errors */"./src/errors.js"),l=r(/*! ../utils/logger */"./src/utils/logger.js"),u=function(e){function t(t){var r=e.call(this,t,a.default.KEY_LOADING)||this;return r.loaders={},r.decryptkey=null,r.decrypturl=null,r}return i(t,e),t.prototype.destroy=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},s.default.prototype.destroy.call(this)},t.prototype.onKeyLoading=function(e){var t=e.frag,r=t.type,n=this.loaders[r],i=t.decryptdata,s=i.uri;if(s!==this.decrypturl||null===this.decryptkey){var o=this.hls.config;n&&(l.logger.warn("abort previous key loader for type:"+r),n.abort()),t.loader=this.loaders[r]=new o.loader(o),this.decrypturl=s,this.decryptkey=null;var u,c,d;u={url:s,frag:t,responseType:"arraybuffer"},c={timeout:o.fragLoadingTimeOut,maxRetry:0,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(u,c,d)}else this.decryptkey&&(i.key=this.decryptkey,this.hls.trigger(a.default.KEY_LOADED,{frag:t}))},t.prototype.loadsuccess=function(e,t,r){var n=r.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(a.default.KEY_LOADED,{frag:n})},t.prototype.loaderror=function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})},t.prototype.loadtimeout=function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},t}(s.default);t.default=u},"./src/loader/level-key.js":
/*!*********************************!*\
  !*** ./src/loader/level-key.js ***!
  \*********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! url-toolkit */"./node_modules/url-toolkit/src/url-toolkit.js"),i=function(){function e(){this.method=null,this.key=null,this.iv=null,this._uri=null}return Object.defineProperty(e.prototype,"uri",{get:function(){return!this._uri&&this.reluri&&(this._uri=n.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri},enumerable:!0,configurable:!0}),e}();t.default=i},"./src/loader/level.js":
/*!*****************************!*\
  !*** ./src/loader/level.js ***!
  \*****************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function t(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}return Object.defineProperty(t.prototype,"hasProgramDateTime",{get:function(){return!(!this.fragments[0]||!e.isFinite(this.fragments[0].programDateTime))},enumerable:!0,configurable:!0}),t}();t.default=r}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/loader/m3u8-parser.js":
/*!***********************************!*\
  !*** ./src/loader/m3u8-parser.js ***!
  \***********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! url-toolkit */"./node_modules/url-toolkit/src/url-toolkit.js"),i=r(/*! ./fragment */"./src/loader/fragment.js"),a=r(/*! ./level */"./src/loader/level.js"),s=r(/*! ./level-key */"./src/loader/level-key.js"),o=r(/*! ../utils/attr-list */"./src/utils/attr-list.js"),l=r(/*! ../utils/logger */"./src/utils/logger.js"),u=r(/*! ../utils/codecs */"./src/utils/codecs.js"),c=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,d=/#EXT-X-MEDIA:(.*)/g,h=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),f=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,p=/\.(mp4|m4s|m4v|m4a)$/i,g=function(){function t(){}return t.findGroup=function(e,t){if(!e)return null;for(var r=null,n=0;n<e.length;n++){var i=e[n];i.id===t&&(r=i)}return r},t.convertAVC1ToAVCOTI=function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t},t.resolve=function(e,t){return n.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},t.parseMasterPlaylist=function(e,r){var n,i=[];function a(e,t){["video","audio"].forEach(function(r){var n=e.filter(function(e){return u.isCodecType(e,r)});if(n.length){var i=n.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)});t[r+"Codec"]=i.length>0?i[0]:n[0],e=e.filter(function(e){return-1===n.indexOf(e)})}}),t.unknownCodecs=e}for(c.lastIndex=0;null!=(n=c.exec(e));){var s={},l=s.attrs=new o.default(n[1]);s.url=t.resolve(n[2],r);var d=l.decimalResolution("RESOLUTION");d&&(s.width=d.width,s.height=d.height),s.bitrate=l.decimalInteger("AVERAGE-BANDWIDTH")||l.decimalInteger("BANDWIDTH"),s.name=l.NAME,a([].concat((l.CODECS||"").split(/[ ,]+/)),s),s.videoCodec&&-1!==s.videoCodec.indexOf("avc1")&&(s.videoCodec=t.convertAVC1ToAVCOTI(s.videoCodec)),i.push(s)}return i},t.parseMasterPlaylistMedia=function(e,r,n,i){var a;void 0===i&&(i=[]);var s=[],l=0;for(d.lastIndex=0;null!==(a=d.exec(e));){var u={},c=new o.default(a[1]);if(c.TYPE===n){if(u.groupId=c["GROUP-ID"],u.name=c.NAME,u.type=n,u.default="YES"===c.DEFAULT,u.autoselect="YES"===c.AUTOSELECT,u.forced="YES"===c.FORCED,c.URI&&(u.url=t.resolve(c.URI,r)),u.lang=c.LANGUAGE,u.name||(u.name=u.lang),i.length){var h=t.findGroup(i,u.groupId);u.audioCodec=h?h.codec:i[0].codec}u.id=l++,s.push(u)}}return s},t.parseLevelPlaylist=function(t,r,n,u,c){var d,g,v=0,_=0,y=new a.default(r),b=new s.default,w=0,S=null,E=new i.default,x=null;for(h.lastIndex=0;null!==(d=h.exec(t));){var T=d[1];if(T){E.duration=parseFloat(T);var k=(" "+d[2]).slice(1);E.title=k||null,E.tagList.push(k?["INF",T,k]:["INF",T])}else if(d[3]){if(e.isFinite(E.duration)){var A=v++;E.type=u,E.start=_,E.levelkey=b,E.sn=A,E.level=n,E.cc=w,E.urlId=c,E.baseurl=r,E.relurl=(" "+d[3]).slice(1),m(E,S),y.fragments.push(E),S=E,_+=E.duration,E=new i.default}}else if(d[4]){if(E.rawByteRange=(" "+d[4]).slice(1),S){var C=S.byteRangeEndOffset;C&&(E.lastByteRangeEndOffset=C)}}else if(d[5])E.rawProgramDateTime=(" "+d[5]).slice(1),E.tagList.push(["PROGRAM-DATE-TIME",E.rawProgramDateTime]),null===x&&(x=y.fragments.length);else{for(d=d[0].match(f),g=1;g<d.length&&void 0===d[g];g++);var j=(" "+d[g+1]).slice(1),D=(" "+d[g+2]).slice(1);switch(d[g]){case"#":E.tagList.push(D?[j,D]:[j]);break;case"PLAYLIST-TYPE":y.type=j.toUpperCase();break;case"MEDIA-SEQUENCE":v=y.startSN=parseInt(j);break;case"TARGETDURATION":y.targetduration=parseFloat(j);break;case"VERSION":y.version=parseInt(j);break;case"EXTM3U":break;case"ENDLIST":y.live=!1;break;case"DIS":w++,E.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":w=parseInt(j);break;case"KEY":var R=j,L=new o.default(R),I=L.enumeratedString("METHOD"),O=L.URI,P=L.hexadecimalInteger("IV");I&&(b=new s.default,O&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(I)>=0&&(b.method=I,b.baseuri=r,b.reluri=O,b.key=null,b.iv=P));break;case"START":var M=j,N=new o.default(M).decimalFloatingPoint("TIME-OFFSET");e.isFinite(N)&&(y.startTimeOffset=N);break;case"MAP":var F=new o.default(j);E.relurl=F.URI,E.rawByteRange=F.BYTERANGE,E.baseurl=r,E.level=n,E.type=u,E.sn="initSegment",y.initSegment=E,(E=new i.default).rawProgramDateTime=y.initSegment.rawProgramDateTime;break;default:l.logger.warn("line parsed but not handled: "+d)}}}return(E=S)&&!E.relurl&&(y.fragments.pop(),_-=E.duration),y.totalduration=_,y.averagetargetduration=_/y.fragments.length,y.endSN=v-1,y.startCC=y.fragments[0]?y.fragments[0].cc:0,y.endCC=w,!y.initSegment&&y.fragments.length&&y.fragments.every(function(e){return p.test(e.relurl)})&&(l.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(E=new i.default).relurl=y.fragments[0].relurl,E.baseurl=r,E.level=n,E.type=u,E.sn="initSegment",y.initSegment=E,y.needSidxRanges=!0),x&&function(e,t){for(var r=e[t],n=t-1;n>=0;n--){var i=e[n];i.programDateTime=r.programDateTime-1e3*i.duration,r=i}}(y.fragments,x),y},t}();function m(t,r){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):r&&r.programDateTime&&(t.programDateTime=r.endProgramDateTime),e.isFinite(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}t.default=g}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/loader/playlist-loader.js":
/*!***************************************!*\
  !*** ./src/loader/playlist-loader.js ***!
  \***************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ../events */"./src/events.js"),s=r(/*! ../event-handler */"./src/event-handler.js"),o=r(/*! ../errors */"./src/errors.js"),l=r(/*! ../utils/logger */"./src/utils/logger.js"),u=r(/*! ../demux/mp4demuxer */"./src/demux/mp4demuxer.js"),c=r(/*! ./m3u8-parser */"./src/loader/m3u8-parser.js"),d=window.performance,h={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},f={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},p=function(t){function r(e){var r=t.call(this,e,a.default.MANIFEST_LOADING,a.default.LEVEL_LOADING,a.default.AUDIO_TRACK_LOADING,a.default.SUBTITLE_TRACK_LOADING)||this;return r.loaders={},r}return i(r,t),Object.defineProperty(r,"ContextType",{get:function(){return h},enumerable:!0,configurable:!0}),Object.defineProperty(r,"LevelType",{get:function(){return f},enumerable:!0,configurable:!0}),r.canHaveQualityLevels=function(e){return e!==h.AUDIO_TRACK&&e!==h.SUBTITLE_TRACK},r.mapContextToLevelType=function(e){switch(e.type){case h.AUDIO_TRACK:return f.AUDIO;case h.SUBTITLE_TRACK:return f.SUBTITLE;default:return f.MAIN}},r.getResponseUrl=function(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r},r.prototype.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,n=t.loader,i=new(r||n)(t);return e.loader=i,this.loaders[e.type]=i,i},r.prototype.getInternalLoader=function(e){return this.loaders[e.type]},r.prototype.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},r.prototype.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},r.prototype.destroy=function(){this.destroyInternalLoaders(),t.prototype.destroy.call(this)},r.prototype.onManifestLoading=function(e){this.load(e.url,{type:h.MANIFEST,level:0,id:null})},r.prototype.onLevelLoading=function(e){this.load(e.url,{type:h.LEVEL,level:e.level,id:e.id})},r.prototype.onAudioTrackLoading=function(e){this.load(e.url,{type:h.AUDIO_TRACK,level:null,id:e.id})},r.prototype.onSubtitleTrackLoading=function(e){this.load(e.url,{type:h.SUBTITLE_TRACK,level:null,id:e.id})},r.prototype.load=function(e,t){var r=this.hls.config;l.logger.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var n,i,a,s,o=this.getInternalLoader(t);if(o){var u=o.context;if(u&&u.url===e)return l.logger.trace("playlist request ongoing"),!1;l.logger.warn("aborting previous loader for type: "+t.type),o.abort()}switch(t.type){case h.MANIFEST:n=r.manifestLoadingMaxRetry,i=r.manifestLoadingTimeOut,a=r.manifestLoadingRetryDelay,s=r.manifestLoadingMaxRetryTimeout;break;case h.LEVEL:n=0,i=r.levelLoadingTimeOut;break;default:n=r.levelLoadingMaxRetry,i=r.levelLoadingTimeOut,a=r.levelLoadingRetryDelay,s=r.levelLoadingMaxRetryTimeout}o=this.createInternalLoader(t),t.url=e,t.responseType=t.responseType||"";var c={timeout:i,maxRetry:n,retryDelay:a,maxRetryDelay:s},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return l.logger.debug("Calling internal loader delegate for URL: "+e),o.load(t,c,d),!0},r.prototype.loadsuccess=function(e,t,r,n){if(void 0===n&&(n=null),r.isSidxRequest)return this._handleSidxRequest(e,r),void this._handlePlaylistLoaded(e,t,r,n);this.resetInternalLoader(r.type);var i=e.data;t.tload=d.now(),0===i.indexOf("#EXTM3U")?i.indexOf("#EXTINF:")>0||i.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,r,n):this._handleMasterPlaylist(e,t,r,n):this._handleManifestParsingError(e,r,"no EXTM3U delimiter",n)},r.prototype.loaderror=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!1,e)},r.prototype.loadtimeout=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!0)},r.prototype._handleMasterPlaylist=function(e,t,n,i){var s=this.hls,o=e.data,u=r.getResponseUrl(e,n),d=c.default.parseMasterPlaylist(o,u);if(d.length){var h=d.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),f=c.default.parseMasterPlaylistMedia(o,u,"AUDIO",h),p=c.default.parseMasterPlaylistMedia(o,u,"SUBTITLES");if(f.length){var g=!1;f.forEach(function(e){e.url||(g=!0)}),!1===g&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(l.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),f.unshift({type:"main",name:"main"}))}s.trigger(a.default.MANIFEST_LOADED,{levels:d,audioTracks:f,subtitles:p,url:u,stats:t,networkDetails:i})}else this._handleManifestParsingError(e,n,"no level found in manifest",i)},r.prototype._handleTrackOrLevelPlaylist=function(t,n,i,s){var o=this.hls,l=i.id,u=i.level,f=i.type,p=r.getResponseUrl(t,i),g=e.isFinite(l)?l:0,m=e.isFinite(u)?u:g,v=r.mapContextToLevelType(i),_=c.default.parseLevelPlaylist(t.data,p,m,v,g);if(_.tload=n.tload,f===h.MANIFEST){var y={url:p,details:_};o.trigger(a.default.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:p,stats:n,networkDetails:s})}if(n.tparsed=d.now(),_.needSidxRanges){var b=_.initSegment.url;this.load(b,{isSidxRequest:!0,type:f,level:u,levelDetails:_,id:l,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else i.levelDetails=_,this._handlePlaylistLoaded(t,n,i,s)},r.prototype._handleSidxRequest=function(e,t){var r=u.default.parseSegmentIndex(new Uint8Array(e.data));if(r){var n=r.references,i=t.levelDetails;n.forEach(function(e,t){var r=e.info,n=i.fragments[t];0===n.byteRange.length&&(n.rawByteRange=String(1+r.end-r.start)+"@"+String(r.start))}),i.initSegment.rawByteRange=String(r.moovEndOffset)+"@0"}},r.prototype._handleManifestParsingError=function(e,t,r,n){this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:r,networkDetails:n})},r.prototype._handleNetworkError=function(e,t,r,n){var i,s;void 0===r&&(r=!1),void 0===n&&(n=null),l.logger.info("A network error occured while loading a "+e.type+"-type playlist");var u=this.getInternalLoader(e);switch(e.type){case h.MANIFEST:i=r?o.ErrorDetails.MANIFEST_LOAD_TIMEOUT:o.ErrorDetails.MANIFEST_LOAD_ERROR,s=!0;break;case h.LEVEL:i=r?o.ErrorDetails.LEVEL_LOAD_TIMEOUT:o.ErrorDetails.LEVEL_LOAD_ERROR,s=!1;break;case h.AUDIO_TRACK:i=r?o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,s=!1;break;default:s=!1}u&&(u.abort(),this.resetInternalLoader(e.type));var c={type:o.ErrorTypes.NETWORK_ERROR,details:i,fatal:s,url:u.url,loader:u,context:e,networkDetails:t};n&&(c.response=n),this.hls.trigger(a.default.ERROR,c)},r.prototype._handlePlaylistLoaded=function(e,t,n,i){var s=n.type,o=n.level,l=n.id,u=n.levelDetails;if(u.targetduration)if(r.canHaveQualityLevels(n.type))this.hls.trigger(a.default.LEVEL_LOADED,{details:u,level:o||0,id:l||0,stats:t,networkDetails:i});else switch(s){case h.AUDIO_TRACK:this.hls.trigger(a.default.AUDIO_TRACK_LOADED,{details:u,id:l,stats:t,networkDetails:i});break;case h.SUBTITLE_TRACK:this.hls.trigger(a.default.SUBTITLE_TRACK_LOADED,{details:u,id:l,stats:t,networkDetails:i})}else this._handleManifestParsingError(e,n,"invalid target duration",i)},r}(s.default);t.default=p}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/observer.js":
/*!*************************!*\
  !*** ./src/observer.js ***!
  \*************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.emit.apply(this,[e,e].concat(t))},t}(r(/*! eventemitter3 */"./node_modules/eventemitter3/index.js").EventEmitter);t.Observer=a},"./src/polyfills/number.js":
/*!*********************************!*\
  !*** ./src/polyfills/number.js ***!
  \*********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../utils/get-self-scope */"./src/utils/get-self-scope.js").getSelfScope().Number;t.Number=n,n.isFinite=n.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},"./src/remux/aac-helper.js":
/*!*********************************!*\
  !*** ./src/remux/aac-helper.js ***!
  \*********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}();t.default=n},"./src/remux/mp4-generator.js":
/*!************************************!*\
  !*** ./src/remux/mp4-generator.js ***!
  \************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Math.pow(2,32)-1,i=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,s,l,s,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))},e.box=function(e){for(var t,r=Array.prototype.slice.call(arguments,1),n=8,i=r.length,a=i;i--;)n+=r[i].byteLength;for((t=new Uint8Array(n))[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),i=0,n=8;i<a;i++)t.set(r[i],n),n+=r[i].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var i=Math.floor(r/(n+1)),a=Math.floor(r%(n+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))},e.moov=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))},e.mvhd=function(t,r){r*=t;var i=Math.floor(r/(n+1)),a=Math.floor(r%(n+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,s)},e.sdtp=function(t){var r,n,i=t.samples||[],a=new Uint8Array(4+i.length);for(n=0;n<i.length;n++)r=i[n].flags,a[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,a)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,n,i,a=[],s=[];for(r=0;r<t.sps.length;r++)i=(n=t.sps[r]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(n));for(r=0;r<t.pps.length;r++)i=(n=t.pps[r]).byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));var o=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(s))),l=t.width,u=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,i=t.duration*t.timescale,a=t.width,s=t.height,o=Math.floor(i/(n+1)),l=Math.floor(i%(n+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,s>>8&255,255&s,0,0]))},e.traf=function(t,r){var i=e.sdtp(t),a=t.id,s=Math.floor(r/(n+1)),o=Math.floor(r%(n+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o])),e.trun(t,i.length+16+20+8+16+8+8),i)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var n,i,a,s,o,l,u=t.samples||[],c=u.length,d=12+16*c,h=new Uint8Array(d);for(r+=8+d,h.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<c;n++)a=(i=u[n]).duration,s=i.size,o=i.flags,l=i.cts,h.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,h)},e.initSegment=function(t){e.types||e.init();var r,n=e.moov(t);return(r=new Uint8Array(e.FTYP.byteLength+n.byteLength)).set(e.FTYP),r.set(n,e.FTYP.byteLength),r},e}();t.default=i},"./src/remux/mp4-remuxer.js":
/*!**********************************!*\
  !*** ./src/remux/mp4-remuxer.js ***!
  \**********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./aac-helper */"./src/remux/aac-helper.js"),i=r(/*! ./mp4-generator */"./src/remux/mp4-generator.js"),a=r(/*! ../events */"./src/events.js"),s=r(/*! ../errors */"./src/errors.js"),o=r(/*! ../utils/logger */"./src/utils/logger.js"),l=function(){function e(e,t,r,n){this.observer=e,this.config=t,this.typeSupported=r;var i=navigator.userAgent;this.isSafari=n&&n.indexOf("Apple")>-1&&i&&!i.match("CriOS"),this.ISGenerated=!1}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},e.prototype.resetInitSegment=function(){this.ISGenerated=!1},e.prototype.remux=function(e,t,r,n,i,s,l){if(this.ISGenerated||this.generateIS(e,t,i),this.ISGenerated){var u=e.samples.length,c=t.samples.length,d=i,h=i;if(u&&c){var f=(e.samples[0].pts-t.samples[0].pts)/t.inputTimeScale;d+=Math.max(0,f),h+=Math.max(0,-f)}if(u){e.timescale||(o.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,i));var p=this.remuxAudio(e,d,s,l);if(c){var g=void 0;p&&(g=p.endPTS-p.startPTS),t.timescale||(o.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,i)),this.remuxVideo(t,h,s,g,l)}}else if(c){var m=this.remuxVideo(t,h,s,0,l);m&&e.codec&&this.remuxEmptyAudio(e,d,s,m)}}r.samples.length&&this.remuxID3(r,i),n.samples.length&&this.remuxText(n,i),this.observer.trigger(a.default.FRAG_PARSED)},e.prototype.generateIS=function(e,t,r){var n,l,u=this.observer,c=e.samples,d=t.samples,h=this.typeSupported,f="audio/mp4",p={},g={tracks:p},m=void 0===this._initPTS;if(m&&(n=l=1/0),e.config&&c.length&&(e.timescale=e.samplerate,o.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(h.mpeg?(f="audio/mpeg",e.codec=""):h.mp3&&(e.codec="mp3")),p.audio={container:f,codec:e.codec,initSegment:!e.isAAC&&h.mpeg?new Uint8Array:i.default.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(n=l=c[0].pts-e.inputTimeScale*r)),t.sps&&t.pps&&d.length){var v=t.inputTimeScale;t.timescale=v,p.video={container:"video/mp4",codec:t.codec,initSegment:i.default.initSegment([t]),metadata:{width:t.width,height:t.height}},m&&(n=Math.min(n,d[0].pts-v*r),l=Math.min(l,d[0].dts-v*r),this.observer.trigger(a.default.INIT_PTS_FOUND,{initPTS:n}))}Object.keys(p).length?(u.trigger(a.default.FRAG_PARSING_INIT_SEGMENT,g),this.ISGenerated=!0,m&&(this._initPTS=n,this._initDTS=l)):u.trigger(a.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},e.prototype.remuxVideo=function(e,t,r,n,l){var u,c,d,h,f,p,g,m=8,v=e.timescale,_=e.samples,y=[],b=_.length,w=this._PTSNormalize,S=this._initPTS,E=this.nextAvcDts,x=this.isSafari;if(0!==b){x&&(r|=_.length&&E&&(l&&Math.abs(t-E/v)<.1||Math.abs(_[0].pts-E-S)<v/5)),r||(E=t*v),_.forEach(function(e){e.pts=w(e.pts-S,E),e.dts=w(e.dts-S,E)}),_.sort(function(e,t){var r=e.dts-t.dts,n=e.pts-t.pts;return r||n||e.id-t.id});var T=_.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(T<0){o.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(T/90)+" ms to overcome this issue");for(var k=0;k<_.length;k++)_[k].dts+=T}var A=_[0];f=Math.max(A.dts,0),h=Math.max(A.pts,0);var C=Math.round((f-E)/90);r&&C&&(C>1?o.logger.log("AVC:"+C+" ms hole between fragments detected,filling it"):C<-1&&o.logger.log("AVC:"+-C+" ms overlapping between fragments detected"),f=E,_[0].dts=f,h=Math.max(h-C,E),_[0].pts=h,o.logger.log("Video/PTS/DTS adjusted: "+Math.round(h/90)+"/"+Math.round(f/90)+",delta:"+C+" ms")),A=_[_.length-1],g=Math.max(A.dts,0),p=Math.max(A.pts,0,g),x&&(u=Math.round((g-f)/(_.length-1)));var j=0,D=0;for(k=0;k<b;k++){for(var R=_[k],L=R.units,I=L.length,O=0,P=0;P<I;P++)O+=L[P].data.length;D+=O,j+=I,R.length=O,R.dts=x?f+k*u:Math.max(R.dts,f),R.pts=Math.max(R.pts,R.dts)}var M=D+4*j+8;try{c=new Uint8Array(M)}catch(e){return void this.observer.trigger(a.default.ERROR,{type:s.ErrorTypes.MUX_ERROR,details:s.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:M,reason:"fail allocating video mdat "+M})}var N=new DataView(c.buffer);N.setUint32(0,M),c.set(i.default.types.mdat,4);for(k=0;k<b;k++){var F=_[k],B=F.units,U=0,G=void 0;for(P=0,I=B.length;P<I;P++){var z=B[P],H=z.data,V=z.data.byteLength;N.setUint32(m,V),m+=4,c.set(H,m),m+=V,U+=4+V}if(x)G=Math.max(0,u*Math.round((F.pts-F.dts)/u));else{if(k<b-1)u=_[k+1].dts-F.dts;else{var K=this.config,W=F.dts-_[k>0?k-1:k].dts;if(K.stretchShortVideoTrack){var q=K.maxBufferHole,X=Math.floor(q*v),Y=(n?h+n*v:this.nextAudioPts)-F.pts;Y>X?((u=Y-W)<0&&(u=W),o.logger.log("It is approximately "+Y/90+" ms to the next segment; using duration "+u/90+" ms for the last video frame.")):u=W}else u=W}G=Math.round(F.pts-F.dts)}y.push({size:U,duration:u,cts:G,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:F.key?2:1,isNonSync:F.key?0:1}})}this.nextAvcDts=g+u;var $=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,y.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var J=y[0].flags;J.dependsOn=2,J.isNonSync=0}e.samples=y,d=i.default.moof(e.sequenceNumber++,f,e),e.samples=[];var Q={data1:d,data2:c,startPTS:h/v,endPTS:(p+u)/v,startDTS:f/v,endDTS:this.nextAvcDts/v,type:"video",hasAudio:!1,hasVideo:!0,nb:y.length,dropped:$};return this.observer.trigger(a.default.FRAG_PARSING_DATA,Q),Q}},e.prototype.remuxAudio=function(e,t,r,l){var u,c,d,h,f,p,g,m=e.inputTimeScale,v=e.timescale,_=m/v,y=(e.isAAC?1024:1152)*_,b=this._PTSNormalize,w=this._initPTS,S=!e.isAAC&&this.typeSupported.mpeg,E=e.samples,x=[],T=this.nextAudioPts;if(r|=E.length&&T&&(l&&Math.abs(t-T/m)<.1||Math.abs(E[0].pts-T-w)<20*y),E.forEach(function(e){e.pts=e.dts=b(e.pts-w,t*m)}),0!==(E=E.filter(function(e){return e.pts>=0})).length){if(r||(T=l?t*m:E[0].pts),e.isAAC)for(var k=this.config.maxAudioFramesDrift,A=0,C=T;A<E.length;){var j,D=E[A];j=(F=D.pts)-C;var R=Math.abs(1e3*j/m);if(j<=-k*y)o.logger.warn("Dropping 1 audio frame @ "+(C/m).toFixed(3)+"s due to "+Math.round(R)+" ms overlap."),E.splice(A,1),e.len-=D.unit.length;else if(j>=k*y&&R<1e4&&C){var L=Math.round(j/y);o.logger.warn("Injecting "+L+" audio frame @ "+(C/m).toFixed(3)+"s due to "+Math.round(1e3*j/m)+" ms gap.");for(var I=0;I<L;I++){var O=Math.max(C,0);(d=n.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),d=D.unit.subarray()),E.splice(A,0,{unit:d,pts:O,dts:O}),e.len+=d.length,C+=y,A++}D.pts=D.dts=C,C+=y,A++}else Math.abs(j),D.pts=D.dts=C,C+=y,A++}I=0;for(var P=E.length;I<P;I++){var M=E[I],N=M.unit,F=M.pts;if(void 0!==g)c.duration=Math.round((F-g)/_);else{var B=Math.round(1e3*(F-T)/m),U=0;if(r&&e.isAAC&&B){if(B>0&&B<1e4)U=Math.round((F-T)/y),o.logger.log(B+" ms hole between AAC samples detected,filling it"),U>0&&((d=n.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(d=N.subarray()),e.len+=U*d.length);else if(B<-12){o.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(T/m).toFixed(3)+"s/"+(F/m).toFixed(3)+"s/"+-B+"ms"),e.len-=N.byteLength;continue}F=T}if(p=F,!(e.len>0))return;var G=S?e.len:e.len+8;u=S?0:8;try{h=new Uint8Array(G)}catch(e){return void this.observer.trigger(a.default.ERROR,{type:s.ErrorTypes.MUX_ERROR,details:s.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:G,reason:"fail allocating audio mdat "+G})}S||(new DataView(h.buffer).setUint32(0,G),h.set(i.default.types.mdat,4));for(A=0;A<U;A++)(d=n.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),d=N.subarray()),h.set(d,u),u+=d.byteLength,c={size:d.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},x.push(c)}h.set(N,u);var z=N.byteLength;u+=z,c={size:z,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},x.push(c),g=F}var H=0,V=x.length;if(V>=2&&(H=x[V-2].duration,c.duration=H),V){this.nextAudioPts=T=g+_*H,e.len=0,e.samples=x,f=S?new Uint8Array:i.default.moof(e.sequenceNumber++,p/_,e),e.samples=[];var K=p/m,W=T/m,q={data1:f,data2:h,startPTS:K,endPTS:W,startDTS:K,endDTS:W,type:"audio",hasAudio:!0,hasVideo:!1,nb:V};return this.observer.trigger(a.default.FRAG_PARSING_DATA,q),q}return null}},e.prototype.remuxEmptyAudio=function(e,t,r,i){var a=e.inputTimeScale,s=a/(e.samplerate?e.samplerate:a),l=this.nextAudioPts,u=(void 0!==l?l:i.startDTS*a)+this._initDTS,c=i.endDTS*a+this._initDTS,d=1024*s,h=Math.ceil((c-u)/d),f=n.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(o.logger.warn("remux empty Audio"),f){for(var p=[],g=0;g<h;g++){var m=u+g*d;p.push({unit:f,pts:m,dts:m}),e.len+=f.length}e.samples=p,this.remuxAudio(e,t,r)}else o.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},e.prototype.remuxID3=function(e){var t,r=e.samples.length,n=e.inputTimeScale,i=this._initPTS,s=this._initDTS;if(r){for(var o=0;o<r;o++)(t=e.samples[o]).pts=(t.pts-i)/n,t.dts=(t.dts-s)/n;this.observer.trigger(a.default.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[]},e.prototype.remuxText=function(e){e.samples.sort(function(e,t){return e.pts-t.pts});var t,r=e.samples.length,n=e.inputTimeScale,i=this._initPTS;if(r){for(var s=0;s<r;s++)(t=e.samples[s]).pts=(t.pts-i)/n;this.observer.trigger(a.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},e.prototype._PTSNormalize=function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e},e}();t.default=l},"./src/remux/passthrough-remuxer.js":
/*!******************************************!*\
  !*** ./src/remux/passthrough-remuxer.js ***!
  \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../events */"./src/events.js"),i=function(){function e(e){this.observer=e}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(){},e.prototype.resetInitSegment=function(){},e.prototype.remux=function(e,t,r,i,a,s,o,l){var u=this.observer,c="";e&&(c+="audio"),t&&(c+="video"),u.trigger(n.default.FRAG_PARSING_DATA,{data1:l,startPTS:a,startDTS:a,type:c,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),u.trigger(n.default.FRAG_PARSED)},e}();t.default=i},"./src/task-loop.js":
/*!**************************!*\
  !*** ./src/task-loop.js ***!
  \**************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i=e.apply(this,[t].concat(r))||this;return i._tickInterval=null,i._tickTimer=null,i._tickCallCount=0,i._boundTick=i.tick.bind(i),i}return i(t,e),t.prototype.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},t.prototype.hasInterval=function(){return!!this._tickInterval},t.prototype.hasNextTick=function(){return!!this._tickTimer},t.prototype.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=setInterval(this._boundTick,e),!0)},t.prototype.clearInterval=function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),this._tickInterval=null,!0)},t.prototype.clearNextTick=function(){return!!this._tickTimer&&(clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.prototype.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=setTimeout(this._boundTick,0)),this._tickCallCount=0)},t.prototype.doTick=function(){},t}(r(/*! ./event-handler */"./src/event-handler.js").default);t.default=a},"./src/utils/attr-list.js":
/*!********************************!*\
  !*** ./src/utils/attr-list.js ***!
  \********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=/^(\d+)x(\d+)$/,n=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,i=function(){function t(e){for(var r in"string"==typeof e&&(e=t.parseAttrList(e)),e)e.hasOwnProperty(r)&&(this[r]=e[r])}return t.prototype.decimalInteger=function(t){var r=parseInt(this[t],10);return r>e.MAX_SAFE_INTEGER?1/0:r},t.prototype.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null},t.prototype.hexadecimalIntegerAsNumber=function(t){var r=parseInt(this[t],16);return r>e.MAX_SAFE_INTEGER?1/0:r},t.prototype.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.prototype.enumeratedString=function(e){return this[e]},t.prototype.decimalResolution=function(e){var t=r.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},t.parseAttrList=function(e){var t,r={};for(n.lastIndex=0;null!==(t=n.exec(e));){var i=t[2];0===i.indexOf('"')&&i.lastIndexOf('"')===i.length-1&&(i=i.slice(1,-1)),r[t[1]]=i}return r},t}();t.default=i}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/utils/binary-search.js":
/*!************************************!*\
  !*** ./src/utils/binary-search.js ***!
  \************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={search:function(e,t){for(var r=0,n=e.length-1,i=null,a=null;r<=n;){var s=t(a=e[i=(r+n)/2|0]);if(s>0)r=i+1;else{if(!(s<0))return a;n=i-1}}return null}}},"./src/utils/buffer-helper.js":
/*!************************************!*\
  !*** ./src/utils/buffer-helper.js ***!
  \************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var r=e.buffered,n=0;n<r.length;n++)if(t>=r.start(n)&&t<=r.end(n))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,r){try{if(e){var n=e.buffered,i=[],a=void 0;for(a=0;a<n.length;a++)i.push({start:n.start(a),end:n.end(a)});return this.bufferedInfo(i,t,r)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,r){var n,i,a,s,o,l=[];for(e.sort(function(e,t){var r=e.start-t.start;return r||t.end-e.end}),o=0;o<e.length;o++){var u=l.length;if(u){var c=l[u-1].end;e[o].start-c<r?e[o].end>c&&(l[u-1].end=e[o].end):l.push(e[o])}else l.push(e[o])}for(o=0,n=0,i=a=t;o<l.length;o++){var d=l[o].start,h=l[o].end;if(t+r>=d&&t<h)i=d,n=(a=h)-t;else if(t+r<d){s=d;break}}return{len:n,start:i,end:a,nextStart:s}},e}();t.BufferHelper=n},"./src/utils/cea-608-parser.js":
/*!*************************************!*\
  !*** ./src/utils/cea-608-parser.js ***!
  \*************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},i=function(e){var t=e;return n.hasOwnProperty(e)&&(t=n[e]),String.fromCharCode(t)},a=15,s=100,o={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},l={17:2,18:4,21:6,22:8,23:10,19:13,20:15},u={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},c={25:2,26:4,29:6,30:8,31:10,27:13,28:15},d=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],h={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){this.verboseFilter[e];this.verboseLevel}},f=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},p=function(){function e(e,t,r,n,i){this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=n||"black",this.flash=i||!1}return e.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},e.prototype.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}},e.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},e.prototype.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},e.prototype.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},e.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),g=function(){function e(e,t,r,n,i,a){this.uchar=e||" ",this.penState=new p(t,r,n,i,a)}return e.prototype.reset=function(){this.uchar=" ",this.penState.reset()},e.prototype.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},e.prototype.setPenState=function(e){this.penState.copy(e)},e.prototype.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},e.prototype.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},e.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),m=function(){function e(){this.chars=[];for(var e=0;e<s;e++)this.chars.push(new g);this.pos=0,this.currPenState=new p}return e.prototype.equals=function(e){for(var t=!0,r=0;r<s;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<s;t++)this.chars[t].copy(e.chars[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<s;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},e.prototype.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(h.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>s&&(h.log("ERROR","Too large cursor position "+this.pos),this.pos=s)},e.prototype.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},e.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.prototype.insertChar=function(e){e>=144&&this.backSpace();var t=i(e);this.pos>=s?h.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},e.prototype.clearFromPos=function(e){var t;for(t=e;t<s;t++)this.chars[t].reset()},e.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},e.prototype.getTextString=function(){for(var e=[],t=!0,r=0;r<s;r++){var n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},e.prototype.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),v=function(){function e(){this.rows=[];for(var e=0;e<a;e++)this.rows.push(new m);this.currRow=a-1,this.nrRollUpRows=null,this.reset()}return e.prototype.reset=function(){for(var e=0;e<a;e++)this.rows[e].clear();this.currRow=a-1},e.prototype.equals=function(e){for(var t=!0,r=0;r<a;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<a;t++)this.rows[t].copy(e.rows[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<a;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},e.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},e.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},e.prototype.insertChar=function(e){this.rows[this.currRow].insertChar(e)},e.prototype.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},e.prototype.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},e.prototype.setCursor=function(e){h.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},e.prototype.setPAC=function(e){h.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<a;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var s=i.rows[n].cueStartTime;if(s&&s<h.time)for(r=0;r<this.nrRollUpRows;r++)this.rows[t-this.nrRollUpRows+r+1].copy(i.rows[n+r])}}this.currRow=t;var o=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,u=Math.max(l-1,0);o.setCursor(e.indent),e.color=o.chars[u].penState.foreground}var c={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(c)},e.prototype.setBkgData=function(e){h.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},e.prototype.setRollUpRows=function(e){this.nrRollUpRows=e},e.prototype.rollUp=function(){if(null!==this.nrRollUpRows){h.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),h.log("INFO","Rolling up")}else h.log("DEBUG","roll_up but nrRollUpRows not set yet")},e.prototype.getDisplayText=function(e){e=e||!1;for(var t=[],r="",n=-1,i=0;i<a;i++){var s=this.rows[i].getTextString();s&&(n=i+1,e?t.push("Row "+n+": '"+s+"'"):t.push(s.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},e.prototype.getTextAndFormat=function(){return this.rows},e}(),_=function(){function e(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new v,this.nonDisplayedMemory=new v,this.lastOutputScreen=new v,this.currRollUpRow=this.displayedMemory.rows[a-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return e.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[a-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},e.prototype.getHandler=function(){return this.outputFilter},e.prototype.setHandler=function(e){this.outputFilter=e},e.prototype.setPAC=function(e){this.writeScreen.setPAC(e)},e.prototype.setBkgData=function(e){this.writeScreen.setBkgData(e)},e.prototype.setMode=function(e){e!==this.mode&&(this.mode=e,h.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},e.prototype.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";h.log("INFO",r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(h.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},e.prototype.ccRCL=function(){h.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},e.prototype.ccBS=function(){h.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},e.prototype.ccAOF=function(){},e.prototype.ccAON=function(){},e.prototype.ccDER=function(){h.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},e.prototype.ccRU=function(e){h.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},e.prototype.ccFON=function(){h.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},e.prototype.ccRDC=function(){h.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},e.prototype.ccTR=function(){h.log("INFO","TR"),this.setMode("MODE_TEXT")},e.prototype.ccRTD=function(){h.log("INFO","RTD"),this.setMode("MODE_TEXT")},e.prototype.ccEDM=function(){h.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},e.prototype.ccCR=function(){h.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},e.prototype.ccENM=function(){h.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},e.prototype.ccEOC=function(){if(h.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,h.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},e.prototype.ccTO=function(e){h.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},e.prototype.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}h.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},e.prototype.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=h.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),!0===e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},e.prototype.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),y=function(){function e(e,t,r){this.field=e||1,this.outputs=[t,r],this.channels=[new _(1,t),new _(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return e.prototype.getHandler=function(e){return this.channels[e].getHandler()},e.prototype.setHandler=function(e,t){this.channels[e].setHandler(t)},e.prototype.addData=function(e,t){var r,n,i,a=!1;this.lastTime=e,h.setTime(e);for(var s=0;s<t.length;s+=2)if(n=127&t[s],i=127&t[s+1],0!==n||0!==i){if(h.log("DATA","["+f([t[s],t[s+1]])+"] -> ("+f([n,i])+")"),(r=this.parseCmd(n,i))||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i)),!r)if(a=this.parseChars(n,i))if(this.currChNr&&this.currChNr>=0)this.channels[this.currChNr-1].insertChars(a);else h.log("WARNING","No channel found yet. TEXT-MODE?");r?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,h.log("WARNING","Couldn't parse cleaned data "+f([n,i])+" orig: "+f([t[s],t[s+1]])))}else this.dataCounters.padding+=2},e.prototype.parseCmd=function(e,t){var r=null;if(!((20===e||28===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,h.log("DEBUG","Repeated command ("+f([e,t])+") is dropped"),!0;r=20===e||23===e?1:2;var n=this.channels[r-1];return 20===e||28===e?32===t?n.ccRCL():33===t?n.ccBS():34===t?n.ccAOF():35===t?n.ccAON():36===t?n.ccDER():37===t?n.ccRU(2):38===t?n.ccRU(3):39===t?n.ccRU(4):40===t?n.ccFON():41===t?n.ccRDC():42===t?n.ccTR():43===t?n.ccRTD():44===t?n.ccEDM():45===t?n.ccCR():46===t?n.ccENM():47===t&&n.ccEOC():n.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},e.prototype.parseMidrow=function(e,t){var r=null;return(17===e||25===e)&&t>=32&&t<=47&&((r=17===e?1:2)!==this.currChNr?(h.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[r-1].ccMIDROW(t),h.log("DEBUG","MIDROW ("+f([e,t])+")"),!0))},e.prototype.parsePAC=function(e,t){var r,n=null;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;r=e<=23?1:2,n=t>=64&&t<=95?1===r?o[e]:u[e]:1===r?l[e]:c[e];var i=this.interpretPAC(n,t);return this.channels[r-1].setPAC(i),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},e.prototype.interpretPAC=function(e,t){var r=t,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1==(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},e.prototype.parseChars=function(e,t){var r=null,n=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),a>=17&&a<=19){var s=t;s=17===a?t+80:18===a?t+112:t+144,h.log("INFO","Special char '"+i(s)+"' in channel "+r),n=[s]}else e>=32&&e<=127&&(n=0===t?[e]:[e,t]);if(n){var o=f(n);h.log("DEBUG","Char codes =  "+o.join(",")),this.lastCmdA=null,this.lastCmdB=null}return n},e.prototype.parseBackgroundAttributes=function(e,t){var r,n,i;return((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47)&&(r={},16===e||24===e?(n=Math.floor((t-32)/2),r.background=d[n],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(r),this.lastCmdA=null,this.lastCmdB=null,!0)},e.prototype.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},e.prototype.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},e}();t.default=y},"./src/utils/codecs.js":
/*!*****************************!*\
  !*** ./src/utils/codecs.js ***!
  \*****************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};t.isCodecType=function(e,t){var r=n[t];return!!r&&!0===r[e.slice(0,4)]},t.isCodecSupportedInMp4=function(e,t){return window.MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}},"./src/utils/cues.js":
/*!***************************!*\
  !*** ./src/utils/cues.js ***!
  \***************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./vttparser */"./src/utils/vttparser.js");t.newCue=function(e,t,r,i){for(var a,s,o,l,u,c=window.VTTCue||window.TextTrackCue,d=0;d<i.rows.length;d++)if(o=!0,l=0,u="",!(a=i.rows[d]).isEmpty()){for(var h=0;h<a.chars.length;h++)a.chars[h].uchar.match(/\s/)&&o?l++:(u+=a.chars[h].uchar,o=!1);a.cueStartTime=t,t===r&&(r+=1e-4),s=new c(t,r,n.fixLineBreaks(u.trim())),l>=16?l--:l++,navigator.userAgent.match(/Firefox\//)?s.line=d+1:s.line=d>7?d-2:d+1,s.align="left",s.position=Math.max(0,Math.min(100,l/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(s)}}},"./src/utils/discontinuities.js":
/*!**************************************!*\
  !*** ./src/utils/discontinuities.js ***!
  \**************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./binary-search */"./src/utils/binary-search.js"),i=r(/*! ../utils/logger */"./src/utils/logger.js");function a(e,t){for(var r=null,n=0;n<e.length;n+=1){var i=e[n];if(i&&i.cc===t){r=i;break}}return r}function s(e,t,r){var n=!1;return t&&t.details&&r&&(r.endCC>r.startCC||e&&e.cc<r.startCC)&&(n=!0),n}function o(e,t){var r=e.fragments,n=t.fragments;if(n.length&&r.length){var s=a(r,n[0].cc);if(s&&(!s||s.startPTS))return s;i.logger.log("No frag in previous level to align on")}else i.logger.log("No fragments to align")}function l(e,t){t.fragments.forEach(function(t){if(t){var r=t.start+e;t.start=t.startPTS=r,t.endPTS=r+t.duration}}),t.PTSKnown=!0}function u(e,t,r){if(s(e,r,t)){var n=o(r.details,t);n&&(i.logger.log("Adjusting PTS using last level due to CC increase within current level"),l(n.start,t))}}function c(t,r){if(r&&r.fragments.length){if(!t.hasProgramDateTime||!r.hasProgramDateTime)return;var n=r.fragments[0].programDateTime,a=(t.fragments[0].programDateTime-n)/1e3+r.fragments[0].start;e.isFinite(a)&&(i.logger.log("adjusting PTS using programDateTime delta, sliding:"+a.toFixed(3)),l(a,t))}}t.findFirstFragWithCC=a,t.findFragWithCC=function(e,t){return n.default.search(e,function(e){return e.cc<t?1:e.cc>t?-1:0})},t.shouldAlignOnDiscontinuities=s,t.findDiscontinuousReferenceFrag=o,t.adjustPts=l,t.alignStream=function(e,t,r){u(e,r,t),!r.PTSKnown&&t&&c(r,t.details)},t.alignDiscontinuities=u,t.alignPDT=c}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/utils/ewma-bandwidth-estimator.js":
/*!***********************************************!*\
  !*** ./src/utils/ewma-bandwidth-estimator.js ***!
  \***********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../utils/ewma */"./src/utils/ewma.js"),i=function(){function e(e,t,r,i){this.hls=e,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new n.default(t),this.fast_=new n.default(r)}return e.prototype.sample=function(e,t){var r=8e3*t/(e=Math.max(e,this.minDelayMs_)),n=e/1e3;this.fast_.sample(n,r),this.slow_.sample(n,r)},e.prototype.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},e.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.prototype.destroy=function(){},e}();t.default=i},"./src/utils/ewma.js":
/*!***************************!*\
  !*** ./src/utils/ewma.js ***!
  \***************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}return e.prototype.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},e.prototype.getTotalWeight=function(){return this.totalWeight_},e.prototype.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}();t.default=n},"./src/utils/get-self-scope.js":
/*!*************************************!*\
  !*** ./src/utils/get-self-scope.js ***!
  \*************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelfScope=function(){return"undefined"==typeof window?self:window}},"./src/utils/logger.js":
/*!*****************************!*\
  !*** ./src/utils/logger.js ***!
  \*****************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./get-self-scope */"./src/utils/get-self-scope.js");function i(){}var a={trace:i,debug:i,log:i,warn:i,info:i,error:i},s=a;function o(e,t){return t="["+e+"] > "+t}var l=n.getSelfScope();function u(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];t.forEach(function(t){s[t]=e[t]?e[t].bind(e):function(e){var t=l.console[e];return t?function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];r[0]&&(r[0]=o(e,r[0])),t.apply(l.console,r)}:i}(t)})}t.enableLogs=function(e){if(!0===e||"object"==typeof e){u(e,"debug","log","info","warn","error");try{s.log()}catch(e){s=a}}else s=a},t.logger=s},"./src/utils/mediakeys-helper.js":
/*!***************************************!*\
  !*** ./src/utils/mediakeys-helper.js ***!
  \***************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;t.requestMediaKeySystemAccess=n},"./src/utils/mediasource-helper.js":
/*!*****************************************!*\
  !*** ./src/utils/mediasource-helper.js ***!
  \*****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMediaSource=function(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}},"./src/utils/output-filter.js":
/*!************************************!*\
  !*** ./src/utils/output-filter.js ***!
  \************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.timelineController=e,this.trackName=t,this.startTime=null,this.endTime=null,this.screen=null}return e.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},e.prototype.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},e}();t.default=n},"./src/utils/texttrack-utils.js":
/*!**************************************!*\
  !*** ./src/utils/texttrack-utils.js ***!
  \**************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendAddTrackEvent=function(e,t){var r=null;try{r=new window.Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)},t.clearCurrentCues=function(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}},"./src/utils/time-ranges.js":
/*!**********************************!*\
  !*** ./src/utils/time-ranges.js ***!
  \**********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={toString:function(e){for(var t="",r=e.length,n=0;n<r;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t}}},"./src/utils/vttcue.js":
/*!*****************************!*\
  !*** ./src/utils/vttcue.js ***!
  \*****************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e="auto",t={"":!0,lr:!0,rl:!0},r={start:!0,middle:!0,end:!0,left:!0,right:!0};function n(e){return"string"==typeof e&&(!!r[e.toLowerCase()]&&e.toLowerCase())}function i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}function a(r,a,s){var o=this,l=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),u={};l?o=document.createElement("custom"):u.enumerable=!0,o.hasBeenReset=!1;var c="",d=!1,h=r,f=a,p=s,g=null,m="",v=!0,_="auto",y="start",b=50,w="middle",S=50,E="middle";if(Object.defineProperty(o,"id",i({},u,{get:function(){return c},set:function(e){c=""+e}})),Object.defineProperty(o,"pauseOnExit",i({},u,{get:function(){return d},set:function(e){d=!!e}})),Object.defineProperty(o,"startTime",i({},u,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",i({},u,{get:function(){return f},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",i({},u,{get:function(){return p},set:function(e){p=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",i({},u,{get:function(){return g},set:function(e){g=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",i({},u,{get:function(){return m},set:function(e){var r=function(e){return"string"==typeof e&&(!!t[e.toLowerCase()]&&e.toLowerCase())}(e);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");m=r,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",i({},u,{get:function(){return v},set:function(e){v=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",i({},u,{get:function(){return _},set:function(t){if("number"!=typeof t&&t!==e)throw new SyntaxError("An invalid number or illegal string was specified.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",i({},u,{get:function(){return y},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",i({},u,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",i({},u,{get:function(){return w},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");w=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",i({},u,{get:function(){return S},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");S=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",i({},u,{get:function(){return E},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),o.displayState=void 0,l)return o}return a.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},a}()},"./src/utils/vttparser.js":
/*!********************************!*\
  !*** ./src/utils/vttparser.js ***!
  \********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./vttcue */"./src/utils/vttcue.js"),i=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function a(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new i,this.regionList=[]}function s(){this.values=Object.create(null)}function o(e,t,r,n){var i=n?e.split(n):[e];for(var a in i)if("string"==typeof i[a]){var s=i[a].split(r);if(2===s.length)t(s[0],s[1])}}s.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var l=new n.default(0,0,0),u="middle"===l.align?"middle":"center";function c(e,t,r){var n=e;function i(){var t=function(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+(0|n)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=i(),a(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.substr(3),a(),t.endTime=i(),a(),function(e,t){var n=new s;o(e,function(e,t){switch(e){case"region":for(var i=r.length-1;i>=0;i--)if(r[i].id===t){n.set(e,r[i].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),s=a[0];n.integer(e,s),n.percent(e,s)&&n.set("snapToLines",!1),n.alt(e,s,["auto"]),2===a.length&&n.alt("lineAlign",a[1],["start",u,"end"]);break;case"position":a=t.split(","),n.percent(e,a[0]),2===a.length&&n.alt("positionAlign",a[1],["start",u,"end","line-left","line-right","auto"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",u,"end","left","right"])}},/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical","");var i=n.get("line","auto");"auto"===i&&-1===l.line&&(i=-1),t.line=i,t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align",u);var a=n.get("position","auto");"auto"===a&&50===l.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}(e,t)}function d(e){return e.replace(/<br(?: \/)?>/gi,"\n")}t.fixLineBreaks=d,a.prototype={parse:function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=d(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var n=e.substr(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.substr(r),n}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var i=void 0;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(i=r()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var s=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:i=r(),t.state){case"HEADER":/:/.test(i)?o(i,function(e,t){},/:/):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new n.default(0,0,""),t.state="CUE",-1===i.indexOf("--\x3e")){t.cue.id=i;continue}case"CUE":try{c(i,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var l=-1!==i.indexOf("--\x3e");if(!i||l&&(s=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID");continue}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}},t.default=a},"./src/utils/webvtt-parser.js":
/*!************************************!*\
  !*** ./src/utils/webvtt-parser.js ***!
  \************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./vttparser */"./src/utils/vttparser.js"),i=r(/*! ../demux/id3 */"./src/demux/id3.js"),a=function(e,t,r){return e.substr(r||0,t.length)===t},s=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()},o={parse:function(t,r,o,l,u,c){var d,h=i.utf8ArrayToStr(new Uint8Array(t)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),f="00:00.000",p=0,g=0,m=0,v=[],_=!0,y=new n.default;y.oncue=function(e){var t=o[l],r=o.ccOffset;t&&t.new&&(void 0!==g?r=o.ccOffset=t.start:function(e,t,r){var n=e[t],i=e[n.prevCC];if(!i||!i.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,void(n.new=!1);for(;i&&i.new;)e.ccOffset+=n.start-i.start,n.new=!1,i=e[(n=i).prevCC];e.presentationOffset=r}(o,l,m)),m&&(r=m-o.presentationOffset),e.startTime+=r-g,e.endTime+=r-g,e.id=s(e.startTime.toString())+s(e.endTime.toString())+s(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&v.push(e)},y.onparsingerror=function(e){d=e},y.onflush=function(){d&&c?c(d):u(v)},h.forEach(function(t){if(_){if(a(t,"X-TIMESTAMP-MAP=")){_=!1,t.substr(16).split(",").forEach(function(e){a(e,"LOCAL:")?f=e.substr(6):a(e,"MPEGTS:")&&(p=parseInt(e.substr(7)))});try{r+(9e4*o[l].start||0)<0&&(r+=8589934592),p-=r,n=f,i=parseInt(n.substr(-3)),s=parseInt(n.substr(-6,2)),u=parseInt(n.substr(-9,2)),c=n.length>9?parseInt(n.substr(0,n.indexOf(":"))):0,g=(e.isFinite(i)&&e.isFinite(s)&&e.isFinite(u)&&e.isFinite(c)?(i+=1e3*s,i+=6e4*u,i+=36e5*c):-1)/1e3,m=p/9e4,-1===g&&(d=new Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(e){d=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(_=!1)}var n,i,s,u,c;y.parse(t+"\n")}),y.flush()}};t.default=o}).call(this,r(/*! ./src/polyfills/number */"./src/polyfills/number.js").Number)},"./src/utils/xhr-loader.js":
/*!*********************************!*\
  !*** ./src/utils/xhr-loader.js ***!
  \*********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ../utils/logger */"./src/utils/logger.js"),i=window.performance,a=window.XMLHttpRequest,s=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}return e.prototype.destroy=function(){this.abort(),this.loader=null},e.prototype.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.prototype.load=function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:i.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},e.prototype.loadInternal=function(){var e,t=this.context;e=this.loader=new a;var r=this.stats;r.tfirst=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(e,t.url)}catch(r){e.open("GET",t.url,!0),n(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(r){return void this.callbacks.onError({code:e.status,text:r.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},e.prototype.readystatechange=function(e){var t=e.currentTarget,r=t.readyState,a=this.stats,s=this.context,o=this.config;if(!a.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===a.tfirst&&(a.tfirst=Math.max(i.now(),a.trequest)),4===r){var l=t.status;if(l>=200&&l<300){a.tload=Math.max(a.tfirst,i.now());var u=void 0,c=void 0;c="arraybuffer"===s.responseType?(u=t.response).byteLength:(u=t.responseText).length,a.loaded=a.total=c;var d={url:t.responseURL,data:u};this.callbacks.onSuccess(d,a,s,t)}else a.retry>=o.maxRetry||l>=400&&l<499?(n.logger.error(l+" while loading "+s.url),this.callbacks.onError({code:l,text:t.statusText},s,t)):(n.logger.warn(l+" while loading "+s.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),a.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)},e.prototype.loadtimeout=function(){n.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},e.prototype.loadprogress=function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var n=this.callbacks.onProgress;n&&n(r,this.context,null,t)},e}();t.default=s}}).default},e.exports=n())},function(e,t,r){(function(r){var n;
/*!
 *  howler.js v2.1.2
 *  howlerjs.com
 *
 *  (c) 2013-2019, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
/*!
 *  howler.js v2.1.2
 *  howlerjs.com
 *
 *  (c) 2013-2019, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
!function(){"use strict";var i=function(){this.init()};i.prototype={init:function(){var e=this||a;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||a;if(e=parseFloat(e),t.ctx||f(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,a.ctx.currentTime);for(var r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio)for(var n=t._howls[r]._getSoundIds(),i=0;i<n.length;i++){var s=t._howls[r]._soundById(n[i]);s&&s._node&&(s._node.volume=s._volume*e)}return t}return t._volume},mute:function(e){var t=this||a;t.ctx||f(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,a.ctx.currentTime);for(var r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio)for(var n=t._howls[r]._getSoundIds(),i=0;i<n.length;i++){var s=t._howls[r]._soundById(n[i]);s&&s._node&&(s._node.muted=!!e||s._muted)}return t},unload:function(){for(var e=this||a,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,f()),e},codecs:function(e){return(this||a)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||a;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||a,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var r=t.canPlayType("audio/mpeg;").replace(/^no$/,""),n=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),i=n&&parseInt(n[0].split("/")[1],10)<33;return e._codecs={mp3:!(i||!r&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!r,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||a;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(r){for(var n=0;n<e.html5PoolSize;n++)try{var i=new Audio;i._unlocked=!0,e._releaseHtml5Audio(i)}catch(r){e.noAudio=!0}for(n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var a=e._howls[n]._getSoundIds(),s=0;s<a.length;s++){var o=e._howls[n]._soundById(a[s]);o&&o._node&&!o._node._unlocked&&(o._node._unlocked=!0,o._node.load())}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0);for(var r=0;r<e._howls.length;r++)e._howls[r]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),e}},_obtainHtml5Audio:function(){var e=this||a;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var t=this||a;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&a.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var r=0;r<e._howls[t]._sounds.length;r++)if(!e._howls[t]._sounds[r]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&a.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var a=new i,s=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};s.prototype={init:function(e){var t=this;return a.ctx||f(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhrWithCredentials=e.xhrWithCredentials||!1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=a.usingWebAudio&&!t._html5,void 0!==a.ctx&&a.ctx&&a.autoUnlock&&a._unlockAudio(),a._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t.load(),t},load:function(){var e=null;if(a.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var t=0;t<this._src.length;t++){var r,n;if(this._format&&this._format[t])r=this._format[t];else{if("string"!=typeof(n=this._src[t])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(r=/^data:audio\/([^;,]+);/i.exec(n))||(r=/\.([^.]+)$/.exec(n.split("?",1)[0])),r&&(r=r[1].toLowerCase())}if(r||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),r&&a.codecs(r)){e=this._src[t];break}}if(e)return this._src=e,this._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new o(this),this._webAudio&&u(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var r=this,n=null;if("number"==typeof e)n=e,e=null;else{if("string"==typeof e&&"loaded"===r._state&&!r._sprite[e])return null;if(void 0===e&&(e="__default",!r._playLock)){for(var i=0,s=0;s<r._sounds.length;s++)r._sounds[s]._paused&&!r._sounds[s]._ended&&(i++,n=r._sounds[s]._id);1===i?e=null:n=null}}var o=n?r._soundById(n):r._inactiveSound();if(!o)return null;if(n&&!e&&(e=o._sprite||"__default"),"loaded"!==r._state){o._sprite=e,o._ended=!1;var l=o._id;return r._queue.push({event:"play",action:function(){r.play(l)}}),l}if(n&&!o._paused)return t||r._loadQueue("play"),o._id;r._webAudio&&a._autoResume();var u=Math.max(0,o._seek>0?o._seek:r._sprite[e][0]/1e3),c=Math.max(0,(r._sprite[e][0]+r._sprite[e][1])/1e3-u),d=1e3*c/Math.abs(o._rate),h=r._sprite[e][0]/1e3,f=(r._sprite[e][0]+r._sprite[e][1])/1e3,p=!(!o._loop&&!r._sprite[e][2]);o._sprite=e,o._ended=!1;var g=function(){o._paused=!1,o._seek=u,o._start=h,o._stop=f,o._loop=p};if(!(u>=f)){var m=o._node;if(r._webAudio){var v=function(){r._playLock=!1,g(),r._refreshBuffer(o);var e=o._muted||r._muted?0:o._volume;m.gain.setValueAtTime(e,a.ctx.currentTime),o._playStart=a.ctx.currentTime,void 0===m.bufferSource.start?o._loop?m.bufferSource.noteGrainOn(0,u,86400):m.bufferSource.noteGrainOn(0,u,c):o._loop?m.bufferSource.start(0,u,86400):m.bufferSource.start(0,u,c),d!==1/0&&(r._endTimers[o._id]=setTimeout(r._ended.bind(r,o),d)),t||setTimeout(function(){r._emit("play",o._id),r._loadQueue()},0)};"running"===a.state?v():(r._playLock=!0,r.once("resume",v),r._clearTimer(o._id))}else{var _=function(){m.currentTime=u,m.muted=o._muted||r._muted||a._muted||m.muted,m.volume=o._volume*a.volume(),m.playbackRate=o._rate;try{var n=m.play();if(n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)?(r._playLock=!0,g(),n.then(function(){r._playLock=!1,m._unlocked=!0,t||(r._emit("play",o._id),r._loadQueue())}).catch(function(){r._playLock=!1,r._emit("playerror",o._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),o._ended=!0,o._paused=!0})):t||(r._playLock=!1,g(),r._emit("play",o._id),r._loadQueue()),m.playbackRate=o._rate,m.paused)return void r._emit("playerror",o._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||o._loop?r._endTimers[o._id]=setTimeout(r._ended.bind(r,o),d):(r._endTimers[o._id]=function(){r._ended(o),m.removeEventListener("ended",r._endTimers[o._id],!1)},m.addEventListener("ended",r._endTimers[o._id],!1))}catch(e){r._emit("playerror",o._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=r._src,m.load());var y=window&&window.ejecta||!m.readyState&&a._navigator.isCocoonJS;if(m.readyState>=3||y)_();else{r._playLock=!0;var b=function(){_(),m.removeEventListener(a._canPlayEvent,b,!1)};m.addEventListener(a._canPlayEvent,b,!1),r._clearTimer(o._id)}}return o._id}r._ended(o)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var r=t._getSoundIds(e),n=0;n<r.length;n++){t._clearTimer(r[n]);var i=t._soundById(r[n]);if(i&&!i._paused&&(i._seek=t.seek(r[n]),i._rateSeek=0,i._paused=!0,t._stopFade(r[n]),i._node))if(t._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),t._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();arguments[1]||t._emit("pause",i?i._id:null)}return t},stop:function(e,t){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"stop",action:function(){r.stop(e)}}),r;for(var n=r._getSoundIds(e),i=0;i<n.length;i++){r._clearTimer(n[i]);var a=r._soundById(n[i]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,r._stopFade(n[i]),a._node&&(r._webAudio?a._node.bufferSource&&(void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),r._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause(),a._node.duration===1/0&&r._clearSound(a._node))),t||r._emit("stop",a._id))}return r},mute:function(e,t){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"mute",action:function(){r.mute(e,t)}}),r;if(void 0===t){if("boolean"!=typeof e)return r._muted;r._muted=e}for(var n=r._getSoundIds(t),i=0;i<n.length;i++){var s=r._soundById(n[i]);s&&(s._muted=e,s._interval&&r._stopFade(s._id),r._webAudio&&s._node?s._node.gain.setValueAtTime(e?0:s._volume,a.ctx.currentTime):s._node&&(s._node.muted=!!a._muted||e),r._emit("mute",s._id))}return r},volume:function(){var e,t,r,n=this,i=arguments;if(0===i.length)return n._volume;if(1===i.length||2===i.length&&void 0===i[1]){var s=n._getSoundIds(),o=s.indexOf(i[0]);o>=0?t=parseInt(i[0],10):e=parseFloat(i[0])}else i.length>=2&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(r=t?n._soundById(t):n._sounds[0])?r._volume:0;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,i)}}),n;void 0===t&&(n._volume=e),t=n._getSoundIds(t);for(var l=0;l<t.length;l++)(r=n._soundById(t[l]))&&(r._volume=e,i[2]||n._stopFade(t[l]),n._webAudio&&r._node&&!r._muted?r._node.gain.setValueAtTime(e,a.ctx.currentTime):r._node&&!r._muted&&(r._node.volume=e*a.volume()),n._emit("volume",r._id));return n},fade:function(e,t,r,n){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"fade",action:function(){i.fade(e,t,r,n)}}),i;e=parseFloat(e),t=parseFloat(t),r=parseFloat(r),i.volume(e,n);for(var s=i._getSoundIds(n),o=0;o<s.length;o++){var l=i._soundById(s[o]);if(l){if(n||i._stopFade(s[o]),i._webAudio&&!l._muted){var u=a.ctx.currentTime,c=u+r/1e3;l._volume=e,l._node.gain.setValueAtTime(e,u),l._node.gain.linearRampToValueAtTime(t,c)}i._startFadeInterval(l,e,t,r,s[o],void 0===n)}}return i},_startFadeInterval:function(e,t,r,n,i,a){var s=this,o=t,l=r-t,u=Math.abs(l/.01),c=Math.max(4,u>0?n/u:n),d=Date.now();e._fadeTo=r,e._interval=setInterval(function(){var i=(Date.now()-d)/n;d=Date.now(),o+=l*i,o=Math.max(0,o),o=Math.min(1,o),o=Math.round(100*o)/100,s._webAudio?e._volume=o:s.volume(o,e._id,!0),a&&(s._volume=o),(r<t&&o<=r||r>t&&o>=r)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,s.volume(r,e._id),s._emit("fade",e._id))},c)},_stopFade:function(e){var t=this._soundById(e);return t&&t._interval&&(this._webAudio&&t._node.gain.cancelScheduledValues(a.ctx.currentTime),clearInterval(t._interval),t._interval=null,this.volume(t._fadeTo,e),t._fadeTo=null,this._emit("fade",e)),this},loop:function(){var e,t,r,n=this,i=arguments;if(0===i.length)return n._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(r=n._soundById(parseInt(i[0],10)))&&r._loop;e=i[0],n._loop=e}else 2===i.length&&(e=i[0],t=parseInt(i[1],10));for(var a=n._getSoundIds(t),s=0;s<a.length;s++)(r=n._soundById(a[s]))&&(r._loop=e,n._webAudio&&r._node&&r._node.bufferSource&&(r._node.bufferSource.loop=e,e&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop)));return n},rate:function(){var e,t,r,n=this,i=arguments;if(0===i.length)t=n._sounds[0]._id;else if(1===i.length){var s=n._getSoundIds(),o=s.indexOf(i[0]);o>=0?t=parseInt(i[0],10):e=parseFloat(i[0])}else 2===i.length&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if("number"!=typeof e)return(r=n._soundById(t))?r._rate:n._rate;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,i)}}),n;void 0===t&&(n._rate=e),t=n._getSoundIds(t);for(var l=0;l<t.length;l++)if(r=n._soundById(t[l])){n.playing(t[l])&&(r._rateSeek=n.seek(t[l]),r._playStart=n._webAudio?a.ctx.currentTime:r._playStart),r._rate=e,n._webAudio&&r._node&&r._node.bufferSource?r._node.bufferSource.playbackRate.setValueAtTime(e,a.ctx.currentTime):r._node&&(r._node.playbackRate=e);var u=n.seek(t[l]),c=(n._sprite[r._sprite][0]+n._sprite[r._sprite][1])/1e3-u,d=1e3*c/Math.abs(r._rate);!n._endTimers[t[l]]&&r._paused||(n._clearTimer(t[l]),n._endTimers[t[l]]=setTimeout(n._ended.bind(n,r),d)),n._emit("rate",r._id)}return n},seek:function(){var e,t,r=this,n=arguments;if(0===n.length)t=r._sounds[0]._id;else if(1===n.length){var i=r._getSoundIds(),s=i.indexOf(n[0]);s>=0?t=parseInt(n[0],10):r._sounds.length&&(t=r._sounds[0]._id,e=parseFloat(n[0]))}else 2===n.length&&(e=parseFloat(n[0]),t=parseInt(n[1],10));if(void 0===t)return r;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"seek",action:function(){r.seek.apply(r,n)}}),r;var o=r._soundById(t);if(o){if(!("number"==typeof e&&e>=0)){if(r._webAudio){var l=r.playing(t)?a.ctx.currentTime-o._playStart:0,u=o._rateSeek?o._rateSeek-o._seek:0;return o._seek+(u+l*Math.abs(o._rate))}return o._node.currentTime}var c=r.playing(t);c&&r.pause(t,!0),o._seek=e,o._ended=!1,r._clearTimer(t),r._webAudio||!o._node||isNaN(o._node.duration)||(o._node.currentTime=e);var d=function(){r._emit("seek",t),c&&r.play(t,!0)};if(c&&!r._webAudio){var h=function(){r._playLock?setTimeout(h,0):d()};setTimeout(h,0)}else d()}return r},playing:function(e){if("number"==typeof e){var t=this._soundById(e);return!!t&&!t._paused}for(var r=0;r<this._sounds.length;r++)if(!this._sounds[r]._paused)return!0;return!1},duration:function(e){var t=this._duration,r=this._soundById(e);return r&&(t=this._sprite[r._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,r=0;r<t.length;r++)t[r]._paused||e.stop(t[r]._id),e._webAudio||(e._clearSound(t[r]._node),t[r]._node.removeEventListener("error",t[r]._errorFn,!1),t[r]._node.removeEventListener(a._canPlayEvent,t[r]._loadFn,!1),a._releaseHtml5Audio(t[r]._node)),delete t[r]._node,e._clearTimer(t[r]._id);var n=a._howls.indexOf(e);n>=0&&a._howls.splice(n,1);var i=!0;for(r=0;r<a._howls.length;r++)if(a._howls[r]._src===e._src||e._src.indexOf(a._howls[r]._src)>=0){i=!1;break}return l&&i&&delete l[e._src],a.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,r,n){var i=this["_on"+e];return"function"==typeof t&&i.push(n?{id:r,fn:t,once:n}:{id:r,fn:t}),this},off:function(e,t,r){var n=this["_on"+e],i=0;if("number"==typeof t&&(r=t,t=null),t||r)for(i=0;i<n.length;i++){var a=r===n[i].id;if(t===n[i].fn&&a||!t&&a){n.splice(i,1);break}}else if(e)this["_on"+e]=[];else{var s=Object.keys(this);for(i=0;i<s.length;i++)0===s[i].indexOf("_on")&&Array.isArray(this[s[i]])&&(this[s[i]]=[])}return this},once:function(e,t,r){return this.on(e,t,r,1),this},_emit:function(e,t,r){for(var n=this["_on"+e],i=n.length-1;i>=0;i--)n[i].id&&n[i].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,r)}.bind(this,n[i].fn),0),n[i].once&&this.off(e,n[i].fn,n[i].id));return this._loadQueue(e),this},_loadQueue:function(e){if(this._queue.length>0){var t=this._queue[0];t.event===e&&(this._queue.shift(),this._loadQueue()),e||t.action()}return this},_ended:function(e){var t=e._sprite;if(!this._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(this._ended.bind(this,e),100),this;var r=!(!e._loop&&!this._sprite[t][2]);if(this._emit("end",e._id),!this._webAudio&&r&&this.stop(e._id,!0).play(e._id),this._webAudio&&r){this._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=a.ctx.currentTime;var n=1e3*(e._stop-e._start)/Math.abs(e._rate);this._endTimers[e._id]=setTimeout(this._ended.bind(this,e),n)}return this._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,this._clearTimer(e._id),this._cleanBuffer(e._node),a._autoSuspend()),this._webAudio||r||this.stop(e._id,!0),this},_clearTimer:function(e){if(this._endTimers[e]){if("function"!=typeof this._endTimers[e])clearTimeout(this._endTimers[e]);else{var t=this._soundById(e);t&&t._node&&t._node.removeEventListener("ended",this._endTimers[e],!1)}delete this._endTimers[e]}return this},_soundById:function(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function(){this._drain();for(var e=0;e<this._sounds.length;e++)if(this._sounds[e]._ended)return this._sounds[e].reset();return new o(this)},_drain:function(){var e=this._pool,t=0,r=0;if(!(this._sounds.length<e)){for(r=0;r<this._sounds.length;r++)this._sounds[r]._ended&&t++;for(r=this._sounds.length-1;r>=0;r--){if(t<=e)return;this._sounds[r]._ended&&(this._webAudio&&this._sounds[r]._node&&this._sounds[r]._node.disconnect(0),this._sounds.splice(r,1),t--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],r=0;r<this._sounds.length;r++)t.push(this._sounds[r]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=a.ctx.createBufferSource(),e._node.bufferSource.buffer=l[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,a.ctx.currentTime),this},_cleanBuffer:function(e){var t=a._navigator&&a._navigator.vendor.indexOf("Apple")>=0;if(a._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=a._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(a._navigator&&a._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var o=function(e){this._parent=e,this.init()};o.prototype={init:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++a._counter,e._sounds.push(this),this.create(),this},create:function(){var e=this._parent,t=a._muted||this._muted||this._parent._muted?0:this._volume;return e._webAudio?(this._node=void 0===a.ctx.createGain?a.ctx.createGainNode():a.ctx.createGain(),this._node.gain.setValueAtTime(t,a.ctx.currentTime),this._node.paused=!0,this._node.connect(a.masterGain)):(this._node=a._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(a._canPlayEvent,this._loadFn,!1),this._node.src=e._src,this._node.preload="auto",this._node.volume=t*a.volume(),this._node.load()),this},reset:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++a._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(a._canPlayEvent,this._loadFn,!1)}};var l={},u=function(e){var t=e._src;if(l[t])return e._duration=l[t].duration,void h(e);if(/^data:[^;]+;base64,/.test(t)){for(var r=atob(t.split(",")[1]),n=new Uint8Array(r.length),i=0;i<r.length;++i)n[i]=r.charCodeAt(i);d(n.buffer,e)}else{var a=new XMLHttpRequest;a.open("GET",t,!0),a.withCredentials=e._xhrWithCredentials,a.responseType="arraybuffer",a.onload=function(){var t=(a.status+"")[0];"0"===t||"2"===t||"3"===t?d(a.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+a.status+".")},a.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete l[t],e.load())},c(a)}},c=function(e){try{e.send()}catch(t){e.onerror()}},d=function(e,t){var r=function(){t._emit("loaderror",null,"Decoding audio data failed.")},n=function(e){e&&t._sounds.length>0?(l[t._src]=e,h(t,e)):r()};"undefined"!=typeof Promise&&1===a.ctx.decodeAudioData.length?a.ctx.decodeAudioData(e).then(n).catch(r):a.ctx.decodeAudioData(e,n,r)},h=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},f=function(){if(a.usingWebAudio){try{"undefined"!=typeof AudioContext?a.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?a.ctx=new webkitAudioContext:a.usingWebAudio=!1}catch(e){a.usingWebAudio=!1}a.ctx||(a.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(a._navigator&&a._navigator.platform),t=a._navigator&&a._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),r=t?parseInt(t[1],10):null;if(e&&r&&r<9){var n=/safari/.test(a._navigator&&a._navigator.userAgent.toLowerCase());(a._navigator&&a._navigator.standalone&&!n||a._navigator&&!a._navigator.standalone&&!n)&&(a.usingWebAudio=!1)}a.usingWebAudio&&(a.masterGain=void 0===a.ctx.createGain?a.ctx.createGainNode():a.ctx.createGain(),a.masterGain.gain.setValueAtTime(a._muted?0:1,a.ctx.currentTime),a.masterGain.connect(a.ctx.destination)),a._setup()}};void 0===(n=function(){return{Howler:a,Howl:s}}.apply(t,[]))||(e.exports=n),t.Howler=a,t.Howl=s,"undefined"!=typeof window?(window.HowlerGlobal=i,window.Howler=a,window.Howl=s,window.Sound=o):void 0!==r&&(r.HowlerGlobal=i,r.Howler=a,r.Howl=s,r.Sound=o)}(),
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.1.2
 *  howlerjs.com
 *
 *  (c) 2013-2019, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){if(!this.ctx||!this.ctx.listener)return this;for(var t=this._howls.length-1;t>=0;t--)this._howls[t].stereo(e);return this},HowlerGlobal.prototype.pos=function(e,t,r){return this.ctx&&this.ctx.listener?(t="number"!=typeof t?this._pos[1]:t,r="number"!=typeof r?this._pos[2]:r,"number"!=typeof e?this._pos:(this._pos=[e,t,r],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(e,t,r,n,i,a){if(!this.ctx||!this.ctx.listener)return this;var s=this._orientation;return t="number"!=typeof t?s[1]:t,r="number"!=typeof r?s[2]:r,n="number"!=typeof n?s[3]:n,i="number"!=typeof i?s[4]:i,a="number"!=typeof a?s[5]:a,"number"!=typeof e?s:(this._orientation=[e,t,r,n,i,a],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(r,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(e,t,r,n,i,a),this)},Howl.prototype.init=(e=Howl.prototype.init,function(t){return this._orientation=t.orientation||[1,0,0],this._stereo=t.stereo||null,this._pos=t.pos||null,this._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},this._onstereo=t.onstereo?[{fn:t.onstereo}]:[],this._onpos=t.onpos?[{fn:t.onpos}]:[],this._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,r){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,r)}}),n;var i=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===r){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var a=n._getSoundIds(r),s=0;s<a.length;s++){var o=n._soundById(a[s]);if(o){if("number"!=typeof e)return o._stereo;o._stereo=e,o._pos=[e,0,0],o._node&&(o._pannerAttr.panningModel="equalpower",o._panner&&o._panner.pan||t(o,i),"spatial"===i?void 0!==o._panner.positionX?(o._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),o._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),o._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):o._panner.setPosition(e,0,0):o._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",o._id)}}return n},Howl.prototype.pos=function(e,r,n,i){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"pos",action:function(){a.pos(e,r,n,i)}}),a;if(r="number"!=typeof r?0:r,n="number"!=typeof n?-.5:n,void 0===i){if("number"!=typeof e)return a._pos;a._pos=[e,r,n]}for(var s=a._getSoundIds(i),o=0;o<s.length;o++){var l=a._soundById(s[o]);if(l){if("number"!=typeof e)return l._pos;l._pos=[e,r,n],l._node&&(l._panner&&!l._panner.pan||t(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setPosition(e,r,n)),a._emit("pos",l._id)}}return a},Howl.prototype.orientation=function(e,r,n,i){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"orientation",action:function(){a.orientation(e,r,n,i)}}),a;if(r="number"!=typeof r?a._orientation[1]:r,n="number"!=typeof n?a._orientation[2]:n,void 0===i){if("number"!=typeof e)return a._orientation;a._orientation=[e,r,n]}for(var s=a._getSoundIds(i),o=0;o<s.length;o++){var l=a._soundById(s[o]);if(l){if("number"!=typeof e)return l._orientation;l._orientation=[e,r,n],l._node&&(l._panner||(l._pos||(l._pos=a._pos||[0,0,-.5]),t(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setOrientation(e,r,n)),a._emit("orientation",l._id)}}return a},Howl.prototype.pannerAttr=function(){var e,r,n,i=this,a=arguments;if(!i._webAudio)return i;if(0===a.length)return i._pannerAttr;if(1===a.length){if("object"!=typeof a[0])return(n=i._soundById(parseInt(a[0],10)))?n._pannerAttr:i._pannerAttr;e=a[0],void 0===r&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),i._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:i._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:i._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:i._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:i._panningModel})}else 2===a.length&&(e=a[0],r=parseInt(a[1],10));for(var s=i._getSoundIds(r),o=0;o<s.length;o++)if(n=i._soundById(s[o])){var l=n._pannerAttr;l={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:l.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:l.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:l.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:l.panningModel};var u=n._panner;u?(u.coneInnerAngle=l.coneInnerAngle,u.coneOuterAngle=l.coneOuterAngle,u.coneOuterGain=l.coneOuterGain,u.distanceModel=l.distanceModel,u.maxDistance=l.maxDistance,u.refDistance=l.refDistance,u.rolloffFactor=l.rolloffFactor,u.panningModel=l.panningModel):(n._pos||(n._pos=i._pos||[0,0,-.5]),t(n,"spatial"))}return i},Sound.prototype.init=function(e){return function(){var t=this._parent;this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,e.call(this),this._stereo?t.stereo(this._stereo):this._pos&&t.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this._parent;return this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,this._stereo?t.stereo(this._stereo):this._pos?t.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,t._refreshBuffer(this)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}).call(this,r(1))},function(e,t,r){(function(e){!function(){var r="undefined"!=typeof window?window:e,n={};for(var i in function(e,t){var r,n="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){e!=Array.prototype&&e!=Object.prototype&&(e[t]=r.value)},i=void 0!==e&&e===this?this:void 0!==t&&null!=t?t:this;function a(){a=function(){},i.Symbol||(i.Symbol=o)}var s,o=(s=0,function(e){return"jscomp_symbol_"+(e||"")+s++});function l(){a();var e=i.Symbol.iterator;e||(e=i.Symbol.iterator=i.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&n(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return u(this)}}),l=function(){}}function u(e){var t=0;return c(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})}function c(e){return l(),(e={next:e})[i.Symbol.iterator]=function(){return this},e}function d(e){l();var t=e[Symbol.iterator];return t?t.call(e):u(e)}function h(e,t){if(t){for(var r=i,a=e.split("."),s=0;s<a.length-1;s++){var o=a[s];o in r||(r[o]={}),r=r[o]}(o=t(s=r[a=a[a.length-1]]))!=s&&null!=o&&n(r,a,{configurable:!0,writable:!0,value:o})}}function f(e){return function(e){function t(t){return e.next(t)}function r(t){return e.throw(t)}return new Promise(function(n,i){!function e(a){a.done?n(a.value):Promise.resolve(a.value).then(t,r).then(e,i)}(e.next())})}(e())}h("Promise",function(e){function t(e){this.b=0,this.g=void 0,this.a=[];var t=this.c();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function r(){this.a=null}function n(e){return e instanceof t?e:new t(function(t){t(e)})}if(e)return e;r.prototype.b=function(e){null==this.a&&(this.a=[],this.f()),this.a.push(e)},r.prototype.f=function(){var e=this;this.c(function(){e.h()})};var a=i.setTimeout;r.prototype.c=function(e){a(e,0)},r.prototype.h=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var r=e[t];e[t]=null;try{r()}catch(e){this.g(e)}}}this.a=null},r.prototype.g=function(e){this.c(function(){throw e})},t.prototype.c=function(){function e(e){return function(n){r||(r=!0,e.call(t,n))}}var t=this,r=!1;return{resolve:e(this.s),reject:e(this.f)}},t.prototype.s=function(e){if(e===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.v(e);else{e:switch(typeof e){case"object":var r=null!=e;break e;case"function":r=!0;break e;default:r=!1}r?this.m(e):this.h(e)}},t.prototype.m=function(e){var t=void 0;try{t=e.then}catch(e){return void this.f(e)}"function"==typeof t?this.C(t,e):this.h(e)},t.prototype.f=function(e){this.i(2,e)},t.prototype.h=function(e){this.i(1,e)},t.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.g=t,this.l()},t.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)s.b(this.a[e]);this.a=null}};var s=new r;return t.prototype.v=function(e){var t=this.c();e.Yb(t.resolve,t.reject)},t.prototype.C=function(e,t){var r=this.c();try{e.call(t,r.resolve,r.reject)}catch(e){r.reject(e)}},t.prototype.then=function(e,r){function n(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){a(e)}}:t}var i,a,s=new t(function(e,t){i=e,a=t});return this.Yb(n(e,i),n(r,a)),s},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Yb=function(e,t){function r(){switch(n.b){case 1:e(n.g);break;case 2:t(n.g);break;default:throw Error("Unexpected state: "+n.b)}}var n=this;null==this.a?s.b(r):this.a.push(r)},t.resolve=n,t.reject=function(e){return new t(function(t,r){r(e)})},t.race=function(e){return new t(function(t,r){for(var i=d(e),a=i.next();!a.done;a=i.next())n(a.value).Yb(t,r)})},t.all=function(e){var r=d(e),i=r.next();return i.done?n([]):new t(function(e,t){function a(t){return function(r){s[t]=r,0==--o&&e(s)}}var s=[],o=0;do{s.push(void 0),o++,n(i.value).Yb(a(s.length-1),t),i=r.next()}while(!i.done)})},t}),h("Promise.prototype.finally",function(e){return e||function(e){return this.then(function(t){return Promise.resolve(e()).then(function(){return t})},function(t){return Promise.resolve(e()).then(function(){throw t})})}});var p,g="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)p=Object.setPrototypeOf;else{var m;e:{var v={};try{v.__proto__={ne:!0},m=v.ne;break e}catch(s){}m=!1}p=m?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var _=p;function y(){this.g=!1,this.c=null,this.o=void 0,this.j=1,this.b=this.f=0,this.i=this.a=null}function b(e){if(e.g)throw new TypeError("Generator is already running");e.g=!0}function w(e,t){e.a={yd:t,Gd:!0},e.j=e.f||e.b}function S(e,t,r){return e.j=r,{value:t}}function E(e){e.j=0}function x(e,t,r){e.f=t,null!=r&&(e.b=r)}function T(e,t){e.f=0,e.b=t||0}function k(e,t){e.j=t,e.f=0}function A(e){e.f=0;var t=e.a.yd;return e.a=null,t}function C(e){e.i=[e.a],e.f=0,e.b=0}function j(e,t){var r=e.i.splice(0)[0];(r=e.a=e.a||r)?r.Gd?e.j=e.f||e.b:null!=r.A&&e.b<r.A?(e.j=r.A,e.a=null):e.j=e.b:e.j=t}function D(e){this.a=new y,this.b=e}function R(e,t,r,n){try{var i=t.call(e.a.c,r);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.a.g=!1,i;var a=i.value}catch(t){return e.a.c=null,w(e.a,t),L(e)}return e.a.c=null,n.call(e.a,a),L(e)}function L(e){for(;e.a.j;)try{var t=e.b(e.a);if(t)return e.a.g=!1,{value:t.value,done:!1}}catch(t){e.a.o=void 0,w(e.a,t)}if(e.a.g=!1,e.a.a){if(t=e.a.a,e.a.a=null,t.Gd)throw t.yd;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function I(e){this.next=function(t){return b(e.a),e.a.c?t=R(e,e.a.c.next,t,e.a.h):(e.a.h(t),t=L(e)),t},this.throw=function(t){return b(e.a),e.a.c?t=R(e,e.a.c.throw,t,e.a.h):(w(e.a,t),t=L(e)),t},this.return=function(t){return function(e,t){b(e.a);var r=e.a.c;return r?R(e,"return"in r?r.return:function(e){return{value:e,done:!0}},t,e.a.return):(e.a.return(t),L(e))}(e,t)},l(),this[Symbol.iterator]=function(){return this}}function O(e,t){return I.prototype=e.prototype,new I(new D(t))}function P(e){if(!(e instanceof Array)){e=d(e);for(var t,r=[];!(t=e.next()).done;)r.push(t.value);e=r}return e}function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function N(e,t,r){e instanceof String&&(e=String(e));for(var n=e.length,i=0;i<n;i++){var a=e[i];if(t.call(r,a,i,e))return{Cd:i,ie:a}}return{Cd:-1,ie:void 0}}function F(e,t,r){if(null==e)throw new TypeError("The 'this' value for String.prototype."+r+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+r+" must not be a regular expression");return e+""}y.prototype.h=function(e){this.o=e},y.prototype.return=function(e){this.a={return:e},this.j=this.b},y.prototype.A=function(e){this.j=e},h("WeakMap",function(e){function t(e){if(this.a=(o+=Math.random()+1).toString(),e){a(),l(),e=d(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function r(e){M(e,s)||n(e,s,{value:{}})}function i(e){var t=Object[e];t&&(Object[e]=function(e){return r(e),t(e)})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),r=Object.seal({}),n=new e([[t,2],[r,3]]);return 2==n.get(t)&&3==n.get(r)&&(n.delete(t),n.set(r,4),!n.has(t)&&4==n.get(r))}catch(e){return!1}}())return e;var s="$jscomp_hidden_"+Math.random();i("freeze"),i("preventExtensions"),i("seal");var o=0;return t.prototype.set=function(e,t){if(r(e),!M(e,s))throw Error("WeakMap key fail: "+e);return e[s][this.a]=t,this},t.prototype.get=function(e){return M(e,s)?e[s][this.a]:void 0},t.prototype.has=function(e){return M(e,s)&&M(e[s],this.a)},t.prototype.delete=function(e){return!(!M(e,s)||!M(e[s],this.a))&&delete e[s][this.a]},t}),h("Map",function(e){function t(){var e={};return e.Ca=e.next=e.head=e}function r(e,t){var r=e.a;return c(function(){if(r){for(;r.head!=e.a;)r=r.Ca;for(;r.next!=r.head;)return r=r.next,{done:!1,value:t(r)};r=null}return{done:!0,value:void 0}})}function n(e,t){var r=t&&typeof t;"object"==r||"function"==r?s.has(t)?r=s.get(t):(r=""+ ++o,s.set(t,r)):r="p_"+t;var n=e.b[r];if(n&&M(e.b,r))for(var i=0;i<n.length;i++){var a=n[i];if(t!=t&&a.key!=a.key||t===a.key)return{id:r,list:n,index:i,X:a}}return{id:r,list:n,index:-1,X:void 0}}function i(e){if(this.b={},this.a=t(),this.size=0,e){e=d(e);for(var r;!(r=e.next()).done;)r=r.value,this.set(r[0],r[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),r=new e(d([[t,"s"]]));if("s"!=r.get(t)||1!=r.size||r.get({x:4})||r.set({x:4},"t")!=r||2!=r.size)return!1;var n=r.entries(),i=n.next();return!i.done&&i.value[0]==t&&"s"==i.value[1]&&!((i=n.next()).done||4!=i.value[0].x||"t"!=i.value[1]||!n.next().done)}catch(e){return!1}}())return e;a(),l();var s=new WeakMap;i.prototype.set=function(e,t){var r=n(this,e);return r.list||(r.list=this.b[r.id]=[]),r.X?r.X.value=t:(r.X={next:this.a,Ca:this.a.Ca,head:this.a,key:e,value:t},r.list.push(r.X),this.a.Ca.next=r.X,this.a.Ca=r.X,this.size++),this},i.prototype.delete=function(e){return!(!(e=n(this,e)).X||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.b[e.id],e.X.Ca.next=e.X.next,e.X.next.Ca=e.X.Ca,e.X.head=null,this.size--,!0)},i.prototype.clear=function(){this.b={},this.a=this.a.Ca=t(),this.size=0},i.prototype.has=function(e){return!!n(this,e).X},i.prototype.get=function(e){return(e=n(this,e).X)&&e.value},i.prototype.entries=function(){return r(this,function(e){return[e.key,e.value]})},i.prototype.keys=function(){return r(this,function(e){return e.key})},i.prototype.values=function(){return r(this,function(e){return e.value})},i.prototype.forEach=function(e,t){for(var r,n=this.entries();!(r=n.next()).done;)r=r.value,e.call(t,r[1],r[0],this)},i.prototype[Symbol.iterator]=i.prototype.entries;var o=0;return i}),h("Set",function(e){function t(e){if(this.a=new Map,e){e=d(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.a.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),r=new e(d([t]));if(!r.has(t)||1!=r.size||r.add(t)!=r||1!=r.size||r.add({x:4})!=r||2!=r.size)return!1;var n=r.entries(),i=n.next();return!i.done&&i.value[0]==t&&i.value[1]==t&&(!(i=n.next()).done&&i.value[0]!=t&&4==i.value[0].x&&i.value[1]==i.value[0]&&n.next().done)}catch(e){return!1}}()?e:(a(),l(),t.prototype.add=function(e){return this.a.set(e,e),this.size=this.a.size,this},t.prototype.delete=function(e){return e=this.a.delete(e),this.size=this.a.size,e},t.prototype.clear=function(){this.a.clear(),this.size=0},t.prototype.has=function(e){return this.a.has(e)},t.prototype.entries=function(){return this.a.entries()},t.prototype.values=function(){return this.a.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var r=this;this.a.forEach(function(n){return e.call(t,n,n,r)})},t)}),h("Array.prototype.findIndex",function(e){return e||function(e,t){return N(this,e,t).Cd}}),h("Array.prototype.keys",function(e){return e||function(){return function(e,t){l(),e instanceof String&&(e+="");var r=0,n={next:function(){if(r<e.length){var i=r++;return{value:t(i,e[i]),done:!1}}return n.next=function(){return{done:!0,value:void 0}},n.next()}};return n[Symbol.iterator]=function(){return n},n}(this,function(e){return e})}}),h("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),h("Array.prototype.includes",function(e){return e||function(e,t){var r=this;r instanceof String&&(r=String(r));var n=r.length,i=t||0;for(0>i&&(i=Math.max(i+n,0));i<n;i++){var a=r[i];if(a===e||Object.is(a,e))return!0}return!1}}),h("String.prototype.includes",function(e){return e||function(e,t){return-1!==F(this,e,"includes").indexOf(e,t||0)}}),h("Array.from",function(e){return e||function(e,t,r){l(),t=null!=t?t:function(e){return e};var n=[],i=e[Symbol.iterator];if("function"==typeof i)for(e=i.call(e);!(i=e.next()).done;)n.push(t.call(r,i.value));else{i=e.length;for(var a=0;a<i;a++)n.push(t.call(r,e[a]))}return n}}),h("String.prototype.startsWith",function(e){return e||function(e,t){for(var r=F(this,e,"startsWith"),n=r.length,i=e.length,a=Math.max(0,Math.min(0|t,r.length)),s=0;s<i&&a<n;)if(r[a++]!=e[s++])return!1;return s>=i}}),h("Array.prototype.find",function(e){return e||function(e,t){return N(this,e,t).ie}});var B=this;function U(e,t){var r,n=e.split("."),i=B;n[0]in i||!i.execScript||i.execScript("var "+n[0]);for(;n.length&&(r=n.shift());)n.length||void 0===t?i=i[r]?i[r]:i[r]={}:i[r]=t}function G(e,t){function r(){}r.prototype=t.prototype,e.ag=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.og=function(e,r,n){return t.prototype[r].apply(e,Array.prototype.slice.call(arguments,2))}}function z(e){this.c=Math.exp(Math.log(.5)/e),this.b=this.a=0}function H(e,t,r){var n=Math.pow(e.c,t);r=r*(1-n)+n*e.a,isNaN(r)||(e.a=r,e.b+=t)}function V(e){return e.a/(1-Math.pow(e.c,e.b))}function K(){this.b=new z(2),this.c=new z(5),this.a=0}function W(){}function q(){}function X(){}B.a=!0,K.prototype.getBandwidthEstimate=function(e){return 128e3>this.a?e:Math.min(V(this.b),V(this.c))},e.console&&e.console.log.bind&&(q=console.warn.bind(console),W=console.error.bind(console));var Y=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function $(e){var t;e instanceof $?(J(this,e.va),this.$a=e.$a,this.ra=e.ra,Q(this,e.xb),this.ia=e.ia,Z(this,e.a.clone()),this.Qa=e.Qa):e&&(t=String(e).match(Y))?(J(this,t[1]||"",!0),this.$a=ee(t[2]||""),this.ra=ee(t[3]||"",!0),Q(this,t[4]),this.ia=ee(t[5]||"",!0),Z(this,t[6]||"",!0),this.Qa=ee(t[7]||"")):this.a=new le(null)}function J(e,t,r){e.va=r?ee(t,!0):t,e.va&&(e.va=e.va.replace(/:$/,""))}function Q(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.xb=t}else e.xb=null}function Z(e,t,r){t instanceof le?e.a=t:(r||(t=te(t,se)),e.a=new le(t))}function ee(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function te(e,t,r){return"string"==typeof e?(e=encodeURI(e).replace(t,re),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function re(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(r=$.prototype).va="",r.$a="",r.ra="",r.xb=null,r.ia="",r.Qa="",r.toString=function(){var e=[],t=this.va;if(t&&e.push(te(t,ne,!0),":"),t=this.ra){e.push("//");var r=this.$a;r&&e.push(te(r,ne,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.xb)&&e.push(":",String(t))}return(t=this.ia)&&(this.ra&&"/"!=t.charAt(0)&&e.push("/"),e.push(te(t,"/"==t.charAt(0)?ae:ie,!0))),(t=this.a.toString())&&e.push("?",t),(t=this.Qa)&&e.push("#",te(t,oe)),e.join("")},r.resolve=function(e){var t=this.clone();"data"===t.va&&(t=new $);var r=!!e.va;r?J(t,e.va):r=!!e.$a,r?t.$a=e.$a:r=!!e.ra,r?t.ra=e.ra:r=null!=e.xb;var n=e.ia;if(r)Q(t,e.xb);else if(r=!!e.ia){if("/"!=n.charAt(0))if(this.ra&&!this.ia)n="/"+n;else{var i=t.ia.lastIndexOf("/");-1!=i&&(n=t.ia.substr(0,i+1)+n)}if(".."==n||"."==n)n="";else if(-1!=n.indexOf("./")||-1!=n.indexOf("/.")){i=0==n.lastIndexOf("/",0),n=n.split("/");for(var a=[],s=0;s<n.length;){var o=n[s++];"."==o?i&&s==n.length&&a.push(""):".."==o?((1<a.length||1==a.length&&""!=a[0])&&a.pop(),i&&s==n.length&&a.push("")):(a.push(o),i=!0)}n=a.join("/")}}return r?t.ia=n:r=""!==e.a.toString(),r?Z(t,e.a.clone()):r=!!e.Qa,r&&(t.Qa=e.Qa),t},r.clone=function(){return new $(this)};var ne=/[#\/\?@]/g,ie=/[#\?:]/g,ae=/[#\?]/g,se=/[#\?@]/g,oe=/#/g;function le(e){this.a=e||null}function ue(e){this.b=e,this.a=null}function ce(e){this.b=e,this.a=null}function de(e,t){var r={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0};this.i=null==e.maxAttempts?r.maxAttempts:e.maxAttempts,this.f=null==e.baseDelay?r.baseDelay:e.baseDelay,this.h=null==e.fuzzFactor?r.fuzzFactor:e.fuzzFactor,this.g=null==e.backoffFactor?r.backoffFactor:e.backoffFactor,this.a=0,this.b=this.f,(this.c=void 0!==t&&t)&&(this.a=1)}function he(e){return f(function t(){var r,n;return O(t,function(t){switch(t.j){case 1:if(e.a>=e.i){if(!e.c)return t.return(Promise.reject());e.a=1,e.b=e.f}return r=e.a,e.a++,0==r?t.return():(n=e.b*(1+(2*Math.random()-1)*e.h),S(t,new Promise(function(e){new ce(e).O(n/1e3)}),2));case 2:e.b*=e.g,E(t)}})})}function fe(e,t,r,n){for(var i=[],a=3;a<arguments.length;++a)i[a-3]=arguments[a];this.severity=e,this.category=t,this.code=r,this.data=i,this.handled=!1}function pe(){var e,t,r=new Promise(function(r,n){e=r,t=n});return r.resolve=e,r.reject=t,r}function ge(e,t){this.promise=e,this.Jd=t,this.a=!1}function me(e){return new ge(Promise.reject(e),function(){return Promise.resolve()})}function ve(){var e=Promise.reject(new fe(2,7,7001));return e.catch(function(){}),new ge(e,function(){return Promise.resolve()})}function _e(e){return new ge(Promise.resolve(e),function(){return Promise.resolve()})}function ye(e){return new ge(e,function(){return e.catch(function(){})})}function be(e){return new ge(Promise.all(e.map(function(e){return e.promise})),function(){return Promise.all(e.map(function(e){return e.abort()}))})}function we(e,t,r){try{var n=e(t);return n&&n.promise&&n.abort?(r.resolve(n.promise),function(){return n.abort()}):(r.resolve(n),function(){return Promise.resolve(n).then(function(){}).catch(function(){})})}catch(e){return r.reject(e),function(){return Promise.resolve()}}}function Se(t,r){for(var n in r=void 0===r?{}:r)this[n]=r[n];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.a=!1}function Ee(){this.a={}}function xe(){this.Bc=new Ee,this.Vb=this}function Te(e){var t=new Set;return function e(r){switch(typeof r){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return r;default:if(!r||r.buffer&&r.buffer.constructor==ArrayBuffer)return r;if(t.has(r))return null;var n=r.constructor==Array;if(r.constructor!=Object&&!n)return null;t.add(r);var i,a=n?[]:{};for(i in r)a[i]=e(r[i]);return n&&(a.length=r.length),a}}(e)}function ke(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function Ae(e,t){var r=e.indexOf(t);-1<r&&e.splice(r,1)}function Ce(e,t,r){if(r||(r=ke),e.length!=t.length)return!1;t=t.slice();for(var n={},i=(e=d(e)).next();!i.done;n={item:n.item},i=e.next()){if(n.item=i.value,-1==(i=t.findIndex(function(e){return function(t){return r(e.item,t)}}(n))))return!1;t[i]=t[t.length-1],t.pop()}return 0==t.length}function je(){this.a=[]}function De(e,t){e.a.push(t.finally(function(){Ae(e.a,t)}))}function Re(e){xe.call(this),this.f=!1,this.g=new je,this.a=new Set,this.b=new Set,this.c=e||null}(r=le.prototype).ha=null,r.$b=null,r.add=function(e,t){if(!this.ha&&(this.ha={},this.$b=0,this.a))for(var r=this.a.split("&"),n=0;n<r.length;n++){var i=r[n].indexOf("="),a=null;if(0<=i){var s=r[n].substring(0,i);a=r[n].substring(i+1)}else s=r[n];s=decodeURIComponent(s.replace(/\+/g," ")),a=a||"",this.add(s,decodeURIComponent(a.replace(/\+/g," ")))}return this.a=null,(r=this.ha.hasOwnProperty(e)&&this.ha[e])||(this.ha[e]=r=[]),r.push(t),this.$b++,this},r.toString=function(){if(this.a)return this.a;if(!this.ha)return"";var e,t=[];for(e in this.ha)for(var r=encodeURIComponent(e),n=this.ha[e],i=0;i<n.length;i++){var a=r;""!==n[i]&&(a+="="+encodeURIComponent(n[i])),t.push(a)}return this.a=t.join("&")},r.clone=function(){var e=new le;if(e.a=this.a,this.ha){var t,r={};for(t in this.ha)r[t]=this.ha[t].concat();e.ha=r,e.$b=this.$b}return e},ue.prototype.O=function(t){var r=this;this.stop();var n=!0,i=null;return this.a=function(){e.clearTimeout(i),n=!1},i=e.setTimeout(function(){n&&r.b()},1e3*t),this},ue.prototype.stop=function(){this.a&&(this.a(),this.a=null)},U("shaka.util.Timer",ce),ce.prototype.sc=function(){return this.stop(),this.b(),this},ce.prototype.tickNow=ce.prototype.sc,ce.prototype.O=function(e){var t=this;return this.stop(),this.a=new ue(function(){t.b()}).O(e),this},ce.prototype.tickAfter=ce.prototype.O,ce.prototype.La=function(e){var t=this;return this.stop(),this.a=new ue(function(){t.a.O(e),t.b()}).O(e),this},ce.prototype.tickEvery=ce.prototype.La,ce.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)},ce.prototype.stop=ce.prototype.stop,U("shaka.util.Error",fe),fe.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},fe.Severity={RECOVERABLE:1,CRITICAL:2},fe.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},fe.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,CAST_RECEIVER_APP_ID_MISSING:8007,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013},pe.prototype.resolve=function(){},pe.prototype.reject=function(){},U("shaka.util.AbortableOperation",ge),ge.failed=me,ge.aborted=ve,ge.completed=_e,ge.notAbortable=ye,ge.prototype.abort=function(){return this.a=!0,this.Jd()},ge.prototype.abort=ge.prototype.abort,ge.all=be,ge.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},ge.prototype.finally=ge.prototype.finally,ge.prototype.U=function(e,t){function r(){return i.reject(new fe(2,7,7001)),n.abort()}var n=this,i=new pe;return this.promise.then(function(t){n.a?i.reject(new fe(2,7,7001)):e?r=we(e,t,i):i.resolve(t)},function(e){t?r=we(t,e,i):i.reject(e)}),new ge(i,function(){return r()})},ge.prototype.chain=ge.prototype.U,Se.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Se.prototype.stopImmediatePropagation=function(){this.a=!0},Se.prototype.stopPropagation=function(){},(r=Ee.prototype).push=function(e,t){this.a.hasOwnProperty(e)?this.a[e].push(t):this.a[e]=[t]},r.get=function(e){return(e=this.a[e])?e.slice():null},r.getAll=function(){var e,t=[];for(e in this.a)t.push.apply(t,this.a[e]);return t},r.remove=function(e,t){var r=this.a[e];if(r)for(var n=0;n<r.length;++n)r[n]==t&&(r.splice(n,1),--n)},r.forEach=function(e){for(var t in this.a)e(t,this.a[t])},xe.prototype.addEventListener=function(e,t){this.Bc.push(e,t)},xe.prototype.removeEventListener=function(e,t){this.Bc.remove(e,t)},xe.prototype.dispatchEvent=function(e){for(var t=this.Bc.get(e.type)||[],r=0;r<t.length;++r){e.target=this.Vb,e.currentTarget=this.Vb;var n=t[r];try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(e){}if(e.a)break}return e.defaultPrevented},je.prototype.destroy=function(){var e=[];return this.a.forEach(function(t){t.promise.catch(function(){}),e.push(t.abort())}),this.a=[],Promise.all(e)},G(Re,xe),U("shaka.net.NetworkingEngine",Re);var Le={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4};Re.RequestType=Le,Re.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Ie={};function Oe(e,t,r){r=r||3;var n=Ie[e];(!n||r>=n.priority)&&(Ie[e]={priority:r,zf:t})}function Pe(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null}}function Me(){this.a=0}function Ne(e,t,r){ge.call(this,e,t),this.b=r}Re.registerScheme=Oe,Re.unregisterScheme=function(e){delete Ie[e]},Re.prototype.Bf=function(e){this.a.add(e)},Re.prototype.registerRequestFilter=Re.prototype.Bf,Re.prototype.cg=function(e){this.a.delete(e)},Re.prototype.unregisterRequestFilter=Re.prototype.cg,Re.prototype.we=function(){this.a.clear()},Re.prototype.clearAllRequestFilters=Re.prototype.we,Re.prototype.Cf=function(e){this.b.add(e)},Re.prototype.registerResponseFilter=Re.prototype.Cf,Re.prototype.dg=function(e){this.b.delete(e)},Re.prototype.unregisterResponseFilter=Re.prototype.dg,Re.prototype.xe=function(){this.b.clear()},Re.prototype.clearAllResponseFilters=Re.prototype.xe,Re.prototype.destroy=function(){return this.f=!0,this.a.clear(),this.b.clear(),this.g.destroy()},Re.prototype.destroy=Re.prototype.destroy,Re.prototype.request=function(e,t){var r=this,n=new Me;if(this.f){var i=Promise.reject(new fe(2,7,7001));return i.catch(function(){}),new Ne(i,function(){return Promise.resolve()},n)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?Te(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},t.uris=Te(t.uris);var a=(i=function(e,t,r){for(var n=_e(void 0),i={},a=(e=d(e.a)).next();!a.done;i={fd:i.fd},a=e.next())i.fd=a.value,n=n.U(function(e){return function(){return e.fd(t,r)}}(i));return n.U(void 0,function(e){if(e&&7001==e.code)throw e;throw new fe(2,1,1006,e)})}(this,e,t)).U(function(){return function e(t,r,n,i,a,s,o){var l=new $(n.uris[a]),u=l.va,c=!1;u||(u=location.protocol,u=u.slice(0,-1),J(l,u),n.uris[a]=l.toString());var d=(u=Ie[u])?u.zf:null;if(!d)return me(new fe(2,1,1e3,l));var h;return ye(he(i)).U(function(){return t.f?ve():(h=Date.now(),d(n.uris[a],n,r,function(e,n,i){t.c&&1==r&&(t.c(e,n),c=!0,o.a=i)}))}).U(function(e){return null==e.timeMs&&(e.timeMs=Date.now()-h),{response:e,Ze:c}},function(l){if(l&&7001==l.code)throw l;if(t.f)return ve();if(l&&1==l.severity)return t.dispatchEvent(new Se("retry",{error:l instanceof fe?l:null})),a=(a+1)%n.uris.length,e(t,r,n,i,a,l,o);throw l||s})}(r,e,t,new de(t.retryParameters,!1),0,null,n)}),s=a.U(function(t){return function(e,t,r){for(var n=_e(void 0),i=(e=d(e.b)).next();!i.done;i=e.next())n=n.U(i.value.bind(null,t,r.response));return n.U(function(){return r},function(e){if(e&&7001==e.code)throw e;var t=2;throw e instanceof fe&&(t=e.severity),new fe(t,1,1007,e)})}(r,e,t)}),o=Date.now(),l=0;i.promise.then(function(){l=Date.now()-o},function(){});var u=0;return a.promise.then(function(){u=Date.now()},function(){}),i=new Ne((i=s.U(function(t){var n=Date.now()-u,i=t.response;return i.timeMs+=l,i.timeMs+=n,t.Ze||!r.c||i.fromCache||1!=e||r.c(i.timeMs,i.data.byteLength),i},function(e){throw e&&(e.severity=2),e})).promise,i.Jd,n),De(this.g,i),i},Re.prototype.request=Re.prototype.request,Re.NumBytesRemainingClass=Me;var Fe=Ne;if(Fe.prototype=g(ge.prototype),Fe.prototype.constructor=Fe,_)_(Fe,ge);else for(var Be in ge)if("prototype"!=Be)if(Object.defineProperties){var Ue=Object.getOwnPropertyDescriptor(ge,Be);Ue&&Object.defineProperty(Fe,Be,Ue)}else Fe[Be]=ge[Be];function Ge(){}function ze(){this.a=new Ee}function He(e,t,r,n){this.target=e,this.type=t,this.listener=r,this.a=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var r=new Set(["passive","capture"]);return Object.keys(t).filter(function(e){return!r.has(e)}),function(e){var t=Ve;if(null==t){t=!1;try{var r={},n={get:function(){return t=!0,!1}};Object.defineProperty(r,"passive",n),Object.defineProperty(r,"capture",n),n=function(){},e.addEventListener("test",n,r),e.removeEventListener("test",n,r)}catch(e){t=!1}Ve=t}return t||!1}(e)?t:t.capture||!1}(e,n),this.target.addEventListener(t,r,this.a)}Fe.ag=ge.prototype,Re.PendingRequest=Ne,Ne.all=be,Ne.notAbortable=ye,Ne.completed=_e,Ne.aborted=ve,Ne.failed=me,U("shaka.util.IReleasable",Ge),Ge.prototype.release=function(){},U("shaka.util.EventManager",ze),ze.prototype.release=function(){this.Ya(),this.a=null},ze.prototype.release=ze.prototype.release,ze.prototype.w=function(e,t,r,n){this.a&&(e=new He(e,t,r,n),this.a.push(t,e))},ze.prototype.listen=ze.prototype.w,ze.prototype.da=function(e,t,r,n){var i=this;this.w(e,t,function n(a){i.ea(e,t,n),r(a)},n)},ze.prototype.listenOnce=ze.prototype.da,ze.prototype.ea=function(e,t,r){if(this.a)for(var n=this.a.get(t)||[],i=(n=d(n)).next();!i.done;i=n.next())(i=i.value).target!=e||r!=i.listener&&r||(i.ea(),this.a.remove(t,i))},ze.prototype.unlisten=ze.prototype.ea,ze.prototype.Ya=function(){if(this.a){for(var e=this.a.getAll(),t=(e=d(e)).next();!t.done;t=e.next())t.value.ea();this.a.a={}}},ze.prototype.removeAll=ze.prototype.Ya,He.prototype.ea=function(){this.target.removeEventListener(this.type,this.listener,this.a),this.listener=this.target=null,this.a=!1},He.prototype.unlisten=He.prototype.ea;var Ve=void 0;function Ke(e){if(e=new Uint8Array(e),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");return new $(e=at(e.subarray(4),!0)).ra}function We(e,t,r){function n(e){new DataView(a.buffer).setUint32(s,e.byteLength,!0),s+=4,i(e)}function i(e){a.set(e,s),s+=e.byteLength}if(!r||!r.byteLength)throw new fe(2,6,6015);t="string"==typeof t?new Uint8Array(lt(t,!0)):new Uint8Array(t);var a=new Uint8Array(8+e.byteLength+t.byteLength+r.byteLength),s=0;return i(new Uint8Array(e)),n(t),n(new Uint8Array(r)),a}function qe(e,t){for(var r=d(e),n=r.next();!n.done;n=r.next())if(!t(n.value))return!1;return!0}function Xe(e){var t=new Map;return Object.keys(e).forEach(function(r){t.set(r,e[r])}),t}function Ye(e){var t={};return e.forEach(function(e,r){t[r]=e}),t}function $e(e,t){var r=e;return t&&(r+='; codecs="'+t+'"'),r}function Je(e){var t=(e=e.split("."))[0];return e.pop(),[t,e.join(".")]}U("shaka.util.FairPlayUtils.defaultGetContentId",Ke),U("shaka.util.FairPlayUtils.initDataTransform",We);var Qe=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function Ze(){return!(!e.MediaSource||!MediaSource.isTypeSupported)}function et(e){return""!=(nt||(rt||(rt=new ce(function(){nt=null})),(nt=document.querySelector("video")||document.querySelector("audio"))||(nt=document.createElement("video")),rt.O(1),nt)).canPlayType(e)}function tt(e){return(navigator.userAgent||"").includes(e)}var rt=null,nt=null;function it(e){if(!e)return"";239==(e=new Uint8Array(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),e=ut(e),e=escape(e);try{return decodeURIComponent(e)}catch(e){throw new fe(2,2,2004)}}function at(e,t,r){if(!e)return"";if(!r&&0!=e.byteLength%2)throw new fe(2,2,2004);if(e instanceof ArrayBuffer)var n=e;else(r=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),n=r.buffer;e=Math.floor(e.byteLength/2),r=new Uint16Array(e),n=new DataView(n);for(var i=0;i<e;i++)r[i]=n.getUint16(2*i,t);return ut(r)}function st(e){var t=new Uint8Array(e);if(239==t[0]&&187==t[1]&&191==t[2])return it(t);if(254==t[0]&&255==t[1])return at(t.subarray(2),!1);if(255==t[0]&&254==t[1])return at(t.subarray(2),!0);var r=function(e,t){return e.byteLength<=t||32<=e[t]&&126>=e[t]}.bind(null,t);if(0==t[0]&&0==t[2])return at(e,!1);if(0==t[1]&&0==t[3])return at(e,!0);if(r(0)&&r(1)&&r(2)&&r(3))return it(e);throw new fe(2,2,2003)}function ot(e){e=encodeURIComponent(e),e=unescape(e);for(var t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t.buffer}function lt(e,t){for(var r=new Uint8Array(2*e.length),n=new DataView(r.buffer),i=0;i<e.length;++i)n.setUint16(2*i,e.charCodeAt(i),t);return r.buffer}function ut(e){if(!ct)for(var t=function(e){try{return P(new Uint8Array(e)),!0}catch(e){return!1}},r={size:65536};0<r.size;(r={size:r.size}).size/=2)if(t(r.size)){ct=function(e){return function(t){for(var r="",n=0;n<t.length;n+=e.size)r+=String.fromCharCode.apply(String,P(t.subarray(n,n+e.size)));return r}}(r);break}return ct(e)}U("shaka.util.StringUtils.fromUTF8",it),U("shaka.util.StringUtils.fromUTF16",at),U("shaka.util.StringUtils.fromBytesAutoDetect",st),U("shaka.util.StringUtils.toUTF8",ot),U("shaka.util.StringUtils.toUTF16",lt);var ct=null;function dt(t,r){var n=ut(t);return r=null==r||r,n=e.btoa(n).replace(/\+/g,"-").replace(/\//g,"_"),r?n:n.replace(/=*$/,"")}function ht(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}function ft(t){for(var r=new Uint8Array(t.length/2),n=0;n<t.length;n+=2)r[n/2]=e.parseInt(t.substr(n,2),16);return r}function pt(e){for(var t="",r=0;r<e.length;++r){var n=e[r].toString(16);1==n.length&&(n="0"+n),t+=n}return t}function gt(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!=t[r])return!1;return!0}function mt(e){for(var t=[],r=0;r<arguments.length;++r)t[r]=arguments[r];for(var n=r=0;n<t.length;++n)r+=t[n].length;r=new Uint8Array(r);for(var i=n=0;i<t.length;++i)r.set(t[i],n),n+=t[i].length;return r}function vt(e){var t=this;this.C=e,this.v=new Set,this.m=this.h=null,this.P=!1,this.a=null,this.i=new ze,this.b=new Map,this.s=[],this.l=new pe,this.c=null,this.g=function(r){t.l.reject(r),e.onError(r)},this.na=new Map,this.T=new Map,this.M=new ce(function(){return function(e){var t=e.na,r=e.T;r.clear(),t.forEach(function(e,t){return r.set(t,e)}),(t=Array.from(r.values())).length&&t.every(function(e){return"expired"==e})&&e.g(new fe(2,6,6014)),e.C.kc(Ye(r))}(t)}),this.f=!1,this.$=new pe,this.D=!1,this.G=[],this.ma=!1,this.W=new ce(function(){!function(e){e.b.forEach(function(t,r){var n=t.Yc,i=r.expiration;isNaN(i)&&(i=1/0),i!=n&&(e.C.onExpirationUpdated(r.sessionId,i),t.Yc=i)})}(t)}).La(1),this.l.catch(function(){})}function _t(e,t,r){return e.s=r,e.D=0<r.length,yt(e,t)}function yt(t,r){var n=r.some(function(e){return 0<e.drmInfos.length});if(!n){var i=Xe(t.c.servers);!function(e,t){var r=[];t.forEach(function(e,t){r.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var n=d(e),i=n.next();!i.done;i=n.next())i.value.drmInfos=r}(r,i)}var a=function(t){if(0==(t=Xe(t.c.clearKeys)).size)return null;var r=[],n=[];t.forEach(function(e,t){var i=ft(t),a=ft(e);i={kty:"oct",kid:dt(i,!1),k:dt(a,!1)},r.push(i),n.push(i.kid)}),t=JSON.stringify({keys:r});var i=JSON.stringify({kids:n});return i=[{initData:new Uint8Array(ot(i)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:i,keyIds:[]}}(t);if(a){var s=d(r);for(i=s.next();!i.done;i=s.next())i.value.drmInfos=[a]}for(i=(a=d(r)).next();!i.done;i=a.next())for(s=(i=d(i.value.drmInfos)).next();!s.done;s=i.next())It(s.value,Xe(t.c.servers),Xe(t.c.advanced||{}));return(i=function(e,t){for(var r=new Set,n=d(t),i=n.next();!i.done;i=n.next()){var a=d(i.value.drmInfos);for(i=a.next();!i.done;i=a.next())r.add(i.value)}for(n=d(r),i=n.next();!i.done;i=n.next())It(i.value,Xe(e.c.servers),Xe(e.c.advanced||{}));a=e.D?"required":"optional";var s=e.D?["persistent-license"]:["temporary"];for(n=new Map,r=d(r),i=r.next();!i.done;i=r.next())i=i.value,n.set(i.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:a,sessionTypes:s,label:i.keySystem,drmInfos:[]});for(r=d(t),i=r.next();!i.done;i=r.next()){i=i.value,a=i.audio,s=i.video;var o=a?$e(a.mimeType,a.codecs):"",l=s?$e(s.mimeType,s.codecs):"",u=d(i.drmInfos);for(i=u.next();!i.done;i=u.next()){i=i.value;var c=n.get(i.keySystem);c.drmInfos.push(i),i.distinctiveIdentifierRequired&&(c.distinctiveIdentifier="required"),i.persistentStateRequired&&(c.persistentState="required"),a&&c.audioCapabilities.push({robustness:i.audioRobustness||"",contentType:o}),s&&c.videoCapabilities.push({robustness:i.videoRobustness||"",contentType:l})}}return n}(t,r)).size?(i=Tt(t,i),n?i:i.catch(function(){})):(t.P=!0,Promise.resolve())}function bt(e){return f(function t(){var r;return O(t,function(t){switch(t.j){case 1:if(!(e.h&&e.a&&e.a.serverCertificate&&e.a.serverCertificate.length)){t.A(0);break}return x(t,3),S(t,e.h.setServerCertificate(e.a.serverCertificate),5);case 5:k(t,0);break;case 3:return r=A(t),t.return(Promise.reject(new fe(2,6,6004,r.message)))}})})}function wt(e){var t=e.a?e.a.initData:[];return t.forEach(function(t){return At(e,t.initDataType,t.initData)}),e.s.forEach(function(t){return kt(e,t)}),t.length||e.s.length||e.l.resolve(),e.l}function St(e,t,r){for(var n=e.b.values(),i=(n=d(n)).next();!i.done;i=n.next())if(gt(r,i.value.initData))return;At(e,t,r)}function Et(e,t){return!!tt("Edge/")||e.v.has(t)}function xt(e){return e=function(e,t){for(var r=[],n=d(e),i=n.next();!i.done;i=n.next())r.push(t(i.value));return r}(e=e.b.keys(),function(e){return e.sessionId}),Array.from(e)}function Tt(e,t){if(1==t.size&&t.has(""))return Promise.reject(new fe(2,6,6e3));for(var r=d(t.values()),n=r.next();!n.done;n=r.next())0==(n=n.value).audioCapabilities.length&&delete n.audioCapabilities,0==n.videoCapabilities.length&&delete n.videoCapabilities;var i=r=new pe;return[!0,!1].forEach(function(e){var r=this;t.forEach(function(t,n){t.drmInfos.some(function(e){return!!e.licenseServerUri})==e&&(i=i.catch(function(){if(!this.f)return navigator.requestMediaKeySystemAccess(n,[t])}.bind(r)))})}.bind(e)),i=(i=i.catch(function(){return Promise.reject(new fe(2,6,6001))})).then(function(e){if(this.f)return Promise.reject();this.v.clear();var r=e.getConfiguration(),n=r.videoCapabilities||[],i=d(r.audioCapabilities||[]);for(r=i.next();!r.done;r=i.next())this.v.add(r.value.contentType);for(r=(n=d(n)).next();!r.done;r=n.next())this.v.add(r.value.contentType);n=e.keySystem,i=[];var a=[],s=[],o=[];return function(e,t,r,n,i){e.forEach(function(e){if(t.includes(e.licenseServerUri)||t.push(e.licenseServerUri),e.serverCertificate&&(r.some(function(t){return gt(t,e.serverCertificate)})||r.push(e.serverCertificate)),e.initData&&e.initData.forEach(function(e){n.some(function(t){return!(!t.keyId||t.keyId!=e.keyId)||t.initDataType==e.initDataType&&gt(t.initData,e.initData)})||n.push(e)}),e.keyIds)for(var a=0;a<e.keyIds.length;++a)i.includes(e.keyIds[a])||i.push(e.keyIds[a])})}((r=t.get(e.keySystem)).drmInfos,i,a,s,o),this.a={keySystem:n,licenseServerUri:i[0],distinctiveIdentifierRequired:"required"==r.distinctiveIdentifier,persistentStateRequired:"required"==r.persistentState,audioRobustness:r.audioCapabilities?r.audioCapabilities[0].robustness:"",videoRobustness:r.videoCapabilities?r.videoCapabilities[0].robustness:"",serverCertificate:a[0],initData:s,keyIds:o},this.a.licenseServerUri?e.createMediaKeys():Promise.reject(new fe(2,6,6012,this.a.keySystem))}.bind(e)).then(function(e){if(this.f)return Promise.reject();this.h=e,this.P=!0}.bind(e)).catch(function(e){if(!this.f)return this.a=null,this.v.clear(),e instanceof fe?Promise.reject(e):Promise.reject(new fe(2,6,6002,e.message))}.bind(e)),r.reject(),i}function kt(e,t){try{var r=e.h.createSession("persistent-license")}catch(t){var n=new fe(2,6,6005,t.message);return e.g(n),Promise.reject(n)}e.i.w(r,"message",e.Rd.bind(e)),e.i.w(r,"keystatuseschange",e.Pd.bind(e));var i={initData:null,loaded:!1,Yc:1/0,xa:null};return e.b.set(r,i),r.load(t).then(function(e){return this.f?Promise.reject():e?(i.loaded=!0,Lt(this)&&this.l.resolve(),r):(this.b.delete(r),void this.g(new fe(2,6,6013)))}.bind(e),function(e){this.f||(this.b.delete(r),this.g(new fe(2,6,6005,e.message)))}.bind(e))}function At(e,t,r){try{var n=e.D?e.h.createSession("persistent-license"):e.h.createSession()}catch(t){return void e.g(new fe(2,6,6005,t.message))}e.i.w(n,"message",e.Rd.bind(e)),e.i.w(n,"keystatuseschange",e.Pd.bind(e)),e.b.set(n,{initData:r,loaded:!1,Yc:1/0,xa:null});try{if(e.c.initDataTransform)r=e.c.initDataTransform(r);else if(e.keySystem().startsWith("com.apple.fps")){var i=e.a.serverCertificate;r=We(r,Ke(r),i)}}catch(r){return t=r,r instanceof fe||(t=new fe(2,6,6016,r)),void e.g(t)}n.generateRequest(t,r.buffer).catch(function(t){if(!e.f){if(e.b.delete(n),t.errorCode&&t.errorCode.systemCode){var r=t.errorCode.systemCode;0>r&&(r+=Math.pow(2,32)),r="0x"+r.toString(16)}e.g(new fe(2,6,6006,t.message,t,r))}})}function Ct(e,t){var r=t.target,n=e.b.get(r),i=e.a.licenseServerUri,a=e.c.advanced[e.a.keySystem];"individualization-request"==t.messageType&&a&&a.individualizationServer&&(i=a.individualizationServer),(i=Pe([i],e.c.retryParameters)).body=t.message,i.method="POST",i.licenseRequestType=t.messageType,i.sessionId=r.sessionId,"com.microsoft.playready"!=e.a.keySystem&&"com.chromecast.playready"!=e.a.keySystem||function(e){var t=at(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){for(var r=(t=(new DOMParser).parseFromString(t,"application/xml")).getElementsByTagName("HttpHeader"),n=0;n<r.length;++n)e.headers[r[n].querySelector("name").textContent]=r[n].querySelector("value").textContent;e.body=ht(t.querySelector("Challenge").textContent).buffer}else e.headers["Content-Type"]="text/xml; charset=utf-8"}(i),e.a.keySystem.startsWith("com.apple.fps")&&e.c.fairPlayTransform&&function(e){var t=new Uint8Array(e.body);t="spc="+dt(t),e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=ot(t)}(i),e.C.rb.request(2,i).promise.then(function(e){return this.f?Promise.reject():(this.a.keySystem.startsWith("com.apple.fps")&&this.c.fairPlayTransform&&function(e){try{var t=it(e.data)}catch(e){return}"<ckc>"===(t=t.trim()).substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));try{t=JSON.parse(t).ckc}catch(e){}e.data=ht(t).buffer}(e),r.update(e.data).then(function(){var e=this;this.C.onEvent(new Se("drmsessionupdate")),n&&(n.xa&&n.xa.resolve(),new ce(function(){n.loaded=!0,Lt(e)&&e.l.resolve()}).O(Pt))}.bind(this)))}.bind(e),function(e){this.f||(e=new fe(2,6,6007,e),this.g(e),n&&n.xa&&n.xa.reject(e))}.bind(e)).catch(function(e){this.f||(e=new fe(2,6,6008,e.message),this.g(e),n&&n.xa&&n.xa.reject(e))}.bind(e))}function jt(){var e=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],t=[{videoCapabilities:e,persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:e}],r=new Map;return e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(e){return function(e){return f(function n(){var i,a,s;return O(n,function(n){switch(n.j){case 1:return x(n,2),S(n,navigator.requestMediaKeySystemAccess(e,t),4);case 4:return i=n.o,s=!!(a=i.getConfiguration().sessionTypes)&&a.includes("persistent-license"),tt("Tizen 3")&&(s=!1),r.set(e,{persistentState:s}),S(n,i.createMediaKeys(),5);case 5:k(n,0);break;case 2:A(n),r.set(e,null),E(n)}})})}(e)}),Promise.all(e).then(function(){return Ye(r)})}function Dt(e,t){var r=t.audio,n=t.video;if(r&&r.encrypted&&!Et(e,$e(r.mimeType,r.codecs))||n&&n.encrypted&&!Et(e,$e(n.mimeType,n.codecs)))return!1;var i=e.keySystem();return 0==t.drmInfos.length||t.drmInfos.some(function(e){return e.keySystem==i})}function Rt(e,t){if(!e.length)return t;if(!t.length)return e;for(var r=[],n=0;n<e.length;n++)for(var i=0;i<t.length;i++)if(e[n].keySystem==t[i].keySystem){var a=e[n];i=t[i];var s=[];s=(s=s.concat(a.initData||[])).concat(i.initData||[]);var o=[];o=(o=o.concat(a.keyIds)).concat(i.keyIds),r.push({keySystem:a.keySystem,licenseServerUri:a.licenseServerUri||i.licenseServerUri,distinctiveIdentifierRequired:a.distinctiveIdentifierRequired||i.distinctiveIdentifierRequired,persistentStateRequired:a.persistentStateRequired||i.persistentStateRequired,videoRobustness:a.videoRobustness||i.videoRobustness,audioRobustness:a.audioRobustness||i.audioRobustness,serverCertificate:a.serverCertificate||i.serverCertificate,initData:s,keyIds:o});break}return r}function Lt(e){return qe(e=e.b.values(),function(e){return e.loaded})}function It(t,r,n){!t.keySystem||"org.w3.clearkey"==t.keySystem&&t.licenseServerUri||(r.size&&(r=r.get(t.keySystem)||"",t.licenseServerUri=r),t.keyIds||(t.keyIds=[]),(n=n.get(t.keySystem))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=n.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=n.persistentStateRequired),t.videoRobustness||(t.videoRobustness=n.videoRobustness),t.audioRobustness||(t.audioRobustness=n.audioRobustness),t.serverCertificate||(t.serverCertificate=n.serverCertificate)),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==t.keySystem&&(t.keySystem="com.chromecast.playready"))}U("shaka.util.Uint8ArrayUtils.toBase64",dt),U("shaka.util.Uint8ArrayUtils.fromBase64",ht),U("shaka.util.Uint8ArrayUtils.fromHex",ft),U("shaka.util.Uint8ArrayUtils.toHex",pt),U("shaka.util.Uint8ArrayUtils.equal",gt),U("shaka.util.Uint8ArrayUtils.concat",mt),(r=vt.prototype).destroy=function(){var e=this;return f(function t(){return O(t,function(t){switch(t.j){case 1:return e.f?S(t,e.$,0):(e.f=!0,S(t,function(e){return f(function t(){var r;return O(t,function(t){switch(t.j){case 1:return e.i.release(),e.i=null,e.l.reject(),e.W.stop(),e.W=null,e.M.stop(),e.M=null,r=Array.from(e.b.keys()),e.b.clear(),S(t,Promise.all(r.map(function(e){return Promise.resolve().then(function(){return f(function t(){return O(t,function(t){switch(t.j){case 1:return x(t,2),S(t,function(e){return f(function t(){var r;return O(t,function(t){switch(t.j){case 1:return r=new Promise(function(e){new ce(e).O(Ot)}),S(t,Promise.race([e.close().then(function(){return!0}),r.then(function(){return!1})]),2);case 2:E(t)}})})}(e),4);case 4:k(t,0);break;case 2:A(t),E(t)}})})})})),2);case 2:if(!e.m){t.A(3);break}return x(t,4),S(t,e.m.setMediaKeys(null),6);case 6:k(t,5);break;case 4:A(t);case 5:e.m=null;case 3:e.a=null,e.v.clear(),e.h=null,e.s=[],e.c=null,e.g=null,e.C=null,E(t)}})})}(e),4));case 4:e.$.resolve(),t.A(0)}})})},r.configure=function(e){this.c=e},r.Cb=function(e){var t=this;if(!this.h)return this.i.da(e,"encrypted",function(){t.g(new fe(2,6,6010))}),Promise.resolve();this.m=e,this.i.da(this.m,"play",function(){for(var e=0;e<t.G.length;e++)Ct(t,t.G[e]);t.ma=!0,t.G=[]}),e=(e=this.m.setMediaKeys(this.h)).catch(function(e){return Promise.reject(new fe(2,6,6003,e.message))});var r=bt(this);return Promise.all([e,r]).then(function(){if(t.f)return Promise.reject();wt(t),t.a.initData.length||t.s.length||t.i.w(t.m,"encrypted",function(e){return St(t,e.initDataType,new Uint8Array(e.initData))})}).catch(function(e){if(!t.f)return Promise.reject(e)})},r.keySystem=function(){return this.a?this.a.keySystem:""},r.dc=function(){for(var e=1/0,t=this.b.keys(),r=(t=d(t)).next();!r.done;r=t.next())r=r.value,isNaN(r.expiration)||(e=Math.min(e,r.expiration));return e},r.Rd=function(e){this.c.delayLicenseRequestUntilPlayed&&this.m.paused&&!this.ma?this.G.push(e):Ct(this,e)},r.Pd=function(e){e=e.target;var t=this.b.get(e),r=!1;e.keyStatuses.forEach(function(e,n){if("string"==typeof n){var i=n;n=e,e=i}if("com.microsoft.playready"==this.a.keySystem&&16==n.byteLength&&!tt("Tizen")){var a=(i=new DataView(n)).getUint32(0,!0),s=i.getUint16(4,!0),o=i.getUint16(6,!0);i.setUint32(0,a,!1),i.setUint16(4,s,!1),i.setUint16(6,o,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(t.loaded=!0),"expired"==e&&(r=!0),i=pt(new Uint8Array(n)),this.na.set(i,e)}.bind(this));var n=e.expiration-Date.now();(0>n||r&&1e3>n)&&t&&!t.xa&&(this.b.delete(e),e.close().catch(function(){})),Lt(this)&&(this.l.resolve(),this.M.O(Mt))};var Ot=1,Pt=5,Mt=.5;function Nt(){this.a=new muxjs.mp4.CaptionParser,this.g=[],this.f={}}function Ft(){}function Bt(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function Ut(e,t,r){return r=void 0===r?0:r,!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t+r>=e.start(0)}function Gt(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var r=0,n=e.length-1;0<=n&&e.end(n)>t;--n)r+=e.end(n)-Math.max(e.start(n),t);return r}function zt(e){if(!e)return[];for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}Nt.prototype.init=function(e){var t=muxjs.mp4.probe;e=new Uint8Array(e),this.g=t.videoTrackIds(e),this.f=t.timescale(e),this.a.init()},Nt.prototype.b=function(e,t){var r=new Uint8Array(e);(r=this.a.parse(r,this.g,this.f))&&r.captions&&t(r.captions),this.a.clearParsedCaptions()},Nt.prototype.c=function(){this.a.resetCaptionStream()},Ft.prototype.init=function(){},Ft.prototype.b=function(){},Ft.prototype.c=function(){};var Ht={ye:function(e,t){return e.reduce(function(e,t,r){return t.catch(e.bind(null,r))}.bind(null,t),Promise.reject())},yc:function(e,t){return e.concat(t)},ic:function(){},Ga:function(e){return null!=e}};function Vt(e,t){if(0==t.length)return e;var r=t.map(function(e){return new $(e)});return e.map(function(e){return new $(e)}).map(function(e){return r.map(e.resolve.bind(e))}).reduce(Ht.yc,[]).map(function(e){return e.toString()})}function Kt(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}var Wt={Na:"video",Ab:"audio",qa:"text",kg:"application"},qt=1/15;function Xt(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.b=null,this.g=[],this.c=[],this.f=!1,this.a.on("data",this.i.bind(this)),this.a.on("done",this.h.bind(this))}function Yt(t,r){return!(!e.muxjs||"mp2t"!=t.toLowerCase().split(";")[0].split("/")[1])&&(r?MediaSource.isTypeSupported($t(r,t)):MediaSource.isTypeSupported($t("audio",t))||MediaSource.isTypeSupported($t("video",t)))}function $t(e,t){var r=t.replace(/mp2t/i,"mp4");"audio"==e&&(r=r.replace("video","audio"));var n=/avc1\.(66|77|100)\.(\d+)/.exec(r);if(n){var i="avc1.",a=n[1],s=Number(n[2]);i=("66"==a?i+"4200":"77"==a?i+"4d00":i+"6400")+(s>>4).toString(16),i+=(15&s).toString(16),r=r.replace(n[0],i)}return r}function Jt(e,t,r){this.startTime=e,this.direction=nr,this.endTime=t,this.payload=r,this.region=new dr,this.position=null,this.positionAlign=Qt,this.size=100,this.textAlign=Zt,this.writingMode=ir,this.lineInterpretation=ar,this.line=null,this.lineHeight="",this.lineAlign=sr,this.displayAlign=tr,this.fontSize=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=lr,this.fontStyle=ur,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id=""}Xt.prototype.destroy=function(){return this.a.dispose(),this.a=null,Promise.resolve()},Xt.prototype.i=function(e){this.c=e.captions;var t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength);t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.g.push(t)},Xt.prototype.h=function(){var e={data:mt.apply(null,this.g),captions:this.c};this.b.resolve(e),this.f=!1},U("shaka.text.Cue",Jt);var Qt="auto";Jt.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Qt};var Zt="center",er={LEFT:"left",RIGHT:"right",CENTER:Zt,START:"start",END:"end"};Jt.textAlign=er;var tr="after",rr={BEFORE:"before",CENTER:"center",AFTER:tr};Jt.displayAlign=rr;var nr="ltr";Jt.direction={HORIZONTAL_LEFT_TO_RIGHT:nr,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var ir="horizontal-tb";Jt.writingMode={HORIZONTAL_TOP_TO_BOTTOM:ir,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var ar=0;Jt.lineInterpretation={LINE_NUMBER:ar,PERCENTAGE:1};var sr="start",or={CENTER:"center",START:sr,END:"end"};Jt.lineAlign=or;var lr=400;Jt.fontWeight={NORMAL:lr,BOLD:700};var ur="normal",cr={NORMAL:ur,ITALIC:"italic",OBLIQUE:"oblique"};function dr(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=hr,this.scroll=fr}Jt.fontStyle=cr,Jt.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},U("shaka.text.CueRegion",dr);var hr=1;dr.units={PX:0,PERCENTAGE:hr,LINES:2};var fr="";function pr(e){this.g=null,this.c=e,this.f=this.m=0,this.h=1/0,this.b=this.a=null,this.l="",this.i=new Map}dr.scrollMode={NONE:fr,UP:"up"};var gr={};function mr(t){return!!(gr[t]||e.muxjs&&"application/cea-608"==t)}function vr(e,t){"application/cea-608"!=t&&(e.g=new gr[t])}function _r(e,t,r,n,i){for(var a=r+" "+n,s=new Map,o=(t=d(t)).next();!o.done;o=t.next()){var l=o.value;o=l.stream,s.has(o)||s.set(o,new Map),s.get(o).has(a)||s.get(o).set(a,[]),l.startTime+=i,l.endTime+=i,l.startTime>=e.f&&l.startTime<e.h&&(l=new Jt(l.startTime,l.endTime,l.text),s.get(o).get(a).push(l),o==e.l&&e.c.append([l]))}for(a=(i=d(s.keys())).next();!a.done;a=i.next())for(a=a.value,e.i.has(a)||e.i.set(a,new Map),o=(t=d(s.get(a).keys())).next();!o.done;o=t.next())o=o.value,l=s.get(a).get(o),e.i.get(a).set(o,l);e.a=null==e.a?Math.max(r,e.f):Math.min(e.a,Math.max(r,e.f)),e.b=Math.max(e.b,Math.min(n,e.h))}function yr(e,t,r){this.f=e,this.g=r,this.b={},this.a=null,this.c={},this.i=new ze,this.v=!1,this.l={},this.m=t,e=this.s=new pe,t=new MediaSource,this.i.da(t,"sourceopen",e.resolve),this.f.src=br(t),this.h=t}U("shaka.text.TextEngine.registerParser",function(e,t){gr[e]=t}),U("shaka.text.TextEngine.unregisterParser",function(e){delete gr[e]}),pr.prototype.destroy=function(){return this.c=this.g=null,this.i.clear(),Promise.resolve()},pr.prototype.Mc=function(e){try{return this.g.parseMedia(new Uint8Array(e),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(e){throw new fe(2,2,2009,e)}},pr.prototype.remove=function(e,t){return Promise.resolve().then(function(){!this.c||!this.c.remove(e,t)||null==this.a||t<=this.a||e>=this.b||(e<=this.a&&t>=this.b?this.a=this.b=null:e<=this.a&&t<this.b?this.a=t:e>this.a&&t>=this.b&&(this.b=e))}.bind(this))},pr.prototype.qe=function(e){this.c.append(e)},pr.prototype.appendCues=pr.prototype.qe,pr.prototype.rc=function(e,t){this.l=e;var r=this.i.get(e);if(r)for(var n=d(r.keys()),i=n.next();!i.done;i=n.next())(i=r.get(i.value))&&(i=i.filter(function(e){return e.endTime<=t}),this.c.append(i))},pr.prototype.setSelectedClosedCaptionId=pr.prototype.rc;var br=e.URL.createObjectURL;function wr(e){var t=$e(e.mimeType,e.codecs),r=function(e){var t=[e.mimeType];return Qe.forEach(function(r,n){var i=e[n];i&&t.push(r+'="'+i+'"')}),t.join(";")}(e);return mr(t)||MediaSource.isTypeSupported(r)||Yt(t,e.type)}function Sr(e,t){e.a||(e.a=new pr(e.g)),vr(e.a,t)}function Er(e){return!e.h||"ended"==e.h.readyState}function xr(e,t){if("text"==t)var r=e.a.a;else r=!(r=kr(e,t))||1==r.length&&1e-6>r.end(0)-r.start(0)?null:1==r.length&&0>r.start(0)?0:r.length?r.start(0):null;return r}function Tr(e,t){return"text"==t?e.a.b:Bt(kr(e,t))}function kr(e,t){try{return e.b[t].buffered}catch(e){return null}}function Ar(t,r,n,i,a,s){return"text"==r?function(e,t,r,n){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==r||null==n)this.g.parseInit(new Uint8Array(t));else{var e={periodStart:this.m,segmentStart:r,segmentEnd:n};e=this.g.parseMedia(new Uint8Array(t),e).filter(function(e){return e.startTime>=this.f&&e.startTime<this.h}.bind(this)),this.c.append(e),null==this.a&&(this.a=Math.max(r,this.f)),this.b=Math.min(n,this.h)}}.bind(e))}(t.a,n,i,a):t.l[r]?function(e,t){e.f=!0,e.b=new pe,e.g=[],e.c=[];var r=new Uint8Array(t);return e.a.push(r),e.a.flush(),e.f&&e.b.reject(new fe(2,3,3018)),e.b}(t.l[r],n).then(function(e){return this.a||Sr(this,"text/vtt"),e.captions&&_r(this.a,e.captions,i,a,this.b.video.timestampOffset),jr(this,r,this.ee.bind(this,r,e.data.buffer))}.bind(t)):(s&&e.muxjs&&(t.a||Sr(t,"text/vtt"),null==i&&null==a?t.m.init(n):t.m.b(n,function(e){e.length&&_r(t.a,e,i,a,t.b.video.timestampOffset)})),jr(t,r,t.ee.bind(t,r,n)))}function Cr(e,t){return"text"==t?e.a?(e.m.c(),e.a.remove(0,1/0)):Promise.resolve():jr(e,t,e.fe.bind(e,t,0,e.h.duration))}function jr(e,t,r){if(e.v)return Promise.reject();if(r={start:r,p:new pe},e.c[t].push(r),1==e.c[t].length)try{r.start()}catch(n){"QuotaExceededError"==n.name?r.p.reject(new fe(2,3,3017,t)):r.p.reject(new fe(2,3,3015,n)),Rr(e,t)}return r.p}function Dr(e,t){if(e.v)return Promise.reject();var r,n=[];for(r in e.b){var i=new pe,a={start:function(e){e.resolve()}.bind(null,i),p:i};e.c[r].push(a),n.push(i),1==e.c[r].length&&a.start()}return Promise.all(n).then(function(){try{t()}catch(t){var e=Promise.reject(new fe(2,3,3015,t))}for(var r in this.b)Rr(this,r);return e}.bind(e),function(e){throw e}.bind(e))}function Rr(e,t){e.c[t].shift();var r=e.c[t][0];if(r)try{r.start()}catch(n){r.p.reject(new fe(2,3,3015,n)),Rr(e,t)}}function Lr(e,t){return e=Or(e),t=Or(t),e.split("-")[0]==t.split("-")[0]}function Ir(e,t){e=Or(e),t=Or(t);var r=e.split("-"),n=t.split("-");return r[0]==n[0]&&1==r.length&&2==n.length}function Or(e){var t=e.split("-");return e=t[0]||"",t=t[1]||"",e=e.toLowerCase(),e=Nr.get(e)||e,(t=t.toUpperCase())?e+"-"+t:e}function Pr(e){return e.language?Or(e.language):e.audio&&e.audio.language?Or(e.audio.language):e.video&&e.video.language?Or(e.video.language):"und"}function Mr(e,t){for(var r=Or(e),n=new Set,i=d(t),a=i.next();!a.done;a=i.next())n.add(Or(a.value));for(a=(i=d(n)).next();!a.done;a=i.next())if((a=a.value)==r)return a;for(a=(i=d(n)).next();!a.done;a=i.next())if(Ir(a=a.value,r))return a;for(a=(i=d(n)).next();!a.done;a=i.next()){var s=a=a.value,o=r;if(s=Or(s),o=Or(o),s=s.split("-"),o=o.split("-"),2==s.length&&2==o.length&&s[0]==o[0])return a}for(a=(n=d(n)).next();!a.done;a=n.next())if(Ir(r,i=a.value))return i;return null}(r=yr.prototype).destroy=function(){var e=this;this.v=!0;var t,r=[];for(t in this.c){var n=this.c[t],i=n[0];for(this.c[t]=n.slice(0,1),i&&r.push(i.p.catch(Ht.ic)),i=1;i<n.length;++i)n[i].p.reject()}for(var a in this.a&&r.push(this.a.destroy()),this.g&&r.push(this.g.destroy()),this.l)r.push(this.l[a].destroy());return Promise.all(r).then(function(){e.i&&(e.i.release(),e.i=null),e.f&&(e.f.removeAttribute("src"),e.f.load(),e.f=null),e.h=null,e.a=null,e.g=null,e.b={},e.l={},e.m=null,e.c={}})},r.init=function(e,t){var r=this;return f(function n(){var i;return O(n,function(n){switch(n.j){case 1:return i=Wt,S(n,r.s,2);case 2:e.forEach(function(e,n){var a=$e(e.mimeType,e.codecs);n==i.qa?Sr(r,a):(!t&&MediaSource.isTypeSupported(a)||!Yt(a,n)||(r.l[n]=new Xt,a=$t(n,a)),a=r.h.addSourceBuffer(a),r.i.w(a,"error",r.Tf.bind(r,n)),r.i.w(a,"updateend",r.ub.bind(r,n)),r.b[n]=a,r.c[n]=[])}),E(n)}})})},r.Jc=function(e){if(e.total=zt(this.f.buffered),e.audio=zt(kr(this,"audio")),e.video=zt(kr(this,"video")),e.text=[],this.a){var t=this.a.a,r=this.a.b;null!=t&&null!=r&&e.text.push({start:t,end:r})}},r.rc=function(e){var t=Tr(this,"video")||0;this.a.rc(e,t)},r.remove=function(e,t,r){return"text"==e?this.a.remove(t,r):jr(this,e,this.fe.bind(this,e,t,r))},r.flush=function(e){return"text"==e?Promise.resolve():jr(this,e,this.Ce.bind(this,e))},r.endOfStream=function(e){return Dr(this,function(){Er(this)||(e?this.h.endOfStream(e):this.h.endOfStream())}.bind(this))},r.wa=function(e){return Dr(this,function(){this.h.duration=e}.bind(this))},r.Y=function(){return this.h.duration},r.ee=function(e,t){this.b[e].appendBuffer(t)},r.fe=function(e,t,r){r<=t?this.ub(e):this.b[e].remove(t,r)},r.oe=function(e){var t=this.b[e].appendWindowStart,r=this.b[e].appendWindowEnd;this.b[e].abort(),this.b[e].appendWindowStart=t,this.b[e].appendWindowEnd=r,this.ub(e)},r.Ce=function(e){this.f.currentTime-=.001,this.ub(e)},r.Sf=function(e,t){0>t&&(t+=.001),this.b[e].timestampOffset=t,this.ub(e)},r.Pf=function(e,t,r){this.b[e].appendWindowStart=0,this.b[e].appendWindowEnd=r,this.b[e].appendWindowStart=t,this.ub(e)},r.Tf=function(e){this.c[e][0].p.reject(new fe(2,3,3014,this.f.error?this.f.error.code:0))},r.ub=function(e){var t=this.c[e][0];t&&(t.p.resolve(),Rr(this,e))};var Nr=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function Fr(e,t,r){function n(e,t,r){return e>=t&&e<=r}var i=e.video;return!(i&&i.width&&i.height&&!(n(i.width,t.minWidth,Math.min(t.maxWidth,r.width))&&n(i.height,t.minHeight,Math.min(t.maxHeight,r.height))&&n(i.width*i.height,t.minPixels,t.maxPixels))||!n(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function Br(e,t,r){var n=!1;return e.forEach(function(e){var i=e.allowedByApplication;e.allowedByApplication=Fr(e,t,r),i!=e.allowedByApplication&&(n=!0)}),n}function Ur(e,t,r,n){n.variants=n.variants.filter(function(n){if(e&&e.P&&!Dt(e,n))return!1;var i=n.audio;return n=n.video,!(i&&!wr(i)||n&&!wr(n)||i&&t&&!Gr(i,t)||n&&r&&!Gr(n,r))}),n.textStreams=n.textStreams.filter(function(e){return mr($e(e.mimeType,e.codecs))})}function Gr(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]}function zr(e){var t=e.audio,r=e.video,n=t?t.codecs:null,i=r?r.codecs:null,a=[];i&&a.push(i),n&&a.push(n);var s=[];r&&s.push(r.mimeType),t&&s.push(t.mimeType),s=s[0]||null;var o=[];t&&o.push(t.kind),r&&o.push(r.kind),o=o[0]||null;var l=new Set;return t&&t.roles.forEach(function(e){return l.add(e)}),r&&r.roles.forEach(function(e){return l.add(e)}),e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:o,width:null,height:null,frameRate:null,mimeType:s,codecs:a.join(", "),audioCodec:n,videoCodec:i,primary:e.primary,roles:Array.from(l),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null},r&&(e.videoId=r.id,e.originalVideoId=r.originalId,e.width=r.width||null,e.height=r.height||null,e.frameRate=r.frameRate||null,e.videoBandwidth=r.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioBandwidth=t.bandwidth||null,e.label=t.label,e.audioRoles=t.roles),e}function Hr(e){return{id:e.id,active:!1,type:"text",bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId}}function Vr(e){return e.__shaka_id||(e.__shaka_id=Kr++),e.__shaka_id}var Kr=0;function Wr(e){return{id:Vr(e),active:!1,type:"",bandwidth:0,language:Or(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}}function qr(e){return e.allowedByApplication&&e.allowedByKeySystem}function Xr(e,t){for(var r=e.filter(function(e){return e.audio&&e.audio.channelsCount}),n=new Map,i=(r=d(r)).next();!i.done;i=r.next()){var a=(i=i.value).audio.channelsCount;n.has(a)||n.set(a,[]),n.get(a).push(i)}return 0==(r=Array.from(n.keys())).length?e:(i=r.filter(function(e){return e<=t})).length?n.get(Math.max.apply(null,i)):n.get(Math.min.apply(null,r))}function Yr(e,t,r){var n=e,i=e.filter(function(e){return e.primary});i.length&&(n=i);var a=n.length?n[0].language:"";if(n=n.filter(function(e){return e.language==a}),t){var s=Mr(Or(t),e.map(function(e){return e.language}));s&&(n=e.filter(function(e){return Or(e.language)==s}))}if(r){if((e=$r(n,r)).length)return e}else if((e=n.filter(function(e){return 0==e.roles.length})).length)return e;return(e=n.map(function(e){return e.roles}).reduce(Ht.yc,[])).length?$r(n,e[0]):n}function $r(e,t){return e.filter(function(e){return e.roles.includes(t)})}function Jr(e,t,r){for(var n=0;n<r.length;n++)if(r[n].audio==e&&r[n].video==t)return r[n];return null}function Qr(){this.h=null,this.f=!1,this.b=new K,this.c=[],this.i=!1,this.a=this.g=null}function Zr(e,t){return e&&(t=t.filter(function(t){return Fr(t,e,{width:1/0,height:1/0})})),t.sort(function(e,t){return e.bandwidth-t.bandwidth})}function en(e,t){this.a=e,this.b=t}function tn(e,t){var r=new en(2,6),n=an,i=n.a,a=r.b-i.b;(0<(r.a-i.a||a)?n.c:n.b)(n.a,r,e,t)}function rn(e,t,r,n){q([r,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",n].join(" "))}function nn(e,t,r,n){W([r,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",n].join(""))}U("shaka.abr.SimpleAbrManager",Qr),Qr.prototype.stop=function(){this.h=null,this.f=!1,this.c=[],this.g=null},Qr.prototype.stop=Qr.prototype.stop,Qr.prototype.init=function(e){this.h=e},Qr.prototype.init=Qr.prototype.init,Qr.prototype.chooseVariant=function(){var e=Zr(this.a.restrictions,this.c),t=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.c.length&&!e.length&&(e=[(e=Zr(null,this.c))[0]]);for(var r=e[0]||null,n=0;n<e.length;++n){var i=e[n],a=(e[n+1]||{bandwidth:1/0}).bandwidth/this.a.bandwidthUpgradeTarget;t>=i.bandwidth/this.a.bandwidthDowngradeTarget&&t<=a&&(r=i)}return this.g=Date.now(),r},Qr.prototype.chooseVariant=Qr.prototype.chooseVariant,Qr.prototype.enable=function(){this.f=!0},Qr.prototype.enable=Qr.prototype.enable,Qr.prototype.disable=function(){this.f=!1},Qr.prototype.disable=Qr.prototype.disable,Qr.prototype.segmentDownloaded=function(e,t){var r=this.b;if(!(16e3>t)){var n=8e3*t/e,i=e/1e3;r.a+=t,H(r.b,i,n),H(r.c,i,n)}if(null!=this.g&&this.f)e:{if(this.i){if(Date.now()-this.g<1e3*this.a.switchInterval)break e}else{if(!(128e3<=this.b.a))break e;this.i=!0}r=this.chooseVariant(),this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate),this.h(r)}},Qr.prototype.segmentDownloaded=Qr.prototype.segmentDownloaded,Qr.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)},Qr.prototype.getBandwidthEstimate=Qr.prototype.getBandwidthEstimate,Qr.prototype.setVariants=function(e){this.c=e},Qr.prototype.setVariants=Qr.prototype.setVariants,Qr.prototype.configure=function(e){this.a=e},Qr.prototype.configure=Qr.prototype.configure,en.prototype.toString=function(){return"v"+this.a+"."+this.b};var an=null,sn="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),on="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),ln=["loop","playbackRate"],un=["pause","play"],cn="abrstatuschanged adaptation buffering emsg error loading streaming texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged textchanged".split(" "),dn={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},hn={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},fn=[["getConfiguration","configure"]],pn=[["isTextTrackVisible","setTextTrackVisibility"]],gn="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack setTextTrackVisibility trickPlay".split(" "),mn=["attach","detach","load","unload"];function vn(e){return JSON.stringify(e,function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Se){var r,n={};for(r in t){var i=t[r];i&&"object"==typeof i?"detail"==r&&(n[r]=i):r in Event||(n[r]=i)}return n}if(t instanceof TimeRanges)for(n={__type__:"TimeRanges",length:t.length,start:[],end:[]},r=0;r<t.length;++r)n.start.push(t.start(r)),n.end.push(t.end(r));else n=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return n}})}function _n(e){return JSON.parse(e,function(e,t){return"NaN"==t?NaN:"-Infinity"==t?-1/0:"Infinity"==t?1/0:t&&"object"==typeof t&&"TimeRanges"==t.__type__?function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t):t&&"object"==typeof t&&"Uint8Array"==t.__type__?new Uint8Array(t.entries):t})}function yn(e,t,r,n,i,a){this.T=e,this.f=new ce(t),this.P=r,this.l=!1,this.G=n,this.M=i,this.C=a,this.b=this.h=!1,this.D="",this.i=null,this.m=this.Nd.bind(this),this.s=this.kf.bind(this),this.a={video:{},player:{}},this.v=0,this.c={},this.g=null}var bn=!1,wn=null;function Sn(e){var t=wn;t.removeUpdateListener(e.m),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.s)}function En(e){for(var t in e.c){var r=e.c[t];delete e.c[t],r.reject(new fe(1,7,7e3))}}function xn(e){e=vn(e),wn.sendMessage("urn:x-cast:com.google.shaka.v2",e,function(){},X)}function Tn(e,t,r){var n=this;xe.call(this),this.c=e,this.b=t,this.i=this.g=this.f=this.l=this.h=null,(this.m=r)&&(this.a=new yn(r,function(){return An(n)},function(){return Cn(n)},function(e,t){return Dn(n,e,t)},function(){return jn(n)},function(){return kn(n)})),function(e){for(var t in e.a&&e.a.init(),e.i=new ze,sn.forEach(function(e){this.i.w(this.c,e,this.ig.bind(this))}.bind(e)),cn.forEach(function(e){this.i.w(this.b,e,this.yf.bind(this))}.bind(e)),e.h={},e.c)Object.defineProperty(e.h,t,{configurable:!1,enumerable:!0,get:e.hg.bind(e,t),set:e.jg.bind(e,t)});for(var r in e.l={},e.b)Object.defineProperty(e.l,r,{configurable:!1,enumerable:!0,get:e.Ud.bind(e,r)});e.f=new xe,e.f.Vb=e.h,e.g=new xe,e.g.Vb=e.l}(this)}function kn(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.b.bc(),startTime:null};return e.c.pause(),ln.forEach(function(e){t.video[e]=this.c[e]}.bind(e)),e.c.ended||(t.startTime=e.c.currentTime),fn.forEach(function(e){var r=e[1];e=this.b[e[0]](),t.player[r]=e}.bind(e)),pn.forEach(function(e){var r=e[1];e=this.b[e[0]](),t.playerAfterLoad[r]=e}.bind(e)),t}function An(e){e.dispatchEvent(new Se("caststatuschanged"))}function Cn(e){e.f.dispatchEvent(new Se(e.h.paused?"pause":"play"))}function jn(e){fn.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(e));var t=e.a.get("player","getAssetUri")(),r=e.a.get("video","ended"),n=Promise.resolve(),i=e.c.autoplay,a=null;r||(a=e.a.get("video","currentTime")),t&&(e.c.autoplay=!1,n=e.b.load(t,a));var s={};ln.forEach(function(e){s[e]=this.a.get("video",e)}.bind(e)),n.then(function(){e.c&&(ln.forEach(function(e){this.c[e]=s[e]}.bind(e)),pn.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(e)),e.c.autoplay=i,t&&e.c.play())},function(t){e.b.dispatchEvent(new Se("error",{detail:t}))})}function Dn(e,t,r){e.a.ga()&&("video"==t?e.f.dispatchEvent(r):"player"==t&&e.g.dispatchEvent(r))}function Rn(e,t,r,n){var i=this;xe.call(this),this.a=e,this.b=t,this.c=new ze,this.D={video:e,player:t},this.s=r||function(){},this.G=n||function(e){return e},this.v=!1,this.h=!0,this.g=0,this.m=!1,this.l=!0,this.i=this.f=null,this.C=new ce(function(){In(i)}),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=e.Qd.bind(e),t.onSenderDisconnected=e.Qd.bind(e),t.onSystemVolumeChanged=e.Be.bind(e),e.i=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.i.onMessage=e.ef.bind(e),e.f=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.f.onMessage=e.rf.bind(e),t.start(),sn.forEach(function(e){this.c.w(this.a,e,this.Wd.bind(this,"video"))}.bind(e)),cn.forEach(function(e){this.c.w(this.b,e,this.Wd.bind(this,"player"))}.bind(e)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?e.b.kd(3840,2160):e.b.kd(1920,1080),e.c.w(e.a,"loadeddata",function(){this.m=!0}.bind(e)),e.c.w(e.b,"loading",function(){this.h=!1,Ln(this)}.bind(e)),e.c.w(e.a,"playing",function(){this.h=!1,Ln(this)}.bind(e)),e.c.w(e.a,"pause",function(){Ln(this)}.bind(e)),e.c.w(e.b,"unloading",function(){this.h=!0,Ln(this)}.bind(e)),e.c.w(e.a,"ended",function(){var e=this;new ce(function(){e.a&&e.a.ended&&(e.h=!0,Ln(e))}).O(5)}.bind(e))}(this)}function Ln(e){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new Se("caststatuschanged")),On(this)||Nn(this,0))}.bind(e))}function In(e){e.C.O(.5);var t={video:{},player:{}};if(on.forEach(function(e){t.video[e]=this.a[e]}.bind(e)),e.b.V())for(var r in hn)0==e.g%hn[r]&&(t.player[r]=e.b[r]());for(var n in dn)0==e.g%dn[n]&&(t.player[n]=e.b[n]());(r=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=r.level,t.video.muted=r.muted),e.m&&(e.g+=1),Mn(e,{type:"update",update:t},e.f),On(e)}function On(e){return!(!e.l||!e.a.duration&&!e.b.V())&&(Pn(e),e.l=!1,!0)}function Pn(e){var t={contentId:e.b.bc(),streamType:e.b.V()?"LIVE":"BUFFERED",duration:e.a.duration,contentType:""};Nn(e,0,t)}function Mn(e,t,r,n){e.v&&(e=vn(t),n?r.getCastChannel(n).send(e):r.broadcast(e))}function Nn(e,t,r){var n=e.a.playbackRate,i=Fn;n={mediaSessionId:0,playbackRate:n,playerState:i=e.h?i.IDLE:e.b.Oc()?i.je:e.a.paused?i.le:i.me,currentTime:e.a.currentTime,supportedMediaCommands:15,volume:{level:e.a.volume,muted:e.a.muted}},r&&(n.media=r),Mn(e,{requestId:t,type:"MEDIA_STATUS",status:[n]},e.i)}(r=yn.prototype).destroy=function(){return En(this),wn&&Sn(this),this.f&&(this.f.stop(),this.f=null),this.M=this.G=null,this.b=this.h=!1,this.s=this.m=this.g=this.c=this.a=this.i=null,Promise.resolve()},r.ga=function(){return this.b},r.cd=function(){return this.D},r.init=function(){if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){delete e.__onGCastApiAvailable,this.h=!0,this.f.sc();var t=new chrome.cast.SessionRequest(this.T);t=new chrome.cast.ApiConfig(t,this.Od.bind(this),this.pf.bind(this),"origin_scoped"),chrome.cast.initialize(t,function(){},function(){}),bn&&this.f.O(.02),(t=wn)&&t.status!=chrome.cast.SessionStatus.STOPPED?this.Od(t):wn=null}else e.__onGCastApiAvailable=function(e){e&&this.init()}.bind(this)},r.jd=function(e){this.i=e,this.b&&xn({type:"appData",appData:this.i})},r.cast=function(e){return this.h?bn?this.b?Promise.reject(new fe(1,8,8002)):(this.g=new pe,chrome.cast.requestSession(this.$c.bind(this,e),this.Md.bind(this)),this.g):Promise.reject(new fe(1,8,8001)):Promise.reject(new fe(1,8,8e3))},r.Eb=function(){this.b&&(En(this),wn&&(Sn(this),wn.stop(function(){},function(){}),wn=null))},r.get=function(e,t){if("video"==e){if(un.includes(t))return this.Yd.bind(this,e,t)}else if("player"==e){if(hn[t]&&!this.get("player","isLive")())return function(){};if(gn.includes(t))return this.Yd.bind(this,e,t);if(mn.includes(t))return this.Ef.bind(this,e,t);if(dn[t])return this.Vd.bind(this,e,t)}return this.Vd(e,t)},r.set=function(e,t,r){this.a[e][t]=r,xn({type:"set",targetName:e,property:t,value:r})},r.$c=function(e,t){wn=t,t.addUpdateListener(this.m),t.addMessageListener("urn:x-cast:com.google.shaka.v2",this.s),this.Nd(),xn({type:"init",initState:e,appData:this.i}),this.g.resolve()},r.Md=function(e){var t=8003;switch(e.code){case"cancel":t=8004;break;case"timeout":t=8005;break;case"receiver_unavailable":t=8006}this.g.reject(new fe(2,8,t,e))},r.Vd=function(e,t){return this.a[e][t]},r.Yd=function(e,t,r){for(var n=[],i=2;i<arguments.length;++i)n[i-2]=arguments[i];xn({type:"call",targetName:e,methodName:t,args:n})},r.Ef=function(e,t,r){for(var n=[],i=2;i<arguments.length;++i)n[i-2]=arguments[i];i=new pe;var a=this.v.toString();return this.v++,this.c[a]=i,xn({type:"asyncCall",targetName:e,methodName:t,args:n,id:a}),i},r.Od=function(e){var t=this.C();this.g=new pe,this.l=!0,this.$c(t,e)},r.pf=function(e){bn="available"==e,this.f.sc()},r.Nd=function(){var e=!!wn&&"connected"==wn.status;if(this.b&&!e){for(var t in this.M(),this.a)this.a[t]={};En(this)}this.D=(this.b=e)?wn.receiver.friendlyName:"",this.f.sc()},r.kf=function(e,t){var r=_n(t);switch(r.type){case"event":var n=r.event;this.G(r.targetName,new Se(n.type,n));break;case"update":for(var i in n=r.update)for(var a in r=this.a[i]||{},n[i])r[a]=n[i][a];this.l&&(this.P(),this.l=!1);break;case"asyncComplete":if(i=r.id,r=r.error,a=this.c[i],delete this.c[i],a)if(r){for(n in i=new fe(r.severity,r.category,r.code),r)i[n]=r[n];a.reject(i)}else a.resolve()}},G(Tn,xe),U("shaka.cast.CastProxy",Tn),Tn.prototype.destroy=function(e){return e&&this.a&&this.a.Eb(),this.i&&(this.i.release(),this.i=null),e=[],this.b&&(e.push(this.b.destroy()),this.b=null),this.a&&(e.push(this.a.destroy()),this.a=null),this.l=this.h=this.c=null,Promise.all(e)},Tn.prototype.destroy=Tn.prototype.destroy,Tn.prototype.Ye=function(){return this.h},Tn.prototype.getVideo=Tn.prototype.Ye,Tn.prototype.Re=function(){return this.l},Tn.prototype.getPlayer=Tn.prototype.Re,Tn.prototype.se=function(){return!!this.a&&(this.a.h&&bn)},Tn.prototype.canCast=Tn.prototype.se,Tn.prototype.ga=function(){return!!this.a&&this.a.ga()},Tn.prototype.isCasting=Tn.prototype.ga,Tn.prototype.cd=function(){return this.a?this.a.cd():""},Tn.prototype.receiverName=Tn.prototype.cd,Tn.prototype.cast=function(){if(!this.a)throw new fe(1,8,8007);var e=kn(this);return this.a.cast(e).then(function(){if(this.b)return this.b.rd()}.bind(this))},Tn.prototype.cast=Tn.prototype.cast,Tn.prototype.jd=function(e){this.a&&this.a.jd(e)},Tn.prototype.setAppData=Tn.prototype.jd,Tn.prototype.$f=function(){if(this.a){var e=this.a;if(e.b){var t=e.C();chrome.cast.requestSession(e.$c.bind(e,t),e.Md.bind(e))}}},Tn.prototype.suggestDisconnect=Tn.prototype.$f,Tn.prototype.ve=function(e){var t=this;return f(function r(){return O(r,function(r){switch(r.j){case 1:if(e==t.m)return r.return();if(t.m=e,!t.a){r.A(2);break}return t.a.Eb(),S(r,t.a.destroy(),3);case 3:t.a=null;case 2:t.a=new yn(e,function(){return An(t)},function(){return Cn(t)},function(e,r){return Dn(t,e,r)},function(){return jn(t)},function(){return kn(t)}),t.a.init(),E(r)}})})},Tn.prototype.changeReceiverId=Tn.prototype.ve,Tn.prototype.Eb=function(){this.a&&this.a.Eb()},Tn.prototype.forceDisconnect=Tn.prototype.Eb,(r=Tn.prototype).hg=function(e){if("addEventListener"==e)return this.f.addEventListener.bind(this.f);if("removeEventListener"==e)return this.f.removeEventListener.bind(this.f);if(this.a&&this.a.ga()&&0==Object.keys(this.a.a.video).length){var t=this.c[e];if("function"!=typeof t)return t}return this.a&&this.a.ga()?this.a.get("video",e):("function"==typeof(e=this.c[e])&&(e=e.bind(this.c)),e)},r.jg=function(e,t){this.a&&this.a.ga()?this.a.set("video",e,t):this.c[e]=t},r.ig=function(e){this.a&&this.a.ga()||this.f.dispatchEvent(new Se(e.type,e))},r.Ud=function(e){if("addEventListener"==e)return this.g.addEventListener.bind(this.g);if("removeEventListener"==e)return this.g.removeEventListener.bind(this.g);if("getMediaElement"==e)return function(){return this.h}.bind(this);if("getSharedConfiguration"==e)return this.a?this.a.get("player","getConfiguration"):this.b.getConfiguration();if("getNetworkingEngine"==e)return this.b.Fb.bind(this.b);if(this.a&&this.a.ga()){if("getManifest"==e||"drmInfo"==e)return function(){return q(e+"() does not work while casting!"),null};if("getManifestUri"==e)return tn("getManifestUri",'Please use "getAssetUri" instead.'),this.Ud("getAssetUri");if("attach"==e||"detach"==e)return function(){return q(e+"() does not work while casting!"),Promise.resolve()}}return this.a&&this.a.ga()&&0==Object.keys(this.a.a.video).length&&dn[e]||!this.a||!this.a.ga()?this.b[e].bind(this.b):this.a.get("player",e)},r.yf=function(e){this.a&&this.a.ga()||this.g.dispatchEvent(e)},G(Rn,xe),U("shaka.cast.CastReceiver",Rn),Rn.prototype.isConnected=function(){return this.v},Rn.prototype.isConnected=Rn.prototype.isConnected,Rn.prototype.bf=function(){return this.h},Rn.prototype.isIdle=Rn.prototype.bf,Rn.prototype.destroy=function(){var e=this;return f(function t(){var r;return O(t,function(t){switch(t.j){case 1:return e.c&&(e.c.release(),e.c=null),r=[],e.b&&(r.push(e.b.destroy()),e.b=null),e.C&&(e.C.stop(),e.C=null),e.a=null,e.D=null,e.s=null,e.v=!1,e.h=!0,e.f=null,e.i=null,S(t,Promise.all(r),2);case 2:cast.receiver.CastReceiverManager.getInstance().stop(),E(t)}})})},Rn.prototype.destroy=Rn.prototype.destroy,(r=Rn.prototype).Qd=function(){this.g=0,this.l=!0,this.v=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,Ln(this)},r.Wd=function(e,t){this.b&&(In(this),Mn(this,{type:"event",targetName:e,event:t},this.f))},r.Be=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();e&&Mn(this,{type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.f),Mn(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)},r.rf=function(e){var t=_n(e.data);switch(t.type){case"init":this.g=0,this.m=!1,this.l=!0,function(e,t,r){for(var n in t.player)e.b[n](t.player[n]);e.s(r),r=Promise.resolve();var i=e.a.autoplay;t.manifest&&(e.a.autoplay=!1,r=e.b.load(t.manifest,t.startTime)),r.then(function(){if(e.b){for(var r in t.video)e.a[r]=t.video[r];for(var n in t.playerAfterLoad)e.b[n](t.playerAfterLoad[n]);e.a.autoplay=i,t.manifest&&(e.a.play(),Nn(e,0))}},function(t){e.b.dispatchEvent(new Se("error",{detail:t}))})}(this,t.initState,t.appData),In(this);break;case"appData":this.s(t.appData);break;case"set":var r=t.targetName,n=t.property;if(t=t.value,"video"==r){var i=cast.receiver.CastReceiverManager.getInstance();if("volume"==n){i.setSystemVolumeLevel(t);break}if("muted"==n){i.setSystemVolumeMuted(t);break}}this.D[r][n]=t;break;case"call":(r=this.D[t.targetName])[t.methodName].apply(r,t.args);break;case"asyncCall":r=t.targetName,n=t.methodName,"player"==r&&"load"==n&&(this.g=0,this.m=!1),i=t.id,e=e.senderId;var a=this.D[r];t=a[n].apply(a,t.args),"player"==r&&"load"==n&&(t=t.then(function(){this.l=!0}.bind(this))),t.then(this.be.bind(this,e,i,null),this.be.bind(this,e,i))}},r.ef=function(e){var t=_n(e.data);switch(t.type){case"PLAY":this.a.play(),Nn(this,0);break;case"PAUSE":this.a.pause(),Nn(this,0);break;case"SEEK":e=t.currentTime;var r=t.resumeState;null!=e&&(this.a.currentTime=Number(e)),r&&"PLAYBACK_START"==r?(this.a.play(),Nn(this,0)):r&&"PLAYBACK_PAUSE"==r&&(this.a.pause(),Nn(this,0));break;case"STOP":this.b.rd().then(function(){this.b&&Nn(this,0)}.bind(this));break;case"GET_STATUS":Nn(this,Number(t.requestId));break;case"VOLUME":e=(r=t.volume).level,r=r.muted;var n=this.a.volume,i=this.a.muted;null!=e&&(this.a.volume=Number(e)),null!=r&&(this.a.muted=r),n==this.a.volume&&i==this.a.muted||Nn(this,0);break;case"LOAD":this.g=0,this.l=this.m=!1,e=t.media,r=t.currentTime,n=this.G(e.contentId),i=t.autoplay||!0,this.s(e.customData),i&&(this.a.autoplay=!0),this.b.load(n,r).then(function(){this.b&&Pn(this)}.bind(this)).catch(function(e){var r="LOAD_FAILED";7==e.category&&7e3==e.code&&(r="LOAD_CANCELLED"),Mn(this,{requestId:Number(t.requestId),type:r},this.i)}.bind(this));break;default:Mn(this,{requestId:Number(t.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.i)}},r.be=function(e,t,r){this.b&&Mn(this,{type:"asyncComplete",id:t,error:r},this.f,e)};var Fn={IDLE:"IDLE",me:"PLAYING",je:"BUFFERING",le:"PAUSED"};function Bn(e,t){this.K=e,this.b=t==Un,this.a=0}U("shaka.util.DataViewReader",Bn);var Un=1;function Gn(){throw new fe(2,3,3e3)}function zn(){this.c=[],this.b=[],this.a=!1}function Hn(e){for(;e.reader.sa()&&!e.parser.a;)e.parser.mc(e.start,e.reader,e.partialOkay)}function Vn(e){for(var t=e.reader.F();0<t&&!e.parser.a;--t)e.parser.mc(e.start,e.reader,e.partialOkay)}function Kn(e){return function(t){e(t.reader.Xa(t.reader.K.byteLength-t.reader.ba()))}}function Wn(e){for(var t=0,r=0;r<e.length;r++)t=t<<8|e.charCodeAt(r);return t}function qn(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function Xn(e){this.f=[],this.b=[],this.a=[],(new zn).fa("pssh",this.c.bind(this)).parse(e.buffer)}Bn.Endianness={lg:0,mg:Un},Bn.prototype.sa=function(){return this.a<this.K.byteLength},Bn.prototype.hasMoreData=Bn.prototype.sa,Bn.prototype.ba=function(){return this.a},Bn.prototype.getPosition=Bn.prototype.ba,Bn.prototype.Ie=function(){return this.K.byteLength},Bn.prototype.getLength=Bn.prototype.Ie,Bn.prototype.ka=function(){try{var e=this.K.getUint8(this.a);return this.a+=1,e}catch(e){Gn()}},Bn.prototype.readUint8=Bn.prototype.ka,Bn.prototype.Mb=function(){try{var e=this.K.getUint16(this.a,this.b);return this.a+=2,e}catch(e){Gn()}},Bn.prototype.readUint16=Bn.prototype.Mb,Bn.prototype.F=function(){try{var e=this.K.getUint32(this.a,this.b);return this.a+=4,e}catch(e){Gn()}},Bn.prototype.readUint32=Bn.prototype.F,Bn.prototype.Xd=function(){try{var e=this.K.getInt32(this.a,this.b);return this.a+=4,e}catch(e){Gn()}},Bn.prototype.readInt32=Bn.prototype.Xd,Bn.prototype.yb=function(){try{if(this.b)var e=this.K.getUint32(this.a,!0),t=this.K.getUint32(this.a+4,!0);else t=this.K.getUint32(this.a,!1),e=this.K.getUint32(this.a+4,!1)}catch(e){Gn()}if(2097151<t)throw new fe(2,3,3001);return this.a+=8,t*Math.pow(2,32)+e},Bn.prototype.readUint64=Bn.prototype.yb,Bn.prototype.Xa=function(e){this.a+e>this.K.byteLength&&Gn();var t=new Uint8Array(this.K.buffer,this.K.byteOffset+this.a,e);return this.a+=e,new Uint8Array(t)},Bn.prototype.readBytes=Bn.prototype.Xa,Bn.prototype.L=function(e){this.a+e>this.K.byteLength&&Gn(),this.a+=e},Bn.prototype.skip=Bn.prototype.L,Bn.prototype.$d=function(e){this.a<e&&Gn(),this.a-=e},Bn.prototype.rewind=Bn.prototype.$d,Bn.prototype.seek=function(e){(0>e||e>this.K.byteLength)&&Gn(),this.a=e},Bn.prototype.seek=Bn.prototype.seek,Bn.prototype.bd=function(){for(var e=this.a;this.sa()&&0!=this.K.getUint8(this.a);)this.a+=1;return e=new Uint8Array(this.K.buffer,this.K.byteOffset+e,this.a-e),this.a+=1,it(e)},Bn.prototype.readTerminatedString=Bn.prototype.bd,U("shaka.util.Mp4Parser",zn),zn.prototype.H=function(e,t){var r=Wn(e);return this.c[r]=0,this.b[r]=t,this},zn.prototype.box=zn.prototype.H,zn.prototype.fa=function(e,t){var r=Wn(e);return this.c[r]=1,this.b[r]=t,this},zn.prototype.fullBox=zn.prototype.fa,zn.prototype.stop=function(){this.a=!0},zn.prototype.stop=zn.prototype.stop,zn.prototype.parse=function(e,t){var r=new Uint8Array(e);for(r=new Bn(new DataView(r.buffer,r.byteOffset,r.byteLength),0),this.a=!1;r.sa()&&!this.a;)this.mc(0,r,t)},zn.prototype.parse=zn.prototype.parse,zn.prototype.mc=function(e,t,r){var n=t.ba(),i=t.F(),a=t.F();switch(i){case 0:i=t.K.byteLength-n;break;case 1:i=t.yb()}var s=this.b[a];if(s){var o=null,l=null;1==this.c[a]&&(o=(l=t.F())>>>24,l&=16777215),a=n+i,r&&a>t.K.byteLength&&(a=t.K.byteLength),a-=t.ba(),t=0<a?t.Xa(a):new Uint8Array(0),s({parser:this,partialOkay:r||!1,version:o,flags:l,reader:t=new Bn(new DataView(t.buffer,t.byteOffset,t.byteLength),0),size:i,start:n+e})}else t.L(Math.min(n+i-t.ba(),t.K.byteLength-t.ba()))},zn.prototype.parseNext=zn.prototype.mc,zn.children=Hn,zn.sampleDescription=Vn,zn.allData=Kn,zn.typeToString=qn,Xn.prototype.c=function(e){if(!(1<e.version)){var t=pt(e.reader.Xa(16)),r=[];if(0<e.version)for(var n=e.reader.F(),i=0;i<n;++i){var a=pt(e.reader.Xa(16));r.push(a)}n=e.reader.F(),e.reader.L(n),this.b.push.apply(this.b,r),this.f.push(t),this.a.push({start:e.start,end:e.start+e.size-1})}};var Yn={ac:function(e,t){var r=Yn.R(e,t);return 1!=r.length?null:r[0]},Gc:function(e,t,r){return 1!=(e=Yn.zd(e,t,r)).length?null:e[0]},R:function(e,t){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&e.tagName==t})},zd:function(e,t,r){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&e.localName==r&&e.namespaceURI==t})},getAttributeNS:function(e,t,r){return e.hasAttributeNS(t,r)?e.getAttributeNS(t,r):null},cc:function(e){return Array.prototype.every.call(e.childNodes,function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE})?e.textContent.trim():null},J:function(e,t,r,n){n=void 0===n?null:n;var i=null;return null!=(e=e.getAttribute(t))&&(i=r(e)),null==i?n:i},vf:function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:Math.floor(e/1e3)):null},Ba:function(e){return e&&(e=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e))?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null},oc:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},parseInt:function(e){return 0==(e=Number(e))%1?e:null},nc:function(e){return 0==(e=Number(e))%1&&0<e?e:null},vb:function(e){return 0==(e=Number(e))%1&&0<=e?e:null},parseFloat:function(e){return e=Number(e),isNaN(e)?null:e},Ae:function(e){var t;return e=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(e)?null:e},Td:function(e,t){var r=new DOMParser;try{var n=r.parseFromString(e,"text/xml")}catch(e){}if(n&&n.documentElement.tagName==t)var i=n.documentElement;return i&&0<i.getElementsByTagName("parsererror").length?null:i},Sd:function(e,t){try{var r=it(e);return Yn.Td(r,t)}catch(e){}}},$n=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");function Jn(e,t,r){var n=function(e){for(var t=[],r=(e=d(e)).next();!r.done;r=e.next())(r=ei(r.value))&&t.push(r);return t}(e),i=null;e=[];var a=[],s=new Set(n.map(function(e){return e.keyId}));if(s.delete(null),1<s.size)throw new fe(2,4,4010);if(r||(a=n.filter(function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.ae||(i=e.init||i,!1)})).length&&(0==(e=function(e,t,r){for(var n=[],i=(r=d(r)).next();!i.done;i=r.next()){i=i.value;var a=$n.get(i.ae);if(a){var s;if(s=Yn.Gc(i.node,"urn:microsoft:playready","pro")){s=ht(s.textContent);var o=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=s.length,u=o.length+16+l,c=new ArrayBuffer(u),h=new Uint8Array(c);c=new DataView(c);var f=0;c.setUint32(f,u),f+=4,c.setUint32(f,1886614376),f+=4,c.setUint32(f,0),f+=4,h.set(o,f),f+=o.length,c.setUint32(f,l),f+=4,h.set(s,f),s=[{initData:h,initDataType:"cenc",keyId:i.keyId}]}else s=null;s=Kt(a,i.init||e||s),(a=Zn.get(a))&&(s.licenseServerUri=a(i)),n.push(s)}else for(i=d(i=t(i.node)||[]),a=i.next();!a.done;a=i.next())n.push(a.value)}return n}(i,t,a)).length&&(e=[Kt("",i)])),n.length&&(r||!a.length))for(e=[],r=(t=d($n.values())).next();!r.done;r=t.next())"org.w3.clearkey"!=(r=r.value)&&e.push(Kt(r,i));if(s=Array.from(s)[0]||null)for(r=(t=d(e)).next();!r.done;r=t.next())for(n=(r=d(r.value.initData)).next();!n.done;n=r.next())n.value.keyId=s;return{wd:s,pg:i,drmInfos:e,Ad:!0}}var Qn,Zn=(new Map).set("com.widevine.alpha",function(e){return(e=Yn.Gc(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""}).set("com.microsoft.playready",function(e){return(e=Yn.Gc(e.node,"urn:microsoft:playready","pro"))&&(e=function(e){var t=0,r=new DataView(e).getUint32(t,!0);if(r!==e.byteLength)return[];t+=6,r=[];for(var n=new DataView(e);t<e.byteLength-1;){var i=n.getUint16(t,!0);t+=2;var a=n.getUint16(t,!0);t+=2;var s=new Uint8Array(e,t,a);r.push({type:i,value:s}),t+=a}return r}((e=ht(e.textContent)).buffer).filter(function(e){return 1===e.type})[0])?(e=at(e.value,!0),(e=Yn.Td(e,"WRMHEADER"))?function(e){return(e=e.querySelector("DATA > LA_URL"))?e.textContent:""}(e):""):""});function ei(e){var t=e.getAttribute("schemeIdUri"),r=Yn.getAttributeNS(e,"urn:mpeg:cenc:2013","default_KID"),n=Yn.zd(e,"urn:mpeg:cenc:2013","pssh").map(Yn.cc);if(!t)return null;if(t=t.toLowerCase(),r&&(r=r.replace(/-/g,"").toLowerCase()).includes(" "))throw new fe(2,4,4009);var i=[];try{i=n.map(function(e){return{initDataType:"cenc",initData:ht(e),keyId:null}})}catch(e){throw new fe(2,4,4007)}return{node:e,ae:t,keyId:r,init:0<i.length?i:null}}function ti(t,r,n,i,a){var s={RepresentationID:r,Number:n,Bandwidth:i,Time:a};return t.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(t,r,n,i){if("$$"==t)return"$";var a=s[r];if(null==a)return t;switch("RepresentationID"==r&&n&&(n=void 0),"Time"==r&&(a=Math.round(a)),i){case void 0:case"d":case"i":case"u":t=a.toString();break;case"o":t=a.toString(8);break;case"x":t=a.toString(16);break;case"X":t=a.toString(16).toUpperCase();break;default:t=a.toString()}return n=e.parseInt(n,10)||1,Array(Math.max(0,n-t.length)+1).join("0")+t})}function ri(e,t){var r=ni(e,t,"timescale"),n=1;r&&(n=Yn.nc(r)||1),r=ni(e,t,"duration"),(r=Yn.nc(r||""))&&(r/=n);var i=ni(e,t,"startNumber"),a=Number(ni(e,t,"presentationTimeOffset"))||0,s=Yn.vb(i||"");null!=i&&null!=s||(s=1);var o=ii(e,t,"SegmentTimeline");if(i=null,o){i=n;var l=e.S.duration||1/0;o=Yn.R(o,"S");for(var u=[],c=0,d=0;d<o.length;++d){var h=o[d],f=Yn.J(h,"t",Yn.vb),p=Yn.J(h,"d",Yn.vb);if(h=Yn.J(h,"r",Yn.parseInt),null!=f&&(f-=a),!p)break;if(f=null!=f?f:c,0>(h=h||0))if(d+1<o.length){if(null==(h=Yn.J(o[d+1],"t",Yn.vb)))break;if(f>=h)break;h=Math.ceil((h-f)/p)-1}else{if(1/0==l)break;if(f/i>=l)break;h=Math.ceil((l*i-f)/p)-1}0<u.length&&f!=c&&(u[u.length-1].end=f/i);for(var g=0;g<=h;++g)c=f+p,u.push({start:f/i,end:c/i,eg:f}),f=c}i=u}return{timescale:n,Z:r,Za:s,la:a/n||0,sd:a,N:i}}function ni(e,t,r){return[t(e.B),t(e.ca),t(e.ja)].filter(Ht.Ga).map(function(e){return e.getAttribute(r)}).reduce(function(e,t){return e||t})}function ii(e,t,r){return[t(e.B),t(e.ca),t(e.ja)].filter(Ht.Ga).map(function(e){return Yn.ac(e,r)}).reduce(function(e,t){return e||t})}function ai(e,t,r,n,i,a){if(a=void 0===a?0:a,Yn.getAttributeNS(e,"http://www.w3.org/1999/xlink","href")){var s=function(e,t,r,n,i,a){for(var s=Yn.getAttributeNS(e,"http://www.w3.org/1999/xlink","href"),o=Yn.getAttributeNS(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",l=0;l<e.attributes.length;l++){var u=e.attributes[l];"http://www.w3.org/1999/xlink"==u.namespaceURI&&(e.removeAttributeNS(u.namespaceURI,u.localName),--l)}if(5<=a)return me(new fe(2,4,4028));if("onLoad"!=o)return me(new fe(2,4,4027));var c=Vt([n],[s]);return i.request(0,Pe(c,t)).U(function(n){if(!(n=Yn.Sd(n.data,e.tagName)))return me(new fe(2,4,4001,s));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;n.childNodes.length;){var o=n.childNodes[0];n.removeChild(o),e.appendChild(o)}for(o=0;o<n.attributes.length;o++){var l=n.attributes[o].nodeName,u=n.getAttribute(l);e.setAttribute(l,u)}return ai(e,t,r,c[0],i,a+1)})}(e,t,r,n,i,a);return r&&(s=s.U(void 0,function(){return ai(e,t,r,n,i,a)})),s}s=[];for(var o=0;o<e.childNodes.length;o++){var l=e.childNodes[o];l instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==Yn.getAttributeNS(l,"http://www.w3.org/1999/xlink","href")?(e.removeChild(l),--o):"SegmentTimeline"!=l.tagName&&s.push(ai(l,t,r,n,i,a)))}return be(s).U(function(){return e})}function si(e,t,r){this.c=e,this.b=t,this.a=r}function oi(e,t,r,n,i,a){this.position=e,this.startTime=t,this.endTime=r,this.c=n,this.b=i,this.a=a}function li(e,t,r,n){var i,a=(new zn).fa("sidx",function(e){i=function(e,t,r,n){var i=[];n.reader.L(4);var a=n.reader.F();if(0==a)throw new fe(2,3,3005);if(0==n.version)var s=n.reader.F(),o=n.reader.F();else s=n.reader.yb(),o=n.reader.yb();n.reader.L(2);var l=n.reader.Mb();for(e=e+n.size+o,o=0;o<l;o++){var u=n.reader.F(),c=(2147483648&u)>>>31;u&=2147483647;var d=n.reader.F();if(n.reader.L(4),1==c)throw new fe(2,3,3006);i.push(new oi(i.length,s/a-t,(s+d)/a-t,function(){return r},e,e+u-1)),s+=d,e+=u}return n.parser.stop(),i}(t,n,r,e)});if(e&&a.parse(e),i)return i;throw new fe(2,3,3004)}function ui(e){this.a=e}function ci(e,t){for(;e.a.length&&e.a[e.a.length-1].startTime>=t;)e.a.pop();for(;e.a.length&&0>=e.a[0].endTime;)e.a.shift();if(0!=e.a.length){var r=e.a[e.a.length-1];e.a[e.a.length-1]=new oi(r.position,r.startTime,t,r.c,r.b,r.a)}}function di(e){this.b=e,this.a=new Bn(e,0),Qn||(Qn=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}function hi(e){var t=fi(e);if(7<t.length)throw new fe(2,3,3002);for(var r=0,n=0;n<t.length;n++)r=256*r+t[n];t=r,r=fi(e);e:{for(n=0;n<Qn.length;n++)if(gt(r,Qn[n])){n=!0;break e}n=!1}if(n)r=e.b.byteLength-e.a.ba();else{if(8==r.length&&224&r[1])throw new fe(2,3,3001);n=r[0]&(1<<8-r.length)-1;for(var i=1;i<r.length;i++)n=256*n+r[i];r=n}return r=e.a.ba()+r<=e.b.byteLength?r:e.b.byteLength-e.a.ba(),n=new DataView(e.b.buffer,e.b.byteOffset+e.a.ba(),r),e.a.L(r),new pi(t,n)}function fi(e){var t,r=e.a.ka();for(t=1;8>=t&&!(r&1<<8-t);t++);if(8<t)throw new fe(2,3,3002);var n=new Uint8Array(t);for(n[0]=r,r=1;r<t;r++)n[r]=e.a.ka();return n}function pi(e,t){this.id=e,this.a=t}function gi(e){if(8<e.a.byteLength)throw new fe(2,3,3002);if(8==e.a.byteLength&&224&e.a.getUint8(0))throw new fe(2,3,3001);for(var t=0,r=0;r<e.a.byteLength;r++){t=256*t+e.a.getUint8(r)}return t}function mi(){}function vi(e){var t=new di(e.a);if(179!=(e=hi(t)).id)throw new fe(2,3,3013);if(e=gi(e),183!=(t=hi(t)).id)throw new fe(2,3,3012);t=new di(t.a);for(var r=0;t.sa();){var n=hi(t);if(241==n.id){r=gi(n);break}}return{fg:e,Df:r}}function _i(e,t){var r=ii(e,t,"Initialization");if(!r)return null;var n=e.B.oa,i=r.getAttribute("sourceURL");i&&(n=Vt(e.B.oa,[i])),i=0;var a=null;return(r=Yn.J(r,"range",Yn.oc))&&(i=r.start,a=r.end),new si(function(){return n},i,a)}function yi(e,t,r,n,i,a,s,o){var l=e.presentationTimeline,u=!e.kb||!e.S.Qc,c=e.S.start,d=e.S.duration,h=t,f=null;return{createSegmentIndex:function(){var e=[h(n,i,a),"webm"==s?h(r.c(),r.b,r.a):null];return h=null,Promise.all(e).then(function(e){var t=e[0];e=e[1]||null,t="mp4"==s?li(t,i,n,o):(new mi).parse(t,e,n,o),l.sb(t,c),f=new ui(t),u&&ci(f,d)})},findSegmentPosition:function(e){return f.find(e)},getSegmentReference:function(e){return f.get(e)}}}function bi(e){return e.Ob}function wi(e,t){var r=_i(e,Si),n=function(e){return[e.B.Ja,e.ca.Ja,e.ja.Ja].filter(Ht.Ga).map(function(e){return Yn.R(e,"SegmentURL")}).reduce(function(e,t){return 0<e.length?e:t}).map(function(t){return t.getAttribute("indexRange")&&!e.Fd&&(e.Fd=!0),{cf:t.getAttribute("media"),start:(t=Yn.J(t,"mediaRange",Yn.oc,{start:0,end:null})).start,end:t.end}})}(e),i=ri(e,Si),a=i.Za;0==a&&(a=1);var s=0;if(i.Z?s=i.Z*(a-1):i.N&&0<i.N.length&&(s=i.N[0].start),!(n={Z:i.Z,startTime:s,Za:a,la:i.la,N:i.N,qb:n}).Z&&!n.N&&1<n.qb.length)throw new fe(2,4,4002);if(!n.Z&&!e.S.duration&&!n.N&&1==n.qb.length)throw new fe(2,4,4002);if(n.N&&0==n.N.length)throw new fe(2,4,4002);return a=i=null,e.ja.id&&e.B.id&&(i=t[a=e.ja.id+","+e.B.id]),s=function(e,t,r,n){var i=n.qb.length;n.N&&n.N.length!=n.qb.length&&(i=Math.min(n.N.length,n.qb.length));for(var a=[],s=n.startTime,o=0;o<i;o++){var l,u=n.qb[o],c=Vt(r,[u.cf]);l=null!=n.Z?s+n.Z:n.N?n.N[o].end:s+e,a.push(new oi(o+t,s,l,function(e){return e}.bind(null,c),u.start,u.end)),s=l}return a}(e.S.duration,n.Za,e.B.oa,n),i?(i.Tc(s),a=e.presentationTimeline.Hb(),i.Dc(a-e.S.start)):(e.presentationTimeline.sb(s,e.S.start),i=new ui(s),a&&e.kb&&(t[a]=i)),e.kb&&e.S.Qc||ci(i,e.S.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:i.find.bind(i),getSegmentReference:i.get.bind(i),initSegmentReference:r,la:n.la}}function Si(e){return e.Ja}function Ei(e,t,r,n){var i=function(e){var t=ni(e,xi,"initialization");if(!t)return null;var r=e.B.id,n=e.bandwidth||null,i=e.B.oa;return new si(function(){var e=ti(t,r,null,n,null);return Vt(i,[e])},0,null)}(e),a=ri(e,xi),s=ni(e,xi,"media"),o=ni(e,xi,"index");if(s=(a={Z:a.Z,timescale:a.timescale,Za:a.Za,la:a.la,sd:a.sd,N:a.N,Sc:s,Jb:o}).Jb?1:0,s+=a.N?1:0,0==(s+=a.Z?1:0))throw new fe(2,4,4002);if(1!=s&&(a.Jb&&(a.N=null),a.Z=null),!a.Jb&&!a.Sc)throw new fe(2,4,4002);if(a.Jb){if("mp4"!=(r=e.B.mimeType.split("/")[1])&&"webm"!=r)throw new fe(2,4,4006);if("webm"==r&&!i)throw new fe(2,4,4005);n=ti(a.Jb,e.B.id,null,e.bandwidth||null,null),e=yi(e,t,i,n=Vt(e.B.oa,[n]),0,null,r,a.la)}else a.Z?(n||(e.presentationTimeline.Vc(a.Z),e.presentationTimeline.Wc(e.S.start)),e=function(e,t){var r=e.S.duration,n=t.Z,i=t.Za,a=t.timescale,s=t.Sc,o=e.bandwidth||null,l=e.B.id,u=e.B.oa;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0>e||r&&e>=r?null:Math.floor(e/n)},getSegmentReference:function(e){var t=e*n,c=t+n;return r&&(c=Math.min(c,r)),0>c||r&&t>=r?null:new oi(e,t,c,function(){var r=ti(s,l,e+i,o,t*a);return Vt(u,[r])},0,null)}}}(e,a)):(s=t=null,e.ja.id&&e.B.id&&(t=r[s=e.ja.id+","+e.B.id]),o=function(e,t){for(var r=[],n=0;n<t.N.length;n++){var i=n+t.Za;r.push(new oi(i,t.N[n].start,t.N[n].end,function(e,t,r,n,i,a){return Vt(n,[e=ti(e,t,i,r,a)]).map(function(e){return e.toString()})}.bind(null,t.Sc,e.B.id,e.bandwidth||null,e.B.oa,i,t.N[n].eg+t.sd),0,null))}return r}(e,a),n=!e.kb||!e.S.Qc,t?(n&&ci(new ui(o),e.S.duration),t.Tc(o),r=e.presentationTimeline.Hb(),t.Dc(r-e.S.start)):(e.presentationTimeline.sb(o,e.S.start),t=new ui(o),s&&e.kb&&(r[s]=t)),n&&ci(t,e.S.duration),e={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:t.find.bind(t),getSegmentReference:t.get.bind(t)});return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:i,la:a.la}}function xi(e){return e.Qb}U("shaka.media.InitSegmentReference",si),si.prototype.Ac=function(){return this.c()},si.prototype.createUris=si.prototype.Ac,si.prototype.Lc=function(){return this.b},si.prototype.getStartByte=si.prototype.Lc,si.prototype.Kc=function(){return this.a},si.prototype.getEndByte=si.prototype.Kc,U("shaka.media.SegmentReference",oi),oi.prototype.ba=function(){return this.position},oi.prototype.getPosition=oi.prototype.ba,oi.prototype.Mc=function(){return this.startTime},oi.prototype.getStartTime=oi.prototype.Mc,oi.prototype.Ge=function(){return this.endTime},oi.prototype.getEndTime=oi.prototype.Ge,oi.prototype.Ac=function(){return this.c()},oi.prototype.createUris=oi.prototype.Ac,oi.prototype.Lc=function(){return this.b},oi.prototype.getStartByte=oi.prototype.Lc,oi.prototype.Kc=function(){return this.a},oi.prototype.getEndByte=oi.prototype.Kc,U("shaka.media.SegmentIndex",ui),ui.prototype.destroy=function(){return this.a=null,Promise.resolve()},ui.prototype.destroy=ui.prototype.destroy,ui.prototype.find=function(e){for(var t=this.a.length-1;0<=t;--t){var r=this.a[t];if(e>=r.startTime&&e<r.endTime)return r.position}return this.a.length&&e<this.a[0].startTime?this.a[0].position:null},ui.prototype.find=ui.prototype.find,ui.prototype.get=function(e){return 0==this.a.length?null:0>(e-=this.a[0].position)||e>=this.a.length?null:this.a[e]},ui.prototype.get=ui.prototype.get,ui.prototype.offset=function(e){for(var t=0;t<this.a.length;++t)this.a[t].startTime+=e,this.a[t].endTime+=e},ui.prototype.offset=ui.prototype.offset,ui.prototype.Tc=function(e){for(var t=[],r=0,n=0;r<this.a.length&&n<e.length;){var i=this.a[r],a=e[n];i.startTime<a.startTime?(t.push(i),r++):(i.startTime>a.startTime?0==r&&t.push(a):(.1<Math.abs(i.endTime-a.endTime)?t.push(new oi(i.position,a.startTime,a.endTime,a.c,a.b,a.a)):t.push(i),r++),n++)}for(;r<this.a.length;)t.push(this.a[r++]);if(t.length)for(r=t[t.length-1].position+1;n<e.length;)i=new oi(r++,(i=e[n++]).startTime,i.endTime,i.c,i.b,i.a),t.push(i);else t=e;this.a=t},ui.prototype.merge=ui.prototype.Tc,ui.prototype.Dc=function(e){for(var t=0;t<this.a.length;++t)if(this.a[t].endTime>e)return void this.a.splice(0,t);this.a=[]},ui.prototype.evict=ui.prototype.Dc,di.prototype.sa=function(){return this.a.sa()},mi.prototype.parse=function(e,t,r,n){var i;if(440786851!=hi(t=new di(new DataView(t))).id)throw new fe(2,3,3008);var a=hi(t);if(408125543!=a.id)throw new fe(2,3,3009);for(t=a.a.byteOffset,a=new di(a.a),i=null;a.sa();){var s=hi(a);if(357149030==s.id){i=s;break}}if(!i)throw new fe(2,3,3010);for(a=new di(i.a),i=1e6,s=null;a.sa();){var o=hi(a);if(2807729==o.id)i=gi(o);else if(17545==o.id)if(4==(s=o).a.byteLength)s=s.a.getFloat32(0);else{if(8!=s.a.byteLength)throw new fe(2,3,3003);s=s.a.getFloat64(0)}}if(null==s)throw new fe(2,3,3011);if(i=s*(a=i/1e9),475249515!=(e=hi(new di(new DataView(e)))).id)throw new fe(2,3,3007);return function(e,t,r,n,i,a){function s(){return i}var o=[];e=new di(e.a);for(var l=null,u=null;e.sa();){var c=hi(e);if(187==c.id){var d=vi(c);d&&(c=r*d.fg,d=t+d.Df,null!=l&&o.push(new oi(o.length,l-a,c-a,s,u,d-1)),l=c,u=d)}}return null!=l&&o.push(new oi(o.length,l-a,n-a,s,u,null)),o}(e,t,a,i,r,n)};var Ti={wb:{},Lb:{},ed:function(e,t){Ti.Lb[e]=t}};function ki(e,t,r){this.f=e,this.pc=t,this.h=this.g=1/0,this.a=1,this.b=this.c=null,this.l=0,this.m=!0,this.i=0,this.s=void 0===r||r}function Ai(e,t,r,n){return e=Pe(e,n),0==t&&null==r||(e.headers.Range=r?"bytes="+t+"-"+r:"bytes="+t+"-"),e}function Ci(){var e=this;this.a=this.b=null,this.f=[],this.c=null,this.l=[],this.h=1,this.m={},this.s=0,this.v=new z(5),this.i=new ce(function(){!function(e){f(function t(){var r,n;return O(t,function(t){switch(t.j){case 1:return r=0,x(t,2),S(t,ji(e),4);case 4:r=t.o,k(t,3);break;case 2:n=A(t),e.a&&(n.severity=1,e.a.onError(n));case 3:if(!e.a)return t.return();Ii(e,r),E(t)}})})}(e)}),this.g=new je}function ji(e){var t=Date.now(),r=e.a.networkingEngine.request(0,Pe(e.f,e.b.retryParameters));return De(e.g,r),r.promise.then(function(t){if(e.a)return t.uri&&!e.f.includes(t.uri)&&e.f.unshift(t.uri),function(e,t,r){if(!(t=Yn.Sd(t,"MPD")))throw new fe(2,4,4001,r);return t=ai(t,e.b.retryParameters,e.b.dash.xlinkFailGracefully,r,e.a.networkingEngine),De(e.g,t),t.promise.then(function(t){return function(e,t,r){return f(function n(){var i,a,s,o,l,u,c,d,h,f,p,g,m,v,_,y,b,w,x,T,k,A,C;return O(n,function(n){switch(n.j){case 1:o=Ht,u=[r],0<(c=(l=Yn).R(t,"Location").map(l.cc).filter(o.Ga)).length&&(d=Vt(u,c),u=e.f=d),h=l.R(t,"BaseURL").map(l.cc),f=Vt(u,h),p=e.b.dash.ignoreMinBufferTime,g=0,p||(g=l.J(t,"minBufferTime",l.Ba)),e.s=l.J(t,"minimumUpdatePeriod",l.Ba,-1),m=l.J(t,"availabilityStartTime",l.vf),v=l.J(t,"timeShiftBufferDepth",l.Ba),_=l.J(t,"suggestedPresentationDelay",l.Ba),y=l.J(t,"maxSegmentDuration",l.Ba),b=t.getAttribute("type")||"static",e.c?w=e.c.presentationTimeline:(x=Math.max(e.b.dash.defaultPresentationDelay,1.5*g),w=new ki(m,null!=_?_:x,e.b.dash.autoCorrectDrift));for(var j={kb:"static"!=b,presentationTimeline:w,ja:null,S:null,ca:null,B:null,bandwidth:0,Fd:!1},D=f,R=Yn.J(t,"mediaPresentationDuration",Yn.Ba),L=[],I=0,O=Yn.R(t,"Period"),P=0;P<O.length;P++){var M=O[P];I=Yn.J(M,"start",Yn.Ba,I);var N=Yn.J(M,"duration",Yn.Ba),F=null;if(P!=O.length-1){var B=Yn.J(O[P+1],"start",Yn.Ba);null!=B&&(F=B-I)}else null!=R&&(F=R-I);if(null==F&&(F=N),M=Di(e,j,D,{start:I,duration:F,node:M,Qc:null==F||P==O.length-1}),L.push(M),N=j.ja.id,e.l.includes(N)||(e.l.push(N),e.c&&(e.a.filterNewPeriod(M),e.c.periods.push(M))),null==F){I=null;break}I+=F}if(null==e.c&&e.a.filterAllPeriods(L),null!=R?(i=L,a=R,s=!1):(i=L,a=I,s=!0),T=a,k=i,w.Rb("static"==b),"static"!=b&&s||w.wa(T||1/0),w.V()&&!isNaN(e.b.availabilityWindowOverride)&&(v=e.b.availabilityWindowOverride),null==v&&(v=1/0),w.md(v),w.Vc(y||1),e.c){n.A(0);break}if(e.c={presentationTimeline:w,periods:k,offlineSessionIds:[],minBufferTime:g||0},!w.he()){n.A(0);break}return A=l.R(t,"UTCTiming"),S(n,function(e,t,r){r=r.map(function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}});var n=e.b.dash.clockSyncUri;return!r.length&&n&&r.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:n}),Ht.ye(r,function(e){var r=e.scheme;switch(e=e.value,r){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return Pi(this,t,e,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return Pi(this,t,e,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return r=Date.parse(e),isNaN(r)?0:r-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return q("NTP UTCTiming scheme is not supported"),Promise.reject();default:return q("Unrecognized scheme in UTCTiming element",r),Promise.reject()}}.bind(e)).catch(function(){return q("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),0})}(e,f,A),4);case 4:if(C=n.o,!e.a)return n.return();w.ce(C),E(n)}})})}(e,t,r)})}(e,t.data,t.uri)}).then(function(){var r=(Date.now()-t)/1e3;return H(e.v,1,r),r})}function Di(e,t,r,n){if(t.ja=Oi(n.node,null,r),t.S=n,t.ja.id||(t.ja.id="__shaka_period_"+n.start),Yn.R(n.node,"EventStream").forEach(e.wf.bind(e,n.start,n.duration)),r=Yn.R(n.node,"AdaptationSet").map(e.uf.bind(e,t)).filter(Ht.Ga),t.kb){t=[];for(var i=d(r),a=i.next();!a.done;a=i.next())for(var s=(a=d(a.value.Gf)).next();!s.done;s=a.next())t.push(s.value);if(t.length!=new Set(t).size)throw new fe(2,4,4018)}var o=r.filter(function(e){return!e.qd});if(r.filter(function(e){return e.qd}).forEach(function(e){var t=e.streams[0],r=e.qd;o.forEach(function(e){e.id==r&&e.streams.forEach(function(e){e.trickModeVideo=t})})}),t=Ri(o,"video"),i=Ri(o,"audio"),!t.length&&!i.length)throw new fe(2,4,4004);for(i.length||(i=[null]),t.length||(t=[null]),r=[],a=0;a<i.length;a++)for(s=0;s<t.length;s++)Li(e,i[a],t[s],r);for(e=Ri(o,"text"),t=[],i=0;i<e.length;i++)t.push.apply(t,e[i].streams);return{startTime:n.start,textStreams:t,variants:r}}function Ri(e,t){return e.filter(function(e){return e.contentType==t})}function Li(e,t,r,n){if(t||r)if(t&&r){var i=t.drmInfos,a=r.drmInfos;if(!i.length||!a.length||0<Rt(i,a).length){a=Rt(t.drmInfos,r.drmInfos);for(var s=0;s<t.streams.length;s++)for(var o=0;o<r.streams.length;o++)i=(r.streams[o].bandwidth||0)+(t.streams[s].bandwidth||0),i={id:e.h++,language:t.language,primary:t.Rc||r.Rc,audio:t.streams[s],video:r.streams[o],bandwidth:i,drmInfos:a,allowedByApplication:!0,allowedByKeySystem:!0},n.push(i)}}else for(a=t||r,s=0;s<a.streams.length;s++)i=a.streams[s].bandwidth||0,i={id:e.h++,language:a.language||"und",primary:a.Rc,audio:t?a.streams[s]:null,video:r?a.streams[s]:null,bandwidth:i,drmInfos:a.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},n.push(i)}function Ii(e,t){0>e.s||e.i.O(Math.max(3,e.s-t,V(e.v)))}function Oi(e,t,r){t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,Xc:null},r=r||t.oa;var n=Yn.vb,i=Yn.Ae,a=Yn.R(e,"BaseURL").map(Yn.cc),s=e.getAttribute("contentType")||t.contentType,o=e.getAttribute("mimeType")||t.mimeType,l=e.getAttribute("codecs")||t.codecs;i=Yn.J(e,"frameRate",i)||t.frameRate;for(var u=Yn.R(e,"InbandEventStream"),c=t.emsgSchemeIdUris.slice(),h=(u=d(u)).next();!h.done;h=u.next())h=h.value.getAttribute("schemeIdUri"),c.includes(h)||c.push(h);return u=function(e){for(var t=0;t<e.length;++t){var r=e[t],n=r.getAttribute("schemeIdUri");if(n&&(r=r.getAttribute("value")))switch(n){case"urn:mpeg:dash:outputChannelPositionList:2012":return r.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(!(n=parseInt(r,10)))continue;return n;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(n=parseInt(r,16)){for(e=0;n;)1&n&&++e,n>>=1;return e}}}return null}(u=Yn.R(e,"AudioChannelConfiguration"))||t.Xc,s||(s=Mi(o,l)),{oa:Vt(r,a),Ob:Yn.ac(e,"SegmentBase")||t.Ob,Ja:Yn.ac(e,"SegmentList")||t.Ja,Qb:Yn.ac(e,"SegmentTemplate")||t.Qb,width:Yn.J(e,"width",n)||t.width,height:Yn.J(e,"height",n)||t.height,contentType:s,mimeType:o,codecs:l,frameRate:i,emsgSchemeIdUris:c,id:e.getAttribute("id"),Xc:u}}function Pi(e,t,r,n){return(t=Pe(t=Vt(t,[r]),e.b.retryParameters)).method=n,t=e.a.networkingEngine.request(4,t),De(e.g,t),t.promise.then(function(e){if("HEAD"==n){if(!e.headers||!e.headers.date)return 0;e=e.headers.date}else e=it(e.data);return e=Date.parse(e),isNaN(e)?0:e-Date.now()})}function Mi(e,t){return mr($e(e,t))?"text":e.split("/")[0]}function Ni(e,t,r,n){this.b=e,this.type=t,this.a=r,this.segments=n||null}function Fi(e,t,r,n){this.id=e,this.name=t,this.a=r,this.value=void 0===n?null:n}function Bi(e,t){this.name=e,this.value=t}function Ui(e,t,r){return(e=e.getAttribute(t))?e.value:r||null}function Gi(e,t){this.b=t,this.a=e}U("shaka.media.ManifestParser.registerParserByExtension",Ti.ed),Ti.Nb=function(e,t){Ti.wb[e]=t},U("shaka.media.ManifestParser.registerParserByMime",Ti.Nb),Ti.Af=function(){var e={};if(Ze()){for(var t in Ti.wb)e[t]=!0;for(var r in Ti.Lb)e[r]=!0}t={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var n=(r=d(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!n.done;n=r.next())e[n=n.value]=Ze()?!!Ti.wb[n]:et(n);for(var i in t)e[i]=Ze()?!!Ti.Lb[i]:et(t[i]);return e},Ti.create=function(e,t,r,n){return f(function i(){var a,s;return O(i,function(i){switch(i.j){case 1:return x(i,2),S(i,Ti.He(e,t,r,n),4);case 4:return a=i.o,i.return(new a);case 2:throw(s=A(i)).severity=2,s}})})},Ti.He=function(e,t,r,n){return f(function i(){var a,s,o,l,u;return O(i,function(i){switch(i.j){case 1:if(a=Ti,n&&(s=a.wb[n.toLowerCase()]))return i.return(s);if((o=a.getExtension(e))&&(l=a.Lb[o]))return i.return(l);if(n){i.A(2);break}return S(i,a.Oe(e,t,r),3);case 3:if((n=i.o)&&(u=Ti.wb[n]))return i.return(u);case 2:throw new fe(2,4,4e3,e)}})})},Ti.Oe=function(e,t,r){return f(function n(){var i,a,s;return O(n,function(n){switch(n.j){case 1:return(i=Pe([e],r)).method="HEAD",S(n,t.request(0,i).promise,2);case 2:return a=n.o,s=a.headers["content-type"],n.return(s?s.toLowerCase():"")}})})},Ti.getExtension=function(e){return 1==(e=new $(e).ia.split("/").pop().split(".")).length?"":e.pop().toLowerCase()},Ti.isSupported=function(e,t){return!!Ze()&&(t in Ti.wb||Ti.getExtension(e)in Ti.Lb)},U("shaka.media.PresentationTimeline",ki),ki.prototype.Y=function(){return this.g},ki.prototype.getDuration=ki.prototype.Y,ki.prototype.wa=function(e){this.g=e},ki.prototype.setDuration=ki.prototype.wa,ki.prototype.Te=function(){return this.f},ki.prototype.getPresentationStartTime=ki.prototype.Te,ki.prototype.ce=function(e){this.l=e},ki.prototype.setClockOffset=ki.prototype.ce,ki.prototype.Rb=function(e){this.m=e},ki.prototype.setStatic=ki.prototype.Rb,ki.prototype.md=function(e){this.h=e},ki.prototype.setSegmentAvailabilityDuration=ki.prototype.md,ki.prototype.Qf=function(e){this.pc=e},ki.prototype.setDelay=ki.prototype.Qf,ki.prototype.Fe=function(){return this.pc},ki.prototype.getDelay=ki.prototype.Fe,ki.prototype.sb=function(e,t){if(0!=e.length){var r=e[e.length-1].endTime+t;this.Wc(e[0].startTime+t),this.a=e.reduce(function(e,t){return Math.max(e,t.endTime-t.startTime)},this.a),this.b=Math.max(this.b,r),null!=this.f&&this.s&&(this.f=(Date.now()+this.l)/1e3-this.b-this.a)}},ki.prototype.notifySegments=ki.prototype.sb,ki.prototype.Wc=function(e){this.c=null==this.c?e:Math.min(this.c,e)},ki.prototype.notifyMinSegmentStartTime=ki.prototype.Wc,ki.prototype.Vc=function(e){this.a=Math.max(this.a,e)},ki.prototype.notifyMaxSegmentDuration=ki.prototype.Vc,ki.prototype.offset=function(e){null!=this.c&&(this.c+=e),null!=this.b&&(this.b+=e)},ki.prototype.offset=ki.prototype.offset,ki.prototype.V=function(){return 1/0==this.g&&!this.m},ki.prototype.isLive=ki.prototype.V,ki.prototype.Va=function(){return 1/0!=this.g&&!this.m},ki.prototype.isInProgress=ki.prototype.Va,ki.prototype.Hb=function(){if(1/0==this.h)return this.i;var e=this.nb()-this.h;return Math.max(this.i,e)},ki.prototype.getSegmentAvailabilityStart=ki.prototype.Hb,ki.prototype.de=function(e){this.i=e},ki.prototype.setUserSeekStart=ki.prototype.de,ki.prototype.nb=function(){return this.V()||this.Va()?Math.min(Math.max(0,(Date.now()+this.l)/1e3-this.a-this.f),this.g):this.g},ki.prototype.getSegmentAvailabilityEnd=ki.prototype.nb,ki.prototype.Gb=function(e){var t=Math.max(this.c,this.i);if(1/0==this.h)return t;var r=this.nb()-this.h;return e=Math.min(r+e,this.za()),Math.max(t,e)},ki.prototype.getSafeSeekRangeStart=ki.prototype.Gb,ki.prototype.mb=function(){return this.Gb(0)},ki.prototype.getSeekRangeStart=ki.prototype.mb,ki.prototype.za=function(){var e=this.V()||this.Va()?this.pc:0;return Math.max(0,this.nb()-e)},ki.prototype.getSeekRangeEnd=ki.prototype.za,ki.prototype.he=function(){return null!=this.f&&null==this.b},ki.prototype.usingPresentationStartTime=ki.prototype.he,U("shaka.dash.DashParser",Ci),(r=Ci.prototype).configure=function(e){this.b=e},r.start=function(e,t){var r=this;return f(function n(){var i;return O(n,function(n){switch(n.j){case 1:return r.f=[e],r.a=t,S(n,ji(r),2);case 2:if(i=n.o,r.a&&Ii(r,i),!r.a)throw new fe(2,7,7001);return n.return(r.c)}})})},r.stop=function(){return this.b=this.a=null,this.f=[],this.c=null,this.l=[],this.m={},null!=this.i&&(this.i.stop(),this.i=null),this.g.destroy()},r.update=function(){ji(this).catch(function(e){this.a&&this.a.onError(e)}.bind(this))},r.onExpirationUpdated=function(){},r.uf=function(e,t){e.ca=Oi(t,e.ja,null);var r=!1,n=Yn.R(t,"Role"),i=n.map(function(e){return e.getAttribute("value")}).filter(Ht.Ga),a=void 0,s="text"==e.ca.contentType;s&&(a="subtitle");for(var o=0;o<n.length;o++){var l=n[o].getAttribute("schemeIdUri");if(null==l||"urn:mpeg:dash:role:2011"==l)switch(l=n[o].getAttribute("value"),l){case"main":r=!0;break;case"caption":case"subtitle":a=l}}var u=null,c=!1;Yn.R(t,"EssentialProperty").forEach(function(e){"http://dashif.org/guidelines/trickmode"==e.getAttribute("schemeIdUri")?u=e.getAttribute("value"):c=!0}),o=Yn.R(t,"Accessibility");var h=new Map;for(n={},l=(o=d(o)).next();!l.done;n={Db:n.Db},l=o.next()){var f=l.value;l=f.getAttribute("schemeIdUri"),f=f.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==l||"urn:scte:dash:cc:cea-708:2015"==l?(n.Db=1,null!=f?f.split(";").forEach(function(e){return function(t){if(t.includes("=")){var r=(t=t.split("="))[0].startsWith("CC")?t[0]:"CC"+t[0];t=t[1].split(",")[0].split(":").pop()}else r="CC"+e.Db,e.Db+=2;h.set(r,Or(t))}}(n)):h.set("CC1","und")):"urn:mpeg:dash:role:2011"==l&&null!=f&&(i.push(f),"captions"==f&&(a="caption"))}if(c)return null;var p=Jn(n=Yn.R(t,"ContentProtection"),this.b.dash.customScheme,this.b.dash.ignoreDrmInfo);if(n=Or(t.getAttribute("lang")||"und"),l=t.getAttribute("label"),0==(i=(o=Yn.R(t,"Representation")).map(this.xf.bind(this,e,p,a,n,l,r,i,h)).filter(function(e){return!!e})).length){if(s)return null;throw new fe(2,4,4003)}return e.ca.contentType&&"application"!=e.ca.contentType||(e.ca.contentType=Mi(i[0].mimeType,i[0].codecs),i.forEach(function(t){t.type=e.ca.contentType})),i.forEach(function(e){p.drmInfos.forEach(function(t){e.keyId&&t.keyIds.push(e.keyId)})}),s=o.map(function(e){return e.getAttribute("id")}).filter(Ht.Ga),{id:e.ca.id||"__fake__"+this.h++,contentType:e.ca.contentType,language:n,Rc:r,streams:i,drmInfos:p.drmInfos,qd:u,Gf:s}},r.xf=function(e,t,r,n,i,a,s,o,l){if(e.B=Oi(l,e.ca,null),!function(e){var t=e.Ob?1:0;return t+=e.Ja?1:0,0==(t+=e.Qb?1:0)?"text"==e.contentType||"application"==e.contentType:(1!=t&&(e.Ob&&(e.Ja=null),e.Qb=null),!0)}(e.B))return null;e.bandwidth=Yn.J(l,"bandwidth",Yn.nc)||0;var u=e.B.contentType;u="text"==u||"application"==u;try{var c=this.Hf.bind(this);if(e.B.Ob)var d=function(e,t){var r=Number(ni(e,bi,"presentationTimeOffset"))||0,n=ni(e,bi,"timescale"),i=1;n&&(i=Yn.nc(n)||1),r=r/i||0,n=_i(e,bi);var a=e.B.contentType;if(i=e.B.mimeType.split("/")[1],"text"!=a&&"mp4"!=i&&"webm"!=i)throw new fe(2,4,4006);if("webm"==i&&!n)throw new fe(2,4,4005);a=ii(e,bi,"RepresentationIndex");var s=ni(e,bi,"indexRange"),o=e.B.oa;if(s=Yn.oc(s||""),a){var l=a.getAttribute("sourceURL");l&&(o=Vt(e.B.oa,[l])),s=Yn.J(a,"range",Yn.oc,s)}if(!s)throw new fe(2,4,4002);return{createSegmentIndex:(i=yi(e,t,n,o,s.start,s.end,i,r)).createSegmentIndex,findSegmentPosition:i.findSegmentPosition,getSegmentReference:i.getSegmentReference,initSegmentReference:n,la:r}}(e,c);else if(e.B.Ja)d=wi(e,this.m);else if(e.B.Qb)d=Ei(e,c,this.m,!!this.c);else{var h=e.B.oa,f=e.S.duration||0;d={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0<=e&&e<f?1:null},getSegmentReference:function(e){return 1!=e?null:new oi(1,0,f,function(){return h},0,null)},initSegmentReference:null,la:0}}}catch(e){if(u&&4002==e.code)return null;throw e}return l=function(e,t,r,n){var i=Jn(e,t,n);if(r.Ad)e=1==r.drmInfos.length&&!r.drmInfos[0].keySystem,t=0==i.drmInfos.length,(0==r.drmInfos.length||e&&!t)&&(r.drmInfos=i.drmInfos),r.Ad=!1;else if(0<i.drmInfos.length&&(r.drmInfos=r.drmInfos.filter(function(e){return i.drmInfos.some(function(t){return t.keySystem==e.keySystem})}),0==r.drmInfos.length))throw new fe(2,4,4008);return i.wd||r.wd}(l=Yn.R(l,"ContentProtection"),this.b.dash.customScheme,t,this.b.dash.ignoreDrmInfo),{id:this.h++,originalId:e.B.id,createSegmentIndex:d.createSegmentIndex,findSegmentPosition:d.findSegmentPosition,getSegmentReference:d.getSegmentReference,initSegmentReference:d.initSegmentReference,presentationTimeOffset:d.la,mimeType:e.B.mimeType,codecs:e.B.codecs,frameRate:e.B.frameRate,bandwidth:e.bandwidth,width:e.B.width,height:e.B.height,kind:r,encrypted:0<t.drmInfos.length,keyId:l,language:n,label:i,type:e.ca.contentType,primary:a,trickModeVideo:null,emsgSchemeIdUris:e.B.emsgSchemeIdUris,roles:s,channelsCount:e.B.Xc,closedCaptions:o}},r.wf=function(e,t,r){var n=Yn.vb,i=r.getAttribute("schemeIdUri")||"",a=r.getAttribute("value")||"",s=Yn.J(r,"timescale",n)||1;Yn.R(r,"Event").forEach(function(r){var o=Yn.J(r,"presentationTime",n)||0,l=Yn.J(r,"duration",n)||0;l=(o=o/s+e)+l/s,null!=t&&(o=Math.min(o,e+t),l=Math.min(l,e+t)),r={schemeIdUri:i,value:a,startTime:o,endTime:l,id:r.getAttribute("id")||"",eventElement:r},this.a.onTimelineRegionAdded(r)}.bind(this))},r.Hf=function(e,t,r){return e=Ai(e,t,r,this.b.retryParameters),e=this.a.networkingEngine.request(1,e),De(this.g,e),e.promise.then(function(e){return e.data})},Ti.ed("mpd",Ci),Ti.Nb("application/dash+xml",Ci),Fi.prototype.toString=function(){var e="#"+this.name,t=this.a?this.a.map(function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)}):[];return this.value&&t.unshift(this.value),0<t.length&&(e+=":"+t.join(",")),e},Fi.prototype.getAttribute=function(e){var t=this.a.filter(function(t){return t.name==e});return t.length?t[0]:null};var zi={lb:function(e,t){return e.filter(function(e){return e.name==t})},Ra:function(e,t){var r=zi.lb(e,t);return r.length?r[0]:null},Hc:function(e,t,r){return e.filter(function(e){var n=e.getAttribute("TYPE");return e=e.getAttribute("GROUP-ID"),n.value==t&&e.value==r})},zc:function(e,t){return Vt([e],[t])[0]},Pc:function(e){return/^#(?!EXT)/m.test(e)}};function Hi(e){this.b=e,this.a=0}function Vi(e){Ki(e,/[ \t]+/gm)}function Ki(e,t){t.lastIndex=e.a;var r=t.exec(e.b);return r=null==r?null:{position:r.index,length:r[0].length,Jf:r},e.a==e.b.length||null==r||r.position!=e.a?null:(e.a+=r.length,r.Jf)}function Wi(e){return e.a==e.b.length?null:(e=Ki(e,/[^ \t\n]*/gm))?e[0]:null}function qi(){this.a=0}function Xi(e,t,r){var n=(t=(t=it(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new fe(2,4,4015);t=0;for(var i=1;i<n.length;i++)if(!zi.Pc(n[i])){var a=$i(e,n[i]);if(--e.a,Ji.includes(a.name)){t=1;break}"EXT-X-STREAM-INF"==a.name&&(i+=1)}for(i=[],a=1;a<n.length;)if(zi.Pc(n[a]))a+=1;else{var s=$i(e,n[a]);if(Qi.includes(s.name)){if(1!=t)throw new fe(2,4,4017);return new Ni(r,t,i,e=Yi(e,r,n=n.splice(a,n.length-a),i))}i.push(s),a+=1,"EXT-X-STREAM-INF"==s.name&&(s.a.push(new Bi("URI",n[a])),a+=1)}return new Ni(r,t,i)}function Yi(e,t,r,n){var i=[],a=[];return r.forEach(function(r){if(/^(#EXT)/.test(r))r=$i(e,r),Ji.includes(r.name)?n.push(r):a.push(r);else{if(zi.Pc(r))return[];r=zi.zc(t,r.trim()),i.push(new Gi(r,a)),a=[]}}),i}function $i(e,t){var r=e.a++,n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new fe(2,4,4016,t);var i,a=n[1],s=n[2];if(n=[],s){var o;(o=Ki(s=new Hi(s),/^([^,=]+)(?:,|$)/g))&&(i=o[1]);for(var l=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;o=Ki(s,l);)n.push(new Bi(o[1],o[2]||o[3]))}return new Fi(r,a,n,i)}var Ji="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),Qi="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function Zi(e){try{var t=Zi.parse(e);return _e({uri:e,ad:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return me(e)}}function ea(){var e=this;this.c=this.g=null,this.$=1,this.D=new Map,this.T=new Set,this.a=new Map,this.b=null,this.v="",this.s=new qi,this.P=0,this.h=new ce(function(){!function(e){f(function t(){var r,n;return O(t,function(t){switch(t.j){case 1:return e.g?(x(t,2),S(t,e.update(),4)):t.return();case 4:r=e.P,e.h.O(r),k(t,0);break;case 2:(n=A(t)).severity=1,e.g.onError(n),e.h.O(.1),E(t)}})})}(e)}),this.f=ba,this.m=null,this.C=0,this.G=1/0,this.i=new je,this.M=[],this.l=new Map,this.W=!1}function ta(e,t){return f(function r(){var n,i,a,s,o,l,u,c,d,h;return O(r,function(r){switch(r.j){case 1:return n=zi,i=wa,a=t.pe,S(r,pa(e,a),2);case 2:if(s=r.o,1!=(o=Xi(e.s,s.data,s.uri)).type)throw new fe(2,4,4017);return u=(l=n.Ra(o.a,"EXT-X-MEDIA-SEQUENCE"))?Number(l.value):0,c=t.stream,S(r,ua(e,t.tc,o,u,c.mimeType,c.codecs),3);case 3:d=r.o,t.Pb.a=d,h=d[d.length-1],n.Ra(o.a,"EXT-X-ENDLIST")&&(va(e,i.Oa),e.b.wa(h.endTime)),E(r)}})})}function ra(e){e.forEach(function(e){var t=e.stream.codecs.split(",");t=t.filter(function(e){return"mp4a.40.34"!=e}),e.stream.codecs=t.join(",")})}function na(e,t,r,n,i){return{id:e.$++,language:t?t.language:"und",primary:!!t&&t.primary||!!r&&r.primary,audio:t,video:r,bandwidth:n,drmInfos:i,allowedByApplication:!0,allowedByKeySystem:!0}}function ia(e,t,r){return f(function n(){var i,a,s,o,l,u,c,d,h;return O(n,function(n){switch(n.j){case 1:if(i=ha(t,"URI"),e.a.has(i))return n.return(e.a.get(i));if(a=ha(t,"TYPE").toLowerCase(),s=Wt,"subtitles"==a&&(a=s.qa),o=Or(Ui(t,"LANGUAGE","und")),l=Ui(t,"NAME"),u=t.getAttribute("DEFAULT"),c=t.getAttribute("AUTOSELECT"),d=Ui(t,"CHANNELS"),"audio"==a)if(d){var f=d.split("/")[0];f=parseInt(f,10)}else f=null;else f=null;return S(n,aa(e,i,r,a,o,!!u||!!c,l,f,null),2);case 2:return null==(h=n.o)?n.return(null):e.a.has(i)?n.return(e.a.get(i)):(e.D.set(t.id,h),e.a.set(i,h),n.return(h))}})})}function aa(e,t,r,n,i,a,s,o,l){return f(function u(){var c,h,p,g,m,v,_,y,b,w,E,x,T,k,A,C,j,D,R,L,I,P,M,N,F;return O(u,function(u){switch(u.j){case 1:return h=(c=zi).zc(e.v,t),g="",S(u,pa(e,h),2);case 2:if(v=u.o,h=v.uri,1!=(p=Xi(e.s,v.data,h)).type)throw new fe(2,4,4017);_=[],p.segments.forEach(function(e){e=c.lb(e.b,"EXT-X-KEY"),_.push.apply(_,e)}),y=!1,b=[],w=null;for(var B=d(_),U=B.next();!U.done;U=B.next())if(E=U.value,"NONE"!=(x=ha(E,"METHOD"))){if(y=!0,"AES-128"==x)return e.W=!0,u.return(null);T=ha(E,"KEYFORMAT"),(A=(k=ya[T])?k(E):null)&&(A.keyIds.length&&(w=A.keyIds[0]),b.push(A))}if(y&&!b.length)throw new fe(2,4,4026);return function(e,t){var r=wa,n=zi.Ra(t.a,"EXT-X-PLAYLIST-TYPE"),i=zi.Ra(t.a,"EXT-X-ENDLIST");i=n&&"VOD"==n.value||i,n=n&&"EVENT"==n.value&&!i,n=!i&&!n,i?va(e,r.Oa):(va(e,n?r.td:r.ke),r=fa(t.a,"EXT-X-TARGETDURATION"),r=Number(r.value),e.C=Math.max(r,e.C),e.G=Math.min(r,e.G))}(e,p),g=function(e,t){if(1==t.length)return t[0];var r=da(e,t);if(null!=r)return r;throw new fe(2,4,4025,t)}(n,r),S(u,function(e,t,r,n){return f(function i(){var a,s,o,l,u,c,d,h,f,p;return O(i,function(i){switch(i.j){case 1:return a=Wt,s=Le,o=n.segments[0].a,l=new $(o),u=l.ia.split(".").pop(),c=ma[t],(d=c[u])?i.return(d):t==a.qa?r&&"vtt"!=r?i.return("application/mp4"):i.return("text/vtt"):((h=Pe([o],e.c.retryParameters)).method="HEAD",S(i,_a(e,h,s.ud),2));case 2:if(f=i.o,!(p=f.headers["content-type"]))throw new fe(2,4,4021,u);return i.return(p.split(";")[0])}})})}(e,n,g,p),3);case 3:return m=u.o,j=(C=c.Ra(p.a,"EXT-X-MEDIA-SEQUENCE"))?Number(C.value):0,S(u,ua(e,t,p,j,m,g),4);case 4:return D=u.o,R=D[0].startTime,L=D[D.length-1].endTime,I=L-R,P=new ui(D),M=sa(p),N=void 0,"text"==n&&(N="subtitle"),F={id:e.$++,originalId:s,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:P.find.bind(P),getSegmentReference:P.get.bind(P),initSegmentReference:M,presentationTimeOffset:0,mimeType:m,codecs:g,kind:N,encrypted:y,keyId:w,language:i,label:s,type:n,primary:a,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:[],channelsCount:o,closedCaptions:l},u.return({stream:F,Pb:P,drmInfos:b,tc:t,pe:h,Uc:R,qg:L,duration:I})}})})}function sa(e){var t=zi.lb(e.a,"EXT-X-MAP");if(!t.length)return null;if(1<t.length)throw new fe(2,4,4020);var r=ha(t=t[0],"URI"),n=zi.zc(e.b,r);return e=0,r=null,(t=Ui(t,"BYTERANGE"))&&(e=t.split("@"),t=Number(e[0]),r=(e=Number(e[1]))+t-1),new si(function(){return[n]},e,r)}function oa(e,t,r,n){var i=t.b,a=t.a;t=fa(i,"EXTINF").value.split(","),t=n+Number(t[0]);var s=0,o=null;return(i=zi.Ra(i,"EXT-X-BYTERANGE"))&&(s=i.value.split("@"),i=Number(s[0]),o=(s=s[1]?Number(s[1]):e.a+1)+i-1),new oi(r,n,t,function(){return[a]},s,o)}function la(e){e.b&&(e.M.forEach(function(t){e.b.sb(t,0)}),e.M=[])}function ua(e,t,r,n,i,a){return f(function s(){var o,l,u,c,d,h,p,g,m,v;return O(s,function(s){switch(s.j){case 1:return o=r.segments,l=[],u=o[0].a,c=oa(null,o[0],n,0),d=sa(r),S(s,function(e,t,r,n,i,a){return f(function s(){var o,l,u,c,d,h,f,p,g;return O(s,function(s){switch(s.j){case 1:if(e.m&&(o=e.a.get(t),l=o.Pb,u=l.get(n.position)))return s.return(u.startTime);if("audio/mpeg"==i)return s.return(0);if("video/mp4"!=i&&"audio/mp4"!=i){s.A(2);break}return c=[ca(e,n)],r&&c.push(ca(e,r)),S(s,Promise.all(c),3);case 3:return d=s.o,h=d[0],f=d[1]||d[0],s.return(function(e,t){var r=0;if((new zn).H("moov",Hn).H("trak",Hn).H("mdia",Hn).fa("mdhd",function(e){e.reader.L(0==e.version?8:16),r=e.reader.F(),e.parser.stop()}).parse(t,!0),!r)throw new fe(2,4,4030);var n=0,i=!1;if((new zn).H("moof",Hn).H("traf",Hn).fa("tfdt",function(e){n=(0==e.version?e.reader.F():e.reader.yb())/r,i=!0,e.parser.stop()}).parse(e,!0),!i)throw new fe(2,4,4030);return n}(h.data,f.data));case 2:if("video/mp2t"!=i){s.A(4);break}return S(s,ca(e,n),5);case 5:return p=s.o,s.return(function(e){function t(){throw new fe(2,4,4030)}e=new Bn(new DataView(e),0);for(var r=0,n=0;;){if(r=e.ba(),71!=(n=e.ka())&&t(),16384&e.Mb()||t(),0!=(n=(48&e.ka())>>4)&&2!=n||t(),3==n&&(n=e.ka(),e.L(n)),1==e.F()>>8)return e.L(3),0!=(r=e.ka()>>6)&&1!=r||t(),0==e.ka()&&t(),r=e.ka(),n=e.Mb(),e=e.Mb(),(1073741824*((14&r)>>1)+((65534&n)<<14|(65534&e)>>1))/9e4;e.seek(r+188),71!=(n=e.ka())&&(e.seek(r+192),n=e.ka()),71!=n&&(e.seek(r+204),n=e.ka()),71!=n&&t(),e.$d(1)}}(p.data));case 4:if("application/mp4"!=i&&!i.startsWith("text/")){s.A(6);break}return S(s,ca(e,n),7);case 7:return g=s.o,s.return(function(e,t,r){return mr(e=$e(e,t))?(vr(t=new pr(null),e),t.Mc(r)):0}(i,a,g.data));case 6:if("video/webm"==i)return s.return(null);throw new fe(2,4,4030)}})})}(e,t,d,c,i,a),2);case 2:h=s.o,u.split("/").pop();for(var _=0;_<o.length;++_)p=o[_],g=l[l.length-1],m=0==_?h:g.endTime,v=oa(g,p,n+_,m),l.push(v);return e.M.push(l),la(e),s.return(l)}})})}function ca(e,t){return f(function r(){var n,i,a,s,o,l;return O(r,function(r){switch(r.j){case 1:return n=Le,i=Ai(t.c(),t.b,t.b+2048-1,e.c.retryParameters),a=Ai(t.c(),t.b,t.a,e.c.retryParameters),x(r,2),S(r,_a(e,i,n.ud),4);case 4:return s=r.o,r.return(s);case 2:if(7001==(o=A(r)).code)throw o;return q("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",i.uris[0]),S(r,_a(e,a,n.ud),5);case 5:return l=r.o,r.return(l)}})})}function da(e,t){for(var r=ga[e],n=0;n<r.length;n++)for(var i=0;i<t.length;i++)if(r[n].test(t[i].trim()))return t[i].trim();return"text"==e?"":null}function ha(e,t){var r=e.getAttribute(t);if(!r)throw new fe(2,4,4023,t);return r.value}function fa(e,t){var r=zi.Ra(e,t);if(!r)throw new fe(2,4,4024,t);return r}function pa(e,t){return _a(e,Pe([t],e.c.retryParameters),Le.ng)}U("shaka.net.DataUriPlugin",Zi),Zi.parse=function(t){var r=t.split(":");if(2>r.length||"data"!=r[0])throw new fe(2,1,1004,t);if(2>(r=r.slice(1).join(":").split(",")).length)throw new fe(2,1,1004,t);var n=r[0];r=e.decodeURIComponent(r.slice(1).join(","));var i=null;if(1<(n=n.split(";")).length&&(i=n[1]),"base64"==i)t=ht(r).buffer;else{if(i)throw new fe(2,1,1005,t);t=ot(r)}return{data:t,contentType:n[0]}},Oe("data",Zi),U("shaka.hls.HlsParser",ea),(r=ea.prototype).configure=function(e){this.c=e},r.start=function(e,t){var r=this;return f(function n(){var i,a;return O(n,function(n){switch(n.j){case 1:return r.g=t,S(n,pa(r,e),2);case 2:return i=n.o,r.v=i.uri,S(n,function(e,t){return f(function r(){var n,i,a,s,o,l,u,c,h,p,g;return O(r,function(r){switch(r.j){case 1:if(0!=(n=Xi(e.s,t,e.v)).type)throw new fe(2,4,4022);return S(r,function(e,t){return f(function r(){var n,i,a,s,o,l,u,c,h,p,g,m;return O(r,function(r){switch(r.j){case 1:return n=zi,i=Ht,a=t.a,s=n.lb(t.a,"EXT-X-MEDIA"),o=s.filter(function(e){return"SUBTITLES"==ha(e,"TYPE")}.bind(e)),l=o.map(function(e){var t=this;return f(function r(){var n;return O(r,function(r){switch(r.j){case 1:return x(r,2),S(r,function(e,t){return f(function r(){var n;return O(r,function(r){switch(r.j){case 1:return ha(t,"TYPE"),S(r,ia(e,t,[]),2);case 2:return n=r.o,r.return(n.stream)}})})}(t,e),4);case 4:return r.return(r.o);case 2:if(n=A(r),t.c.hls.ignoreTextStreamFailures)return r.return(null);throw n}})})}.bind(e)),u=s.filter(function(e){return"CLOSED-CAPTIONS"==ha(e,"TYPE")}),function(e,t){for(var r=d(t),n=r.next();!n.done;n=r.next()){ha(n=n.value,"TYPE");var i=Ui(n,"LANGUAGE")||"und";i=Or(i);var a=ha(n,"GROUP-ID");n=ha(n,"INSTREAM-ID"),e.l.get(a)||e.l.set(a,new Map),e.l.get(a).set(n,i)}}(e,u),S(r,Promise.all(l),2);case 2:return c=r.o,h=n.lb(a,"EXT-X-STREAM-INF"),p=h.map(function(e){return function(e,t,r){return f(function n(){var i,a,s,o,l,u,c,h,p,g,m,v,_,y,b,w,E,x,T,k,A,C,j,D,R,L,I;return O(n,function(n){switch(n.j){case 1:return i=Wt,a=zi,s=Ui(t,"CODECS","avc1.42E01E,mp4a.40.2"),o=function(e){for(var t=new Set,r=[],n=(e=d(e)).next();!n.done;n=e.next()){var i=Je(n=n.value)[0];t.has(i)||(r.push(n),t.add(i))}return r}(s.split(/\s*,\s*/)),l=t.getAttribute("RESOLUTION"),c=u=null,h=Ui(t,"FRAME-RATE"),p=Number(ha(t,"BANDWIDTH")),l&&(g=l.value.split("x"),u=g[0],c=g[1]),m=(m=(m=a.lb(r.a,"EXT-X-MEDIA")).filter(function(e){return"CLOSED-CAPTIONS"!=ha(e,"TYPE")})).filter(function(e){var t=Ui(e,"URI")||"";return"SUBTITLES"==(Ui(e,"TYPE")||"")||""!=t}),v=Ui(t,"AUDIO"),_=Ui(t,"VIDEO"),v?m=a.Hc(m,"AUDIO",v):_&&(m=a.Hc(m,"VIDEO",_)),(y=da(i.qa,o))&&((b=Ui(t,"SUBTITLES"))&&((w=a.Hc(m,"SUBTITLES",b)).length&&(E=e.D.get(w[0].id))&&(E.stream.codecs=y)),Ae(o,y)),x=m.map(function(e){return ia(this,e,o)}.bind(e)),T=[],k=[],S(n,Promise.all(x),2);case 2:if(C=(C=n.o).filter(function(e){return null!=e}),v?T=C:_&&(k=C),D=!1,T.length||k.length?T.length?(L=ha(t,"URI"),I=T[0].tc,L==I?(j=i.Ab,D=!0):j=i.Na):j=i.Ab:1==o.length?(R=da(i.Na,o),j=l||h||R?i.Na:i.Ab):(j=i.Na,o=[o.join(",")]),D){n.A(3);break}return S(n,function(e,t,r,n){return f(function i(){var a,s,o,l,u;return O(i,function(i){switch(i.j){case 1:return a=Wt,s=ha(t,"URI"),e.a.has(s)?i.return(e.a.get(s)):(o=Ui(t,"CLOSED-CAPTIONS"),l=null,n==a.Na&&o&&"NONE"!=o&&(l=e.l.get(o)),S(i,aa(e,s,r,n,"und",!1,null,null,l),2));case 2:return null==(u=i.o)?i.return(null):e.a.has(s)?i.return(e.a.get(s)):(e.a.set(s,u),i.return(u))}})})}(e,t,o,j),4);case 4:A=n.o;case 3:if(A)A.stream.type==i.Ab?T=[A]:k=[A];else if(null===A)return n.return([]);return k&&ra(k),T&&ra(T),n.return(function(e,t,r,n,i,a,s){r.forEach(function(e){(e=e.stream)&&(e.width=Number(i)||void 0,e.height=Number(a)||void 0,e.frameRate=Number(s)||void 0)}.bind(e)),t.length||(t=[null]),r.length||(r=[null]);for(var o=[],l=(t=d(t)).next();!l.done;l=t.next()){l=l.value;for(var u=d(r),c=u.next();!c.done;c=u.next()){var h=c.value;c=l?l.stream:null;var f=h?h.stream:null,p=l?l.drmInfos:null,g=h?h.drmInfos:null;h=(h?h.tc:"")+" - "+(l?l.tc:"");var m=void 0;if(c&&f){if(p.length&&g.length&&!(0<Rt(p,g).length))continue;m=Rt(p,g)}else c?m=p:f&&(m=g);e.T.has(h)||(c=na(e,c,f,n,m),o.push(c),e.T.add(h))}}return o}(e,T,k,p,u,c,h))}})})}(this,e,t)}.bind(e)),S(r,Promise.all(p),3);case 3:return g=r.o,m=(m=g.reduce(i.yc,[])).filter(function(e){return null!=e}),r.return({startTime:0,variants:m,textStreams:c.filter(function(e){return null!=e})})}})})}(e,n),2);case 2:if(i=r.o,!e.g)throw new fe(2,7,7001);if(e.W&&0==i.variants.length)throw new fe(2,4,4034);e.g.filterAllPeriods([i]),a=1/0,s=0,o=1/0;for(var m=d(e.a.values()),v=m.next();!v.done;v=m.next())l=v.value,a=Math.min(a,l.Uc),s=Math.max(s,l.Uc),"text"!=l.stream.type&&(o=Math.min(o,l.duration));if(e.f!=wa.Oa?(e.b=new ki(0,3*e.C),e.b.Rb(!1)):(e.b=new ki(null,0),e.b.Rb(!0)),la(e),e.f!=wa.Oa){for(e.P=e.G,u=wa,e.f==u.td&&(c=e.b.pc,isNaN(e.c.availabilityWindowOverride)||(c=e.c.availabilityWindowOverride),e.b.md(c)),h=0;95443.7176888889<=s;)h+=95443.7176888889,s-=95443.7176888889;if(h)for(v=(m=d(e.a.values())).next();!v.done;v=m.next())95443.7176888889>(p=v.value).Uc&&(p.stream.presentationTimeOffset=-h,p.Pb.offset(h))}else for(e.b.wa(o),e.b.offset(-a),v=(m=d(e.a.values())).next();!v.done;v=m.next())(g=v.value).stream.presentationTimeOffset=a,g.Pb.offset(-a),ci(g.Pb,o);e.m={presentationTimeline:e.b,periods:[i],offlineSessionIds:[],minBufferTime:0},E(r)}})})}(r,i.data),3);case 3:return 0<(a=r.P)&&r.h.O(a),n.return(r.m)}})})},r.stop=function(){this.h&&(this.h.stop(),this.h=null);var e=[];return this.i&&(e.push(this.i.destroy()),this.i=null),this.c=this.g=null,this.D.clear(),this.T.clear(),this.a.clear(),this.m=null,Promise.all(e)},r.update=function(){if(this.f!=wa.Oa){for(var e=[],t=d(this.a.values()),r=t.next();!r.done;r=t.next())e.push(ta(this,r.value));return Promise.all(e)}},r.onExpirationUpdated=function(){};var ga={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},ma={audio:{mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",ts:"video/mp2t"},video:{mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function va(e,t){e.f=t,e.b&&e.b.Rb(e.f==wa.Oa),e.f!=wa.Oa||e.h.stop()}function _a(e,t,r){if(!e.i)throw new fe(2,7,7001);return t=e.g.networkingEngine.request(r,t),De(e.i,t),t.promise}var ya={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=ha(e,"METHOD");return tn("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227"),["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].includes(t)?(t=ha(e,"URI"),t=Zi.parse(t),t=Kt("com.widevine.alpha",[{initDataType:"cenc",initData:t=new Uint8Array(t.data)}]),(e=Ui(e,"KEYID"))&&(t.keyIds=[e.substr(2).toLowerCase()]),t):null}},ba="VOD",wa={Oa:ba,ke:"EVENT",td:"LIVE"};function Sa(){this.a=new Map}function Ea(e,t,r){xa(e,t).text=r}function xa(e,t){return e.a.has(t)||e.a.set(t,new Ta),e.a.get(t)}function Ta(){this.text=this.variant=null}function ka(e,t){this.a=e,this.b=new Set([e]);for(var r=d(t=t||[]),n=r.next();!n.done;n=r.next())this.add(n.value)}function Aa(e,t){var r;if(!(r=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(r=e.audio&&t.audio)){r=e.audio;var n=t.audio;r=!(r.channelsCount==n.channelsCount&&Ca(r,n)&&ja(r.roles,n.roles))}return!r&&(r=e.video&&t.video)&&(r=!(Ca(r=e.video,n=t.video)&&ja(r.roles,n.roles))),!r}function Ca(e,t){if(e.mimeType!=t.mimeType)return!1;var r=e.codecs.split(",").map(function(e){return Je(e)[0]}),n=t.codecs.split(",").map(function(e){return Je(e)[0]});if(r.length!=n.length)return!1;r.sort(),n.sort();for(var i=0;i<r.length;i++)if(r[i]!=n[i])return!1;return!0}function ja(e,t){var r=new Set(e),n=new Set(t);if(r.delete("main"),n.delete("main"),r.size!=n.size)return!1;for(var i=(r=d(r)).next();!i.done;i=r.next())if(!n.has(i.value))return!1;return!0}function Da(e){this.a=e,this.b=new Ra(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0)}function Ra(e,t,r){this.c=e,this.b=t,this.a=r}function La(e,t){this.a=Oa,this.b=(new Map).set(Oa,t).set(Ia,e)}Ti.ed("m3u8",ea),Ti.Nb("application/x-mpegurl",ea),Ti.Nb("application/vnd.apple.mpegurl",ea),ka.prototype.add=function(e){return!!Aa(this.a,e)&&(this.b.add(e),!0)},ka.prototype.values=function(){return this.b.values()},Da.prototype.create=function(e){var t=this,r=e.filter(function(e){return Aa(t.a,e)});return r.length?new ka(r[0],r):this.b.create(e)},Ra.prototype.create=function(e){var t=[];t=function(e,t){var r=Mr(Or(t),e.map(function(e){return Pr(e)}));return r?e.filter(function(e){return r==Pr(e)}):[]}(e,this.c);var r=e.filter(function(e){return e.primary});for(t=t.length?t:r.length?r:e,this.b&&((e=function(e,t){return e.filter(function(e){var r=e.audio;return e=e.video,r&&0<=r.roles.indexOf(t)||e&&0<=e.roles.indexOf(t)})}(t,this.b)).length&&(t=e)),this.a&&((e=Xr(t,this.a)).length&&(t=e)),e=new ka(t[0]),r=(t=d(t)).next();!r.done;r=t.next())r=r.value,Aa(e.a,r)&&e.add(r);return e};var Ia=0,Oa=1;function Pa(e,t){this.f=e,this.g=Na(e),this.b=e.a.currentTime,this.c=Date.now()/1e3,this.h=t,this.a=function(){}}function Ma(e){this.a=e}function Na(e){if(e.a.paused||0==e.a.playbackRate||null==e.a.buffered)var t=!1;else e:{t=e.a.buffered,e=e.a.currentTime;for(var r=0;r<t.length;r++){var n=t.start(r),i=t.end(r);if(!(e<n||e>i-.5)){t=!0;break e}}t=!1}return t}function Fa(e,t,r,n,i){var a=this;this.a=e,this.v=t,this.s=r,this.l=i,this.f=new ze,this.i=!1,this.m=e.readyState,this.c=!1,this.b=n,this.h=!1,this.f.w(e,"waiting",function(){return Ba(a)}),this.g=new ce(function(){Ba(a)}).La(.25)}function Ba(e){if(0!=e.a.readyState){if(e.a.seeking){if(!e.i)return}else e.i=!1;if(!e.a.paused){e.a.readyState!=e.m&&(e.c=!1,e.m=e.a.readyState);var t=e.s.smallGapLimit,r=e.a.currentTime,n=e.a.buffered;e:{if(n&&n.length&&!(1==n.length&&1e-6>n.end(0)-n.start(0)))for(var i=tt("Edge/")||tt("Trident/")||tt("Tizen")||tt("CrKey")?.5:.1,a=0;a<n.length;a++)if(n.start(a)>r&&(0==a||n.end(a-1)-r<=i)){i=a;break e}i=null}if(null==i)e.b&&(n=Na(r=(e=e.b).f),r=r.a.currentTime,i=Date.now()/1e3,e.b==r&&e.g==n||(e.c=i,e.b=r,e.g=n),(r=i-e.c)>=e.h&&n&&e.a(e.b,r));else if(0!=i||e.h){a=n.start(i);var s=e.v.za();if(!(a>=s)){t=(s=a-r)<=t;var o=!1;.001>s||(t||e.c||(e.c=!0,(r=new Se("largegap",{currentTime:r,gapSize:s})).cancelable=!0,e.l(r),e.s.jumpLargeGaps&&!r.defaultPrevented&&(o=!0)),!t&&!o)||(0!=i&&n.end(i-1),e.a.currentTime=a)}}}}}function Ua(e){var t=this;this.c=e,this.a=new Set,this.b=new ce(function(){Ga(t,!1)}).La(.25)}function Ga(e,t){for(var r=d(e.a),n=r.next();!n.done;n=r.next())n.value.g(e.c.currentTime,t)}function za(e){for(var t=[],r=(e=d(e)).next();!r.done;r=e.next())for(var n=(r=d(r.value.variants)).next();!n.done;n=r.next())t.push(n.value);return t}function Ha(e,t){for(var r=null,n=d(e),i=n.next();!i.done;i=n.next())t>=(i=i.value).startTime&&(r=i);return r}function Va(e){this.c=e,this.a=null,this.b=function(){}}function Ka(e){var t=this;this.a=e,this.f=!1,this.c=this.a.ec(),this.b=new ce(function(){t.a.Id(.25*t.c)})}function Wa(e){e.b.stop();var t=e.f?0:e.c;if(0<=t)try{return void(e.a.ec()!=t&&e.a.ld(t))}catch(e){}e.b.La(.25),0!=e.a.ec()&&e.a.ld(0)}function qa(e,t,r){this.a=e,this.f=t,this.g=r,this.h=!1,this.b=new ze,this.c=new Qa(e),0<e.readyState?$a(this,r):Ya(this,r)}function Xa(e){return e.h?e.a.currentTime:e.g}function Ya(e,t){e.g=t,e.b.ea(e.a,"loadedmetadata"),e.b.da(e.a,"loadedmetadata",function(){$a(e,t)})}function $a(e,t){.001>Math.abs(e.a.currentTime-t)?Ja(e):(e.b.da(e.a,"seeking",function(){Ja(e)}),Za(e.c,0==e.a.currentTime?t:e.a.currentTime))}function Ja(e){e.h=!0,e.b.w(e.a,"seeking",function(){return e.f()})}function Qa(e){var t=this;this.b=e,this.h=10,this.g=this.f=this.c=0,this.a=new ce(function(){0>=t.c?t.a.stop():t.b.currentTime!=t.f?t.a.stop():(t.b.currentTime=t.g,t.c--)})}function Za(e,t){e.f=e.b.currentTime,e.g=t,e.c=e.h,e.b.currentTime=t,e.a.La(.1)}function es(e){function t(){null==r.c?r.f=!0:(r.b.da(r.a,"seeking",function(){r.f=!0}),r.a.currentTime=r.c)}var r=this;this.a=e,this.f=!1,this.c=null,this.b=new ze,0==this.a.readyState?this.b.da(this.a,"loadedmetadata",t):t()}function ts(e,t,r,n,i,a){var s=this;this.b=e,this.a=t.presentationTimeline,this.C=t.minBufferTime||0,this.g=r,this.v=i,this.l=null,this.f=new Fa(e,t.presentationTimeline,r,function(e,t){if(!t.stallEnabled)return null;var r=t.stallSkip,n=new Pa(new Ma(e),t.stallThreshold);return function(e,t){e.a=t}(n,function(){e.currentTime+=r}),n}(e,r),a),this.c=new qa(e,function(){var e=s.f;e.i=!0,e.h=!1,e.c=!1;var t=Xa(s.c);return e=ns(s,t),.001<Math.abs(e-t)&&(t=(new Date).getTime()/1e3,!s.l||s.l<t-1)?(s.l=t,0<(t=s.c).a.readyState?Za(t.c,e):Ya(t,e),e=void 0):(s.v(),e=void 0),e},function(e,t){return null==t?t=1/0>e.a.Y()?e.a.mb():e.a.za():0>t&&(t=e.a.za()+t),rs(e,is(e,t))}(this,n)),this.i=new ce(function(){if(0!=s.b.readyState&&!s.b.paused){var e=s.b.currentTime,t=s.a.mb(),r=s.a.za();3>r-t&&(t=r-3),e<t&&(e=ns(s,e),s.b.currentTime=e)}}).La(.25)}function rs(e,t){var r=e.a.Y();return t>=r?r-e.g.durationBackoff:t}function ns(e,t){var r=Ut.bind(null,e.b.buffered),n=Math.max(e.C,e.g.rebufferingGoal),i=e.g.safeSeekOffset,a=e.a.mb(),s=e.a.za(),o=e.a.Y();3>s-a&&(a=s-3);var l=e.a.Gb(n),u=e.a.Gb(i);return n=e.a.Gb(n+i),t>=o?rs(e,t):t>s?s:t<a?r(u)?u:n:t>=l||r(t)?t:n}function is(e,t){var r=e.a.mb();return t<r?r:t>(r=e.a.za())?r:t}function as(){this.b=function(){},this.a=new Set}function ss(e){var t=this;this.h=e,this.f=new Map,this.a=function(){},this.b=function(){},this.c=function(){},this.i=[{bb:null,ab:ls,Ua:function(e,r){return t.a(e,r)}},{bb:os,ab:ls,Ua:function(e,r){return t.a(e,r)}},{bb:us,ab:ls,Ua:function(e,r){return t.a(e,r)}},{bb:ls,ab:os,Ua:function(e,r){return t.b(e,r)}},{bb:ls,ab:us,Ua:function(e,r){return t.b(e,r)}},{bb:os,ab:us,Ua:function(e,r){return t.c(e,r)}},{bb:us,ab:os,Ua:function(e,r){return t.c(e,r)}}]}Pa.prototype.release=function(){this.f=null,this.a=function(){}},Fa.prototype.release=function(){this.f&&(this.f.release(),this.f=null),null!=this.g&&(this.g.stop(),this.g=null),this.b&&(this.b.release(),this.b=null),this.a=this.v=this.l=null},Fa.prototype.Zc=function(){this.h=!0,Ba(this)},Ua.prototype.release=function(){this.b.stop();for(var e=d(this.a),t=e.next();!t.done;t=e.next())t.value.release();this.a.clear()},Va.prototype.release=function(){this.a=this.c=null,this.b=function(){}},Va.prototype.g=function(e){var t=this.a,r=this.c.periods;t!=(e=Ha(r,e)||r[0])&&this.b(e),this.a=e},Ka.prototype.release=function(){this.b&&(this.b.stop(),this.b=null),this.a=null},Ka.prototype.set=function(e){this.c=e,Wa(this)},qa.prototype.release=function(){this.b&&(this.b.release(),this.b=null),null!=this.c&&(this.c.release(),this.c=null),this.f=function(){},this.a=null},Qa.prototype.release=function(){this.a&&(this.a.stop(),this.a=null),this.b=null},es.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.a=null},es.prototype.m=function(e){this.c=this.f?this.c:e},es.prototype.h=function(){return(this.f?this.a.currentTime:this.c)||0},es.prototype.s=function(){},ts.prototype.release=function(){this.c&&(this.c.release(),this.c=null),this.f&&(this.f.release(),this.f=null),this.i&&(this.i.stop(),this.i=null),this.b=this.c=this.a=this.g=null,this.v=function(){}},ts.prototype.m=function(e){var t=this.c;0<t.a.readyState?Za(t.c,e):Ya(t,e)},ts.prototype.h=function(){var e=Xa(this.c);return 0<this.b.readyState&&!this.b.paused?is(this,e):e},ts.prototype.s=function(){this.f.Zc()},as.prototype.release=function(){this.b=function(){},this.a.clear()},ss.prototype.release=function(){this.h=null,this.f.clear(),this.a=function(){},this.b=function(){},this.c=function(){}},ss.prototype.g=function(e,t){for(var r=d(this.h.a),n=r.next();!n.done;n=r.next()){n=n.value;var i=this.f.get(n),a=e<n.startTime?os:e>n.endTime?us:ls;this.f.set(n,a);for(var s=d(this.i),o=s.next();!o.done;o=s.next())(o=o.value).bb==i&&o.ab==a&&o.Ua(n,t)}};var os=1,ls=2,us=3;function cs(e,t){this.a=t,this.c=e,this.g=null,this.l=1,this.v=Promise.resolve(),this.h=[],this.i=new Map,this.b=new Map,this.s=!1,this.G=null,this.D=this.f=this.m=!1,this.C=0}function ds(e){return fs(e,"audio")}function hs(e){return fs(e,"video")}function fs(e,t){var r=e.b.get(t);return r?r.Ia||r.stream:null}function ps(e,t){return f(function r(){var n,i,a,s,o,l,u,c,d;return O(r,function(r){switch(r.j){case 1:return n=Wt,S(r,Cr(e.a.I,n.qa),2);case 2:return e.C++,e.D=!1,i=e.C,a=e.a.I,s=new Map,o=new Set,s.set(n.qa,t),o.add(t),S(r,a.init(s,!1),3);case 3:return e.f?r.return():S(r,Ss(e,o),4);case 4:if(e.f)return r.return();l=e.a.I.g.isTextVisible()||e.g.alwaysStreamText,e.C!=i||e.b.has(n.qa)||e.D||!l||(u=e.a.Sa(),c=js(e,u),d=bs(t,c,0),e.b.set(n.qa,d),Is(e,d,0)),E(r)}})})}function gs(e,t){var r=e.b.get("video");if(r){var n=r.stream;if(n)if(t){var i=n.trickModeVideo;i&&!r.Ia&&(vs(e,i,!1,0,!1),r.Ia=n)}else(n=r.Ia)&&(r.Ia=null,vs(e,n,!0,0,!1))}}function ms(e,t,r,n){t.video&&vs(e,t.video,r,n,!1),t.audio&&vs(e,t.audio,r,n,!1)}function vs(e,t,r,n,i){var a=e.b.get(t.type);if(!a&&"text"==t.type&&e.g.ignoreTextStreamFailures)ps(e,t);else if(a){var s=Ds(e,t),o=Array.from(e.b.values()).every(function(e){return e.pa==a.pa});r&&s!=a.pa&&o?e.b.forEach(function(t){_s(e,t)}):(a.Ia&&(t.trickModeVideo?(a.Ia=t,t=t.trickModeVideo):a.Ia=null),(o=e.h[s])&&o.zb&&(o=e.i.get(t.id))&&o.zb&&(a.stream!=t||i)&&("text"==t.type&&Sr(e.a.I,$e(t.mimeType,t.codecs)),a.stream=t,a.hc=!0,function(e,t,r){if(!t.Kb)return!1;var n=e.a.Sa(),i=Tr(e.a.I,t.type);if(null==(r=(r=Ts(e,t,n,i,r))&&r.a?r.a-r.b:null))return!1;var a=t.stream.initSegmentReference;return a&&(r+=(a.a?a.a-a.b:null)||0),a=e.a.getBandwidthEstimate(),8*r/a<i-n-Math.max(e.c.minBufferTime||0,e.g.rebufferingGoal)||t.Kb.b.a>r}(e,a,s)&&a.Kb.abort(),r&&(a.Pa?a.uc=!0:a.Ha?(a.Ma=!0,a.Zb=n,a.uc=!0):(Os(a),Ls(e,a,!0,n).catch(function(t){e.a&&e.a.onError(t)})))))}}function _s(e,t){t.Pa||t.Ma||(t.Ha?(t.Ma=!0,t.Zb=0):null==xr(e.a.I,t.type)?null==t.Da&&Is(e,t,0):(Os(t),Ls(e,t,!1,0).catch(function(t){e.a&&e.a.onError(t)})))}function ys(e,t,r,n,i){return f(function a(){var s,o,l,u,c,d,h;return O(a,function(a){switch(a.j){case 1:return s=e.a.Sa(),o=js(e,s),l=Wt,u=new Map,c=new Set,t&&(u.set(l.Ab,t),c.add(t)),r&&(u.set(l.Na,r),c.add(r)),n&&(u.set(l.qa,n),c.add(n)),d=e.a.I,h=e.g.forceTransmuxTS,S(a,d.init(u,h),2);case 2:return e.f?a.return():(function(e){var t=e.c.presentationTimeline.Y();1/0>t?e.a.I.wa(t):e.a.I.wa(Math.pow(2,32))}(e),S(a,Ss(e,c),3));case 3:if(e.f)return a.return();u.forEach(function(t,r){if(!e.b.has(r)){var n=bs(t,o,i);e.b.set(r,n),Is(e,n,0)}}),E(a)}})})}function bs(e,t,r){return{stream:e,type:e.type,pb:null,Aa:null,Ia:null,hc:!0,pa:t,endOfStream:!1,Ha:!1,Da:null,Ma:!1,Zb:0,uc:!1,Pa:!1,dd:!1,Ib:!1,Zd:r||0,Kb:null}}function ws(e,t){var r=e.h[t];if(r)return r.promise;r={promise:new pe,zb:!1},e.h[t]=r;for(var n=new Set,i=d(e.c.periods[t].variants),a=i.next();!a.done;a=i.next())(a=a.value).video&&n.add(a.video),a.video&&a.video.trickModeVideo&&n.add(a.video.trickModeVideo),a.audio&&n.add(a.audio);for(a=(i=d(e.c.periods[t].textStreams)).next();!a.done;a=i.next())n.add(a.value);return e.v=e.v.then(function(){if(!this.f)return Ss(this,n)}.bind(e)).then(function(){this.f||(this.h[t].promise.resolve(),this.h[t].zb=!0)}.bind(e)).catch(function(e){this.f||(this.h[t].promise.catch(function(){}),this.h[t].promise.reject(),delete this.h[t],this.a.onError(e))}.bind(e)),r.promise}function Ss(e,t){return f(function r(){var n,i,a,s,o,l,u;return O(r,function(r){switch(r.j){case 1:n=[];for(var c=d(t),h=c.next();!h.done;h=c.next())i=h.value,(a=e.i.get(i.id))?n.push(a.promise):(e.i.set(i.id,{promise:new pe,zb:!1}),n.push(i.createSegmentIndex()));return x(r,2),S(r,Promise.all(n),4);case 4:if(e.f)return r.return();k(r,3);break;case 2:if(s=A(r),e.f)return r.return();for(h=(r=d(t)).next();!h.done;h=r.next())o=h.value,e.i.get(o.id).promise.catch(function(){}),e.i.get(o.id).promise.reject(),e.i.delete(o.id);throw s;case 3:for(h=(c=d(t)).next();!h.done;h=c.next())l=h.value,(u=e.i.get(l.id)).zb||(u.promise.resolve(),u.zb=!0);E(r)}})})}function Es(e,t){if(!e.f&&!t.Ha&&null!=t.Da&&!t.Pa)if(t.Da=null,t.Ma)Ls(e,t,t.uc,t.Zb);else{try{var r=function(e,t){if(As(t))return e.a.I.rc(t.stream.originalId||""),null;var r=e.a.Sa(),n=xs(e,t,r),i=Ds(e,t.stream),a=js(e,n),s=function(e,t,r){return"text"==t?null==(e=e.a).b||e.b<r?0:e.b-Math.max(r,e.a):Gt(e=kr(e,t),r)}(e.a.I,t.type,r),o=Math.max(e.c.minBufferTime||0,e.g.rebufferingGoal,e.g.bufferingGoal)*e.l;if(n>=e.c.presentationTimeline.Y())return t.endOfStream=!0,"video"==t.type&&(n=e.b.get("text"))&&"application/cea-608"==n.stream.mimeType&&(n.endOfStream=!0),null;if(t.endOfStream=!1,t.pa=a,a!=i)return null;if(s>=o)return.5;if(a=Tr(e.a.I,t.type),!(a=Ts(e,t,r,a,i)))return 1;var l=1/0;return Array.from(e.b.values()).forEach(function(t){As(t)||(t=xs(e,t,r),l=Math.min(l,t))}),n>=l+e.c.presentationTimeline.a?1:(t.Zd=0,function(e,t,r,n,i){var a=e.c.periods[n],s=t.stream,o=e.c.presentationTimeline.Y(),l=e.c.periods[n+1];n=function(e,t,r,n,i){return t.hc?(r=function(e,t,r,n,i){return"text"==t?(e.a.m=r,(e=e.a).f=n,e.h=i,Promise.resolve()):Promise.all([jr(e,t,e.oe.bind(e,t)),jr(e,t,e.Sf.bind(e,t,r)),jr(e,t,e.Pf.bind(e,t,n,i))])}(e.a.I,t.type,e.c.periods[r].startTime-t.stream.presentationTimeOffset,n,i),t.stream.initSegmentReference?(e=Rs(e,t,t.stream.initSegmentReference).then(function(e){if(!this.f)return Ar(this.a.I,t.type,e,null,null,t.stream.closedCaptions&&0<t.stream.closedCaptions.size)}.bind(e)).catch(function(e){return t.hc=!0,Promise.reject(e)}),Promise.all([r,e])):r):Promise.resolve()}(e,t,n,Math.max(0,a.startTime-.1),l?l.startTime+.01:o),t.Ha=!0,t.hc=!1,o=Rs(e,t,i),Promise.all([n,o]).then(function(e){if(!this.f&&!this.m)return function(e,t,r,n,i,a,s){var o=i.closedCaptions&&0<i.closedCaptions.size;return null!=i.emsgSchemeIdUris&&0<i.emsgSchemeIdUris.length&&(new zn).fa("emsg",e.M.bind(e,n,a,i.emsgSchemeIdUris)).parse(s),function(e,t,r){var n=Math.max(e.g.bufferBehind,e.c.presentationTimeline.a),i=xr(e.a.I,t.type);return null==i?Promise.resolve():0>=(r=r-i-n)?Promise.resolve():e.a.I.remove(t.type,i,i+r).then(function(){}.bind(e))}(e,t,r).then(function(){if(!this.f)return Ar(this.a.I,t.type,s,a.startTime+n.startTime,a.endTime+n.startTime,o)}.bind(e)).then(function(){if(!this.f)return t.pb=i,t.Aa=a,Promise.resolve()}.bind(e))}(this,t,r,a,s,i,e[1])}.bind(e)).then(function(){this.f||this.m||(t.Ha=!1,t.dd=!1,t.Ma||this.a.Zc(),Is(this,t,0),function(e,t){if(!e.s){var r=Array.from(e.b.values());if(1==r.length&&"text"==r[0].type||(e.s=r.every(function(e){return"text"==e.type||!e.Ma&&!e.Pa&&e.Aa})),e.s){for(r=Ds(e,t),e.h[r]||ws(e,r).then(function(){this.f||this.a.Kd()}.bind(e)).catch(Ht.ic),r=0;r<e.c.periods.length;++r)ws(e,r).catch(Ht.ic);e.a.sf&&e.a.sf()}}}(this,s))}.bind(e)).catch(function(e){this.f||this.m||(t.Ha=!1,"text"==t.type&&this.g.ignoreTextStreamFailures?this.b.delete("text"):7001==e.code?(t.Ha=!1,t.Da=null,Is(this,t,0)):3017==e.code?function(e,t,r){if(!Array.from(e.b.values()).some(function(e){return e!=t&&e.dd})){var n=Math.round(100*e.l);if(20<n)e.l-=.2;else{if(!(4<n))return t.Ib=!0,e.m=!0,void e.a.onError(r);e.l-=.04}t.dd=!0}Is(e,t,4)}(this,t,e):(t.Ib=!0,e.severity=2,Ps(this,e)))}.bind(e))}(e,t,r,i,a),null)}(e,t);null!=r&&(Is(e,t,r),t.Ib=!1)}catch(t){return void Ps(e,t)}r=Array.from(e.b.values()),function(e,t){var r=Ds(e,t.stream);if(t.pa!=r){var n=t.pa,i=Array.from(e.b.values());i.every(function(e){return e.pa==n||As(e)})&&i.every(Cs)&&ws(e,n).then(function(){if(!this.f&&i.every(function(e){var t=Cs(e),r=Ds(this,e.stream);return!!As(e)||t&&e.pa==n&&r!=n}.bind(this))){var e=this.c.periods[n],t=this.a.Ld(e),r=new Map;t.variant&&t.variant.video&&r.set("video",t.variant.video),t.variant&&t.variant.audio&&r.set("audio",t.variant.audio),t.text&&r.set("text",t.text);var a=d(this.b.keys());for(t=a.next();!t.done;t=a.next())if(t=t.value,!r.has(t)&&"text"!=t)return void this.a.onError(new fe(2,5,5005));for(t=(a=d(Array.from(r.keys()))).next();!t.done;t=a.next())if(t=t.value,!this.b.has(t)){if("text"!=t)return void this.a.onError(new fe(2,5,5005));ys(this,null,null,r.get("text"),e.startTime),r.delete(t)}for(t=(e=d(Array.from(this.b.keys()))).next();!t.done;t=e.next())t=t.value,(a=r.get(t))?(vs(this,a,!1,0,!1),Is(this,this.b.get(t),0)):this.b.delete(t);this.a.Kd()}}.bind(e)).catch(Ht.ic)}}(e,t),e.s&&r.every(function(e){return e.endOfStream})&&e.a.I.endOfStream().then(function(){if(!this.f){var e=this.a.I.Y();0!=e&&e<this.c.presentationTimeline.Y()&&this.c.presentationTimeline.wa(e)}}.bind(e))}}function xs(e,t,r){return t.pb&&t.Aa?(r=Ds(e,t.pb),e.c.periods[r].startTime+t.Aa.endTime):Math.max(r,t.Zd)}function Ts(e,t,r,n,i){if(t.Aa&&t.stream==t.pb)return ks(e,t,i,t.Aa.position+1);if(t.Aa?(r=Ds(e,t.pb),r=t.stream.findSegmentPosition(Math.max(0,e.c.periods[r].startTime+t.Aa.endTime-e.c.periods[i].startTime))):r=t.stream.findSegmentPosition(Math.max(0,(n||r)-e.c.periods[i].startTime)),null==r)return null;var a=null;return null==n&&(a=ks(e,t,i,Math.max(0,r-1))),a||ks(e,t,i,r)}function ks(e,t,r,n){return r=e.c.periods[r],(t=t.stream.getSegmentReference(n))?(e=(n=e.c.presentationTimeline).Hb(),n=n.nb(),r.startTime+t.endTime<e||r.startTime+t.startTime>n?null:t):null}function As(e){return"text"==e.type&&"application/cea-608"==e.stream.mimeType}function Cs(e){return!e.Ha&&null==e.Da&&!e.Ma&&!e.Pa}function js(e,t){var r=Ha(e.c.periods,t+qt);return r?e.c.periods.indexOf(r):0}function Ds(e,t){for(var r=e.c.periods,n=0;n<r.length;n++){for(var i=r[n],a=new Set,s=d(i.variants),o=s.next();!o.done;o=s.next())(o=o.value).audio&&a.add(o.audio),o.video&&a.add(o.video),o.video&&o.video.trickModeVideo&&a.add(o.video.trickModeVideo);for(s=(i=d(i.textStreams)).next();!s.done;s=i.next())a.add(s.value);if(a.has(t))return n}return-1}function Rs(e,t,r){return r=Ai(r.c(),r.b,r.a,e.g.retryParameters),e=e.a.rb.request(1,r),t.Kb=e,e.promise.then(function(e){return t.Kb=null,e.data})}function Ls(e,t,r,n){return f(function i(){var a,s,o;return O(i,function(i){switch(i.j){case 1:return t.Ma=!1,t.uc=!1,t.Zb=0,t.Pa=!0,n?(s=e.a.Sa(),o=e.a.I.Y(),a=e.a.I.remove(t.type,s+n,o)):a=Cr(e.a.I,t.type).then(function(){if(!this.f&&r)return this.a.I.flush(t.type)}.bind(e)),S(i,a,2);case 2:if(e.f)return i.return();t.pb=null,t.Aa=null,t.Pa=!1,t.endOfStream=!1,Is(e,t,0),E(i)}})})}function Is(e,t,r){t.Da=new ue(function(){return f(function r(){var n;return O(r,function(r){switch(r.j){case 1:return x(r,2),S(r,Es(e,t),4);case 4:k(r,0);break;case 2:n=A(r),e.a&&e.a.onError(n),E(r)}})})}).O(r)}function Os(e){null!=e.Da&&(e.Da.stop(),e.Da=null)}function Ps(e,t){he(e.G).then(function(){this.f||(this.a.onError(t),t.handled||this.g.failureCallback(t))}.bind(e))}function Ms(e,t,r,n,i,a){if(200<=r&&299>=r&&202!=r)return{uri:i||n,ad:n,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};i=null;try{i=st(t)}catch(e){}throw new fe(401==r||403==r?2:1,1,1001,n,r,i,e,a)}function Ns(e,t,r,n){var i=new Ns.b;Xe(t.headers).forEach(function(e,t){i.append(t,e)});var a=new Ns.a,s={vd:!1,ge:!1};if(e=new ge(e=Ns.l(e,r,{body:t.body||void 0,headers:i,method:t.method,signal:a.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},s,n),function(){return s.vd=!0,a.abort(),Promise.resolve()}),t=t.retryParameters.timeout){var o=new ce(function(){s.ge=!0,a.abort()});o.O(t/1e3),e.finally(function(){o.stop()})}return e}function Fs(e,t,r,n){var i=new Fs.f,a=Date.now(),s=0;return new ge(new Promise(function(o,l){for(var u in i.open(t.method,e,!0),i.responseType="arraybuffer",i.timeout=t.retryParameters.timeout,i.withCredentials=t.allowCrossSiteCredentials,i.onabort=function(){l(new fe(1,1,7001,e,r))},i.onload=function(t){for(var n=(t=t.target).getAllResponseHeaders().trim().split("\r\n"),i={},a=(n=d(n)).next();!a.done;a=n.next())i[(a=a.value.split(": "))[0].toLowerCase()]=a.slice(1).join(": ");try{var s=Ms(i,t.response,t.status,e,t.responseURL,r);o(s)}catch(e){l(e)}},i.onerror=function(t){l(new fe(1,1,1002,e,t,r))},i.ontimeout=function(){l(new fe(1,1,1003,e,r))},i.onprogress=function(e){var t=Date.now();(100<t-a||e.lengthComputable&&e.loaded==e.total)&&(n(t-a,e.loaded-s,e.total-e.loaded),s=e.loaded,a=t)},t.headers)i.setRequestHeader(u.toLowerCase(),t.headers[u]);i.send(t.body)}),function(){return i.abort(),Promise.resolve()})}function Bs(){this.a=this.f=this.b=0,this.c=new Map,this.g=0}function Us(e,t){this.g=e,this.b=new Map,this.c=!1,this.f=t,this.a=new Bs}function Gs(e,t,r,n,i){var a=function(e,t){e.b+=t;var r=e.g;return e.g++,e.c.set(r,t),r}(e.a,n);n=e.b.get(t)||Promise.resolve(),e.b.set(t,n.then(function(){return f(function t(){var n;return O(t,function(t){switch(t.j){case 1:return S(t,function(e,t){return f(function r(){var n;return O(r,function(r){switch(r.j){case 1:return S(r,e.g.request(1,t).promise,2);case 2:return n=r.o,r.return(n.data)}})})}(e,r),2);case 2:if(n=t.o,e.c)throw new fe(2,9,7001);e.a.close(a,n.byteLength);var s=e.a;return e.f(0==s.b?0:s.f/s.b,e.a.a),t.return(i(n))}})})}))}function zs(e,t){var r=this;this.c=e,this.b=e.objectStore(t),this.a=new pe,e.onabort=function(e){e.preventDefault(),r.a.reject()},e.onerror=function(e){e.preventDefault(),r.a.reject()},e.oncomplete=function(){r.a.resolve()}}function Hs(e,t){return new Promise(function(r,n){var i=e.b.openCursor();i.onerror=n,i.onsuccess=function(e){if(!(e=e.target.result))return r();t(e.key,e.value,e),e.continue()}})}function Vs(e){this.b=e,this.a=[]}function Ks(e,t){return qs(e,t,"readonly")}function Ws(e,t){return qs(e,t,"readwrite")}function qs(e,t,r){var n=new zs(r=e.b.transaction([t],r),t);return e.a.push(n),n.promise().then(function(){Ae(e.a,n)},function(){Ae(e.a,n)}),n}function Xs(e){this.a=new Vs(e)}function Ys(){this.a=new Map}function $s(e,t,r){if(!(e=e.a.get(t)))throw new fe(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(r)))throw new fe(2,9,9013,"Could not find cell with name "+r);return t}function Js(e,t){Qs.set(e,t)}cs.prototype.destroy=function(){for(var e=d(this.b.values()),t=e.next();!t.done;t=e.next())Os(t.value);return this.b.clear(),this.i.clear(),this.g=this.h=this.v=this.c=this.a=null,this.f=!0,Promise.resolve()},cs.prototype.configure=function(e){this.g=e,this.G=new de({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0},!0)},cs.prototype.start=function(){var e=this;return f(function t(){var r,n,i;return O(t,function(t){switch(t.j){case 1:return r=e.a.Sa(),n=js(e,r),(i=e.a.Ld(e.c.periods[n])).variant||i.text?S(t,ys(e,i.variant?i.variant.audio:null,i.variant?i.variant.video:null,i.text,r),2):t.return(new fe(2,5,5005));case 2:if(e.f)return t.return();e.a&&e.a.gf&&e.a.gf(),E(t)}})})},cs.prototype.M=function(e,t,r,n){var i=n.reader.bd(),a=n.reader.bd(),s=n.reader.F(),o=n.reader.F(),l=n.reader.F(),u=n.reader.F();n=n.reader.Xa(n.reader.K.byteLength-n.reader.ba()),e=e.startTime+t.startTime+o/s,r.includes(i)&&("urn:mpeg:dash:event:2012"==i?this.a.hf():this.a.onEvent(new Se("emsg",{detail:{startTime:e,endTime:e+l/s,schemeIdUri:i,value:a,timescale:s,presentationTimeDelta:o,eventDuration:l,id:u,messageData:n}})))},U("shaka.net.HttpFetchPlugin",Ns),Ns.l=function(e,t,r,n,i){return f(function a(){var s,o,l,u,c,d,h,p,g,m,v,_;return O(a,function(a){switch(a.j){case 1:return s=Ns.g,o=Ns.c,d=c=0,h=Date.now(),x(a,2),S(a,s(e,r),4);case 4:return l=a.o,p=l.clone().body.getReader(),m=(g=l.headers.get("Content-Length"))?parseInt(g,10):0,new o({start:function(e){!function t(){return f(function r(){var n,a;return O(r,function(r){switch(r.j){case 1:return x(r,2),S(r,p.read(),4);case 4:n=r.o,k(r,3);break;case 2:return A(r),r.return();case 3:n.done||(c+=n.value.byteLength),(100<(a=Date.now())-h||n.done)&&(i(a-h,c-d,m-c),d=c,h=a),n.done?e.close():(e.enqueue(n.value),t()),E(r)}})})}()}}),S(a,l.arrayBuffer(),5);case 5:u=a.o,k(a,3);break;case 2:if(v=A(a),n.vd)throw new fe(1,1,7001,e,t);if(n.ge)throw new fe(1,1,1003,e,t);throw new fe(1,1,1002,e,v,t);case 3:return _={},l.headers.forEach(function(e,t){_[t.trim()]=e}),a.return(Ms(_,u,l.status,e,l.url,t))}})})},Ns.isSupported=function(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!e.fetch||!e.AbortController)},Ns.isSupported=Ns.isSupported,Ns.g=e.fetch,Ns.a=e.AbortController,Ns.c=e.ReadableStream,Ns.b=e.Headers,Ns.isSupported()&&(Oe("http",Ns,2),Oe("https",Ns,2)),U("shaka.net.HttpXHRPlugin",Fs),Fs.f=e.XMLHttpRequest,Oe("http",Fs,1),Oe("https",Fs,1),Bs.prototype.close=function(e,t){if(this.c.has(e)){var r=this.c.get(e);this.c.delete(e),this.f+=r,this.a+=t}},Us.prototype.destroy=function(){return this.c=!0,Promise.all(this.b.values()).then(function(){},function(){})},zs.prototype.abort=function(){try{this.c.abort()}catch(e){}return this.a.catch(function(){})},zs.prototype.store=function(){return this.b},zs.prototype.promise=function(){return this.a},Vs.prototype.destroy=function(){return Promise.all(this.a.map(function(e){return e.abort()}))},Xs.prototype.destroy=function(){return this.a.destroy()},Xs.prototype.getAll=function(){var e=this;return f(function t(){var r,n;return O(t,function(t){switch(t.j){case 1:return r=Ks(e.a,"session-ids"),n=[],S(t,Hs(r,function(e,t){n.push(t)}),2);case 2:return S(t,r.promise(),3);case 3:return t.return(n)}})})},Xs.prototype.add=function(e){for(var t=Ws(this.a,"session-ids"),r=t.store(),n=(e=d(e)).next();!n.done;n=e.next())r.add(n.value);return t.promise()},Xs.prototype.remove=function(e){var t=this;return f(function r(){var n;return O(r,function(r){switch(r.j){case 1:return S(r,Hs(n=Ws(t.a,"session-ids"),function(t,r,n){0<=e.indexOf(r.sessionId)&&n.delete()}),2);case 2:return S(r,n.promise(),0)}})})},Ys.prototype.destroy=function(){for(var e=[],t=d(this.a.values()),r=t.next();!r.done;r=t.next())e.push(r.value.destroy());return this.a.clear(),Promise.all(e)},Ys.prototype.init=function(){var e=this;Qs.forEach(function(t,r){var n=t();n&&e.a.set(r,n)});for(var t=[],r=d(this.a.values()),n=r.next();!n.done;n=r.next())t.push(n.value.init());return Promise.all(t)},Ys.prototype.erase=function(){var e=this;return f(function t(){var r,n;return O(t,function(t){switch(t.j){case 1:return r=Array.from(e.a.values()),(n=0<r.length)||Qs.forEach(function(e){(e=e())&&r.push(e)}),S(t,Promise.all(r.map(function(e){return e.erase()})),2);case 2:if(!n)return S(t,Promise.all(r.map(function(e){return e.destroy()})),0);t.A(0)}})})},U("shaka.offline.StorageMuxer.register",Js),U("shaka.offline.StorageMuxer.unregister",function(e){Qs.delete(e)});var Qs=new Map;function Zs(e){this.a=new Vs(e)}function eo(e){return Promise.reject(new fe(2,9,9011,"Cannot add new value to "+e))}function to(e,t,r,n){var i=(e=Ws(e.a,t)).store();return r.forEach(function(e){i.delete(e).onsuccess=function(){return n(e)}}),e.promise()}function ro(e,t,r){var n=(e=Ks(e.a,t)).store(),i={},a=[];return r.forEach(function(e){n.get(e).onsuccess=function(t){null==(t=t.target.result)&&a.push(e),i[e]=t}}),e.promise().then(function(){return a.length?Promise.reject(new fe(2,9,9012,"Could not find values for "+a)):r.map(function(e){return i[e]})})}function no(e){return{originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,periods:e.periods.map(io),sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata}}function io(e){return function(e){var t=e.streams.filter(function(e){return"audio"==e.contentType}),r=e.streams.filter(function(e){return"video"==e.contentType});if(!t.every(function(e){return e.variantIds})||!r.every(function(e){return e.variantIds})){t.forEach(function(e){e.variantIds=[]}),r.forEach(function(e){e.variantIds=[]});var n=0;if(r.length&&!t.length){var i=n++;r.forEach(function(e){e.variantIds.push(i)})}if(!r.length&&t.length){var a=n++;t.forEach(function(e){e.variantIds.push(a)})}r.length&&t.length&&t.forEach(function(e){r.forEach(function(t){var r=n++;e.variantIds.push(r),t.variantIds.push(r)})})}}(e),e.streams.forEach(function(){}),{startTime:e.startTime,streams:e.streams.map(ao)}}function ao(e){var t=e.$e?lo(e.$e):null;return{id:e.id,originalId:null,primary:e.primary,presentationTimeOffset:e.presentationTimeOffset,contentType:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:t,encrypted:e.encrypted,keyId:e.keyId,segments:e.segments.map(so),variantIds:e.variantIds}}function so(e){var t=lo(e.uri);return{startTime:e.startTime,endTime:e.endTime,dataKey:t}}function oo(e){return{data:e.data}}function lo(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new fe(2,9,9004,"Could not parse uri "+e)}function uo(e,t,r,n){this.a=new Vs(e),this.c=t,this.b=r,this.f=n}function co(e,t,r){if(e.f)return Promise.reject(new fe(1,9,9011,"Cannot add new value to "+t));var n=(e=Ws(e.a,t)).store(),i=[];return r.forEach(function(e){n.add(e).onsuccess=function(e){i.push(e.target.result)}}),e.promise().then(function(){return i})}function ho(e,t,r,n){var i=(e=Ws(e.a,t)).store();return r.forEach(function(e){i.delete(e).onsuccess=function(){return n(e)}}),e.promise()}function fo(e,t,r){var n=(e=Ks(e.a,t)).store(),i={},a=[];return r.forEach(function(e){var t=n.get(e);t.onsuccess=function(){null==t.result&&a.push(e),i[e]=t.result}}),e.promise().then(function(){return a.length?Promise.reject(new fe(1,9,9012,"Could not find values for "+a)):r.map(function(e){return i[e]})})}function po(){this.g=this.c=this.b=this.a=this.f=null}function go(e,t,r,n){this.a=e,this.g=t,this.f=r,this.c=n,this.b=["offline:",e,"/",t,"/",r,"/",n].join("")}function mo(e){if(null==(e=/^offline:([a-z]+)\/([^\/]+)\/([^\/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var r=e[2];if(!r)return null;var n=e[3];return n&&null!=t?new go(t,r,n,Number(e[4])):null}function vo(e,t){this.b=e,this.a=t}function _o(e,t,r){var n=t.streams.filter(function(e){return"audio"==e.contentType}),i=t.streams.filter(function(e){return"video"==e.contentType});return n=function(e,t,r){for(var n=new Set,i=d(t),a=i.next();!a.done;a=i.next()){var s=d(a.value.variantIds);for(a=s.next();!a.done;a=s.next())n.add(a.value)}for(i=d(r),a=i.next();!a.done;a=i.next())for(s=d(a.value.variantIds),a=s.next();!a.done;a=s.next())n.add(a.value);for(i=new Map,n=d(n),a=n.next();!a.done;a=n.next())a=a.value,i.set(a,{id:a,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});for(t=d(t),n=t.next();!n.done;n=t.next())for(n=n.value,a=yo(e,n),s=d(n.variantIds),n=s.next();!n.done;n=s.next())(n=i.get(n.value)).language=a.language,n.primary=n.primary||a.primary,n.audio=a;for(r=d(r),t=r.next();!t.done;t=r.next())for(n=t.value,t=yo(e,n),a=d(n.variantIds),n=a.next();!n.done;n=a.next())(n=i.get(n.value)).primary=n.primary||t.primary,n.video=t;return i}(e,n,i),i=t.streams.filter(function(e){return"text"==e.contentType}).map(function(t){return yo(e,t)}),t.streams.forEach(function(n){n=n.segments.map(function(t,r){return bo(e,r,t)}),r.sb(n,t.startTime)}),{startTime:t.startTime,variants:Array.from(n.values()),textStreams:i}}function yo(e,t){var r=t.segments.map(function(t,r){return bo(e,r,t)}),n=new ui(r);return r={id:t.id,originalId:t.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return n.find(e)},getSegmentReference:function(e){return n.get(e)},initSegmentReference:null,presentationTimeOffset:t.presentationTimeOffset,mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate||void 0,kind:t.kind,encrypted:t.encrypted,keyId:t.keyId,language:t.language,label:t.label||null,type:t.contentType,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},null!=t.initSegmentKey&&(r.initSegmentReference=function(e,t){var r=new go("segment",e.b,e.a,t);return new si(function(){return[r.toString()]},0,null)}(e,t.initSegmentKey)),r}function bo(e,t,r){var n=new go("segment",e.b,e.a,r.dataKey);return new oi(t,r.startTime,r.endTime,function(){return[n.toString()]},0,null)}function wo(){this.a=null}function So(e){var t=mo(e);return t&&"manifest"==t.a?So.h(e):t&&"segment"==t.a?So.i(t.key(),t):me(new fe(2,1,9004,e))}function Eo(e,t,r){return f(function n(){var i,a,s,o,l,u;return O(n,function(n){switch(n.j){case 1:i=[];for(var c=[],h=d(r),p=h.next();!p.done;p=h.next()){p=p.value;for(var g=!1,m=d(c),v=m.next();!v.done;v=m.next())if(xo((v=v.value).info,p)){v.sessionIds.push(p.sessionId),g=!0;break}g||c.push({info:p,sessionIds:[p.sessionId]})}a=d(c),s=a.next();case 2:if(s.done){n.A(4);break}return o=s.value,l=function(e,t,r){return f(function n(){var i,a;return O(n,function(n){switch(n.j){case 1:return i=new vt({rb:t,onError:function(){},kc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),x(n,2),i.configure(e),S(n,function(e,t,r,n,i,a){var s=new Map;return s.set(t,{audioCapabilities:i,videoCapabilities:a,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t,drmInfos:[{keySystem:t,licenseServerUri:r,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:n,initData:null,keyIds:null}]}),Tt(e,s)}(i,r.info.keySystem,r.info.licenseUri,r.info.serverCertificate,r.info.audioCapabilities,r.info.videoCapabilities),4);case 4:k(n,3);break;case 2:return A(n),S(n,i.destroy(),5);case 5:return n.return([]);case 3:return x(n,6),S(n,bt(i),8);case 8:k(n,7);break;case 6:return A(n),S(n,i.destroy(),9);case 9:return n.return([]);case 7:return a=[],S(n,Promise.all(r.sessionIds.map(function(e){return f(function t(){return O(t,function(t){switch(t.j){case 1:return x(t,2),S(t,function(e,t){return f(function r(){var n,i,a;return O(r,function(r){switch(r.j){case 1:return S(r,kt(e,t),2);case 2:return(n=r.o)?(i=[],(a=e.b.get(n))&&(a.xa=new pe,i.push(a.xa)),i.push(n.remove()),S(r,Promise.all(i),0)):r.return()}})})}(i,e),4);case 4:a.push(e),k(t,0);break;case 2:A(t),E(t)}})})})),10);case 10:return S(n,i.destroy(),11);case 11:return n.return(a)}})})}(e,t,o),S(n,l,5);case 5:u=n.o,i=i.concat(u),s=a.next(),n.A(2);break;case 4:return n.return(i)}})})}function xo(e,t){function r(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&Ce(e.audioCapabilities,t.audioCapabilities,r)&&Ce(e.videoCapabilities,t.videoCapabilities,r)}function To(e,t){var r={ya:null,u:null,mimeType:null,startTime:null,od:null,uri:null},n=this;this.g=t,this.c=e,this.i=r,this.h=null,this.f=[],this.b=this.a=null,this.l=!0,this.m=Promise.resolve().then(function(){return function(e){return f(function t(){return O(t,function(t){switch(t.j){case 1:if(e.l){if(0==e.f.length||e.a&&!e.a.Ta)var r=!1;else{e.a&&(e.a.ta.Wa(),e.a=null);var n=(r=e.f.shift()).create(e.i);n?(r.ta.tb(),e.a={node:n.node,payload:n.payload,Ta:n.Ta,ta:r.ta}):r.ta.lc(),r=!0}return r?r=Promise.resolve():e.a?r=function(e){return f(function t(){var r,n;return O(t,function(t){switch(t.j){case 1:return e.c=e.g.Pe(e.c,e.i,e.a.node,e.a.payload),x(t,2),e.b=e.g.ze(e.c,e.i,e.a.payload),S(t,e.b.promise,4);case 4:e.b=null,e.c==e.a.node&&(e.a.ta.jc(),e.a=null),k(t,0);break;case 2:return 7001==(r=A(t)).code?e.a.ta.Wa():e.a.ta.onError(r),e.a=null,e.b=null,n=e,S(t,e.g.handleError(e.i,r),5);case 5:n.c=t.o,E(t)}})})}(e):(e.g.ff(e.c),e.h=new pe,r=e.h),S(t,r,1)}t.A(0)}})})}(n)})}function ko(e,t){var r={tb:function(){},jc:function(){},Wa:function(){},onError:function(){},lc:function(){},sg:function(){}};return e.f.push({create:t,ta:r}),e.b&&e.b.abort(),Ao(e),r}function Ao(e){e.h&&(e.h.resolve(),e.h=null)}function Co(e){this.a=null;for(var t=0;t<e.textTracks.length;++t){var r=e.textTracks[t];r.mode="disabled","Shaka Player TextTrack"==r.label&&(this.a=r)}this.a||(this.a=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.a.mode="hidden"}function jo(e){if(e.startTime>=e.endTime)return null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,t.size=e.size;try{t.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function Do(e,t){var r=e.mode;e.mode="showing"==r?"showing":"hidden";for(var n=e.cues,i=n.length-1;0<=i;i--){var a=n[i];a&&t(a)&&e.removeCue(a)}e.mode=r}function Ro(e,t,r,n,i){var a,s=i in n,o=!0;for(a in t){var l=i+"."+a,u=s?n[i]:r[a];s||a in r?void 0===t[a]?void 0===u||s?delete e[a]:e[a]=Te(u):u.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=Te(u)),l=Ro(e[a],t[a],u,n,l),o=o&&l):typeof t[a]!=typeof u||null==t[a]||t[a].constructor!=u.constructor?o=!1:e[a]=t[a]:o=!1}return o}function Lo(e,t){for(var r={},n=r,i=0,a=0;!(0>(i=e.indexOf(".",i)));)0!=i&&"\\"==e[i-1]||(n[a=e.substring(a,i).replace(/\\\./g,".")]={},n=n[a],a=i+1),i+=1;return n[e.substring(a).replace(/\\\./g,".")]=t,r}function Io(){}function Oo(){var e=5e5,t=1/0;navigator.connection&&(e=1e6*navigator.connection.downlink,navigator.connection.saveData&&(t=360));var r={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:function(e){return e},fairPlayTransform:!0},n={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},availabilityWindowOverride:NaN,dash:{customScheme:function(e){if(e)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0},hls:{ignoreTextStreamFailures:!1}},i={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},failureCallback:function(){},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1};tt("Web0S")&&(i.stallEnabled=!1);var a={trackSelectionCallback:function(e){return e},progressCallback:function(){},usePersistentLicense:!0},s={drm:r,manifest:n,streaming:i,offline:a,abrFactory:Qr,abr:{enabled:!0,defaultBandwidthEstimate:e,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return a.trackSelectionCallback=function(e){return function(e,t){var r=e.filter(function(e){return"variant"==e.type}),n=[],i=Mr(t,r.map(function(e){return e.language}));i&&(n=r.filter(function(e){return Or(e.language)==i})),0==n.length&&(n=r.filter(function(e){return e.primary})),0==n.length&&(r.map(function(e){return e.language}),n=r);var a=n.filter(function(e){return e.height&&480>=e.height});if(a.length&&(a.sort(function(e,t){return t.height-e.height}),n=a.filter(function(e){return e.height==a[0].height})),r=[],n.length){var s=Math.floor(n.length/2);n.sort(function(e,t){return e.bandwidth-t.bandwidth}),r.push(n[s])}for(n=d(e),s=n.next();!s.done;s=n.next())"text"==(s=s.value).type&&r.push(s);return r}(e,s.preferredAudioLanguage)},s}function Po(e,t,r){var n={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Ro(e,t,r||Oo(),n,"")}function Mo(){this.a=null,this.b=[]}function No(e,t){if(null==e.a)e.a={timestamp:Date.now()/1e3,state:t,duration:0};else{var r=Date.now()/1e3;e.a.duration=r-e.a.timestamp,e.a.state!=t&&(e.b.push(e.a),e.a={timestamp:r,state:t,duration:0})}}function Fo(e,t){var r=0;e.a&&e.a.state==t&&(r+=e.a.duration);for(var n=d(e.b),i=n.next();!i.done;i=n.next())r+=(i=i.value).state==t?i.duration:0;return r}function Bo(){this.b=this.c=null,this.a=[]}function Uo(){this.f=this.l=this.b=this.h=this.i=this.g=this.m=NaN,this.a=new Mo,this.c=new Bo}function Go(t,r){var n=this;xe.call(this),this.h=xl,this.a=null,this.eb=!1,this.i=new ze,this.vc=this.l=this.Bb=this.c=this.m=this.f=this.Sb=this.P=this.Tb=this.W=this.gb=this.s=this.D=this.g=this.G=null,this.Hd=1e9,this.Wb=new Set,this.ib=!0,this.Ea=null,this.Dd=!1,this.Bd=0,this.na=null,this.$=new Sa,this.b=$o(this),this.Xb={width:1/0,height:1/0},this.v=null,this.Ub=new Ra(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount),this.ma=this.b.preferredTextLanguage,this.cb=this.b.preferredTextRole,r&&r(this),this.G=function(e){return new Re(function(t,r){e.l&&e.l.segmentDownloaded(t,r)})}(this),this.i.w(e,"online",function(){n.gd()}),this.C={name:"detach"},this.M={name:"attach"},this.Fa={name:"unload"},this.Ec={name:"manifest-parser"},this.Cc={name:"manifest"},this.fb={name:"media-source"},this.wc={name:"drm-engine"},this.T={name:"load"},this.Ic={name:"src-equals-drm-engine"},this.hb={name:"src-equals"};var i=new Map;i.set(this.M,function(e,t){return ye(function(e,t,r){return null==t.u&&(t.u=r.u,e.i.w(t.u,"error",function(){var t=dl(e);t&&e.Ka(t)})),e.a=t.u,Promise.resolve()}(n,e,t))}),i.set(this.C,function(e){return e.u&&(n.i.ea(e.u,"error"),e.u=null),n.a=null,ye(e=Promise.resolve())}),i.set(this.Fa,function(e){return ye(Ko(n,e))}),i.set(this.fb,function(t){return ye(t=function(t,r){return f(function n(){var i,a,s,o;return O(n,function(n){switch(n.j){case 1:return i=e.muxjs?new Nt:new Ft,a=t.b.textDisplayFactory,s=new a,t.xc=a,S(n,(o=new yr(r.u,i,s)).s,2);case 2:t.D=o,E(n)}})})}(n,t))}),i.set(this.Ec,function(e,t){return ye(function(e,t,r){return f(function n(){var i,a,s;return O(n,function(n){switch(n.j){case 1:if(t.ya=r.ya,t.mimeType=r.mimeType,t.uri=r.uri,i=t.uri,a=e.G,e.Bb=i,t.ya){e.m=t.ya(),n.A(2);break}return s=e,S(n,Ti.create(i,a,e.b.manifest.retryParameters,t.mimeType),3);case 3:s.m=n.o;case 2:e.m.configure(e.b.manifest),E(n)}})})}(n,e,t))}),i.set(this.Cc,function(e){return function(e,t){var r=t.uri,n=e.G;e.Sb=new as,function(e,t){e.b=t}(e.Sb,function(t){cl(e,"timelineregionadded",t)});var i={networkingEngine:n,filterNewPeriod:function(t){return e.Fc(t)},filterAllPeriods:function(t){return Jo(e,t)},onTimelineRegionAdded:function(t){var r=e.Sb;e:{for(var n=d(r.a),i=n.next();!i.done;i=n.next())if((i=i.value).schemeIdUri==t.schemeIdUri&&i.startTime==t.startTime&&i.endTime==t.endTime){n=i;break e}n=null}null==n&&(r.a.add(t),r.b(t))},onEvent:function(t){return e.dispatchEvent(t)},onError:function(t){return e.Ka(t)}};return new ge(Promise.resolve().then(function(){return f(function t(){var n;return O(t,function(t){switch(t.j){case 1:return n=e,S(t,e.m.start(r,i),2);case 2:if(n.c=t.o,e.dispatchEvent(new Se("manifestparsed")),0==e.c.periods.length)throw new fe(2,4,4014);!function(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.some(function(e){return e.variants.some(t)})&&e.forEach(function(e){e.variants=e.variants.filter(t)})}(e.c.periods),E(t)}})})}),function(){return e.m.stop()})}(n,e)}),i.set(this.wc,function(){return ye(function(e){return f(function t(){return O(t,function(t){switch(t.j){case 1:return e.g=new vt({rb:e.G,onError:function(t){e.Ka(t)},kc:function(t){hl(e,t)},onExpirationUpdated:function(t,r){fl(e,t,r)},onEvent:function(t){e.dispatchEvent(t)}}),e.g.configure(e.b.drm),S(t,_t(e.g,za(e.c.periods),e.c.offlineSessionIds),2);case 2:Jo(e,e.c.periods),E(t)}})})}(n))}),i.set(this.T,function(e,t){return ye(function(e,t,r){return f(function n(){var i,a,s,o,l,u,c,h,f;return O(n,function(n){switch(n.j){case 1:return t.startTime=r.startTime,i=t.u,a=t.uri,e.Bb=a,e.v=new Uo,s=function(){return tl(e)},o=function(){var t=e.a.playbackRate;0!=t&&e.W.set(t)},e.i.w(i,"playing",s),e.i.w(i,"pause",s),e.i.w(i,"ended",s),e.i.w(i,"ratechange",o),l=e.b.abrFactory,e.l&&e.vc==l||(e.vc=l,e.l=new l,e.l.configure(e.b.abr)),function(e,t){for(var r=0;r<t.length;r++){for(var n=t[r],i=new Map,a=d(n.variants),s=a.next();!s.done;s=a.next())if((s=s.value).video&&s.video.closedCaptions)for(var o=d((s=s.video).closedCaptions.keys()),l=o.next();!l.done;l=o.next())if(l=l.value,!i.has(l)){var u={id:e.Hd++,originalId:l,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",codecs:"",kind:"caption",encrypted:!1,keyId:null,language:s.closedCaptions.get(l),label:null,type:"text",primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:s.roles,channelsCount:null,closedCaptions:null};i.set(l,u)}for(i=d(i.values()),a=i.next();!a.done;a=i.next())n.textStreams.push(a.value)}}(e,e.c.periods),e.Ub=new Ra(e.b.preferredAudioLanguage,e.b.preferredVariantRole,e.b.preferredAudioChannelCount),e.ma=e.b.preferredTextLanguage,function(e,t,r){0<t&&(e.V()||e.de(t)),r<e.Y()&&(e.V()||e.wa(r))}(e.c.presentationTimeline,e.b.playRangeStart,e.b.playRangeEnd),S(n,e.g.Cb(i),2);case 2:return e.l.init(function(t,r,n){r=void 0!==r&&r,n=void 0===n?0:n;e:{for(var i=d(e.c.periods),a=i.next();!a.done;a=i.next())if((a=a.value).variants.includes(t)){i=a;break e}i=null}Xo(e,i,t,!0),e.f&&(ms(e.f,t,r,n),il(e))}),e.s=function(e,t){return new ts(e.a,e.c,e.b.streaming,t,function(){e.gb&&Ga(e.gb,!0),e.f&&function(e){function t(t){var i=e.a.I;return"text"==t?t=null!=(t=i.a).a&&null!=t.b&&(r>=t.a&&r<t.b):t=Ut(t=kr(i,t),r,n),t}var r=e.a.Sa(),n=e.g.smallGapLimit,i=js(e,r);if(qe(e.b.values(),function(e){return e.pa==i}))for(var a=d(e.b.keys()),s=a.next();!s.done;s=a.next())t(s=s.value)||_s(e,e.b.get(s));else qe(e.b.keys(),t)||e.b.forEach(function(t){_s(e,t)})}(e.f)},function(t){return e.dispatchEvent(t)})}(e,t.startTime),e.gb=function(e){var t=new Va(e.c);!function(e,t){e.b=t}(t,function(){al(e)});var r=new ss(e.Sb);!function(e,t,r,n){e.a=t,e.b=r,e.c=n}(r,function(t){cl(e,"timelineregionenter",t)},function(t){cl(e,"timelineregionexit",t)},function(t,r){r||(cl(e,"timelineregionenter",t),cl(e,"timelineregionexit",t))});var n=new Ua(e.a);return n.a.add(t),n.a.add(r),n}(e),e.W=new Ka({ec:function(){return t.u.playbackRate},ld:function(e){t.u.playbackRate=e},Id:function(e){t.u.currentTime+=e}}),u=Math.max(e.c.minBufferTime,e.b.streaming.rebufferingGoal),Wo(e,u),e.f=function(e){return new cs(e.c,{Sa:function(){return e.s.h()},getBandwidthEstimate:function(){return e.l.getBandwidthEstimate()},I:e.D,rb:e.G,Ld:e.df.bind(e),Kd:e.te.bind(e),onError:e.Ka.bind(e),onEvent:function(t){return e.dispatchEvent(t)},hf:e.jf.bind(e),Zc:e.qf.bind(e)})}(e),e.f.configure(e.b.streaming),function(e){function t(e){var t="";e.video&&(t=Je(e.video.codecs)[0]);var r="";return e.audio&&(r=Je(e.audio.codecs)[0]),t+"-"+r}var r=e.c.periods.reduce(function(e,t){return e.concat(t.variants)},[]);r=Xr(r,e.b.preferredAudioChannelCount);var n=new Ee;r.forEach(function(e){var r=t(e);n.push(r,e)});var i=null,a=1/0;n.forEach(function(e,t){var r=0,n=0;t.forEach(function(e){r+=e.bandwidth||0,++n});var s=r/n;s<a&&(i=e,a=s)}),e.c.periods.forEach(function(e){e.variants=e.variants.filter(function(e){return t(e)==i})})}(e),e.h=Tl,e.dispatchEvent(new Se("streaming")),S(n,e.f.start(),3);case 3:e.b.streaming.startAtSegmentBoundary&&(c=e.s.h(),h=function(e,t){function r(e,t){if(!e)return null;var r=e.findSegmentPosition(t-a.startTime);return null==r?null:(r=e.getSegmentReference(r))?r.startTime+a.startTime:null}var n=ds(e.f),i=hs(e.f),a=_l(e);return n=r(n,t),null!=(i=r(i,t))&&null!=n?Math.max(i,n):null!=i?i:null!=n?n:t}(e,c),e.s.m(h)),e.c.periods.forEach(e.Fc.bind(e)),al(e),il(e),(f=_l(e)||e.c.periods[0]).variants.some(function(e){return e.primary}),rl(e,f.variants),e.i.da(i,"loadeddata",function(){e.v.b=Date.now()/1e3-r.od}),E(n)}})})}(n,e,t))}),i.set(this.Ic,function(e){return ye(e=function(e,t){return f(function r(){var n,i;return O(r,function(r){switch(r.j){case 1:return n=Wt,e.g=new vt({rb:e.G,onError:function(t){e.Ka(t)},kc:function(t){hl(e,t)},onExpirationUpdated:function(t,r){fl(e,t,r)},onEvent:function(t){e.dispatchEvent(t)}}),e.g.configure(e.b.drm),i={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:n.Na,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},S(r,_t(e.g,[i],[]),2);case 2:return S(r,e.g.Cb(t.u),0)}})})}(n,e))}),i.set(this.hb,function(e,t){return function(e,t,r){function n(){return tl(e)}if(t.uri=r.uri,t.startTime=r.startTime,e.Bb=t.uri,e.v=new Uo,e.s=new es(t.u),null!=t.startTime&&e.s.m(t.startTime),e.W=new Ka({ec:function(){return t.u.playbackRate},ld:function(e){t.u.playbackRate=e},Id:function(e){t.u.currentTime+=e}}),Wo(e,e.b.streaming.rebufferingGoal),e.i.w(t.u,"playing",n),e.i.w(t.u,"pause",n),e.i.w(t.u,"ended",n),e.i.da(t.u,"loadeddata",function(){e.v.b=Date.now()/1e3-r.od}),e.a.audioTracks&&(e.i.w(e.a.audioTracks,"addtrack",function(){return al(e)}),e.i.w(e.a.audioTracks,"removetrack",function(){return al(e)})),e.a.textTracks){var i=e.a.textTracks;e.i.w(i,"addtrack",function(){return al(e)}),e.i.w(i,"removetrack",function(){return al(e)})}t.u.src=t.uri,e.h=kl,e.dispatchEvent(new Se("streaming"));var a=new pe;return e.a.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?a.resolve():e.a.error?a.reject(dl(e)):(e.i.da(e.a,"loadeddata",function(){a.resolve()}),e.i.da(e.a,"error",function(){a.reject(dl(e))})),new ge(a,function(){return a.reject(new fe(2,7,7001)),Promise.resolve()})}(n,e,t)}),this.jb=new To(this.C,{Pe:function(e,t,r,i){var a=null;return e==n.C&&(a=r==n.C?n.C:n.M),e==n.M&&(a=r==n.C||t.u!=i.u?n.C:r==n.M?n.M:r==n.fb||r==n.T?n.fb:r==n.hb?n.Ic:null),e==n.fb&&(a=r==n.T&&t.u==i.u?n.Ec:n.Fa),e==n.Ec&&(a=wl(n.T,n.Cc,n.Fa,r,t,i)),e==n.Cc&&(a=wl(n.T,n.wc,n.Fa,r,t,i)),e==n.wc&&(a=wl(n.T,n.T,n.Fa,r,t,i)),e==n.Ic&&(a=r==n.hb&&t.u==i.u?n.hb:n.Fa),e!=n.T&&e!=n.hb||(a=n.Fa),e==n.Fa&&(a=i.u&&t.u==i.u?n.M:n.C),a},ze:function(e,t,r){return n.dispatchEvent(new Se("onstatechange",{state:e.name})),i.get(e)(t,r)},handleError:function(e){return f(function t(){return O(t,function(t){switch(t.j){case 1:return S(t,Ko(n,e),2);case 2:return t.return(e.u?n.M:n.C)}})})},ff:function(e){n.dispatchEvent(new Se("onstateidle",{state:e.name}))}}),t&&this.Cb(t,!0)}(r=Zs.prototype).destroy=function(){return this.a.destroy()},r.hasFixedKeySpace=function(){return!0},r.addSegments=function(){return eo("segment")},r.removeSegments=function(e,t){return to(this,"segment",e,t)},r.getSegments=function(e){return ro(this,"segment",e).then(function(e){return e.map(oo)})},r.addManifests=function(){return eo("manifest")},r.updateManifestExpiration=function(e,t){var r=Ws(this.a,"manifest"),n=r.store(),i=new pe;return n.get(e).onsuccess=function(r){(r=r.target.result)?(r.expiration=t,n.put(r),i.resolve()):i.reject(new fe(2,9,9012,"Could not find values for "+e))},r.promise().then(function(){return i})},r.removeManifests=function(e,t){return to(this,"manifest",e,t)},r.getManifests=function(e){return ro(this,"manifest",e).then(function(e){return e.map(no)})},r.getAllManifests=function(){var e=this;return f(function t(){var r,n;return O(t,function(t){switch(t.j){case 1:return r=Ks(e.a,"manifest"),n=new Map,S(t,Hs(r,function(e,t){n.set(e,no(t))}),2);case 2:return S(t,r.promise(),3);case 3:return t.return(n)}})})},(r=uo.prototype).destroy=function(){return this.a.destroy()},r.hasFixedKeySpace=function(){return this.f},r.addSegments=function(e){return co(this,this.c,e)},r.removeSegments=function(e,t){return ho(this,this.c,e,t)},r.getSegments=function(e){return fo(this,this.c,e)},r.addManifests=function(e){return co(this,this.b,e)},r.updateManifestExpiration=function(e,t){var r=Ws(this.a,this.b),n=r.store();return n.get(e).onsuccess=function(r){(r=r.target.result)&&(r.expiration=t,n.put(r,e))},r.promise()},r.removeManifests=function(e,t){return ho(this,this.b,e,t)},r.getManifests=function(e){return fo(this,this.b,e)},r.getAllManifests=function(){var e=this;return f(function t(){var r,n;return O(t,function(t){switch(t.j){case 1:return r=Ks(e.a,e.b),n=new Map,S(t,Hs(r,function(e,t){n.set(e,t)}),2);case 2:return S(t,r.promise(),3);case 3:return t.return(n)}})})},(r=po.prototype).init=function(){var t=this,r=new pe,n=e.indexedDB.open("shaka_offline_db",4);return n.onsuccess=function(e){e=e.target.result,t.f=e;var n=e.objectStoreNames;n=n.contains("manifest")&&n.contains("segment")?new Zs(e):null,t.a=n,n=(n=e.objectStoreNames).contains("manifest-v2")&&n.contains("segment-v2")?new uo(e,"segment-v2","manifest-v2",!0):null,t.b=n,n=(n=e.objectStoreNames).contains("manifest-v3")&&n.contains("segment-v3")?new uo(e,"segment-v3","manifest-v3",!1):null,t.c=n,e=e.objectStoreNames.contains("session-ids")?new Xs(e):null,t.g=e,r.resolve()},n.onupgradeneeded=function(e){e=e.target.result;for(var t=d(["segment-v3","manifest-v3","session-ids"]),r=t.next();!r.done;r=t.next())r=r.value,e.objectStoreNames.contains(r)||e.createObjectStore(r,{autoIncrement:!0})},n.onerror=function(e){r.reject(new fe(2,9,9001,n.error)),e.preventDefault()},r},r.destroy=function(){var e=this;return f(function t(){return O(t,function(t){switch(t.j){case 1:if(!e.a){t.A(2);break}return S(t,e.a.destroy(),2);case 2:if(!e.b){t.A(4);break}return S(t,e.b.destroy(),4);case 4:if(!e.c){t.A(6);break}return S(t,e.c.destroy(),6);case 6:if(!e.g){t.A(8);break}return S(t,e.g.destroy(),8);case 8:e.f&&e.f.close(),E(t)}})})},r.getCells=function(){var e=new Map;return this.a&&e.set("v1",this.a),this.b&&e.set("v2",this.b),this.c&&e.set("v3",this.c),e},r.getEmeSessionCell=function(){return this.g},r.erase=function(){var t=this;return f(function r(){return O(r,function(r){switch(r.j){case 1:if(!t.a){r.A(2);break}return S(r,t.a.destroy(),2);case 2:if(!t.b){r.A(4);break}return S(r,t.b.destroy(),4);case 4:if(!t.c){r.A(6);break}return S(r,t.c.destroy(),6);case 6:return t.f&&t.f.close(),S(r,function(){var t=new pe,r=e.indexedDB.deleteDatabase("shaka_offline_db");return r.onblocked=function(){},r.onsuccess=function(){t.resolve()},r.onerror=function(e){t.reject(new fe(2,9,9001,r.error)),e.preventDefault()},t}(),8);case 8:return t.f=null,t.a=null,t.b=null,t.c=null,S(r,t.init(),0)}})})},Js("idb",function(){return e.indexedDB?new po:null}),go.prototype.ua=function(){return this.g},go.prototype.aa=function(){return this.f},go.prototype.key=function(){return this.c},go.prototype.toString=function(){return this.b},(r=wo.prototype).configure=function(){},r.start=function(e){var t=this;return f(function r(){var n,i,a,s,o;return O(r,function(r){switch(r.j){case 1:return n=mo(e),t.a=n,null==n||"manifest"!=n.a?r.return(Promise.reject(new fe(2,1,9004,n))):(i=new Ys,T(r,2),S(r,i.init(),4));case 4:return S(r,$s(i,n.ua(),n.aa()),5);case 5:return S(r,r.o.getManifests([n.key()]),6);case 6:return a=r.o,s=a[0],o=new vo(n.ua(),n.aa()),r.return(function(e,t){var r=new ki(null,0);r.wa(t.duration);var n=t.periods.map(function(t){return _o(e,t,r)}),i=t.drmInfo?[t.drmInfo]:[];return t.drmInfo&&n.forEach(function(e){e.variants.forEach(function(e){e.drmInfos=i})}),{presentationTimeline:r,minBufferTime:2,offlineSessionIds:t.sessionIds,periods:n}}(o,s));case 2:return C(r),S(r,i.destroy(),7);case 7:j(r,0)}})})},r.stop=function(){return Promise.resolve()},r.update=function(){},r.onExpirationUpdated=function(e,t){var r=this;return f(function n(){var i,a,s,o,l,u,c;return O(n,function(n){switch(n.j){case 1:return i=r.a,a=new Ys,x(n,2,3),S(n,a.init(),5);case 5:return S(n,$s(a,i.ua(),i.aa()),6);case 6:return S(n,(s=n.o).getManifests([i.key()]),7);case 7:if(o=n.o,l=o[0],u=l.sessionIds.includes(e),c=null==l.expiration||l.expiration>t,!u||!c){n.A(3);break}return S(n,s.updateManifestExpiration(i.key(),t),3);case 3:return C(n),S(n,a.destroy(),10);case 10:j(n,0);break;case 2:A(n),n.A(3)}})})},Ti.Nb("application/x-offline-manifest",wo),U("shaka.offline.OfflineScheme",So),So.h=function(e){return _e(e={uri:e,ad:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}})},So.i=function(e,t){var r=new Ys;return _e(void 0).U(function(){return r.init()}).U(function(){return $s(r,t.ua(),t.aa())}).U(function(e){return e.getSegments([t.key()])}).U(function(e){return{uri:t,ad:t,data:e[0].data,headers:{}}}).finally(function(){return r.destroy()})},Oe("offline",So),To.prototype.destroy=function(){var e=this;return f(function t(){return O(t,function(t){switch(t.j){case 1:return e.l=!1,e.b&&e.b.abort(),Ao(e),S(t,e.m,2);case 2:e.a&&e.a.ta.Wa();for(var r=d(e.f),n=r.next();!n.done;n=r.next())n.value.ta.Wa();e.a=null,e.f=[],e.g=null,E(t)}})})},U("shaka.text.SimpleTextDisplayer",Co),Co.prototype.remove=function(e,t){return!!this.a&&(Do(this.a,function(r){return r.startTime<t&&r.endTime>e}),!0)},Co.prototype.remove=Co.prototype.remove,Co.prototype.append=function(e){for(var t=jo,r=[],n=0;n<e.length;n++){var i=t(e[n]);i&&r.push(i)}r.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:r.indexOf(t)-r.indexOf(e)}).forEach(function(e){this.a.addCue(e)}.bind(this))},Co.prototype.append=Co.prototype.append,Co.prototype.destroy=function(){return this.a&&Do(this.a,function(){return!0}),this.a=null,Promise.resolve()},Co.prototype.destroy=Co.prototype.destroy,Co.prototype.isTextVisible=function(){return"showing"==this.a.mode},Co.prototype.isTextVisible=Co.prototype.isTextVisible,Co.prototype.setTextVisibility=function(e){this.a.mode=e?"showing":"hidden"},Co.prototype.setTextVisibility=Co.prototype.setTextVisibility,U("shaka.util.ConfigUtils.mergeConfigObjects",Ro),U("shaka.util.ConfigUtils.convertToConfigObject",Lo),U("shaka.util.PlayerConfiguration",Io),Io.mergeConfigObjects=Po,G(Go,xe),U("shaka.Player",Go),Go.prototype.destroy=function(){var e=this;return f(function t(){var r;return O(t,function(t){switch(t.j){case 1:return e.h==El?t.return():(e.h=El,r=ko(e.jb,function(){return{node:e.C,payload:{ya:null,u:null,mimeType:null,startTime:null,od:null,uri:null},Ta:!1}}),S(t,new Promise(function(e){r.tb=function(){},r.jc=function(){e()},r.Wa=function(){e()},r.onError=function(){e()},r.lc=function(){e()}}),2));case 2:return S(t,e.jb.destroy(),3);case 3:if(e.i&&(e.i.release(),e.i=null),e.vc=null,e.l=null,e.b=null,!e.G){t.A(0);break}return S(t,e.G.destroy(),5);case 5:e.G=null,E(t)}})})},Go.prototype.destroy=Go.prototype.destroy,Go.version="v2.5.5";var zo=["2","5"];an=new function(e){this.a=e,this.c=rn,this.b=nn}(new en(Number(zo[0]),Number(zo[1])));var Ho=["output-restricted","internal-error"],Vo={};function Ko(e,t){return f(function r(){return O(r,function(r){switch(r.j){case 1:if(e.h!=El&&(e.h=xl),e.dispatchEvent(new Se("unloading")),t.ya=null,t.mimeType=null,t.startTime=null,t.uri=null,t.u&&(e.i.ea(t.u,"loadeddata"),e.i.ea(t.u,"playing"),e.i.ea(t.u,"pause"),e.i.ea(t.u,"ended"),e.i.ea(t.u,"ratechange")),e.gb&&(e.gb.release(),e.gb=null),e.Tb&&(e.Tb.stop(),e.Tb=null),!e.m){r.A(2);break}return S(r,e.m.stop(),3);case 3:e.m=null;case 2:if(!e.l){r.A(4);break}return S(r,e.l.stop(),4);case 4:if(!e.f){r.A(6);break}return S(r,e.f.destroy(),7);case 7:e.f=null;case 6:if(e.s&&(e.s.release(),e.s=null),!e.D){r.A(8);break}return S(r,e.D.destroy(),9);case 9:e.D=null;case 8:if(t.u&&t.u.src&&(t.u.removeAttribute("src"),t.u.load()),!e.g){r.A(10);break}return S(r,e.g.destroy(),11);case 11:e.g=null;case 10:e.$.a.clear(),e.Bb=null,e.P=null,e.Wb.clear(),e.c=null,e.v=null,e.xc=null,e.ib=!0,el(e),E(r)}})})}function Wo(e,t){e.P=new La(t,Math.min(.5,t/2)),e.P.a=Ia,el(e),e.Tb=new ce(function(){switch(e.h){case kl:var t=!!e.a.ended||Bt(e.a.buffered)>=e.a.duration-.1;break;case Tl:e:if(e.a.ended||Er(e.D))t=!0;else{if(e.c.presentationTimeline.V()){var r=e.c.presentationTimeline.nb();if(Bt(e.a.buffered)>=r){t=!0;break e}}t=!1}break;default:t=!1}var n=Gt(e.a.buffered,e.a.currentTime),i=t,a=(r=e.P).b.get(r.a);t=r.a,n=i||n>=a?Oa:Ia,r.a=n,t!=n&&el(e)}).La(.25)}function qo(e){if(e.m&&e.m.configure(e.b.manifest),e.g&&e.g.configure(e.b.drm),e.f){e.f.configure(e.b.streaming);try{e.c.periods.forEach(e.Fc.bind(e))}catch(t){e.Ka(t)}var t=ds(e.f),r=hs(e.f),n=_l(e);t=Jr(t,r,n.variants),e.l&&t&&t.allowedByApplication&&t.allowedByKeySystem?rl(e,n.variants):nl(e,n)}if(e.D&&(n=e.b.textDisplayFactory,e.xc!=n)){t=new n;var i=(r=e.D).g;r.g=t,i&&(t.setTextVisibility(i.isTextVisible()),i.destroy()),r.a&&(r.a.c=t),e.xc=n,e.f&&((t=(n=e.f).b.get("text"))&&vs(n,t.stream,!0,0,!0))}e.l&&(e.l.configure(e.b.abr),e.b.abr.enabled&&!e.ib?e.l.enable():e.l.disable(),ul(e))}function Xo(e,t,r,n){xa(e.$,t).variant=r,(e=e.v.c).c!=r&&(e.c=r,e.a.push({timestamp:Date.now()/1e3,id:r.id,type:"variant",fromAdaptation:n,bandwidth:r.bandwidth}))}function Yo(e,t,r,n){Ea(e.$,t,r),(e=e.v.c).b!=r&&(e.b=r,e.a.push({timestamp:Date.now()/1e3,id:r.id,type:"text",fromAdaptation:n,bandwidth:null}))}function $o(e){var t=Oo();return t.streaming.failureCallback=function(t){e.V()&&[1001,1002,1003].includes(t.code)&&(t.severity=1,e.gd())},t.textDisplayFactory=function(){return new Co(e.a)},t}function Jo(e,t){var r=e.f?ds(e.f):null,n=e.f?hs(e.f):null;if(t.forEach(Ur.bind(null,e.g,r,n)),0==(r=function(e,t){var r=0;return e.forEach(function(e){r+=t(e)?1:0}),r}(t,function(e){return e.variants.some(qr)})))throw new fe(2,4,4032);if(r<t.length)throw new fe(2,4,4011);t.forEach(function(e){Br(e.variants,this.b.restrictions,this.Xb)&&this.f&&_l(this)==e&&al(this),pl(this,e.variants)}.bind(e))}function Qo(e,t,r,n){r=void 0!==r&&r,n=void 0===n?0:n,e.ib?(e.Ea=t,e.Dd=r,e.Bd=n):(ms(e.f,t,r,n),sl(e))}function Zo(e,t){e.ib?e.na=t:(vs(e.f,t,!0,0,!1),ol(e))}function el(e){var t=e.Oc();if(e.v&&e.P&&e.s){var r=e.W;r.f=t,Wa(r),tl(e)}e.dispatchEvent(new Se("buffering",{buffering:t}))}function tl(e){if(e.v&&e.P){var t=e.v.a;e.P.a==Ia?No(t,"buffering"):e.a.paused?No(t,"paused"):e.a.ended?No(t,"ended"):No(t,"playing")}}function rl(e,t){try{pl(e,t)}catch(t){return e.Ka(t),null}var r=t.filter(function(e){return qr(e)});return r=e.Ub.create(r),e.l.setVariants(Array.from(r.values())),e.l.chooseVariant()}function nl(e,t){var r=rl(e,t.variants);r&&(Xo(e,t,r,!0),Qo(e,r,!0)),(r=Yr(t.textStreams,e.ma,e.cb)[0]||null)&&(e.b.streaming.alwaysStreamText||e.gc())&&(Yo(e,t,r,!0),Zo(e,r)),il(e)}function il(e){gl(e,new Se("adaptation"))}function al(e){gl(e,new Se("trackschanged"))}function sl(e){gl(e,new Se("variantchanged"))}function ol(e){gl(e,new Se("textchanged"))}function ll(e){gl(e,new Se("texttrackvisibility"))}function ul(e){gl(e,new Se("abrstatuschanged",{rg:e.b.abr.enabled}))}function cl(e,t,r){e.dispatchEvent(new Se(t,{detail:{schemeIdUri:r.schemeIdUri,value:r.value,startTime:r.startTime,endTime:r.endTime,id:r.id,eventElement:r.eventElement}}))}function dl(e){if(!e.a.error)return null;var t=e.a.error.code;if(1==t)return null;var r=e.a.error.msExtendedCode;return r&&(0>r&&(r+=Math.pow(2,32)),r=r.toString(16)),new fe(2,3,3016,t,r,e.a.error.message)}function hl(e,t){if(e.f){var r=_l(e),n=!1,i=Object.keys(t),a=1==i.length&&"00"==i[0];i.length&&r.variants.forEach(function(e){(function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t})(e).forEach(function(r){var i=e.allowedByKeySystem;r.keyId&&(r=t[a?"00":r.keyId],e.allowedByKeySystem=!!r&&!Ho.includes(r)),i!=e.allowedByKeySystem&&(n=!0)})}),(i=Jr(i=ds(e.f),hs(e.f),r.variants))&&!i.allowedByKeySystem&&nl(e,r),n&&(al(e),rl(e,r.variants))}}function fl(e,t,r){e.m&&e.m.onExpirationUpdated&&e.m.onExpirationUpdated(t,r),e.dispatchEvent(new Se("expirationupdated"))}function pl(e,t){var r=e.g?Ye(e.g.T):{},n=Object.keys(r);n=n.length&&"00"==n[0];for(var i=!1,a=!1,s=[],o=[],l=d(t),u=l.next();!u.done;u=l.next()){var c=[];(u=u.value).audio&&c.push(u.audio),u.video&&c.push(u.video);for(var h=(c=d(c)).next();!h.done;h=c.next())if((h=h.value).keyId){var f=r[n?"00":h.keyId];f?Ho.includes(f)&&(o.includes(f)||o.push(f)):s.includes(h.keyId)||s.push(h.keyId)}u.allowedByApplication?u.allowedByKeySystem&&(i=!0):a=!0}if(!i)throw new fe(2,4,4012,{hasAppRestrictions:a,missingKeys:s,restrictedKeyStatuses:o})}function gl(e,t){f(function r(){return O(r,function(r){switch(r.j){case 1:return S(r,Promise.resolve(),2);case 2:e.h!=El&&e.dispatchEvent(t),E(r)}})})}function ml(e){for(var t=new Set,r=(e=d(e)).next();!r.done;r=e.next())(r=r.value).language?t.add(Or(r.language)):t.add("und");return t}function vl(e){for(var t=new Map,r=(e=d(e)).next();!r.done;r=e.next()){var n=r.value;r="und";var i=[];for(n.language&&(r=Or(n.language)),(i="variant"==n.type?n.audioRoles:n.roles)&&i.length||(i=[""]),t.has(r)||t.set(r,new Set),i=(n=d(i)).next();!i.done;i=n.next())i=i.value,t.get(r).add(i)}var a=[];return t.forEach(function(e,t){for(var r=d(e),n=r.next();!n.done;n=r.next())a.push({language:t,role:n.value})}),a}function _l(e){for(var t=e.s.h(),r=null,n=(e=d(e.c.periods)).next();!n.done;n=e.next())(n=n.value).startTime<=t&&(r=n);return r}function yl(e){var t=_l(e);return xa(e.$,t).variant}function bl(){return new fe(2,7,7e3)}function wl(e,t,r,n,i,a){return n==e&&i.u==a.u&&i.uri==a.uri&&i.mimeType==a.mimeType&&i.ya==a.ya?t:r}function Sl(e){return new Promise(function(t,r){e.Wa=function(){return r(bl())},e.jc=function(){return t()},e.onError=function(e){return r(e)},e.lc=function(){return r(bl())}})}Go.registerSupportPlugin=function(e,t){Vo[e]=t},Go.isBrowserSupported=function(){return!!(e.Promise&&e.Uint8Array&&Array.prototype.forEach&&e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration)&&(!!Ze()||et("application/x-mpegurl"))},Go.probeSupport=function(){return jt().then(function(e){for(var t=Ti.Af(),r={},n=d('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),i=n.next();!i.done;i=n.next()){r[i=i.value]=Ze()?!!mr(i)||(MediaSource.isTypeSupported(i)||Yt(i)):et(i);var a=i.split(";")[0];r[a]=r[a]||r[i]}for(var s in e={manifest:t,media:r,drm:e},Vo)e[s]=Vo[s]();return e})},Go.prototype.Cb=function(e,t){if(t=void 0===t||t,this.h==El)return Promise.reject(bl());var r={ya:null,u:null,mimeType:null,startTime:null,od:null,uri:null};r.u=e,Ze()||(t=!1);var n=t?this.fb:this.M,i=ko(this.jb,function(){return{node:n,payload:r,Ta:!1}});return i.tb=function(){},Sl(i)},Go.prototype.attach=Go.prototype.Cb,Go.prototype.detach=function(){var e=this;if(this.h==El)return Promise.reject(bl());var t=ko(this.jb,function(){return{node:e.C,payload:{ya:null,u:null,mimeType:null,startTime:null,od:null,uri:null},Ta:!1}});return t.tb=function(){},Sl(t)},Go.prototype.detach=Go.prototype.detach,Go.prototype.rd=function(e){var t=this;if(e=void 0===e||e,this.h==El)return Promise.reject(bl());Ze()||(e=!1);var r={ya:null,u:null,mimeType:null,startTime:null,od:null,uri:null},n=ko(this.jb,function(n){var i=n.u&&e?t.fb:n.u?t.M:t.C;return r.u=n.u,{node:i,payload:r,Ta:!1}});return n.tb=function(){},Sl(n)},Go.prototype.unload=Go.prototype.rd,Go.prototype.load=function(e,t,r){if(this.h==El)return Promise.reject(bl());this.dispatchEvent(new Se("loading"));var n={ya:null,u:null,mimeType:null,startTime:null,od:null,uri:null};n.uri=e,n.od=Date.now()/1e3,r&&"string"!=typeof r&&(tn("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),n.ya=function(){return new r}),r&&"string"==typeof r&&(n.mimeType=r),void 0!==t&&(n.startTime=t);var i=function(e){if(e.ya)return!1;if(!Ze())return!0;var t=e.mimeType;return e=e.uri||"",t||(t={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",ts:"video/mp2t",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac"}[Ti.getExtension(e)]),!!t&&(!!et(t)&&(!Ti.isSupported(e,t)||!!navigator.vendor&&navigator.vendor.includes("Apple")))}(n)?this.hb:this.T,a=ko(this.jb,function(e){return null==e.u?null:(n.u=e.u,{node:i,payload:n,Ta:!0})});return a.tb=function(){},new Promise(function(e,t){a.lc=function(){return t(new fe(2,7,7002))},a.jc=function(){return e()},a.Wa=function(){return t(bl())},a.onError=function(e){return t(e)}})},Go.prototype.load=Go.prototype.load,Go.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Lo(e,t));var r=Po(this.b,e,$o(this));return qo(this),r},Go.prototype.configure=Go.prototype.configure,Go.prototype.getConfiguration=function(){var e=$o(this);return Po(e,this.b,$o(this)),e},Go.prototype.getConfiguration=Go.prototype.getConfiguration,Go.prototype.If=function(){for(var e in this.b)delete this.b[e];Po(this.b,$o(this),$o(this)),qo(this)},Go.prototype.resetConfiguration=Go.prototype.If,Go.prototype.Je=function(){return this.h},Go.prototype.getLoadMode=Go.prototype.Je,Go.prototype.Ne=function(){return this.a},Go.prototype.getMediaElement=Go.prototype.Ne,Go.prototype.Fb=function(){return this.G},Go.prototype.getNetworkingEngine=Go.prototype.Fb,Go.prototype.bc=function(){return this.Bb},Go.prototype.getAssetUri=Go.prototype.bc,Go.prototype.Me=function(){return tn("getManifestUri",'Please use "getAssetUri" instead.'),this.bc()},Go.prototype.getManifestUri=Go.prototype.Me,Go.prototype.V=function(){return this.c?this.c.presentationTimeline.V():!(!this.a||!this.a.src)&&1/0==this.a.duration},Go.prototype.isLive=Go.prototype.V,Go.prototype.Va=function(){return!!this.c&&this.c.presentationTimeline.Va()},Go.prototype.isInProgress=Go.prototype.Va,Go.prototype.af=function(){if(this.c){if(!this.c.periods.length)return!1;var e=this.c.periods[0].variants;return!!e.length&&!e[0].video}return!(!this.a||!this.a.src)&&(this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight)},Go.prototype.isAudioOnly=Go.prototype.af,Go.prototype.Kf=function(){if(this.c){var e=this.c.presentationTimeline;return{start:e.mb(),end:e.za()}}return this.a&&this.a.src&&(e=this.a.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},Go.prototype.seekRange=Go.prototype.Kf,Go.prototype.keySystem=function(){return this.g?this.g.keySystem():""},Go.prototype.keySystem=Go.prototype.keySystem,Go.prototype.drmInfo=function(){return this.g?this.g.a:null},Go.prototype.drmInfo=Go.prototype.drmInfo,Go.prototype.dc=function(){return this.g?this.g.dc():1/0},Go.prototype.getExpiration=Go.prototype.dc,Go.prototype.Oc=function(){return!!this.P&&this.P.a==Ia},Go.prototype.isBuffering=Go.prototype.Oc,Go.prototype.Qe=function(){if(this.W){var e=this.W;e=e.f?0:e.c}else e=0;return e},Go.prototype.getPlaybackRate=Go.prototype.Qe,Go.prototype.bg=function(e){0==e?q("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.W.set(e),this.h==Tl&&gs(this.f,1<Math.abs(e)))},Go.prototype.trickPlay=Go.prototype.bg,Go.prototype.ue=function(){this.h==kl&&this.W.set(1),this.h==Tl&&(this.W.set(1),gs(this.f,!1))},Go.prototype.cancelTrickPlay=Go.prototype.ue,Go.prototype.Nc=function(){if(this.c&&this.s){for(var e=yl(this),t=[],r=d(function(e){return null==(e=_l(e))?[]:e.variants.filter(function(e){return qr(e)})}(this)),n=r.next();!n.done;n=r.next()){var i=zr(n=n.value);i.active=n==e,t.push(i)}return t}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(e){var t=Wr(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind?(t.primary=!0,t.roles=["main"],t.audioRoles=["main"]):t.audioRoles=[],t}):[]},Go.prototype.getVariantTracks=Go.prototype.Nc,Go.prototype.ob=function(){if(this.c&&this.s){for(var e=function(e){var t=_l(e);if(null==t)return null;if(!xa(e.$,t).text){var r=Yr(t.textStreams,e.ma,e.cb);r.length&&Ea(e.$,t,r[0])}return xa(e.$,t).text}(this),t=[],r=d(function(e){var t=_l(e);return null==t?[]:t.textStreams.filter(function(t){return!e.Wb.has(t)})}(this)),n=r.next();!n.done;n=r.next()){var i=Hr(n=n.value);i.active=n==e,t.push(i)}return t}return this.a&&this.a.src&&this.a.textTracks?Array.from(this.a.textTracks).map(function(e){var t=Wr(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),t}):[]},Go.prototype.getTextTracks=Go.prototype.ob,Go.prototype.hd=function(e){if(this.c&&this.f){var t=_l(this),r=t.textStreams.find(function(t){return t.id==e.id});r&&(Yo(this,t,r,!1),Zo(this,r),this.ma=r.language)}else if(this.a&&this.a.src&&this.a.textTracks){for(r=(t=d(t=Array.from(this.a.textTracks))).next();!r.done;r=t.next())Vr(r=r.value)==e.id?r.mode=this.eb?"showing":"hidden":r.mode="disabled";ol(this)}},Go.prototype.selectTextTrack=Go.prototype.hd,Go.prototype.Mf=function(){tn("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var e=this.ob().filter(function(e){return"application/cea-608"==e.mimeType});0<e.length&&this.hd(e[0])},Go.prototype.selectEmbeddedTextTrack=Go.prototype.Mf,Go.prototype.gg=function(){tn("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var e=this.ob().filter(function(e){return e.active})[0];return!!e&&"application/cea-608"==e.mimeType},Go.prototype.usingEmbeddedTextTrack=Go.prototype.gg,Go.prototype.Of=function(e,t,r){if(r=void 0===r?0:r,this.c&&this.f){var n=_l(this);this.b.abr.enabled&&q("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var i=n.variants.find(function(t){return t.id==e.id});i&&qr(i)&&(Xo(this,n,i,!1),Qo(this,i,t,r),this.Ub=new Da(i),rl(this,n.variants))}else if(this.a&&this.a.audioTracks){for(r=(t=d(t=Array.from(this.a.audioTracks))).next();!r.done;r=t.next())Vr(r=r.value)==e.id&&(r.enabled=!0);sl(this)}},Go.prototype.selectVariantTrack=Go.prototype.Of,Go.prototype.Ee=function(){return vl(this.Nc())},Go.prototype.getAudioLanguagesAndRoles=Go.prototype.Ee,Go.prototype.Xe=function(){return vl(this.ob())},Go.prototype.getTextLanguagesAndRoles=Go.prototype.Xe,Go.prototype.De=function(){return Array.from(ml(this.Nc()))},Go.prototype.getAudioLanguages=Go.prototype.De,Go.prototype.We=function(){return Array.from(ml(this.ob()))},Go.prototype.getTextLanguages=Go.prototype.We,Go.prototype.Lf=function(e,t){if(this.c&&this.s){var r=_l(this);this.Ub=new Ra(e,t||"",0),nl(this,r)}else if(this.a&&this.a.audioTracks){for(var n=(r=d(r=Array.from(this.a.audioTracks))).next();!n.done;n=r.next())(n=n.value).language==e&&(n.enabled=!0);sl(this)}},Go.prototype.selectAudioLanguage=Go.prototype.Lf,Go.prototype.Nf=function(e,t){if(this.c&&this.s){var r=_l(this);this.ma=e,this.cb=t||"";var n=Yr(r.textStreams,this.ma,this.cb)[0]||null;n&&(Yo(this,r,n,!1),(this.b.streaming.alwaysStreamText||this.gc())&&Zo(this,n))}else(r=this.ob().filter(function(t){return t.language==e})[0])&&this.hd(r)},Go.prototype.selectTextLanguage=Go.prototype.Nf,Go.prototype.gc=function(){var e=this.eb;return this.c?this.D.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Array.from(this.a.textTracks).some(function(e){return"showing"==e.mode}):e},Go.prototype.isTextTrackVisible=Go.prototype.gc,Go.prototype.Rf=function(e){var t=this;return f(function r(){var n,i,a,s;return O(r,function(r){switch(r.j){case 1:if(t.eb==(n=e))return r.return();if(t.eb=n,t.h!=Tl){if(t.a&&t.a.src&&t.a.textTracks)for(var o=d(Array.from(t.a.textTracks)),l=o.next();!l.done;l=o.next())"disabled"!=(i=l.value).mode&&(i.mode=e?"showing":"hidden");r.A(2);break}if(t.D.g.setTextVisibility(e),t.b.streaming.alwaysStreamText){r.A(2);break}if(!e){(o=t.f).D=!0,(l=o.b.get("text"))&&(Os(l),o.b.delete("text")),r.A(2);break}if(a=_l(t),!(0<(s=Yr(a.textStreams,t.ma,t.cb)).length)){r.A(2);break}return S(r,ps(t.f,s[0]),2);case 2:ll(t),E(r)}})})},Go.prototype.setTextTrackVisibility=Go.prototype.Rf,Go.prototype.Se=function(){if(!this.V())return null;if(this.c)return new Date(1e3*(this.c.presentationTimeline.f+this.a.currentTime));if(this.a&&this.a.getStartDate){var e=this.a.getStartDate();return isNaN(e.getTime())?null:new Date(e.getTime()+1e3*this.a.currentTime)}return null},Go.prototype.getPlayheadTimeAsDate=Go.prototype.Se,Go.prototype.Ue=function(){if(!this.V())return null;if(this.c)return new Date(1e3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var e=this.a.getStartDate();return isNaN(e.getTime())?null:e}return null},Go.prototype.getPresentationStartTimeAsDate=Go.prototype.Ue,Go.prototype.Jc=function(){var e={total:[],audio:[],video:[],text:[]};return this.h==kl&&(e.total=zt(this.a.buffered)),this.h==Tl&&this.D.Jc(e),e},Go.prototype.getBufferedInfo=Go.prototype.Jc,Go.prototype.getStats=function(){if(this.h!=Tl&&this.h!=kl)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,switchHistory:[],stateHistory:[]};tl(this);var e=this.a;if(e.getVideoPlaybackQuality){e=e.getVideoPlaybackQuality();var t=this.v,r=Number(e.totalVideoFrames);t.i=Number(e.droppedVideoFrames),t.h=r}this.h==Tl&&((e=yl(this))&&(this.v.l=e.bandwidth),e&&e.video&&(t=this.v,r=e.video.height||NaN,t.m=e.video.width||NaN,t.g=r),e=this.l.getBandwidthEstimate(),this.v.f=e);var n=this.v;e=n.m,t=n.g,r=n.l;for(var i=n.h,a=n.i,s=n.f,o=n.b,l=Fo(n.a,"playing"),u=Fo(n.a,"paused"),c=Fo(n.a,"buffering"),h=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var r=[],n=d(e.b),i=n.next();!i.done;i=n.next())r.push(t(i.value));return e.a&&r.push(t(e.a)),r}(n.a),f=[],p=(n=d(n.c.a)).next();!p.done;p=n.next())p=p.value,f.push({timestamp:p.timestamp,id:p.id,type:p.type,fromAdaptation:p.fromAdaptation,bandwidth:p.bandwidth});return{width:e,height:t,streamBandwidth:r,decodedFrames:i,droppedFrames:a,estimatedBandwidth:s,loadLatency:o,playTime:l,pauseTime:u,bufferingTime:c,stateHistory:h,switchHistory:f}},Go.prototype.getStats=Go.prototype.getStats,Go.prototype.addTextTrack=function(e,t,r,n,i,a){var s=this;return f(function o(){var l,u,c,d,h,f,p,g,m;return O(o,function(o){switch(o.j){case 1:if(s.h==kl)throw Error("State error!");if(s.h!=Tl)throw Error("State error!");if(l=_l(s),u=Wt,c=s.c.periods.indexOf(l),h=(d=c+1)>=s.c.periods.length?s.c.presentationTimeline.Y():s.c.periods[d].startTime,1/0==(f=h-l.startTime))throw new fe(1,4,4033);return p=new oi(1,0,f,function(){return[e]},0,null),g={id:s.Hd++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(e){return 1==e?p:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:n,codecs:i||"",kind:r,encrypted:!1,keyId:null,language:t,label:a||null,type:u.qa,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},s.Wb.add(g),l.textStreams.push(g),S(o,ps(s.f,g),2);case 2:return(m=fs(s.f,"text"))&&Ea(s.$,l,m),s.Wb.delete(g),nl(s,l),al(s),o.return(Hr(g))}})})},Go.prototype.addTextTrack=Go.prototype.addTextTrack,Go.prototype.kd=function(e,t){this.Xb.width=e,this.Xb.height=t},Go.prototype.setMaxHardwareResolution=Go.prototype.kd,Go.prototype.gd=function(){if(this.h==Tl){var e=this.f;if(e.f)e=!1;else if(e.m)e=!1;else{for(var t=d(e.b.values()),r=t.next();!r.done;r=t.next())(r=r.value).Ib&&(r.Ib=!1,Is(e,r,.1));e=!0}}else e=!1;return e},Go.prototype.retryStreaming=Go.prototype.gd,Go.prototype.Ke=function(){return this.c},Go.prototype.getManifest=Go.prototype.Ke,Go.prototype.Le=function(){return this.m?this.m.constructor:null},Go.prototype.getManifestParserFactory=Go.prototype.Le,(r=Go.prototype).Fc=function(e){var t=this.f?ds(this.f):null,r=this.f?hs(this.f):null;if(Ur(this.g,t,r,e),!(t=e.variants).some(qr))throw new fe(2,4,4011);if(pl(this,e.variants),Br(t,this.b.restrictions,this.Xb)&&this.f&&_l(this)==e&&al(this),e=this.g?this.g.a:null)for(r=(t=d(t)).next();!r.done;r=t.next())for(var n=(r=d(r.value.drmInfos)).next();!n.done;n=r.next())if((n=n.value).keySystem==e.keySystem)for(var i=(n=d(n.initData||[])).next();!i.done;i=n.next())i=i.value,St(this.g,i.initDataType,i.initData)},r.df=function(e){try{this.ib=!0,this.l.disable(),ul(this);var t=rl(this,e.variants),r=Yr(e.textStreams,this.ma,this.cb)[0]||null;this.Ea&&(e.variants.includes(this.Ea)&&(t=this.Ea),this.Ea=null),this.na&&(e.textStreams.includes(this.na)&&(r=this.na),this.na=null),t&&Xo(this,e,t,!0),r&&Yo(this,e,r,!0);var n=this.f,i=n.b.get("video");if(i)var a=n.c.periods[i.pa];else{var s=n.b.get("audio");a=s?n.c.periods[s.pa]:null}var o=t?t.audio:null;if(!a&&r){var l;if(l=o){e=r;var u=Or(this.b.preferredTextLanguage),c=Or(o.language),d=Or(e.language);l=Lr(d,u)&&!Lr(c,d)}l&&(this.eb=!0),this.eb&&this.D.g.setTextVisibility(!0),ll(this)}return this.b.streaming.alwaysStreamText||this.gc()?{variant:t,text:r}:{variant:t,text:null}}catch(e){return this.Ka(e),{variant:null,text:null}}},r.te=function(){this.ib=!1,this.b.abr.enabled&&(this.l.enable(),ul(this)),this.Ea&&(ms(this.f,this.Ea,this.Dd,this.Bd),sl(this),this.Ea=null),this.na&&(vs(this.f,this.na,!0,0,!1),ol(this),this.na=null)},r.jf=function(){this.m&&this.m.update&&this.m.update()},r.qf=function(){this.s&&this.s.s()},r.Ka=function(e){if(this.h!=El){var t=new Se("error",{detail:e});this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)}};var El=0,xl=1,Tl=2,kl=3;function Al(e,t){var r=_o(new vo(e.ua(),e.aa()),t.periods[0],new ki(null,0)),n=t.appMetadata||{};return r=Cl(r),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:r,appMetadata:n}}function Cl(e){for(var t=[],r=function(e){return e.filter(function(e){return qr(e)})}(e.variants),n=(r=d(r)).next();!n.done;n=r.next())t.push(zr(n.value));for(r=(e=d(e.textStreams)).next();!r.done;r=e.next())t.push(Hr(r.value));return t}function jl(){this.a={}}function Dl(e,t){var r=e.a[t];return null==r&&(r=0),r}function Rl(e){this.a=!1,this.b=new pe,this.c=e}function Ll(e){var t=new Ol;e.periods.forEach(function(e,r){var n=Ml(e.variants);if(0==r)for(var i=(n=d(n.a)).next();!i.done;i=n.next())t.add(i.value);else!function(e,t){e.a=e.a.filter(function(e){return Pl(t,e)})}(t,n)});for(var r=(e=d(e.periods)).next();!r.done;r=e.next())(r=r.value).variants=r.variants.filter(function(e){return Pl(t,new Il(e))})}function Il(e){var t=e.audio;e=e.video,this.b=t?t.mimeType:null,this.a=t?t.codecs.split(".")[0]:null,this.f=e?e.mimeType:null,this.c=e?e.codecs.split(".")[0]:null}function Ol(){this.a=[]}function Pl(e,t){return e.a.some(function(e){return t.b==e.b&&t.a==e.a&&t.f==e.f&&t.c==e.c})}function Ml(e){for(var t=new Ol,r=(e=d(e)).next();!r.done;r=e.next())t.add(new Il(r.value));return t}function Nl(e){var t=this;if(e&&e.constructor!=Go)throw new fe(2,9,9008);this.b=this.a=null,e?(this.a=e.b,this.b=e.Fb()):(this.a=Oo(),this.b=new Re),this.f=!1,this.c=[],this.g=[];var r=!e;this.h=new Rl(function(){return f(function e(){var n;return O(e,function(e){switch(e.j){case 1:return n=function(){},S(e,Promise.all(t.g.map(function(e){return e.then(n,n)})),2);case 2:if(!r){e.A(3);break}return S(e,t.b.destroy(),3);case 3:t.a=null,t.b=null,E(e)}})})})}function Fl(){if(Ze())e:{for(var e=d(Qs.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function Bl(e,t){for(var r=[],n=d(e.periods),i=n.next();!i.done;i=n.next())for(var a=(i=d(i.value.streams)).next();!a.done;a=i.next())a=a.value,t&&"video"==a.contentType?r.push({contentType:$e(a.mimeType,a.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=a.contentType||r.push({contentType:$e(a.mimeType,a.codecs),robustness:e.drmInfo.audioRobustness});return r}function Ul(e,t,r){return f(function n(){return O(n,function(n){switch(n.j){case 1:return S(n,function(e,t,r,n){return f(function i(){var a,s,o;return O(i,function(i){switch(i.j){case 1:return n.drmInfo?(a=function(e){var t=Array.from(e.a.keys());if(!t.length)throw new fe(2,9,9e3,"No supported storage mechanisms found");return e.a.get(t[0]).getEmeSessionCell()}(r),s=n.sessionIds.map(function(e){return{sessionId:e,keySystem:n.drmInfo.keySystem,licenseUri:n.drmInfo.licenseServerUri,serverCertificate:n.drmInfo.serverCertificate,audioCapabilities:Bl(n,!1),videoCapabilities:Bl(n,!0)}}),S(i,Eo(t,e,s),2)):i.return();case 2:return o=i.o,S(i,a.remove(o),3);case 3:return S(i,a.add(s.filter(function(e){return-1==o.indexOf(e.sessionId)})),0)}})})}(e.b,e.a.drm,r,t),0)}})})}function Gl(e,t,r,n){function i(){o+=1,e.a.offline.progressCallback(l,o/s)}var a=function(e){var t=[];return e.periods.forEach(function(e){e.streams.forEach(function(e){null!=e.initSegmentKey&&t.push(e.initSegmentKey),e.segments.forEach(function(e){t.push(e.dataKey)})})}),t}(n),s=a.length+1,o=0,l=Al(r,n);return Promise.all([t.removeSegments(a,i),t.removeManifests([r.key()],i)])}function zl(e,t,r,n,i,a){var s={id:a.id,originalId:a.originalId,primary:a.primary,presentationTimeOffset:a.presentationTimeOffset||0,contentType:a.type,mimeType:a.mimeType,codecs:a.codecs,frameRate:a.frameRate,kind:a.kind,language:a.language,label:a.label,width:a.width||null,height:a.height||null,initSegmentKey:null,encrypted:a.encrypted,keyId:a.keyId,segments:[],variantIds:[]};i=i.presentationTimeline.Hb();var o=a.id;return function(e,t,r){for(var n=null==(t=e.findSegmentPosition(t))?null:e.getSegmentReference(t);n;)r(n),n=e.getSegmentReference(++t)}(a,i,function(i){var l=Ai(i.c(),i.b,i.a,e.a.streaming.retryParameters);Gs(t,o,l,function(e,t,r){return r=r.endTime-r.startTime,Dl(e,t)*r}(n,a.id,i),function(t){return r.addSegments([{data:t}]).then(function(t){e.c.push(t[0]),s.segments.push({startTime:i.startTime,endTime:i.endTime,dataKey:t[0]})})})}),(i=a.initSegmentReference)&&(i=Ai(i.c(),i.b,i.a,e.a.streaming.retryParameters),Gs(t,o,i,.5*Dl(n,a.id),function(t){return r.addSegments([{data:t}]).then(function(t){e.c.push(t[0]),s.initSegmentKey=t[0]})})),s}function Hl(e){if(e.h.a)throw new fe(2,9,7001)}function Vl(){if(!Fl())throw new fe(2,9,9e3)}function Kl(e,t){return f(function r(){return O(r,function(r){switch(r.j){case 1:return e.g.push(t),T(r,2),S(r,t,4);case 4:return r.return(r.o);case 2:C(r),Ae(e.g,t),j(r,0)}})})}function Wl(e){for(var t=new Set,r=(e=d(e.periods)).next();!r.done;r=e.next()){for(var n=d((r=r.value).textStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(n=(r=d(r.variants)).next();!n.done;n=r.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video)}return t}function ql(e){e.variants.map(function(e){return e.video});var t=new Set(e.variants.map(function(e){return e.audio}));e=e.textStreams;for(var r=d(t),n=r.next();!n.done;n=r.next())for(var i=(n=d(t)).next();!i.done;i=n.next());for(r=(t=d(e)).next();!r.done;r=t.next())for(n=(r=d(e)).next();!n.done;n=r.next());}Go.LoadMode={DESTROYED:El,NOT_LOADED:xl,MEDIA_SOURCE:Tl,SRC_EQUALS:kl},Rl.prototype.destroy=function(){var e=this;return this.a?this.b:(this.a=!0,this.c().then(function(){e.b.resolve()},function(){e.b.resolve()}))},Ol.prototype.add=function(e){Pl(this,e)||this.a.push(e)},U("shaka.offline.Storage",Nl),Nl.support=Fl,Nl.prototype.destroy=function(){return this.h.destroy()},Nl.prototype.destroy=Nl.prototype.destroy,Nl.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Lo(e,t));var r=e,n=!1;return null!=r.trackSelectionCallback&&(n=!0,r.offline=r.offline||{},r.offline.trackSelectionCallback=r.trackSelectionCallback,delete r.trackSelectionCallback),null!=r.progressCallback&&(n=!0,r.offline=r.offline||{},r.offline.progressCallback=r.progressCallback,delete r.progressCallback),null!=r.usePersistentLicense&&(n=!0,r.offline=r.offline||{},r.offline.usePersistentLicense=r.usePersistentLicense,delete r.usePersistentLicense),n&&tn("Storage.configure with OfflineConfig","Please configure storage with a player configuration."),Po(this.a,e)},Nl.prototype.configure=Nl.prototype.configure,Nl.prototype.getConfiguration=function(){var e=Oo();return Po(e,this.a,Oo()),e},Nl.prototype.getConfiguration=Nl.prototype.getConfiguration,Nl.prototype.Fb=function(){return this.b},Nl.prototype.getNetworkingEngine=Nl.prototype.Fb,Nl.prototype.store=function(e,t,r){var n=this;return Kl(this,function(e,t,r,n){return f(function i(){var a,s,o,l,u,c,h,p,g;return O(i,function(i){switch(i.j){case 1:return Vl(),e.f?i.return(Promise.reject(new fe(2,9,9006))):(e.f=!0,S(i,function(e,t,r){return f(function n(){var i,a,s,o,l,u;return O(n,function(n){switch(n.j){case 1:return i=null,a=e.b,s={networkingEngine:a,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){i=e}},S(n,r(),2);case 2:return(o=n.o).configure(e.a.manifest),Hl(e),T(n,3),S(n,o.start(t,s),5);case 5:return l=n.o,Hl(e),u=Wl(l),S(n,Promise.all(Array.from(u).map(function(e){return e.createSegmentIndex()})),6);case 6:if(Hl(e),i)throw i;return n.return(l);case 3:return C(n),S(n,o.stop(),7);case 7:j(n,0)}})})}(e,t,n),2));case 2:if(a=i.o,Hl(e),!(!a.presentationTimeline.V()&&!a.presentationTimeline.Va()))throw new fe(2,9,9005,t);return s=null,o=new Ys,u=l=null,x(i,3,4),S(i,function(e,t,r){return f(function n(){var i,a,s;return O(n,function(n){switch(n.j){case 1:return i=new vt({rb:e.b,onError:r,kc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),a=za(t.periods),s=e.a,i.configure(s.drm),S(n,function(e,t,r){return e.s=[],e.D=r,yt(e,t)}(i,a,s.offline.usePersistentLicense),2);case 2:return S(n,bt(i),3);case 3:return S(n,wt(i),4);case 4:return n.return(i)}})})}(e,a,function(e){u=u||e}),6);case 6:if(s=i.o,Hl(e),u)throw u;return function(e,t,r){(function(e,t){for(var r={width:1/0,height:1/0},n=d(e.periods),i=n.next();!i.done;i=n.next())(i=i.value).variants=i.variants.filter(function(e){return Fr(e,t,r)})})(t,e.a.restrictions),function(e){for(var t=(e=d(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter(function(e){var t=!0;return e.audio&&(t=t&&wr(e.audio)),e.video&&(t=t&&wr(e.video)),t})}(t),function(e,t){for(var r=d(e.periods),n=r.next();!n.done;n=r.next())(n=n.value).variants=n.variants.filter(function(e){return Dt(t,e)})}(t,r),Ll(t),function(e,t){var r=new Ol;e.periods.forEach(function(e,n){0<n&&(e.variants=e.variants.filter(function(e){return Pl(r,new Il(e))})),t(e),r=Ml(e.variants)})}(t,function(t){for(var r=[],n=d(t.variants),i=n.next();!i.done;i=n.next())r.push(zr(i.value));for(i=(n=d(t.textStreams)).next();!i.done;i=n.next())r.push(Hr(i.value));r=e.a.offline.trackSelectionCallback(r);var a=new Set,s=new Set;for(n=(r=d(r)).next();!n.done;n=r.next())"variant"==(n=n.value).type&&a.add(n.id),"text"==n.type&&s.add(n.id);t.variants=t.variants.filter(function(e){return a.has(e.id)}),t.textStreams=t.textStreams.filter(function(e){return s.has(e.id)})}),function(e){if(0==e.periods.length)throw new fe(2,4,4014);for(var t=(e=d(e.periods)).next();!t.done;t=e.next())ql(t.value)}(t)}(e,a,s),S(i,o.init(),7);case 7:return Hl(e),S(i,function(e){var t=null;if(e.a.forEach(function(e,r){e.getCells().forEach(function(e,n){e.hasFixedKeySpace()||t||(t={path:{ua:r,aa:n},aa:e})})}),t)return t;throw new fe(2,9,9013,"Could not find a cell that supports add-operations")}(o),8);case 8:return l=i.o,Hl(e),S(i,function(e,t,r,n,i,a){return f(function s(){var o,l,u,c;return O(s,function(s){switch(s.j){case 1:return o=function(e,t,r){var n=null==t.expiration?1/0:t.expiration;return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.Y(),size:0,expiration:n,tracks:t=Cl(t.periods[0]),appMetadata:r}}(i,n,a),l=new Us(e.b,function(t,r){o.size=r,e.a.offline.progressCallback(o,t)}),T(s,2),c=u=function(e,t,r,n,i,a,s){var o=new jl,l=i.periods.map(function(n){return function(e,t,r,n,i,a){i.periods.forEach(function(e){e.variants.forEach(function(e){var t=e.audio,r=e.video;if(t&&!r&&(n.a[t.id]=t.bandwidth||e.bandwidth),!t&&r&&(n.a[r.id]=r.bandwidth||e.bandwidth),t&&r){var i=t.bandwidth||393216,a=r.bandwidth||e.bandwidth-i;0>=a&&(a=e.bandwidth),n.a[t.id]=i,n.a[r.id]=a}}),e.textStreams.forEach(function(e){n.a[e.id]=52})});for(var s=Wl(i),o=new Map,l=(s=d(s)).next();!l.done;l=s.next()){l=l.value;var u=zl(e,t,r,n,i,l);o.set(l.id,u)}return a.variants.forEach(function(e){e.audio&&o.get(e.audio.id).variantIds.push(e.id),e.video&&o.get(e.video.id).variantIds.push(e.id)}),{startTime:a.startTime,streams:Array.from(o.values())}}(e,t,r,o,i,n)}),u=n.a,c=xt(n);if(u&&e.a.offline.usePersistentLicense){if(!c.length)throw new fe(2,9,9007,a);u.initData=[]}return{originalManifestUri:a,duration:i.presentationTimeline.Y(),size:0,expiration:n.dc(),periods:l,sessionIds:e.a.offline.usePersistentLicense?c:[],drmInfo:u,appMetadata:s}}(e,l,t,r,n,i,a),S(s,function(e){return f(function t(){return O(t,function(t){switch(t.j){case 1:return S(t,Promise.all(e.b.values()),2);case 2:return t.return(e.a.a)}})})}(l),4);case 4:return c.size=s.o,s.return(u);case 2:return C(s),S(s,l.destroy(),5);case 5:j(s,0)}})})}(e,l.aa,s,a,t,r),9);case 9:if(c=i.o,Hl(e),u)throw u;return S(i,l.aa.addManifests([c]),10);case 10:return h=i.o,Hl(e),p=new go("manifest",l.path.ua,l.path.aa,h[0]),i.return(Al(p,c));case 4:return C(i),e.f=!1,e.c=[],S(i,o.destroy(),11);case 11:if(!s){i.A(12);break}return S(i,s.destroy(),12);case 12:j(i,0);break;case 3:if(g=A(i),!l){i.A(14);break}return S(i,l.aa.removeSegments(e.c,function(){}),14);case 14:throw u||g}})})}(this,e,t||{},function(){return f(function t(){var i,a;return O(t,function(t){switch(t.j){case 1:return r&&"string"!=typeof r?(tn("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),i=r,t.return(new i)):S(t,Ti.create(e,n.b,n.a.manifest.retryParameters,r),2);case 2:return a=t.o,t.return(a)}})})}))},Nl.prototype.store=Nl.prototype.store,Nl.prototype.Ve=function(){return this.f},Nl.prototype.getStoreInProgress=Nl.prototype.Ve,Nl.prototype.remove=function(e){return Kl(this,function(e,t){return f(function r(){var n,i,a,s,o,l;return O(r,function(r){switch(r.j){case 1:return Vl(),null==(n=mo(t))||"manifest"!=n.a?r.return(Promise.reject(new fe(2,9,9004,t))):(i=n,a=new Ys,T(r,2),S(r,a.init(),4));case 4:return S(r,$s(a,i.ua(),i.aa()),5);case 5:return S(r,(s=r.o).getManifests([i.key()]),6);case 6:return o=r.o,l=o[0],S(r,Promise.all([Ul(e,l,a),Gl(e,s,i,l)]),2);case 2:return C(r),S(r,a.destroy(),8);case 8:j(r,0)}})})}(this,e))},Nl.prototype.remove=Nl.prototype.remove,Nl.prototype.Ff=function(){return Kl(this,function(e){return f(function t(){var r,n,i,a,s,o,l,u,c;return O(t,function(t){switch(t.j){case 1:return Vl(),r=e.b,n=e.a.drm,i=new Ys,a=!1,T(t,2),S(t,i.init(),4);case 4:for(s=[],function(e,t){e.a.forEach(function(e){t(e.getEmeSessionCell())})}(i,function(e){return s.push(e)}),o=Promise.resolve(),l={},u=d(s),c=u.next();!c.done;l={qc:l.qc},c=u.next())l.qc=c.value,o=o.then(function(e){return function(){return f(function t(){var i,s;return O(t,function(t){switch(t.j){case 1:return S(t,e.qc.getAll(),2);case 2:return i=t.o,S(t,Eo(n,r,i),3);case 3:return s=t.o,S(t,e.qc.remove(s),4);case 4:s.length!=i.length&&(a=!0),E(t)}})})}}(l));return S(t,o,2);case 2:return C(t),S(t,i.destroy(),6);case 6:j(t,3);break;case 3:return t.return(!a)}})})}(this))},Nl.prototype.removeEmeSessions=Nl.prototype.Ff,Nl.prototype.list=function(){return Kl(this,f(function e(){var t,r,n;return O(e,function(e){switch(e.j){case 1:return Vl(),t=[],r=new Ys,T(e,2),S(e,r.init(),4);case 4:return n=Promise.resolve(),function(e,t){e.a.forEach(function(e,r){e.getCells().forEach(function(e,n){t({ua:r,aa:n},e)})})}(r,function(e,r){n=n.then(function(){return f(function n(){return O(n,function(n){switch(n.j){case 1:return S(n,r.getAllManifests(),2);case 2:n.o.forEach(function(r,n){var i=Al(new go("manifest",e.ua,e.aa,n),r);t.push(i)}),E(n)}})})})}),S(e,n,2);case 2:return C(e),S(e,r.destroy(),6);case 6:j(e,3);break;case 3:return e.return(t)}})}))},Nl.prototype.list=Nl.prototype.list,Nl.deleteAll=function(){return f(function e(){var t;return O(e,function(e){switch(e.j){case 1:return t=new Ys,T(e,2),S(e,t.erase(),2);case 2:return C(e),S(e,t.destroy(),5);case 5:j(e,0)}})})},Vo.offline=Fl,U("shaka.polyfill.installAll",function(){for(var e=0;e<$l.length;++e)$l[e].re()});var Xl,Yl,$l=[];function Jl(e,t){for(var r={priority:t=t||0,re:e},n=0;n<$l.length;n++)if($l[n].priority<t)return void $l.splice(n,0,r);$l.push(r)}function Ql(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"==typeof Event)var r=new Event(t,e);else(r=document.createEvent("Event")).initEvent(t,e.bubbles,e.cancelable);e.target.dispatchEvent(r)}function Zl(e,t,r){if("input"==e)switch(this.type){case"range":e="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,e,t,r)}function eu(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(t){for(var r=[],n=0;n<arguments.length;++n)r[n]=arguments[n];return(r=e.apply(this,r)).abort=function(){},r}}function tu(e){var t=e.target,r=t.mediaSource_;if(r.Ed){for(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),t.xd=!0,e=0;e<r.sourceBuffers.length;++e)if(0==r.sourceBuffers[e].xd)return;r.Ed=!1}}function ru(e){e=e.target;for(var t=0;t<e.sourceBuffers.length;++t)e.sourceBuffers[t].removeEventListener("updateend",tu,!1);e.removeEventListener("sourceclose",ru,!1)}function nu(e,t){try{var r=new iu(e,t);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}function iu(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(var r=d(t),n=r.next();!n.done;n=r.next()){var i=n.value;if("required"==i.persistentState)n=null;else{n={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:i.initDataTypes,sessionTypes:["temporary"],label:i.label};var a=!1,s=!1;if(i.audioCapabilities)for(var o=d(i.audioCapabilities),l=o.next();!l.done;l=o.next())if((l=l.value).contentType){a=!0;var u=l.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,u)&&(n.audioCapabilities.push(l),s=!0)}if(i.videoCapabilities)for(l=(i=d(i.videoCapabilities)).next();!l.done;l=i.next())(o=l.value).contentType&&(a=!0,l=o.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,l)&&(n.videoCapabilities.push(o),s=!0));a||(s=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),n=s?n:null}if(n)return void(this.a=n)}throw(r=Error("Unsupported keySystem")).name="NotSupportedError",r.code=DOMException.NOT_SUPPORTED_ERR,r}function au(e){var t=this.mediaKeys;return t&&t!=e&&ou(t,null),delete this.mediaKeys,(this.mediaKeys=e)?ou(e,this):Promise.resolve()}function su(e){this.b=new WebKitMediaKeys(e),this.a=new ze}function ou(e,t){if(e.a.Ya(),!t)return Promise.resolve();e.a.w(t,"webkitneedkey",uu);try{return 1<=t.readyState?t.webkitSetMediaKeys(e.b):e.a.da(t,"loadedmetadata",function(){t.webkitSetMediaKeys(e.b)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function lu(e){xe.call(this),this.b=null,this.g=e,this.c=this.a=null,this.f=new ze,this.sessionId="",this.expiration=NaN,this.closed=new pe,this.keyStatuses=new du}function uu(e){var t=new Event("encrypted");t.initDataType="cenc",t.initData=e.initData,this.dispatchEvent(t)}function cu(e,t){var r=e.keyStatuses;r.size=null==t?0:1,r.a=t,e.dispatchEvent(new Se("keystatuseschange"))}function du(){this.size=0,this.a=void 0}function hu(e,t){try{var r=new fu(e,t);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}function fu(e,t){this.keySystem=e;for(var r=!1,n=0;n<t.length;++n){var i=t[n],a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:i.initDataTypes,sessionTypes:["temporary"],label:i.label},s=!1;if(i.audioCapabilities)for(var o=0;o<i.audioCapabilities.length;++o){var l=i.audioCapabilities[o];if(l.contentType){s=!0;var u=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,u)&&(a.audioCapabilities.push(l),r=!0)}}if(i.videoCapabilities)for(o=0;o<i.videoCapabilities.length;++o)(l=i.videoCapabilities[o]).contentType&&(s=!0,u=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,u)&&(a.videoCapabilities.push(l),r=!0));if(s||(r=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==i.persistentState&&(r=!1),r)return void(this.a=a)}throw(r=Error("Unsupported keySystem")).name="NotSupportedError",r.code=DOMException.NOT_SUPPORTED_ERR,r}function pu(e){var t=this.mediaKeys;return t&&t!=e&&mu(t,null),delete this.mediaKeys,(this.mediaKeys=e)?mu(e,this):Promise.resolve()}function gu(e){this.a=new MSMediaKeys(e),this.b=new ze}function mu(e,t){if(e.b.Ya(),!t)return Promise.resolve();e.b.w(t,"msneedkey",_u);var r=e;try{return 1<=t.readyState?t.msSetMediaKeys(e.a):t.addEventListener("loadedmetadata",function e(){t.msSetMediaKeys(r.a),t.removeEventListener("loadedmetadata",e)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function vu(e){xe.call(this),this.c=null,this.g=e,this.b=this.a=null,this.f=new ze,this.sessionId="",this.expiration=NaN,this.closed=new pe,this.keyStatuses=new bu}function _u(e){if(e.initData){var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",t.initData=function(e){if(!e)return e;var t=new Xn(e);if(1>=t.a.length)return e;for(var r=[],n=0;n<t.a.length;n++)r.push(e.subarray(t.a[n].start,t.a[n].end+1));for(e=[],t={},n=d(r),r=n.next();!r.done;t={fc:t.fc},r=n.next())t.fc=r.value,e.some(function(e){return function(t){return gt(t,e.fc)}}(t))||e.push(t.fc);for(t=0,n=d(e),r=n.next();!r.done;r=n.next())t+=r.value.length;for(t=new Uint8Array(t),n=0,e=d(e),r=e.next();!r.done;r=e.next())r=r.value,t.set(r,n),n+=r.length;return t}(e.initData),this.dispatchEvent(t)}}function yu(e,t){var r=e.keyStatuses;r.size=null==t?0:1,r.a=t,e.dispatchEvent(new Se("keystatuseschange"))}function bu(){this.size=0,this.a=void 0}function wu(){return Promise.reject(Error("The key system specified is not supported."))}function Su(e){return null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Eu(){throw new TypeError("Illegal constructor.")}function xu(){throw new TypeError("Illegal constructor.")}U("shaka.polyfill.register",Jl),Jl(function(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitExitFullscreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitSupportsFullscreen||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Ql),document.addEventListener("webkitfullscreenerror",Ql),document.addEventListener("mozfullscreenchange",Ql),document.addEventListener("mozfullscreenerror",Ql),document.addEventListener("MSFullscreenChange",Ql),document.addEventListener("MSFullscreenError",Ql)}}),Jl(function(){tt("CrKey")&&delete e.indexedDB}),Jl(function(){tt("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=Zl)}),Jl(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})}),Jl(function(){}),Jl(function(){if(e.MediaSource)if(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType)!function(){var e=MediaSource.isTypeSupported,t=/^dv(?:h[e1]|a[v1])\./;MediaSource.isTypeSupported=function(r){for(var n=r.split(/ *; */),i=n[0],a={},s=1;s<n.length;++s){var o=n[s].split("="),l=o[0];o=o[1].replace(/"(.*)"/,"$1"),a[l]=o}if(!(n=a.codecs))return e(r);var u=!1,c=!1;for(var d in r=n.split(",").filter(function(e){return t.test(e)&&(c=!0),/^(hev|hvc)1\.2/.test(e)&&(u=!0),!0}),c&&(u=!1),a.codecs=r.join(","),u&&(a.eotf="smpte2084"),a)i+="; "+d+'="'+a[d]+'"';return cast.__platform__.canDisplayType(i)}}();else if(navigator.vendor&&navigator.vendor.includes("Apple")){var t=navigator.appVersion;!function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"mp2t"!=t.split(/ *; */)[0].split("/")[1].toLowerCase()&&e(t)}}(),t.includes("Version/8")?e.MediaSource=null:t.includes("Version/9")?eu():t.includes("Version/10")?(eu(),function(){var e=MediaSource.prototype.endOfStream;MediaSource.prototype.endOfStream=function(t){for(var r=[],n=0;n<arguments.length;++n)r[n]=arguments[n];for(var i=n=0;i<this.sourceBuffers.length;++i){var a=this.sourceBuffers[i];a=a.buffered.end(a.buffered.length-1),n=Math.max(n,a)}if(!isNaN(this.duration)&&n<this.duration)for(this.Ed=!0,n=0;n<this.sourceBuffers.length;++n)this.sourceBuffers[n].xd=!1;return e.apply(this,r)};var t=!1,r=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(e){for(var n=[],i=0;i<arguments.length;++i)n[i]=arguments[i];return(n=r.apply(this,n)).mediaSource_=this,n.addEventListener("updateend",tu,!1),t||(this.addEventListener("sourceclose",ru,!1),t=!0),n}}()):(t.includes("Version/11")||t.includes("Version/12"))&&(eu(),function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,r){return e.call(this,t,r-.001)}}())}else tt("Tizen")&&function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"opus"!=Je(t)[0]&&e(t)}}()}),iu.prototype.createMediaKeys=function(){var e=new su(this.keySystem);return Promise.resolve(e)},iu.prototype.getConfiguration=function(){return this.a},su.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new lu(this.b,e)},su.prototype.setServerCertificate=function(e){return e&&new Uint8Array(e),Promise.resolve(!0)},G(lu,xe),(r=lu.prototype).generateRequest=function(e,t){this.a=new pe;try{this.b=this.g.createSession("video/mp4",new Uint8Array(t)),this.sessionId=this.b.sessionId||"",this.f.w(this.b,"webkitkeymessage",this.Wf.bind(this)),this.f.w(this.b,"webkitkeyadded",this.Uf.bind(this)),this.f.w(this.b,"webkitkeyerror",this.Vf.bind(this)),cu(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},r.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},r.update=function(e){this.c=new pe;try{this.b.update(new Uint8Array(e))}catch(e){this.c.reject(e)}return this.c},r.close=function(){try{this.b.close(),this.closed.resolve(),this.f.Ya()}catch(e){this.closed.reject(e)}return this.closed},r.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},r.Wf=function(e){this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Se("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},r.Uf=function(){this.c&&(cu(this,"usable"),this.c.resolve(),this.c=null)},r.Vf=function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=this.b.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.c)this.c.reject(e),this.c=null;else switch(this.b.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:cu(this,"output-not-allowed");break;default:cu(this,"internal-error")}},(r=du.prototype).forEach=function(e){this.a&&e(this.a,Xl)},r.get=function(e){if(this.has(e))return this.a},r.has=function(e){var t=Xl;return!(!this.a||!gt(new Uint8Array(e),new Uint8Array(t)))},r.entries=function(){},r.keys=function(){},r.values=function(){},Jl(function(){e.HTMLVideoElement&&e.WebKitMediaKeys&&(Xl=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=au,e.MediaKeys=su,e.MediaKeySystemAccess=iu,navigator.requestMediaKeySystemAccess=nu)}),fu.prototype.createMediaKeys=function(){var e=new gu(this.keySystem);return Promise.resolve(e)},fu.prototype.getConfiguration=function(){return this.a},gu.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new vu(this.a,e)},gu.prototype.setServerCertificate=function(){return Promise.resolve(!1)},G(vu,xe),(r=vu.prototype).generateRequest=function(e,t){this.a=new pe;try{this.c=this.g.createSession("video/mp4",new Uint8Array(t),null),this.f.w(this.c,"mskeymessage",this.nf.bind(this)),this.f.w(this.c,"mskeyadded",this.lf.bind(this)),this.f.w(this.c,"mskeyerror",this.mf.bind(this)),yu(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},r.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},r.update=function(e){this.b=new pe;try{this.c.update(new Uint8Array(e))}catch(e){this.b.reject(e)}return this.b},r.close=function(){try{this.c.close(),this.closed.resolve(),this.f.Ya()}catch(e){this.closed.reject(e)}return this.closed},r.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},r.nf=function(e){this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Se("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},r.lf=function(){this.a?(yu(this,"usable"),this.a.resolve(),this.a=null):this.b&&(yu(this,"usable"),this.b.resolve(),this.b=null)},r.mf=function(){var e=Error("EME PatchedMediaKeysMs key error");if(e.errorCode=this.c.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.b)this.b.reject(e),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:yu(this,"output-not-allowed");break;default:yu(this,"internal-error")}},(r=bu.prototype).forEach=function(e){this.a&&e(this.a,Yl)},r.get=function(e){if(this.has(e))return this.a},r.has=function(e){var t=Yl;return!(!this.a||!gt(new Uint8Array(e),new Uint8Array(t)))},r.entries=function(){},r.keys=function(){},r.values=function(){},Jl(function(){!e.HTMLVideoElement||!e.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(Yl=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=pu,e.MediaKeys=gu,e.MediaKeySystemAccess=fu,navigator.requestMediaKeySystemAccess=hu)}),Eu.prototype.createSession=function(){},Eu.prototype.setServerCertificate=function(){},xu.prototype.getConfiguration=function(){},xu.prototype.createMediaKeys=function(){},Jl(function(){!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=wu,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Su,e.MediaKeys=Eu,e.MediaKeySystemAccess=xu)},-10);var Tu,ku="";function Au(e){return ku?ku+e.charAt(0).toUpperCase()+e.slice(1):e}function Cu(e,t){try{var r=new Du(e,t);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}function ju(e){var t=this.mediaKeys;return t&&t!=e&&Lu(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Lu(e,this),Promise.resolve()}function Du(e,t){this.a=this.keySystem=e;var r=!1;"org.w3.clearkey"==e&&(this.a="webkit-org.w3.clearkey",r=!1);var n=!1,i=document.getElementsByTagName("video");i=i.length?i[0]:document.createElement("video");for(var a=0;a<t.length;++a){var s=t[a],o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:s.initDataTypes,sessionTypes:["temporary"],label:s.label},l=!1;if(s.audioCapabilities)for(var u=0;u<s.audioCapabilities.length;++u){var c=s.audioCapabilities[u];if(c.contentType){l=!0;var d=c.contentType.split(";")[0];i.canPlayType(d,this.a)&&(o.audioCapabilities.push(c),n=!0)}}if(s.videoCapabilities)for(u=0;u<s.videoCapabilities.length;++u)(c=s.videoCapabilities[u]).contentType&&(l=!0,i.canPlayType(c.contentType,this.a)&&(o.videoCapabilities.push(c),n=!0));if(l||(n=i.canPlayType("video/mp4",this.a)||i.canPlayType("video/webm",this.a)),"required"==s.persistentState&&(r?(o.persistentState="required",o.sessionTypes=["persistent-license"]):n=!1),n)return void(this.b=o)}throw r="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(r="None of the requested configurations were supported."),(r=Error(r)).name="NotSupportedError",r.code=DOMException.NOT_SUPPORTED_ERR,r}function Ru(e){this.g=e,this.b=null,this.a=new ze,this.c=[],this.f={}}function Lu(e,t){e.b=t,e.a.Ya();var r=ku;t&&(e.a.w(t,r+"needkey",e.tf.bind(e)),e.a.w(t,r+"keymessage",e.Zf.bind(e)),e.a.w(t,r+"keyadded",e.Xf.bind(e)),e.a.w(t,r+"keyerror",e.Yf.bind(e)))}function Iu(e,t){var r=e.f[t];return r||((r=e.c.shift())?(r.sessionId=t,e.f[t]=r):null)}function Ou(e,t,r){xe.call(this),this.f=e,this.h=!1,this.a=this.b=null,this.c=t,this.g=r,this.sessionId="",this.expiration=NaN,this.closed=new pe,this.keyStatuses=new Nu}function Pu(e,t,r){if(e.h)return Promise.reject(Error("The session is already initialized."));e.h=!0;try{if("persistent-license"==e.g)if(r)var n=new Uint8Array(ot("LOAD_SESSION|"+r));else{var i=ot("PERSISTENT|"),a=new Uint8Array(i.byteLength+t.byteLength);a.set(new Uint8Array(i),0),a.set(new Uint8Array(t),i.byteLength),n=a}else n=new Uint8Array(t)}catch(e){return Promise.reject(e)}e.b=new pe;var s=Au("generateKeyRequest");try{e.f[s](e.c,n)}catch(t){if("InvalidStateError"!=t.name)return e.b=null,Promise.reject(t);new ce(function(){try{e.f[s](e.c,n)}catch(t){e.b.reject(t),e.b=null}}).O(.01)}return e.b}function Mu(e,t){var r=e.keyStatuses;r.size=null==t?0:1,r.a=t,e.dispatchEvent(new Se("keystatuseschange"))}function Nu(){this.size=0,this.a=void 0}function Fu(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function Bu(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Uu(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Gu(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function zu(t,r,n){return new e.TextTrackCue(t,r,n)}function Hu(t,r,n){return new e.TextTrackCue(t+"-"+r+"-"+n,t,r,n)}function Vu(){}Du.prototype.createMediaKeys=function(){var e=new Ru(this.a);return Promise.resolve(e)},Du.prototype.getConfiguration=function(){return this.b},(r=Ru.prototype).createSession=function(e){if("temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.b||document.createElement("video");return t.src||(t.src="about:blank"),e=new Ou(t,this.g,e),this.c.push(e),e},r.setServerCertificate=function(){return Promise.resolve(!1)},r.tf=function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="webm",t.initData=e.initData,this.b.dispatchEvent(t)},r.Zf=function(e){var t=Iu(this,e.sessionId);t&&(e=new Se("message",{messageType:null==t.keyStatuses.a?"licenserequest":"licenserenewal",message:e.message}),t.b&&(t.b.resolve(),t.b=null),t.dispatchEvent(e))},r.Xf=function(e){(e=Iu(this,e.sessionId))&&(Mu(e,"usable"),e.a&&e.a.resolve(),e.a=null)},r.Yf=function(e){var t=Iu(this,e.sessionId);t&&t.handleError(e)},G(Ou,xe),(r=Ou.prototype).handleError=function(e){var t=Error("EME v0.1b key error");t.errorCode=e.errorCode,t.errorCode.systemCode=e.systemCode,!e.sessionId&&this.b?(t.method="generateRequest",45==e.systemCode&&(t.message="Unsupported session type."),this.b.reject(t),this.b=null):e.sessionId&&this.a?(t.method="update",this.a.reject(t),this.a=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Mu(this,"output-restricted"):Mu(this,1==t?"expired":"internal-error"))},r.nd=function(e,t){if(this.a)this.a.then(this.nd.bind(this,e,t)).catch(this.nd.bind(this,e,t));else{if(this.a=e,"webkit-org.w3.clearkey"==this.c){var r=it(t),n=JSON.parse(r);"oct"!=n.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),r=ht(n.keys[0].k),n=ht(n.keys[0].kid)}else r=new Uint8Array(t),n=null;var i=Au("addKey");try{this.f[i](this.c,r,n,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}},r.generateRequest=function(e,t){return Pu(this,t,null)},r.load=function(e){return"persistent-license"==this.g?Pu(this,null,e):Promise.reject(Error("Not a persistent session."))},r.update=function(e){var t=new pe;return this.nd(t,e),t},r.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Au("cancelKeyRequest");try{this.f[e](this.c,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},r.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},(r=Nu.prototype).forEach=function(e){this.a&&e(this.a,Tu)},r.get=function(e){if(this.has(e))return this.a},r.has=function(e){var t=Tu;return!(!this.a||!gt(new Uint8Array(e),new Uint8Array(t)))},r.entries=function(){},r.keys=function(){},r.values=function(){},Jl(function(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)ku="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;Tu=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=Cu,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=ju,e.MediaKeys=Ru,e.MediaKeySystemAccess=Du}}),Jl(function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=Bu,document.exitPictureInPicture=Uu,document.addEventListener("webkitpresentationmodechanged",Fu,!0))}}),Jl(function(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch(function(){}),e}}}),Jl(function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in t&&(t.getVideoPlaybackQuality=Gu)}}),Jl(function(){if(!e.VTTCue&&e.TextTrackCue){var t=TextTrackCue.length;if(3==t)e.VTTCue=zu;else if(6==t)e.VTTCue=Hu;else{try{var r=!!zu(1,2,"")}catch(e){r=!1}r&&(e.VTTCue=zu)}}}),Vu.prototype.parseInit=function(){},Vu.prototype.parseMedia=function(e,t){var r=it(e),n=[],i=new DOMParser,a=null;try{a=i.parseFromString(r,"text/xml")}catch(e){throw new fe(2,2,2005)}if(a){if(!(a=a.getElementsByTagName("tt")[0]))throw new fe(2,2,2005);var s=Yn.getAttributeNS(a,"http://www.w3.org/ns/ttml#parameter","frameRate"),o=Yn.getAttributeNS(a,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),l=Yn.getAttributeNS(a,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),u=Yn.getAttributeNS(a,"http://www.w3.org/ns/ttml#parameter","tickRate");if(r=a.getAttribute("xml:space")||"default",i=a.getAttribute("tts:extent"),"default"!=r&&"preserve"!=r)throw new fe(2,2,2005);r="default"==r,s=new dc(s,o,l,u),o=rc(a.getElementsByTagName("metadata")[0]),l=rc(a.getElementsByTagName("styling")[0]),u=rc(a.getElementsByTagName("layout")[0]);for(var c=[],d=0;d<u.length;d++){var h,f,p=u[d],g=l,m=i,v=new dr,_=p.getAttribute("xml:id");if(_)v.id=_,_=null,m&&(_=Ku.exec(m)||qu.exec(m)),m=_?Number(_[1]):null,_=_?Number(_[2]):null,(h=sc(p,g,"extent"))&&(null!=(h=(f=Ku.exec(h))||qu.exec(h))&&(v.width=null!=m?100*Number(h[1])/m:Number(h[1]),v.height=null!=_?100*Number(h[2])/_:Number(h[2]),v.widthUnits=f||null!=m?hr:0,v.heightUnits=f||null!=_?hr:0)),(p=sc(p,g,"origin"))&&(null!=(h=(f=Ku.exec(p))||qu.exec(p))&&(v.viewportAnchorX=null!=_?100*Number(h[1])/_:Number(h[1]),v.viewportAnchorY=null!=m?100*Number(h[2])/m:Number(h[2]),v.viewportAnchorUnits=f||null!=m?hr:0));else v=null;v&&c.push(v)}for(i=rc(a.getElementsByTagName("body")[0]),a=0;a<i.length;a++)(d=nc(i[a],t.periodStart,s,o,l,u,c,r))&&n.push(d)}return n};var Ku=/^(\d{1,2}|100)% (\d{1,2}|100)%$/,Wu=/^(\d+px|\d+em)$/,qu=/^(\d+)px (\d+)px$/,Xu=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Yu=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,$u=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Ju=/^(\d*(?:\.\d*)?)f$/,Qu=/^(\d*(?:\.\d*)?)t$/,Zu=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,ec={left:sr,center:"center",right:"end",start:sr,end:"end"},tc={left:"line-left",center:"center",right:"line-right"};function rc(e){var t=[];if(!e)return t;for(var r=e.childNodes,n=0;n<r.length;n++){var i="span"==r[n].nodeName&&"p"==e.nodeName;r[n].nodeType!=Node.ELEMENT_NODE||"br"==r[n].nodeName||i||(i=rc(r[n]),t=t.concat(i))}return t.length||t.push(e),t}function nc(e,t,r,n,i,a,s,o){if(!e.hasAttribute("begin")&&!e.hasAttribute("end")&&/^\s*$/.test(e.textContent))return null;!function e(t,r){for(var n=t.childNodes,i=0;i<n.length;i++)if("br"==n[i].nodeName&&0<i)n[i-1].textContent+="\n";else if(0<n[i].childNodes.length)e(n[i],r);else if(r){var a=n[i].textContent.trim();a=a.replace(/\s+/g," "),n[i].textContent=a}}(e,o),o=uc(e.getAttribute("begin"),r);var l=uc(e.getAttribute("end"),r);r=uc(e.getAttribute("dur"),r);var u=e.textContent;if(null==l&&null!=r&&(l=o+r),null==o||null==l)throw new fe(2,2,2001);if(t=new Jt(o+t,l+t,u),(a=lc(e,"region",a,""))&&a.getAttribute("xml:id")){var c=a.getAttribute("xml:id");s=s.filter(function(e){return e.id==c}),t.region=s[0]}return function(e,t,r,n,i){"rtl"==ac(t,r,i,"direction")&&(e.direction="rtl");var a=ac(t,r,i,"writingMode");"tb"==a||"tblr"==a?e.writingMode="vertical-lr":"tbrl"==a?e.writingMode="vertical-rl":"rltb"==a||"rl"==a?e.direction="rtl":a&&(e.direction=nr),(a=ac(t,r,i,"textAlign"))&&(e.positionAlign=tc[a],e.lineAlign=ec[a],e.textAlign=er[a.toUpperCase()]);(a=ac(t,r,i,"displayAlign"))&&(e.displayAlign=rr[a.toUpperCase()]);(a=ac(t,r,i,"color"))&&(e.color=a);(a=ac(t,r,i,"backgroundColor"))&&(e.backgroundColor=a);(a=ac(t,r,i,"fontFamily"))&&(e.fontFamily=a);(a=ac(t,r,i,"fontWeight"))&&"bold"==a&&(e.fontWeight=700),(a=ac(t,r,i,"wrapOption"))&&"noWrap"==a&&(e.wrapLine=!1),(a=ac(t,r,i,"lineHeight"))&&a.match(Wu)&&(e.lineHeight=a),(a=ac(t,r,i,"fontSize"))&&a.match(Wu)&&(e.fontSize=a),(a=ac(t,r,i,"fontStyle"))&&(e.fontStyle=cr[a.toUpperCase()]);if(n){a=n.getAttribute("imagetype");var s=n.getAttribute("encoding");n=n.textContent.trim(),"PNG"==a&&"Base64"==s&&n&&(e.backgroundImage="data:image/png;base64,"+n)}(r=sc(r,i,"textDecoration"))&&ic(e,r),(t=oc(t,i,"textDecoration"))&&ic(e,t)}(t,e,a,n=lc(e,"smpte:backgroundImage",n,"#"),i),t}function ic(e,t){for(var r=t.split(" "),n=0;n<r.length;n++)switch(r[n]){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&Ae(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Ae(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Ae(e.textDecoration,"overline")}}function ac(e,t,r,n){return(e=oc(e,r,n))?e:sc(t,r,n)}function sc(e,t,r){for(var n=rc(e),i=0;i<n.length;i++){var a=Yn.getAttributeNS(n[i],"http://www.w3.org/ns/ttml#styling",r);if(a)return a}return(e=lc(e,"style",t,""))?Yn.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",r):null}function oc(e,t,r){return(e=lc(e,"style",t,""))?Yn.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",r):null}function lc(e,t,r,n){if(!e||1>r.length)return null;var i=null,a=e;for(e=null;a&&!(e=a.getAttribute(t))&&(a=a.parentNode)instanceof Element;);if(t=e)for(e=0;e<r.length;e++)if(n+r[e].getAttribute("xml:id")==t){i=r[e];break}return i}function uc(e,t){var r=null;if(Xu.test(e)){r=Xu.exec(e);var n=Number(r[1]),i=Number(r[2]),a=Number(r[3]),s=Number(r[4]);r=(a+=(s+=(Number(r[5])||0)/t.b)/t.frameRate)+60*i+3600*n}else Yu.test(e)?r=cc(Yu,e):$u.test(e)?r=cc($u,e):Ju.test(e)?(r=Ju.exec(e),r=Number(r[1])/t.frameRate):Qu.test(e)?(r=Qu.exec(e),r=Number(r[1])/t.a):Zu.test(e)&&(r=cc(Zu,e));return r}function cc(e,t){var r=e.exec(t);return null==r||""==r[0]?null:(Number(r[4])||0)/1e3+(Number(r[3])||0)+60*(Number(r[2])||0)+3600*(Number(r[1])||0)}function dc(e,t,r,n){this.frameRate=Number(e)||30,this.b=Number(t)||1,this.a=Number(n),0==this.a&&(this.a=e?this.frameRate*this.b:1),r&&(e=/^(\d+) (\d+)$/g.exec(r))&&(this.frameRate*=Number(e[1])/Number(e[2]))}function hc(){this.a=new Vu}function fc(){}function pc(e,t,r){var n;(n=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=n[1],e.textAlign="middle"==t?Zt:er[t.toUpperCase()]):(n=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==n[1]?"vertical-lr":"vertical-rl":(n=/^size:([\d.]+)%$/.exec(t))?e.size=Number(n[1]):(n=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))?(e.position=Number(n[1]),n[2]&&(t=n[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center")):(n=/^region:(.*)$/.exec(t))?(t=function(e,t){var r=e.filter(function(e){return e.id==t});return r.length?r[0]:null}(r,n[1]))&&(e.region=t):(r=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(r[1]),r[2]&&(e.lineAlign=or[r[2].toUpperCase()])):(r=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=ar,e.line=Number(r[1]),r[2]&&(e.lineAlign=or[r[2].toUpperCase()]))}function gc(e){if(null==(e=Ki(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g)))return null;var t=Number(e[2]),r=Number(e[3]);return 59<t||59<r?null:Number(e[4])/1e3+r+60*t+3600*(Number(e[1])||0)}function mc(){this.a=null}function vc(e,t,r){var n,i,a;return(new zn).H("payl",Kn(function(e){n=it(e)})).H("iden",Kn(function(e){i=it(e)})).H("sttg",Kn(function(e){a=it(e)})).parse(e),n?function(e,t,r,n,i){if(e=new Jt(n,i,e),t&&(e.id=t),r)for(t=new Hi(r),r=Wi(t);r;)pc(e,r,[]),Vi(t),r=Wi(t);return e}(n,i,a,t,r):null}gr["application/ttml+xml"]=Vu,hc.prototype.parseInit=function(e){var t=!1;if((new zn).H("moov",Hn).H("trak",Hn).H("mdia",Hn).H("minf",Hn).H("stbl",Hn).fa("stsd",Vn).H("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new fe(2,2,2007)},hc.prototype.parseMedia=function(e,t){var r=!1,n=[];if((new zn).H("mdat",Kn(function(e){r=!0,n=n.concat(this.a.parseMedia(e,t))}.bind(this))).parse(e),!r)throw new fe(2,2,2007);return n},gr['application/mp4; codecs="stpp"']=hc,gr['application/mp4; codecs="stpp.TTML.im1t"']=hc,fc.prototype.parseInit=function(){},fc.prototype.parseMedia=function(e,t){var r=it(e);if(r=(r=r.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(r[0]))throw new fe(2,2,2e3);var n=t.segmentStart;if(null==n&&(n=0,r[0].includes("X-TIMESTAMP-MAP"))){var i=r[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),a=r[0].match(/MPEGTS:(\d+)/m);if(i&&a){if(null==(n=gc(new Hi(i[1]))))throw new fe(2,2,2e3);n=t.periodStart+(Number(a[1])/9e4-n)}}a=[];var s=r[0].split("\n");for(i=1;i<s.length;i++)if(/^Region:/.test(s[i])){var o=new Hi(s[i]),l=new dr;Wi(o),Vi(o);for(var u=Wi(o);u;){var c=l,d=u;(u=/^id=(.*)$/.exec(d))?c.id=u[1]:(u=/^width=(\d{1,2}|100)%$/.exec(d))?c.width=Number(u[1]):(u=/^lines=(\d+)$/.exec(d))?(c.height=Number(u[1]),c.heightUnits=2):(u=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))?(c.regionAnchorX=Number(u[1]),c.regionAnchorY=Number(u[2])):(u=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))?(c.viewportAnchorX=Number(u[1]),c.viewportAnchorY=Number(u[2])):/^scroll=up$/.exec(d)&&(c.scroll="up"),Vi(o),u=Wi(o)}a.push(l)}for(i=[],o=1;o<r.length;o++){if(u=s=r[o].split("\n"),d=n,s=a,1==u.length&&!u[0]||/^NOTE($|[ \t])/.test(u[0])||"STYLE"==u[0])s=null;else{l=null,u[0].includes("--\x3e")||(l=u[0],u.splice(0,1));var h=gc(c=new Hi(u[0])),f=Ki(c,/[ \t]+--\x3e[ \t]+/g),p=gc(c);if(null==h||null==f||null==p)throw new fe(2,2,2001);for(u=new Jt(h+d,p+d,u.slice(1).join("\n").trim()),Vi(c),d=Wi(c);d;)pc(u,d,s),Vi(c),d=Wi(c);null!=l&&(u.id=l),s=u}s&&i.push(s)}return i},gr["text/vtt"]=fc,gr['text/vtt; codecs="vtt"']=fc,mc.prototype.parseInit=function(e){var t=!1;if((new zn).H("moov",Hn).H("trak",Hn).H("mdia",Hn).fa("mdhd",function(e){0==e.version?(e.reader.L(4),e.reader.L(4),this.a=e.reader.F(),e.reader.L(4)):(e.reader.L(8),e.reader.L(8),this.a=e.reader.F(),e.reader.L(8)),e.reader.L(4)}.bind(this)).H("minf",Hn).H("stbl",Hn).fa("stsd",Vn).H("wvtt",function(){t=!0}).parse(e),!this.a)throw new fe(2,2,2008);if(!t)throw new fe(2,2,2008)},mc.prototype.parseMedia=function(e,t){var r=this;if(!this.a)throw new fe(2,2,2008);var n,i=0,a=[],s=[],o=!1,l=!1,u=!1,c=null;if((new zn).H("moof",Hn).H("traf",Hn).fa("tfdt",function(e){o=!0,i=0==e.version?e.reader.F():e.reader.yb()}).fa("tfhd",function(e){var t=e.flags;(e=e.reader).L(4),1&t&&e.L(8),2&t&&e.L(4),c=8&t?e.F():null}).fa("trun",function(e){l=!0;var t=e.version,r=e.flags,n=(e=e.reader).F();1&r&&e.L(4),4&r&&e.L(4);for(var i=[],s=0;s<n;s++){var o={duration:null,sampleSize:null,pd:null};256&r&&(o.duration=e.F()),512&r&&(o.sampleSize=e.F()),1024&r&&e.L(4),2048&r&&(o.pd=0==t?e.F():e.Xd()),i.push(o)}a=i}).H("mdat",Kn(function(e){u=!0,n=e})).parse(e),!u&&!o&&!l)throw new fe(2,2,2008);var d=i,h=new Bn(new DataView(n.buffer,n.byteOffset,n.byteLength),0);return a.forEach(function(e){var n=e.duration||c,a=e.pd?i+e.pd:d;d=a+(n||0);var o=0;do{var l=h.F();o+=l;var u=null;"vttc"==qn(h.F())?8<l&&(u=h.Xa(l-8)):h.L(l-8),n&&u&&s.push(vc(u,t.periodStart+a/r.a,t.periodStart+d/r.a))}while(e.sampleSize&&o<e.sampleSize)}),s.filter(Ht.Ga)},gr['application/mp4; codecs="wvtt"']=mc,U("shaka.util.Dom.createHTMLElement",function(e){return document.createElement(e)}),U("shaka.util.Dom.createVideoElement",function(){var e=document.createElement("video");return e.muted=!0,e.width=600,e.height=400,e}),U("shaka.util.Dom.asHTMLElement",function(e){return e}),U("shaka.util.Dom.asHTMLMediaElement",function(e){return e}),U("shaka.util.Dom.removeAllChildren",function(e){for(;e.firstChild;)e.removeChild(e.firstChild)})}.call(n,r,r),n.shaka)t[i]=n.shaka[i]}()}).call(this,r(1))},function(e,t,r){!function(){"use strict";var e,t,r,n=function(t,r){if(!(this instanceof n))return new n(t,r);var i={direction:"horizontal",touchEventsTarget:"container",initialSlide:0,speed:300,autoplay:!1,autoplayDisableOnInteraction:!0,autoplayStopOnLast:!1,iOSEdgeSwipeDetection:!1,iOSEdgeSwipeThreshold:20,freeMode:!1,freeModeMomentum:!0,freeModeMomentumRatio:1,freeModeMomentumBounce:!0,freeModeMomentumBounceRatio:1,freeModeMomentumVelocityRatio:1,freeModeSticky:!1,freeModeMinimumVelocity:.02,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",coverflow:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},flip:{slideShadows:!0,limitRotation:!0},cube:{slideShadows:!0,shadow:!0,shadowOffset:20,shadowScale:.94},fade:{crossFade:!1},parallax:!1,zoom:!1,zoomMax:3,zoomMin:1,zoomToggle:!0,scrollbar:null,scrollbarHide:!0,scrollbarDraggable:!1,scrollbarSnapOnRelease:!1,keyboardControl:!1,mousewheelControl:!1,mousewheelReleaseOnEdges:!1,mousewheelInvert:!1,mousewheelForceToAxis:!1,mousewheelSensitivity:1,mousewheelEventsTarged:"container",hashnav:!1,hashnavWatchState:!1,history:!1,replaceState:!1,breakpoints:void 0,spaceBetween:0,slidesPerView:1,slidesPerColumn:1,slidesPerColumnFill:"column",slidesPerGroup:1,centeredSlides:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,onlyExternal:!1,threshold:0,touchMoveStopPropagation:!0,touchReleaseOnEdges:!1,uniqueNavElements:!0,pagination:null,paginationElement:"span",paginationClickable:!1,paginationHide:!1,paginationBulletRender:null,paginationProgressRender:null,paginationFractionRender:null,paginationCustomRender:null,paginationType:"bullets",resistance:!0,resistanceRatio:.85,nextButton:null,prevButton:null,watchSlidesProgress:!1,watchSlidesVisibility:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,lazyLoading:!1,lazyLoadingInPrevNext:!1,lazyLoadingInPrevNextAmount:1,lazyLoadingOnTransitionStart:!1,preloadImages:!0,updateOnImagesReady:!0,loop:!1,loopAdditionalSlides:0,loopedSlides:null,control:void 0,controlInverse:!1,controlBy:"slide",normalizeSlideIndex:!0,allowSwipeToPrev:!0,allowSwipeToNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",passiveListeners:!0,containerModifierClass:"swiper-container-",slideClass:"swiper-slide",slideActiveClass:"swiper-slide-active",slideDuplicateActiveClass:"swiper-slide-duplicate-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",slideNextClass:"swiper-slide-next",slideDuplicateNextClass:"swiper-slide-duplicate-next",slidePrevClass:"swiper-slide-prev",slideDuplicatePrevClass:"swiper-slide-duplicate-prev",wrapperClass:"swiper-wrapper",bulletClass:"swiper-pagination-bullet",bulletActiveClass:"swiper-pagination-bullet-active",buttonDisabledClass:"swiper-button-disabled",paginationCurrentClass:"swiper-pagination-current",paginationTotalClass:"swiper-pagination-total",paginationHiddenClass:"swiper-pagination-hidden",paginationProgressbarClass:"swiper-pagination-progressbar",paginationClickableClass:"swiper-pagination-clickable",paginationModifierClass:"swiper-pagination-",lazyLoadingClass:"swiper-lazy",lazyStatusLoadingClass:"swiper-lazy-loading",lazyStatusLoadedClass:"swiper-lazy-loaded",lazyPreloaderClass:"swiper-lazy-preloader",notificationClass:"swiper-notification",preloaderClass:"preloader",zoomContainerClass:"swiper-zoom-container",observer:!1,observeParents:!1,a11y:!1,prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",paginationBulletMessage:"Go to slide {{index}}",runCallbacksOnInit:!0},s=r&&r.virtualTranslate;r=r||{};var o={};for(var l in r)if("object"!=typeof r[l]||null===r[l]||(r[l].nodeType||r[l]===window||r[l]===document||void 0!==a&&r[l]instanceof a||"undefined"!=typeof jQuery&&r[l]instanceof jQuery))o[l]=r[l];else for(var u in o[l]={},r[l])o[l][u]=r[l][u];for(var c in i)if(void 0===r[c])r[c]=i[c];else if("object"==typeof r[c])for(var d in i[c])void 0===r[c][d]&&(r[c][d]=i[c][d]);var h=this;if(h.params=r,h.originalParams=o,h.classNames=[],void 0!==e&&void 0!==a&&(e=a),(void 0!==e||(e=void 0===a?window.Dom7||window.Zepto||window.jQuery:a))&&(h.$=e,h.currentBreakpoint=void 0,h.getActiveBreakpoint=function(){if(!h.params.breakpoints)return!1;var e,t=!1,r=[];for(e in h.params.breakpoints)h.params.breakpoints.hasOwnProperty(e)&&r.push(e);r.sort(function(e,t){return parseInt(e,10)>parseInt(t,10)});for(var n=0;n<r.length;n++)(e=r[n])>=window.innerWidth&&!t&&(t=e);return t||"max"},h.setBreakpoint=function(){var e=h.getActiveBreakpoint();if(e&&h.currentBreakpoint!==e){var t=e in h.params.breakpoints?h.params.breakpoints[e]:h.originalParams,r=h.params.loop&&t.slidesPerView!==h.params.slidesPerView;for(var n in t)h.params[n]=t[n];h.currentBreakpoint=e,r&&h.destroyLoop&&h.reLoop(!0)}},h.params.breakpoints&&h.setBreakpoint(),h.container=e(t),0!==h.container.length)){if(h.container.length>1){var f=[];return h.container.each(function(){f.push(new n(this,r))}),f}h.container[0].swiper=h,h.container.data("swiper",h),h.classNames.push(h.params.containerModifierClass+h.params.direction),h.params.freeMode&&h.classNames.push(h.params.containerModifierClass+"free-mode"),h.support.flexbox||(h.classNames.push(h.params.containerModifierClass+"no-flexbox"),h.params.slidesPerColumn=1),h.params.autoHeight&&h.classNames.push(h.params.containerModifierClass+"autoheight"),(h.params.parallax||h.params.watchSlidesVisibility)&&(h.params.watchSlidesProgress=!0),h.params.touchReleaseOnEdges&&(h.params.resistanceRatio=0),["cube","coverflow","flip"].indexOf(h.params.effect)>=0&&(h.support.transforms3d?(h.params.watchSlidesProgress=!0,h.classNames.push(h.params.containerModifierClass+"3d")):h.params.effect="slide"),"slide"!==h.params.effect&&h.classNames.push(h.params.containerModifierClass+h.params.effect),"cube"===h.params.effect&&(h.params.resistanceRatio=0,h.params.slidesPerView=1,h.params.slidesPerColumn=1,h.params.slidesPerGroup=1,h.params.centeredSlides=!1,h.params.spaceBetween=0,h.params.virtualTranslate=!0),"fade"!==h.params.effect&&"flip"!==h.params.effect||(h.params.slidesPerView=1,h.params.slidesPerColumn=1,h.params.slidesPerGroup=1,h.params.watchSlidesProgress=!0,h.params.spaceBetween=0,void 0===s&&(h.params.virtualTranslate=!0)),h.params.grabCursor&&h.support.touch&&(h.params.grabCursor=!1),h.wrapper=h.container.children("."+h.params.wrapperClass),h.params.pagination&&(h.paginationContainer=e(h.params.pagination),h.params.uniqueNavElements&&"string"==typeof h.params.pagination&&h.paginationContainer.length>1&&1===h.container.find(h.params.pagination).length&&(h.paginationContainer=h.container.find(h.params.pagination)),"bullets"===h.params.paginationType&&h.params.paginationClickable?h.paginationContainer.addClass(h.params.paginationModifierClass+"clickable"):h.params.paginationClickable=!1,h.paginationContainer.addClass(h.params.paginationModifierClass+h.params.paginationType)),(h.params.nextButton||h.params.prevButton)&&(h.params.nextButton&&(h.nextButton=e(h.params.nextButton),h.params.uniqueNavElements&&"string"==typeof h.params.nextButton&&h.nextButton.length>1&&1===h.container.find(h.params.nextButton).length&&(h.nextButton=h.container.find(h.params.nextButton))),h.params.prevButton&&(h.prevButton=e(h.params.prevButton),h.params.uniqueNavElements&&"string"==typeof h.params.prevButton&&h.prevButton.length>1&&1===h.container.find(h.params.prevButton).length&&(h.prevButton=h.container.find(h.params.prevButton)))),h.isHorizontal=function(){return"horizontal"===h.params.direction},h.rtl=h.isHorizontal()&&("rtl"===h.container[0].dir.toLowerCase()||"rtl"===h.container.css("direction")),h.rtl&&h.classNames.push(h.params.containerModifierClass+"rtl"),h.rtl&&(h.wrongRTL="-webkit-box"===h.wrapper.css("display")),h.params.slidesPerColumn>1&&h.classNames.push(h.params.containerModifierClass+"multirow"),h.device.android&&h.classNames.push(h.params.containerModifierClass+"android"),h.container.addClass(h.classNames.join(" ")),h.translate=0,h.progress=0,h.velocity=0,h.lockSwipeToNext=function(){h.params.allowSwipeToNext=!1,!1===h.params.allowSwipeToPrev&&h.params.grabCursor&&h.unsetGrabCursor()},h.lockSwipeToPrev=function(){h.params.allowSwipeToPrev=!1,!1===h.params.allowSwipeToNext&&h.params.grabCursor&&h.unsetGrabCursor()},h.lockSwipes=function(){h.params.allowSwipeToNext=h.params.allowSwipeToPrev=!1,h.params.grabCursor&&h.unsetGrabCursor()},h.unlockSwipeToNext=function(){h.params.allowSwipeToNext=!0,!0===h.params.allowSwipeToPrev&&h.params.grabCursor&&h.setGrabCursor()},h.unlockSwipeToPrev=function(){h.params.allowSwipeToPrev=!0,!0===h.params.allowSwipeToNext&&h.params.grabCursor&&h.setGrabCursor()},h.unlockSwipes=function(){h.params.allowSwipeToNext=h.params.allowSwipeToPrev=!0,h.params.grabCursor&&h.setGrabCursor()},h.setGrabCursor=function(e){h.container[0].style.cursor="move",h.container[0].style.cursor=e?"-webkit-grabbing":"-webkit-grab",h.container[0].style.cursor=e?"-moz-grabbin":"-moz-grab",h.container[0].style.cursor=e?"grabbing":"grab"},h.unsetGrabCursor=function(){h.container[0].style.cursor=""},h.params.grabCursor&&h.setGrabCursor(),h.imagesToLoad=[],h.imagesLoaded=0,h.loadImage=function(e,t,r,n,i,a){var s;function o(){a&&a()}e.complete&&i?o():t?((s=new window.Image).onload=o,s.onerror=o,n&&(s.sizes=n),r&&(s.srcset=r),t&&(s.src=t)):o()},h.preloadImages=function(){function e(){null!=h&&h&&(void 0!==h.imagesLoaded&&h.imagesLoaded++,h.imagesLoaded===h.imagesToLoad.length&&(h.params.updateOnImagesReady&&h.update(),h.emit("onImagesReady",h)))}h.imagesToLoad=h.container.find("img");for(var t=0;t<h.imagesToLoad.length;t++)h.loadImage(h.imagesToLoad[t],h.imagesToLoad[t].currentSrc||h.imagesToLoad[t].getAttribute("src"),h.imagesToLoad[t].srcset||h.imagesToLoad[t].getAttribute("srcset"),h.imagesToLoad[t].sizes||h.imagesToLoad[t].getAttribute("sizes"),!0,e)},h.autoplayTimeoutId=void 0,h.autoplaying=!1,h.autoplayPaused=!1,h.startAutoplay=function(){return void 0===h.autoplayTimeoutId&&(!!h.params.autoplay&&(!h.autoplaying&&(h.autoplaying=!0,h.emit("onAutoplayStart",h),void L())))},h.stopAutoplay=function(e){h.autoplayTimeoutId&&(h.autoplayTimeoutId&&clearTimeout(h.autoplayTimeoutId),h.autoplaying=!1,h.autoplayTimeoutId=void 0,h.emit("onAutoplayStop",h))},h.pauseAutoplay=function(e){h.autoplayPaused||(h.autoplayTimeoutId&&clearTimeout(h.autoplayTimeoutId),h.autoplayPaused=!0,0===e?(h.autoplayPaused=!1,L()):h.wrapper.transitionEnd(function(){h&&(h.autoplayPaused=!1,h.autoplaying?L():h.stopAutoplay())}))},h.minTranslate=function(){return-h.snapGrid[0]},h.maxTranslate=function(){return-h.snapGrid[h.snapGrid.length-1]},h.updateAutoHeight=function(){var e,t=[],r=0;if("auto"!==h.params.slidesPerView&&h.params.slidesPerView>1)for(e=0;e<Math.ceil(h.params.slidesPerView);e++){var n=h.activeIndex+e;if(n>h.slides.length)break;t.push(h.slides.eq(n)[0])}else t.push(h.slides.eq(h.activeIndex)[0]);for(e=0;e<t.length;e++)if(void 0!==t[e]){var i=t[e].offsetHeight;r=i>r?i:r}r&&h.wrapper.css("height",r+"px")},h.updateContainerSize=function(){var e,t;e=void 0!==h.params.width?h.params.width:h.container[0].clientWidth,t=void 0!==h.params.height?h.params.height:h.container[0].clientHeight,0===e&&h.isHorizontal()||0===t&&!h.isHorizontal()||(e=e-parseInt(h.container.css("padding-left"),10)-parseInt(h.container.css("padding-right"),10),t=t-parseInt(h.container.css("padding-top"),10)-parseInt(h.container.css("padding-bottom"),10),h.width=e,h.height=t,h.size=h.isHorizontal()?h.width:h.height)},h.updateSlidesSize=function(){h.slides=h.wrapper.children("."+h.params.slideClass),h.snapGrid=[],h.slidesGrid=[],h.slidesSizesGrid=[];var e,t=h.params.spaceBetween,r=-h.params.slidesOffsetBefore,n=0,i=0;if(void 0!==h.size){var a,s;"string"==typeof t&&t.indexOf("%")>=0&&(t=parseFloat(t.replace("%",""))/100*h.size),h.virtualSize=-t,h.rtl?h.slides.css({marginLeft:"",marginTop:""}):h.slides.css({marginRight:"",marginBottom:""}),h.params.slidesPerColumn>1&&(a=Math.floor(h.slides.length/h.params.slidesPerColumn)===h.slides.length/h.params.slidesPerColumn?h.slides.length:Math.ceil(h.slides.length/h.params.slidesPerColumn)*h.params.slidesPerColumn,"auto"!==h.params.slidesPerView&&"row"===h.params.slidesPerColumnFill&&(a=Math.max(a,h.params.slidesPerView*h.params.slidesPerColumn)));var o,l=h.params.slidesPerColumn,u=a/l,c=u-(h.params.slidesPerColumn*u-h.slides.length);for(e=0;e<h.slides.length;e++){s=0;var d,f,p,g=h.slides.eq(e);if(h.params.slidesPerColumn>1)"column"===h.params.slidesPerColumnFill?(p=e-(f=Math.floor(e/l))*l,(f>c||f===c&&p===l-1)&&++p>=l&&(p=0,f++),d=f+p*a/l,g.css({"-webkit-box-ordinal-group":d,"-moz-box-ordinal-group":d,"-ms-flex-order":d,"-webkit-order":d,order:d})):f=e-(p=Math.floor(e/u))*u,g.css("margin-"+(h.isHorizontal()?"top":"left"),0!==p&&h.params.spaceBetween&&h.params.spaceBetween+"px").attr("data-swiper-column",f).attr("data-swiper-row",p);"none"!==g.css("display")&&("auto"===h.params.slidesPerView?(s=h.isHorizontal()?g.outerWidth(!0):g.outerHeight(!0),h.params.roundLengths&&(s=R(s))):(s=(h.size-(h.params.slidesPerView-1)*t)/h.params.slidesPerView,h.params.roundLengths&&(s=R(s)),h.isHorizontal()?h.slides[e].style.width=s+"px":h.slides[e].style.height=s+"px"),h.slides[e].swiperSlideSize=s,h.slidesSizesGrid.push(s),h.params.centeredSlides?(r=r+s/2+n/2+t,0===n&&0!==e&&(r=r-h.size/2-t),0===e&&(r=r-h.size/2-t),Math.abs(r)<.001&&(r=0),i%h.params.slidesPerGroup==0&&h.snapGrid.push(r),h.slidesGrid.push(r)):(i%h.params.slidesPerGroup==0&&h.snapGrid.push(r),h.slidesGrid.push(r),r=r+s+t),h.virtualSize+=s+t,n=s,i++)}if(h.virtualSize=Math.max(h.virtualSize,h.size)+h.params.slidesOffsetAfter,h.rtl&&h.wrongRTL&&("slide"===h.params.effect||"coverflow"===h.params.effect)&&h.wrapper.css({width:h.virtualSize+h.params.spaceBetween+"px"}),h.support.flexbox&&!h.params.setWrapperSize||(h.isHorizontal()?h.wrapper.css({width:h.virtualSize+h.params.spaceBetween+"px"}):h.wrapper.css({height:h.virtualSize+h.params.spaceBetween+"px"})),h.params.slidesPerColumn>1&&(h.virtualSize=(s+h.params.spaceBetween)*a,h.virtualSize=Math.ceil(h.virtualSize/h.params.slidesPerColumn)-h.params.spaceBetween,h.isHorizontal()?h.wrapper.css({width:h.virtualSize+h.params.spaceBetween+"px"}):h.wrapper.css({height:h.virtualSize+h.params.spaceBetween+"px"}),h.params.centeredSlides)){for(o=[],e=0;e<h.snapGrid.length;e++)h.snapGrid[e]<h.virtualSize+h.snapGrid[0]&&o.push(h.snapGrid[e]);h.snapGrid=o}if(!h.params.centeredSlides){for(o=[],e=0;e<h.snapGrid.length;e++)h.snapGrid[e]<=h.virtualSize-h.size&&o.push(h.snapGrid[e]);h.snapGrid=o,Math.floor(h.virtualSize-h.size)-Math.floor(h.snapGrid[h.snapGrid.length-1])>1&&h.snapGrid.push(h.virtualSize-h.size)}0===h.snapGrid.length&&(h.snapGrid=[0]),0!==h.params.spaceBetween&&(h.isHorizontal()?h.rtl?h.slides.css({marginLeft:t+"px"}):h.slides.css({marginRight:t+"px"}):h.slides.css({marginBottom:t+"px"})),h.params.watchSlidesProgress&&h.updateSlidesOffset()}},h.updateSlidesOffset=function(){for(var e=0;e<h.slides.length;e++)h.slides[e].swiperSlideOffset=h.isHorizontal()?h.slides[e].offsetLeft:h.slides[e].offsetTop},h.currentSlidesPerView=function(){var e,t,r=1;if(h.params.centeredSlides){var n,i=h.slides[h.activeIndex].swiperSlideSize;for(e=h.activeIndex+1;e<h.slides.length;e++)h.slides[e]&&!n&&(r++,(i+=h.slides[e].swiperSlideSize)>h.size&&(n=!0));for(t=h.activeIndex-1;t>=0;t--)h.slides[t]&&!n&&(r++,(i+=h.slides[t].swiperSlideSize)>h.size&&(n=!0))}else for(e=h.activeIndex+1;e<h.slides.length;e++)h.slidesGrid[e]-h.slidesGrid[h.activeIndex]<h.size&&r++;return r},h.updateSlidesProgress=function(e){if(void 0===e&&(e=h.translate||0),0!==h.slides.length){void 0===h.slides[0].swiperSlideOffset&&h.updateSlidesOffset();var t=-e;h.rtl&&(t=e),h.slides.removeClass(h.params.slideVisibleClass);for(var r=0;r<h.slides.length;r++){var n=h.slides[r],i=(t+(h.params.centeredSlides?h.minTranslate():0)-n.swiperSlideOffset)/(n.swiperSlideSize+h.params.spaceBetween);if(h.params.watchSlidesVisibility){var a=-(t-n.swiperSlideOffset),s=a+h.slidesSizesGrid[r];(a>=0&&a<h.size||s>0&&s<=h.size||a<=0&&s>=h.size)&&h.slides.eq(r).addClass(h.params.slideVisibleClass)}n.progress=h.rtl?-i:i}}},h.updateProgress=function(e){void 0===e&&(e=h.translate||0);var t=h.maxTranslate()-h.minTranslate(),r=h.isBeginning,n=h.isEnd;0===t?(h.progress=0,h.isBeginning=h.isEnd=!0):(h.progress=(e-h.minTranslate())/t,h.isBeginning=h.progress<=0,h.isEnd=h.progress>=1),h.isBeginning&&!r&&h.emit("onReachBeginning",h),h.isEnd&&!n&&h.emit("onReachEnd",h),h.params.watchSlidesProgress&&h.updateSlidesProgress(e),h.emit("onProgress",h,h.progress)},h.updateActiveIndex=function(){var e,t,r,n=h.rtl?h.translate:-h.translate;for(t=0;t<h.slidesGrid.length;t++)void 0!==h.slidesGrid[t+1]?n>=h.slidesGrid[t]&&n<h.slidesGrid[t+1]-(h.slidesGrid[t+1]-h.slidesGrid[t])/2?e=t:n>=h.slidesGrid[t]&&n<h.slidesGrid[t+1]&&(e=t+1):n>=h.slidesGrid[t]&&(e=t);h.params.normalizeSlideIndex&&(e<0||void 0===e)&&(e=0),(r=Math.floor(e/h.params.slidesPerGroup))>=h.snapGrid.length&&(r=h.snapGrid.length-1),e!==h.activeIndex&&(h.snapIndex=r,h.previousIndex=h.activeIndex,h.activeIndex=e,h.updateClasses(),h.updateRealIndex())},h.updateRealIndex=function(){h.realIndex=parseInt(h.slides.eq(h.activeIndex).attr("data-swiper-slide-index")||h.activeIndex,10)},h.updateClasses=function(){h.slides.removeClass(h.params.slideActiveClass+" "+h.params.slideNextClass+" "+h.params.slidePrevClass+" "+h.params.slideDuplicateActiveClass+" "+h.params.slideDuplicateNextClass+" "+h.params.slideDuplicatePrevClass);var t=h.slides.eq(h.activeIndex);t.addClass(h.params.slideActiveClass),r.loop&&(t.hasClass(h.params.slideDuplicateClass)?h.wrapper.children("."+h.params.slideClass+":not(."+h.params.slideDuplicateClass+')[data-swiper-slide-index="'+h.realIndex+'"]').addClass(h.params.slideDuplicateActiveClass):h.wrapper.children("."+h.params.slideClass+"."+h.params.slideDuplicateClass+'[data-swiper-slide-index="'+h.realIndex+'"]').addClass(h.params.slideDuplicateActiveClass));var n=t.next("."+h.params.slideClass).addClass(h.params.slideNextClass);h.params.loop&&0===n.length&&(n=h.slides.eq(0)).addClass(h.params.slideNextClass);var i=t.prev("."+h.params.slideClass).addClass(h.params.slidePrevClass);if(h.params.loop&&0===i.length&&(i=h.slides.eq(-1)).addClass(h.params.slidePrevClass),r.loop&&(n.hasClass(h.params.slideDuplicateClass)?h.wrapper.children("."+h.params.slideClass+":not(."+h.params.slideDuplicateClass+')[data-swiper-slide-index="'+n.attr("data-swiper-slide-index")+'"]').addClass(h.params.slideDuplicateNextClass):h.wrapper.children("."+h.params.slideClass+"."+h.params.slideDuplicateClass+'[data-swiper-slide-index="'+n.attr("data-swiper-slide-index")+'"]').addClass(h.params.slideDuplicateNextClass),i.hasClass(h.params.slideDuplicateClass)?h.wrapper.children("."+h.params.slideClass+":not(."+h.params.slideDuplicateClass+')[data-swiper-slide-index="'+i.attr("data-swiper-slide-index")+'"]').addClass(h.params.slideDuplicatePrevClass):h.wrapper.children("."+h.params.slideClass+"."+h.params.slideDuplicateClass+'[data-swiper-slide-index="'+i.attr("data-swiper-slide-index")+'"]').addClass(h.params.slideDuplicatePrevClass)),h.paginationContainer&&h.paginationContainer.length>0){var a,s=h.params.loop?Math.ceil((h.slides.length-2*h.loopedSlides)/h.params.slidesPerGroup):h.snapGrid.length;if(h.params.loop?((a=Math.ceil((h.activeIndex-h.loopedSlides)/h.params.slidesPerGroup))>h.slides.length-1-2*h.loopedSlides&&(a-=h.slides.length-2*h.loopedSlides),a>s-1&&(a-=s),a<0&&"bullets"!==h.params.paginationType&&(a=s+a)):a=void 0!==h.snapIndex?h.snapIndex:h.activeIndex||0,"bullets"===h.params.paginationType&&h.bullets&&h.bullets.length>0&&(h.bullets.removeClass(h.params.bulletActiveClass),h.paginationContainer.length>1?h.bullets.each(function(){e(this).index()===a&&e(this).addClass(h.params.bulletActiveClass)}):h.bullets.eq(a).addClass(h.params.bulletActiveClass)),"fraction"===h.params.paginationType&&(h.paginationContainer.find("."+h.params.paginationCurrentClass).text(a+1),h.paginationContainer.find("."+h.params.paginationTotalClass).text(s)),"progress"===h.params.paginationType){var o=(a+1)/s,l=o,u=1;h.isHorizontal()||(u=o,l=1),h.paginationContainer.find("."+h.params.paginationProgressbarClass).transform("translate3d(0,0,0) scaleX("+l+") scaleY("+u+")").transition(h.params.speed)}"custom"===h.params.paginationType&&h.params.paginationCustomRender&&(h.paginationContainer.html(h.params.paginationCustomRender(h,a+1,s)),h.emit("onPaginationRendered",h,h.paginationContainer[0]))}h.params.loop||(h.params.prevButton&&h.prevButton&&h.prevButton.length>0&&(h.isBeginning?(h.prevButton.addClass(h.params.buttonDisabledClass),h.params.a11y&&h.a11y&&h.a11y.disable(h.prevButton)):(h.prevButton.removeClass(h.params.buttonDisabledClass),h.params.a11y&&h.a11y&&h.a11y.enable(h.prevButton))),h.params.nextButton&&h.nextButton&&h.nextButton.length>0&&(h.isEnd?(h.nextButton.addClass(h.params.buttonDisabledClass),h.params.a11y&&h.a11y&&h.a11y.disable(h.nextButton)):(h.nextButton.removeClass(h.params.buttonDisabledClass),h.params.a11y&&h.a11y&&h.a11y.enable(h.nextButton))))},h.updatePagination=function(){if(h.params.pagination&&h.paginationContainer&&h.paginationContainer.length>0){var e="";if("bullets"===h.params.paginationType){for(var t=h.params.loop?Math.ceil((h.slides.length-2*h.loopedSlides)/h.params.slidesPerGroup):h.snapGrid.length,r=0;r<t;r++)h.params.paginationBulletRender?e+=h.params.paginationBulletRender(h,r,h.params.bulletClass):e+="<"+h.params.paginationElement+' class="'+h.params.bulletClass+'"></'+h.params.paginationElement+">";h.paginationContainer.html(e),h.bullets=h.paginationContainer.find("."+h.params.bulletClass),h.params.paginationClickable&&h.params.a11y&&h.a11y&&h.a11y.initPagination()}"fraction"===h.params.paginationType&&(e=h.params.paginationFractionRender?h.params.paginationFractionRender(h,h.params.paginationCurrentClass,h.params.paginationTotalClass):'<span class="'+h.params.paginationCurrentClass+'"></span> / <span class="'+h.params.paginationTotalClass+'"></span>',h.paginationContainer.html(e)),"progress"===h.params.paginationType&&(e=h.params.paginationProgressRender?h.params.paginationProgressRender(h,h.params.paginationProgressbarClass):'<span class="'+h.params.paginationProgressbarClass+'"></span>',h.paginationContainer.html(e)),"custom"!==h.params.paginationType&&h.emit("onPaginationRendered",h,h.paginationContainer[0])}},h.update=function(e){var t;h&&(h.updateContainerSize(),h.updateSlidesSize(),h.updateProgress(),h.updatePagination(),h.updateClasses(),h.params.scrollbar&&h.scrollbar&&h.scrollbar.set(),e?(h.controller&&h.controller.spline&&(h.controller.spline=void 0),h.params.freeMode?(r(),h.params.autoHeight&&h.updateAutoHeight()):(("auto"===h.params.slidesPerView||h.params.slidesPerView>1)&&h.isEnd&&!h.params.centeredSlides?h.slideTo(h.slides.length-1,0,!1,!0):h.slideTo(h.activeIndex,0,!1,!0))||r()):h.params.autoHeight&&h.updateAutoHeight());function r(){h.rtl,h.translate;t=Math.min(Math.max(h.translate,h.maxTranslate()),h.minTranslate()),h.setWrapperTranslate(t),h.updateActiveIndex(),h.updateClasses()}},h.onResize=function(e){h.params.onBeforeResize&&h.params.onBeforeResize(h),h.params.breakpoints&&h.setBreakpoint();var t=h.params.allowSwipeToPrev,r=h.params.allowSwipeToNext;h.params.allowSwipeToPrev=h.params.allowSwipeToNext=!0,h.updateContainerSize(),h.updateSlidesSize(),("auto"===h.params.slidesPerView||h.params.freeMode||e)&&h.updatePagination(),h.params.scrollbar&&h.scrollbar&&h.scrollbar.set(),h.controller&&h.controller.spline&&(h.controller.spline=void 0);var n=!1;if(h.params.freeMode){var i=Math.min(Math.max(h.translate,h.maxTranslate()),h.minTranslate());h.setWrapperTranslate(i),h.updateActiveIndex(),h.updateClasses(),h.params.autoHeight&&h.updateAutoHeight()}else h.updateClasses(),n=("auto"===h.params.slidesPerView||h.params.slidesPerView>1)&&h.isEnd&&!h.params.centeredSlides?h.slideTo(h.slides.length-1,0,!1,!0):h.slideTo(h.activeIndex,0,!1,!0);h.params.lazyLoading&&!n&&h.lazy&&h.lazy.load(),h.params.allowSwipeToPrev=t,h.params.allowSwipeToNext=r,h.params.onAfterResize&&h.params.onAfterResize(h)},h.touchEventsDesktop={start:"mousedown",move:"mousemove",end:"mouseup"},window.navigator.pointerEnabled?h.touchEventsDesktop={start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled&&(h.touchEventsDesktop={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}),h.touchEvents={start:h.support.touch||!h.params.simulateTouch?"touchstart":h.touchEventsDesktop.start,move:h.support.touch||!h.params.simulateTouch?"touchmove":h.touchEventsDesktop.move,end:h.support.touch||!h.params.simulateTouch?"touchend":h.touchEventsDesktop.end},(window.navigator.pointerEnabled||window.navigator.msPointerEnabled)&&("container"===h.params.touchEventsTarget?h.container:h.wrapper).addClass("swiper-wp8-"+h.params.direction),h.initEvents=function(e){var t=e?"off":"on",n=e?"removeEventListener":"addEventListener",i="container"===h.params.touchEventsTarget?h.container[0]:h.wrapper[0],a=h.support.touch?i:document,s=!!h.params.nested;if(h.browser.ie)i[n](h.touchEvents.start,h.onTouchStart,!1),a[n](h.touchEvents.move,h.onTouchMove,s),a[n](h.touchEvents.end,h.onTouchEnd,!1);else{if(h.support.touch){var o=!("touchstart"!==h.touchEvents.start||!h.support.passiveListener||!h.params.passiveListeners)&&{passive:!0,capture:!1};i[n](h.touchEvents.start,h.onTouchStart,o),i[n](h.touchEvents.move,h.onTouchMove,s),i[n](h.touchEvents.end,h.onTouchEnd,o)}(r.simulateTouch&&!h.device.ios&&!h.device.android||r.simulateTouch&&!h.support.touch&&h.device.ios)&&(i[n]("mousedown",h.onTouchStart,!1),document[n]("mousemove",h.onTouchMove,s),document[n]("mouseup",h.onTouchEnd,!1))}window[n]("resize",h.onResize),h.params.nextButton&&h.nextButton&&h.nextButton.length>0&&(h.nextButton[t]("click",h.onClickNext),h.params.a11y&&h.a11y&&h.nextButton[t]("keydown",h.a11y.onEnterKey)),h.params.prevButton&&h.prevButton&&h.prevButton.length>0&&(h.prevButton[t]("click",h.onClickPrev),h.params.a11y&&h.a11y&&h.prevButton[t]("keydown",h.a11y.onEnterKey)),h.params.pagination&&h.params.paginationClickable&&(h.paginationContainer[t]("click","."+h.params.bulletClass,h.onClickIndex),h.params.a11y&&h.a11y&&h.paginationContainer[t]("keydown","."+h.params.bulletClass,h.a11y.onEnterKey)),(h.params.preventClicks||h.params.preventClicksPropagation)&&i[n]("click",h.preventClicks,!0)},h.attachEvents=function(){h.initEvents()},h.detachEvents=function(){h.initEvents(!0)},h.allowClick=!0,h.preventClicks=function(e){h.allowClick||(h.params.preventClicks&&e.preventDefault(),h.params.preventClicksPropagation&&h.animating&&(e.stopPropagation(),e.stopImmediatePropagation()))},h.onClickNext=function(e){e.preventDefault(),h.isEnd&&!h.params.loop||h.slideNext()},h.onClickPrev=function(e){e.preventDefault(),h.isBeginning&&!h.params.loop||h.slidePrev()},h.onClickIndex=function(t){t.preventDefault();var r=e(this).index()*h.params.slidesPerGroup;h.params.loop&&(r+=h.loopedSlides),h.slideTo(r)},h.updateClickedSlide=function(t){var r=I(t,"."+h.params.slideClass),n=!1;if(r)for(var i=0;i<h.slides.length;i++)h.slides[i]===r&&(n=!0);if(!r||!n)return h.clickedSlide=void 0,void(h.clickedIndex=void 0);if(h.clickedSlide=r,h.clickedIndex=e(r).index(),h.params.slideToClickedSlide&&void 0!==h.clickedIndex&&h.clickedIndex!==h.activeIndex){var a,s=h.clickedIndex,o="auto"===h.params.slidesPerView?h.currentSlidesPerView():h.params.slidesPerView;if(h.params.loop){if(h.animating)return;a=parseInt(e(h.clickedSlide).attr("data-swiper-slide-index"),10),h.params.centeredSlides?s<h.loopedSlides-o/2||s>h.slides.length-h.loopedSlides+o/2?(h.fixLoop(),s=h.wrapper.children("."+h.params.slideClass+'[data-swiper-slide-index="'+a+'"]:not(.'+h.params.slideDuplicateClass+")").eq(0).index(),setTimeout(function(){h.slideTo(s)},0)):h.slideTo(s):s>h.slides.length-o?(h.fixLoop(),s=h.wrapper.children("."+h.params.slideClass+'[data-swiper-slide-index="'+a+'"]:not(.'+h.params.slideDuplicateClass+")").eq(0).index(),setTimeout(function(){h.slideTo(s)},0)):h.slideTo(s)}else h.slideTo(s)}};var p,g,m,v,_,y,b,w,S,E,x,T,k="input, select, textarea, button, video",A=Date.now(),C=[];for(var j in h.animating=!1,h.touches={startX:0,startY:0,currentX:0,currentY:0,diff:0},h.onTouchStart=function(t){if(t.originalEvent&&(t=t.originalEvent),(x="touchstart"===t.type)||!("which"in t)||3!==t.which)if(h.params.noSwiping&&I(t,"."+h.params.noSwipingClass))h.allowClick=!0;else if(!h.params.swipeHandler||I(t,h.params.swipeHandler)){var r=h.touches.currentX="touchstart"===t.type?t.targetTouches[0].pageX:t.pageX,n=h.touches.currentY="touchstart"===t.type?t.targetTouches[0].pageY:t.pageY;if(!(h.device.ios&&h.params.iOSEdgeSwipeDetection&&r<=h.params.iOSEdgeSwipeThreshold)){if(p=!0,g=!1,m=!0,_=void 0,T=void 0,h.touches.startX=r,h.touches.startY=n,v=Date.now(),h.allowClick=!0,h.updateContainerSize(),h.swipeDirection=void 0,h.params.threshold>0&&(w=!1),"touchstart"!==t.type){var i=!0;e(t.target).is(k)&&(i=!1),document.activeElement&&e(document.activeElement).is(k)&&document.activeElement.blur(),i&&t.preventDefault()}h.emit("onTouchStart",h,t)}}},h.onTouchMove=function(t){if(t.originalEvent&&(t=t.originalEvent),!x||"mousemove"!==t.type){if(t.preventedByNestedSwiper)return h.touches.startX="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,void(h.touches.startY="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY);if(h.params.onlyExternal)return h.allowClick=!1,void(p&&(h.touches.startX=h.touches.currentX="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,h.touches.startY=h.touches.currentY="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY,v=Date.now()));if(x&&h.params.touchReleaseOnEdges&&!h.params.loop)if(h.isHorizontal()){if(h.touches.currentX<h.touches.startX&&h.translate<=h.maxTranslate()||h.touches.currentX>h.touches.startX&&h.translate>=h.minTranslate())return}else if(h.touches.currentY<h.touches.startY&&h.translate<=h.maxTranslate()||h.touches.currentY>h.touches.startY&&h.translate>=h.minTranslate())return;if(x&&document.activeElement&&t.target===document.activeElement&&e(t.target).is(k))return g=!0,void(h.allowClick=!1);if(m&&h.emit("onTouchMove",h,t),!(t.targetTouches&&t.targetTouches.length>1)){var n;if(h.touches.currentX="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,h.touches.currentY="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY,void 0===_)h.isHorizontal()&&h.touches.currentY===h.touches.startY||!h.isHorizontal()&&h.touches.currentX===h.touches.startX?_=!1:(n=180*Math.atan2(Math.abs(h.touches.currentY-h.touches.startY),Math.abs(h.touches.currentX-h.touches.startX))/Math.PI,_=h.isHorizontal()?n>h.params.touchAngle:90-n>h.params.touchAngle);if(_&&h.emit("onTouchMoveOpposite",h,t),void 0===T&&(h.touches.currentX===h.touches.startX&&h.touches.currentY===h.touches.startY||(T=!0)),p)if(_)p=!1;else if(T){h.allowClick=!1,h.emit("onSliderMove",h,t),t.preventDefault(),h.params.touchMoveStopPropagation&&!h.params.nested&&t.stopPropagation(),g||(r.loop&&h.fixLoop(),b=h.getWrapperTranslate(),h.setWrapperTransition(0),h.animating&&h.wrapper.trigger("webkitTransitionEnd transitionend oTransitionEnd MSTransitionEnd msTransitionEnd"),h.params.autoplay&&h.autoplaying&&(h.params.autoplayDisableOnInteraction?h.stopAutoplay():h.pauseAutoplay()),E=!1,!h.params.grabCursor||!0!==h.params.allowSwipeToNext&&!0!==h.params.allowSwipeToPrev||h.setGrabCursor(!0)),g=!0;var i=h.touches.diff=h.isHorizontal()?h.touches.currentX-h.touches.startX:h.touches.currentY-h.touches.startY;i*=h.params.touchRatio,h.rtl&&(i=-i),h.swipeDirection=i>0?"prev":"next",y=i+b;var a=!0;if(i>0&&y>h.minTranslate()?(a=!1,h.params.resistance&&(y=h.minTranslate()-1+Math.pow(-h.minTranslate()+b+i,h.params.resistanceRatio))):i<0&&y<h.maxTranslate()&&(a=!1,h.params.resistance&&(y=h.maxTranslate()+1-Math.pow(h.maxTranslate()-b-i,h.params.resistanceRatio))),a&&(t.preventedByNestedSwiper=!0),!h.params.allowSwipeToNext&&"next"===h.swipeDirection&&y<b&&(y=b),!h.params.allowSwipeToPrev&&"prev"===h.swipeDirection&&y>b&&(y=b),h.params.threshold>0){if(!(Math.abs(i)>h.params.threshold||w))return void(y=b);if(!w)return w=!0,h.touches.startX=h.touches.currentX,h.touches.startY=h.touches.currentY,y=b,void(h.touches.diff=h.isHorizontal()?h.touches.currentX-h.touches.startX:h.touches.currentY-h.touches.startY)}h.params.followFinger&&((h.params.freeMode||h.params.watchSlidesProgress)&&h.updateActiveIndex(),h.params.freeMode&&(0===C.length&&C.push({position:h.touches[h.isHorizontal()?"startX":"startY"],time:v}),C.push({position:h.touches[h.isHorizontal()?"currentX":"currentY"],time:(new window.Date).getTime()})),h.updateProgress(y),h.setWrapperTranslate(y))}}}},h.onTouchEnd=function(t){if(t.originalEvent&&(t=t.originalEvent),m&&h.emit("onTouchEnd",h,t),m=!1,p){h.params.grabCursor&&g&&p&&(!0===h.params.allowSwipeToNext||!0===h.params.allowSwipeToPrev)&&h.setGrabCursor(!1);var r,n=Date.now(),i=n-v;if(h.allowClick&&(h.updateClickedSlide(t),h.emit("onTap",h,t),i<300&&n-A>300&&(S&&clearTimeout(S),S=setTimeout(function(){h&&(h.params.paginationHide&&h.paginationContainer.length>0&&!e(t.target).hasClass(h.params.bulletClass)&&h.paginationContainer.toggleClass(h.params.paginationHiddenClass),h.emit("onClick",h,t))},300)),i<300&&n-A<300&&(S&&clearTimeout(S),h.emit("onDoubleTap",h,t))),A=Date.now(),setTimeout(function(){h&&(h.allowClick=!0)},0),p&&g&&h.swipeDirection&&0!==h.touches.diff&&y!==b)if(p=g=!1,r=h.params.followFinger?h.rtl?h.translate:-h.translate:-y,h.params.freeMode){if(r<-h.minTranslate())return void h.slideTo(h.activeIndex);if(r>-h.maxTranslate())return void(h.slides.length<h.snapGrid.length?h.slideTo(h.snapGrid.length-1):h.slideTo(h.slides.length-1));if(h.params.freeModeMomentum){if(C.length>1){var a=C.pop(),s=C.pop(),o=a.position-s.position,l=a.time-s.time;h.velocity=o/l,h.velocity=h.velocity/2,Math.abs(h.velocity)<h.params.freeModeMinimumVelocity&&(h.velocity=0),(l>150||(new window.Date).getTime()-a.time>300)&&(h.velocity=0)}else h.velocity=0;h.velocity=h.velocity*h.params.freeModeMomentumVelocityRatio,C.length=0;var u=1e3*h.params.freeModeMomentumRatio,c=h.velocity*u,d=h.translate+c;h.rtl&&(d=-d);var f,_=!1,w=20*Math.abs(h.velocity)*h.params.freeModeMomentumBounceRatio;if(d<h.maxTranslate())h.params.freeModeMomentumBounce?(d+h.maxTranslate()<-w&&(d=h.maxTranslate()-w),f=h.maxTranslate(),_=!0,E=!0):d=h.maxTranslate();else if(d>h.minTranslate())h.params.freeModeMomentumBounce?(d-h.minTranslate()>w&&(d=h.minTranslate()+w),f=h.minTranslate(),_=!0,E=!0):d=h.minTranslate();else if(h.params.freeModeSticky){var x,T=0;for(T=0;T<h.snapGrid.length;T+=1)if(h.snapGrid[T]>-d){x=T;break}d=Math.abs(h.snapGrid[x]-d)<Math.abs(h.snapGrid[x-1]-d)||"next"===h.swipeDirection?h.snapGrid[x]:h.snapGrid[x-1],h.rtl||(d=-d)}if(0!==h.velocity)u=h.rtl?Math.abs((-d-h.translate)/h.velocity):Math.abs((d-h.translate)/h.velocity);else if(h.params.freeModeSticky)return void h.slideReset();h.params.freeModeMomentumBounce&&_?(h.updateProgress(f),h.setWrapperTransition(u),h.setWrapperTranslate(d),h.onTransitionStart(),h.animating=!0,h.wrapper.transitionEnd(function(){h&&E&&(h.emit("onMomentumBounce",h),h.setWrapperTransition(h.params.speed),h.setWrapperTranslate(f),h.wrapper.transitionEnd(function(){h&&h.onTransitionEnd()}))})):h.velocity?(h.updateProgress(d),h.setWrapperTransition(u),h.setWrapperTranslate(d),h.onTransitionStart(),h.animating||(h.animating=!0,h.wrapper.transitionEnd(function(){h&&h.onTransitionEnd()}))):h.updateProgress(d),h.updateActiveIndex()}(!h.params.freeModeMomentum||i>=h.params.longSwipesMs)&&(h.updateProgress(),h.updateActiveIndex())}else{var k,j=0,D=h.slidesSizesGrid[0];for(k=0;k<h.slidesGrid.length;k+=h.params.slidesPerGroup)void 0!==h.slidesGrid[k+h.params.slidesPerGroup]?r>=h.slidesGrid[k]&&r<h.slidesGrid[k+h.params.slidesPerGroup]&&(j=k,D=h.slidesGrid[k+h.params.slidesPerGroup]-h.slidesGrid[k]):r>=h.slidesGrid[k]&&(j=k,D=h.slidesGrid[h.slidesGrid.length-1]-h.slidesGrid[h.slidesGrid.length-2]);var R=(r-h.slidesGrid[j])/D;if(i>h.params.longSwipesMs){if(!h.params.longSwipes)return void h.slideTo(h.activeIndex);"next"===h.swipeDirection&&(R>=h.params.longSwipesRatio?h.slideTo(j+h.params.slidesPerGroup):h.slideTo(j)),"prev"===h.swipeDirection&&(R>1-h.params.longSwipesRatio?h.slideTo(j+h.params.slidesPerGroup):h.slideTo(j))}else{if(!h.params.shortSwipes)return void h.slideTo(h.activeIndex);"next"===h.swipeDirection&&h.slideTo(j+h.params.slidesPerGroup),"prev"===h.swipeDirection&&h.slideTo(j)}}else p=g=!1}},h._slideTo=function(e,t){return h.slideTo(e,t,!0,!0)},h.slideTo=function(e,t,r,n){void 0===r&&(r=!0),void 0===e&&(e=0),e<0&&(e=0),h.snapIndex=Math.floor(e/h.params.slidesPerGroup),h.snapIndex>=h.snapGrid.length&&(h.snapIndex=h.snapGrid.length-1);var i=-h.snapGrid[h.snapIndex];if(h.params.autoplay&&h.autoplaying&&(n||!h.params.autoplayDisableOnInteraction?h.pauseAutoplay(t):h.stopAutoplay()),h.updateProgress(i),h.params.normalizeSlideIndex)for(var a=0;a<h.slidesGrid.length;a++)-Math.floor(100*i)>=Math.floor(100*h.slidesGrid[a])&&(e=a);return!(!h.params.allowSwipeToNext&&i<h.translate&&i<h.minTranslate())&&(!(!h.params.allowSwipeToPrev&&i>h.translate&&i>h.maxTranslate()&&(h.activeIndex||0)!==e)&&(void 0===t&&(t=h.params.speed),h.previousIndex=h.activeIndex||0,h.activeIndex=e,h.updateRealIndex(),h.rtl&&-i===h.translate||!h.rtl&&i===h.translate?(h.params.autoHeight&&h.updateAutoHeight(),h.updateClasses(),"slide"!==h.params.effect&&h.setWrapperTranslate(i),!1):(h.updateClasses(),h.onTransitionStart(r),0===t||h.browser.lteIE9?(h.setWrapperTranslate(i),h.setWrapperTransition(0),h.onTransitionEnd(r)):(h.setWrapperTranslate(i),h.setWrapperTransition(t),h.animating||(h.animating=!0,h.wrapper.transitionEnd(function(){h&&h.onTransitionEnd(r)}))),!0)))},h.onTransitionStart=function(e){void 0===e&&(e=!0),h.params.autoHeight&&h.updateAutoHeight(),h.lazy&&h.lazy.onTransitionStart(),e&&(h.emit("onTransitionStart",h),h.activeIndex!==h.previousIndex&&(h.emit("onSlideChangeStart",h),h.activeIndex>h.previousIndex?h.emit("onSlideNextStart",h):h.emit("onSlidePrevStart",h)))},h.onTransitionEnd=function(e){h.animating=!1,h.setWrapperTransition(0),void 0===e&&(e=!0),h.lazy&&h.lazy.onTransitionEnd(),e&&(h.emit("onTransitionEnd",h),h.activeIndex!==h.previousIndex&&(h.emit("onSlideChangeEnd",h),h.activeIndex>h.previousIndex?h.emit("onSlideNextEnd",h):h.emit("onSlidePrevEnd",h))),h.params.history&&h.history&&h.history.setHistory(h.params.history,h.activeIndex),h.params.hashnav&&h.hashnav&&h.hashnav.setHash()},h.slideNext=function(e,t,r){if(h.params.loop){if(h.animating)return!1;h.fixLoop();h.container[0].clientLeft;return h.slideTo(h.activeIndex+h.params.slidesPerGroup,t,e,r)}return h.slideTo(h.activeIndex+h.params.slidesPerGroup,t,e,r)},h._slideNext=function(e){return h.slideNext(!0,e,!0)},h.slidePrev=function(e,t,r){if(h.params.loop){if(h.animating)return!1;h.fixLoop();h.container[0].clientLeft;return h.slideTo(h.activeIndex-1,t,e,r)}return h.slideTo(h.activeIndex-1,t,e,r)},h._slidePrev=function(e){return h.slidePrev(!0,e,!0)},h.slideReset=function(e,t,r){return h.slideTo(h.activeIndex,t,e)},h.disableTouchControl=function(){return h.params.onlyExternal=!0,!0},h.enableTouchControl=function(){return h.params.onlyExternal=!1,!0},h.setWrapperTransition=function(e,t){h.wrapper.transition(e),"slide"!==h.params.effect&&h.effects[h.params.effect]&&h.effects[h.params.effect].setTransition(e),h.params.parallax&&h.parallax&&h.parallax.setTransition(e),h.params.scrollbar&&h.scrollbar&&h.scrollbar.setTransition(e),h.params.control&&h.controller&&h.controller.setTransition(e,t),h.emit("onSetTransition",h,e)},h.setWrapperTranslate=function(e,t,r){var n=0,i=0;h.isHorizontal()?n=h.rtl?-e:e:i=e,h.params.roundLengths&&(n=R(n),i=R(i)),h.params.virtualTranslate||(h.support.transforms3d?h.wrapper.transform("translate3d("+n+"px, "+i+"px, 0px)"):h.wrapper.transform("translate("+n+"px, "+i+"px)")),h.translate=h.isHorizontal()?n:i;var a=h.maxTranslate()-h.minTranslate();(0===a?0:(e-h.minTranslate())/a)!==h.progress&&h.updateProgress(e),t&&h.updateActiveIndex(),"slide"!==h.params.effect&&h.effects[h.params.effect]&&h.effects[h.params.effect].setTranslate(h.translate),h.params.parallax&&h.parallax&&h.parallax.setTranslate(h.translate),h.params.scrollbar&&h.scrollbar&&h.scrollbar.setTranslate(h.translate),h.params.control&&h.controller&&h.controller.setTranslate(h.translate,r),h.emit("onSetTranslate",h,h.translate)},h.getTranslate=function(e,t){var r,n,i,a;return void 0===t&&(t="x"),h.params.virtualTranslate?h.rtl?-h.translate:h.translate:(i=window.getComputedStyle(e,null),window.WebKitCSSMatrix?((n=i.transform||i.webkitTransform).split(",").length>6&&(n=n.split(", ").map(function(e){return e.replace(",",".")}).join(", ")),a=new window.WebKitCSSMatrix("none"===n?"":n)):r=(a=i.MozTransform||i.OTransform||i.MsTransform||i.msTransform||i.transform||i.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,")).toString().split(","),"x"===t&&(n=window.WebKitCSSMatrix?a.m41:16===r.length?parseFloat(r[12]):parseFloat(r[4])),"y"===t&&(n=window.WebKitCSSMatrix?a.m42:16===r.length?parseFloat(r[13]):parseFloat(r[5])),h.rtl&&n&&(n=-n),n||0)},h.getWrapperTranslate=function(e){return void 0===e&&(e=h.isHorizontal()?"x":"y"),h.getTranslate(h.wrapper[0],e)},h.observers=[],h.initObservers=function(){if(h.params.observeParents)for(var e=h.container.parents(),t=0;t<e.length;t++)O(e[t]);O(h.container[0],{childList:!1}),O(h.wrapper[0],{attributes:!1})},h.disconnectObservers=function(){for(var e=0;e<h.observers.length;e++)h.observers[e].disconnect();h.observers=[]},h.createLoop=function(){h.wrapper.children("."+h.params.slideClass+"."+h.params.slideDuplicateClass).remove();var t=h.wrapper.children("."+h.params.slideClass);"auto"!==h.params.slidesPerView||h.params.loopedSlides||(h.params.loopedSlides=t.length),h.loopedSlides=parseInt(h.params.loopedSlides||h.params.slidesPerView,10),h.loopedSlides=h.loopedSlides+h.params.loopAdditionalSlides,h.loopedSlides>t.length&&(h.loopedSlides=t.length);var r,n=[],i=[];for(t.each(function(r,a){var s=e(this);r<h.loopedSlides&&i.push(a),r<t.length&&r>=t.length-h.loopedSlides&&n.push(a),s.attr("data-swiper-slide-index",r)}),r=0;r<i.length;r++)h.wrapper.append(e(i[r].cloneNode(!0)).addClass(h.params.slideDuplicateClass));for(r=n.length-1;r>=0;r--)h.wrapper.prepend(e(n[r].cloneNode(!0)).addClass(h.params.slideDuplicateClass))},h.destroyLoop=function(){h.wrapper.children("."+h.params.slideClass+"."+h.params.slideDuplicateClass).remove(),h.slides.removeAttr("data-swiper-slide-index")},h.reLoop=function(e){var t=h.activeIndex-h.loopedSlides;h.destroyLoop(),h.createLoop(),h.updateSlidesSize(),e&&h.slideTo(t+h.loopedSlides,0,!1)},h.fixLoop=function(){var e;h.activeIndex<h.loopedSlides?(e=h.slides.length-3*h.loopedSlides+h.activeIndex,e+=h.loopedSlides,h.slideTo(e,0,!1,!0)):("auto"===h.params.slidesPerView&&h.activeIndex>=2*h.loopedSlides||h.activeIndex>h.slides.length-2*h.params.slidesPerView)&&(e=-h.slides.length+h.activeIndex+h.loopedSlides,e+=h.loopedSlides,h.slideTo(e,0,!1,!0))},h.appendSlide=function(e){if(h.params.loop&&h.destroyLoop(),"object"==typeof e&&e.length)for(var t=0;t<e.length;t++)e[t]&&h.wrapper.append(e[t]);else h.wrapper.append(e);h.params.loop&&h.createLoop(),h.params.observer&&h.support.observer||h.update(!0)},h.prependSlide=function(e){h.params.loop&&h.destroyLoop();var t=h.activeIndex+1;if("object"==typeof e&&e.length){for(var r=0;r<e.length;r++)e[r]&&h.wrapper.prepend(e[r]);t=h.activeIndex+e.length}else h.wrapper.prepend(e);h.params.loop&&h.createLoop(),h.params.observer&&h.support.observer||h.update(!0),h.slideTo(t,0,!1)},h.removeSlide=function(e){h.params.loop&&(h.destroyLoop(),h.slides=h.wrapper.children("."+h.params.slideClass));var t,r=h.activeIndex;if("object"==typeof e&&e.length){for(var n=0;n<e.length;n++)t=e[n],h.slides[t]&&h.slides.eq(t).remove(),t<r&&r--;r=Math.max(r,0)}else t=e,h.slides[t]&&h.slides.eq(t).remove(),t<r&&r--,r=Math.max(r,0);h.params.loop&&h.createLoop(),h.params.observer&&h.support.observer||h.update(!0),h.params.loop?h.slideTo(r+h.loopedSlides,0,!1):h.slideTo(r,0,!1)},h.removeAllSlides=function(){for(var e=[],t=0;t<h.slides.length;t++)e.push(t);h.removeSlide(e)},h.effects={fade:{setTranslate:function(){for(var e=0;e<h.slides.length;e++){var t=h.slides.eq(e),r=-t[0].swiperSlideOffset;h.params.virtualTranslate||(r-=h.translate);var n=0;h.isHorizontal()||(n=r,r=0);var i=h.params.fade.crossFade?Math.max(1-Math.abs(t[0].progress),0):1+Math.min(Math.max(t[0].progress,-1),0);t.css({opacity:i}).transform("translate3d("+r+"px, "+n+"px, 0px)")}},setTransition:function(e){if(h.slides.transition(e),h.params.virtualTranslate&&0!==e){var t=!1;h.slides.transitionEnd(function(){if(!t&&h){t=!0,h.animating=!1;for(var e=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],r=0;r<e.length;r++)h.wrapper.trigger(e[r])}})}}},flip:{setTranslate:function(){for(var t=0;t<h.slides.length;t++){var r=h.slides.eq(t),n=r[0].progress;h.params.flip.limitRotation&&(n=Math.max(Math.min(r[0].progress,1),-1));var i=-180*n,a=0,s=-r[0].swiperSlideOffset,o=0;if(h.isHorizontal()?h.rtl&&(i=-i):(o=s,s=0,a=-i,i=0),r[0].style.zIndex=-Math.abs(Math.round(n))+h.slides.length,h.params.flip.slideShadows){var l=h.isHorizontal()?r.find(".swiper-slide-shadow-left"):r.find(".swiper-slide-shadow-top"),u=h.isHorizontal()?r.find(".swiper-slide-shadow-right"):r.find(".swiper-slide-shadow-bottom");0===l.length&&(l=e('<div class="swiper-slide-shadow-'+(h.isHorizontal()?"left":"top")+'"></div>'),r.append(l)),0===u.length&&(u=e('<div class="swiper-slide-shadow-'+(h.isHorizontal()?"right":"bottom")+'"></div>'),r.append(u)),l.length&&(l[0].style.opacity=Math.max(-n,0)),u.length&&(u[0].style.opacity=Math.max(n,0))}r.transform("translate3d("+s+"px, "+o+"px, 0px) rotateX("+a+"deg) rotateY("+i+"deg)")}},setTransition:function(t){if(h.slides.transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t),h.params.virtualTranslate&&0!==t){var r=!1;h.slides.eq(h.activeIndex).transitionEnd(function(){if(!r&&h&&e(this).hasClass(h.params.slideActiveClass)){r=!0,h.animating=!1;for(var t=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],n=0;n<t.length;n++)h.wrapper.trigger(t[n])}})}}},cube:{setTranslate:function(){var t,r=0;h.params.cube.shadow&&(h.isHorizontal()?(0===(t=h.wrapper.find(".swiper-cube-shadow")).length&&(t=e('<div class="swiper-cube-shadow"></div>'),h.wrapper.append(t)),t.css({height:h.width+"px"})):0===(t=h.container.find(".swiper-cube-shadow")).length&&(t=e('<div class="swiper-cube-shadow"></div>'),h.container.append(t)));for(var n=0;n<h.slides.length;n++){var i=h.slides.eq(n),a=90*n,s=Math.floor(a/360);h.rtl&&(a=-a,s=Math.floor(-a/360));var o=Math.max(Math.min(i[0].progress,1),-1),l=0,u=0,c=0;n%4==0?(l=4*-s*h.size,c=0):(n-1)%4==0?(l=0,c=4*-s*h.size):(n-2)%4==0?(l=h.size+4*s*h.size,c=h.size):(n-3)%4==0&&(l=-h.size,c=3*h.size+4*h.size*s),h.rtl&&(l=-l),h.isHorizontal()||(u=l,l=0);var d="rotateX("+(h.isHorizontal()?0:-a)+"deg) rotateY("+(h.isHorizontal()?a:0)+"deg) translate3d("+l+"px, "+u+"px, "+c+"px)";if(o<=1&&o>-1&&(r=90*n+90*o,h.rtl&&(r=90*-n-90*o)),i.transform(d),h.params.cube.slideShadows){var f=h.isHorizontal()?i.find(".swiper-slide-shadow-left"):i.find(".swiper-slide-shadow-top"),p=h.isHorizontal()?i.find(".swiper-slide-shadow-right"):i.find(".swiper-slide-shadow-bottom");0===f.length&&(f=e('<div class="swiper-slide-shadow-'+(h.isHorizontal()?"left":"top")+'"></div>'),i.append(f)),0===p.length&&(p=e('<div class="swiper-slide-shadow-'+(h.isHorizontal()?"right":"bottom")+'"></div>'),i.append(p)),f.length&&(f[0].style.opacity=Math.max(-o,0)),p.length&&(p[0].style.opacity=Math.max(o,0))}}if(h.wrapper.css({"-webkit-transform-origin":"50% 50% -"+h.size/2+"px","-moz-transform-origin":"50% 50% -"+h.size/2+"px","-ms-transform-origin":"50% 50% -"+h.size/2+"px","transform-origin":"50% 50% -"+h.size/2+"px"}),h.params.cube.shadow)if(h.isHorizontal())t.transform("translate3d(0px, "+(h.width/2+h.params.cube.shadowOffset)+"px, "+-h.width/2+"px) rotateX(90deg) rotateZ(0deg) scale("+h.params.cube.shadowScale+")");else{var g=Math.abs(r)-90*Math.floor(Math.abs(r)/90),m=1.5-(Math.sin(2*g*Math.PI/360)/2+Math.cos(2*g*Math.PI/360)/2),v=h.params.cube.shadowScale,_=h.params.cube.shadowScale/m,y=h.params.cube.shadowOffset;t.transform("scale3d("+v+", 1, "+_+") translate3d(0px, "+(h.height/2+y)+"px, "+-h.height/2/_+"px) rotateX(-90deg)")}var b=h.isSafari||h.isUiWebView?-h.size/2:0;h.wrapper.transform("translate3d(0px,0,"+b+"px) rotateX("+(h.isHorizontal()?0:r)+"deg) rotateY("+(h.isHorizontal()?-r:0)+"deg)")},setTransition:function(e){h.slides.transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e),h.params.cube.shadow&&!h.isHorizontal()&&h.container.find(".swiper-cube-shadow").transition(e)}},coverflow:{setTranslate:function(){for(var t=h.translate,r=h.isHorizontal()?-t+h.width/2:-t+h.height/2,n=h.isHorizontal()?h.params.coverflow.rotate:-h.params.coverflow.rotate,i=h.params.coverflow.depth,a=0,s=h.slides.length;a<s;a++){var o=h.slides.eq(a),l=h.slidesSizesGrid[a],u=(r-o[0].swiperSlideOffset-l/2)/l*h.params.coverflow.modifier,c=h.isHorizontal()?n*u:0,d=h.isHorizontal()?0:n*u,f=-i*Math.abs(u),p=h.isHorizontal()?0:h.params.coverflow.stretch*u,g=h.isHorizontal()?h.params.coverflow.stretch*u:0;Math.abs(g)<.001&&(g=0),Math.abs(p)<.001&&(p=0),Math.abs(f)<.001&&(f=0),Math.abs(c)<.001&&(c=0),Math.abs(d)<.001&&(d=0);var m="translate3d("+g+"px,"+p+"px,"+f+"px)  rotateX("+d+"deg) rotateY("+c+"deg)";if(o.transform(m),o[0].style.zIndex=1-Math.abs(Math.round(u)),h.params.coverflow.slideShadows){var v=h.isHorizontal()?o.find(".swiper-slide-shadow-left"):o.find(".swiper-slide-shadow-top"),_=h.isHorizontal()?o.find(".swiper-slide-shadow-right"):o.find(".swiper-slide-shadow-bottom");0===v.length&&(v=e('<div class="swiper-slide-shadow-'+(h.isHorizontal()?"left":"top")+'"></div>'),o.append(v)),0===_.length&&(_=e('<div class="swiper-slide-shadow-'+(h.isHorizontal()?"right":"bottom")+'"></div>'),o.append(_)),v.length&&(v[0].style.opacity=u>0?u:0),_.length&&(_[0].style.opacity=-u>0?-u:0)}}h.browser.ie&&(h.wrapper[0].style.perspectiveOrigin=r+"px 50%")},setTransition:function(e){h.slides.transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e)}}},h.lazy={initialImageLoaded:!1,loadImageInSlide:function(t,r){if(void 0!==t&&(void 0===r&&(r=!0),0!==h.slides.length)){var n=h.slides.eq(t),i=n.find("."+h.params.lazyLoadingClass+":not(."+h.params.lazyStatusLoadedClass+"):not(."+h.params.lazyStatusLoadingClass+")");!n.hasClass(h.params.lazyLoadingClass)||n.hasClass(h.params.lazyStatusLoadedClass)||n.hasClass(h.params.lazyStatusLoadingClass)||(i=i.add(n[0])),0!==i.length&&i.each(function(){var t=e(this);t.addClass(h.params.lazyStatusLoadingClass);var i=t.attr("data-background"),a=t.attr("data-src"),s=t.attr("data-srcset"),o=t.attr("data-sizes");h.loadImage(t[0],a||i,s,o,!1,function(){if(null!=h&&h){if(i?(t.css("background-image",'url("'+i+'")'),t.removeAttr("data-background")):(s&&(t.attr("srcset",s),t.removeAttr("data-srcset")),o&&(t.attr("sizes",o),t.removeAttr("data-sizes")),a&&(t.attr("src",a),t.removeAttr("data-src"))),t.addClass(h.params.lazyStatusLoadedClass).removeClass(h.params.lazyStatusLoadingClass),n.find("."+h.params.lazyPreloaderClass+", ."+h.params.preloaderClass).remove(),h.params.loop&&r){var e=n.attr("data-swiper-slide-index");if(n.hasClass(h.params.slideDuplicateClass)){var l=h.wrapper.children('[data-swiper-slide-index="'+e+'"]:not(.'+h.params.slideDuplicateClass+")");h.lazy.loadImageInSlide(l.index(),!1)}else{var u=h.wrapper.children("."+h.params.slideDuplicateClass+'[data-swiper-slide-index="'+e+'"]');h.lazy.loadImageInSlide(u.index(),!1)}}h.emit("onLazyImageReady",h,n[0],t[0])}}),h.emit("onLazyImageLoad",h,n[0],t[0])})}},load:function(){var t,r=h.params.slidesPerView;if("auto"===r&&(r=0),h.lazy.initialImageLoaded||(h.lazy.initialImageLoaded=!0),h.params.watchSlidesVisibility)h.wrapper.children("."+h.params.slideVisibleClass).each(function(){h.lazy.loadImageInSlide(e(this).index())});else if(r>1)for(t=h.activeIndex;t<h.activeIndex+r;t++)h.slides[t]&&h.lazy.loadImageInSlide(t);else h.lazy.loadImageInSlide(h.activeIndex);if(h.params.lazyLoadingInPrevNext)if(r>1||h.params.lazyLoadingInPrevNextAmount&&h.params.lazyLoadingInPrevNextAmount>1){var n=h.params.lazyLoadingInPrevNextAmount,i=r,a=Math.min(h.activeIndex+i+Math.max(n,i),h.slides.length),s=Math.max(h.activeIndex-Math.max(i,n),0);for(t=h.activeIndex+r;t<a;t++)h.slides[t]&&h.lazy.loadImageInSlide(t);for(t=s;t<h.activeIndex;t++)h.slides[t]&&h.lazy.loadImageInSlide(t)}else{var o=h.wrapper.children("."+h.params.slideNextClass);o.length>0&&h.lazy.loadImageInSlide(o.index());var l=h.wrapper.children("."+h.params.slidePrevClass);l.length>0&&h.lazy.loadImageInSlide(l.index())}},onTransitionStart:function(){h.params.lazyLoading&&(h.params.lazyLoadingOnTransitionStart||!h.params.lazyLoadingOnTransitionStart&&!h.lazy.initialImageLoaded)&&h.lazy.load()},onTransitionEnd:function(){h.params.lazyLoading&&!h.params.lazyLoadingOnTransitionStart&&h.lazy.load()}},h.scrollbar={isTouched:!1,setDragPosition:function(e){var t=h.scrollbar,r=(h.isHorizontal()?"touchstart"===e.type||"touchmove"===e.type?e.targetTouches[0].pageX:e.pageX||e.clientX:"touchstart"===e.type||"touchmove"===e.type?e.targetTouches[0].pageY:e.pageY||e.clientY)-t.track.offset()[h.isHorizontal()?"left":"top"]-t.dragSize/2,n=-h.minTranslate()*t.moveDivider,i=-h.maxTranslate()*t.moveDivider;r<n?r=n:r>i&&(r=i),r=-r/t.moveDivider,h.updateProgress(r),h.setWrapperTranslate(r,!0)},dragStart:function(e){var t=h.scrollbar;t.isTouched=!0,e.preventDefault(),e.stopPropagation(),t.setDragPosition(e),clearTimeout(t.dragTimeout),t.track.transition(0),h.params.scrollbarHide&&t.track.css("opacity",1),h.wrapper.transition(100),t.drag.transition(100),h.emit("onScrollbarDragStart",h)},dragMove:function(e){var t=h.scrollbar;t.isTouched&&(e.preventDefault?e.preventDefault():e.returnValue=!1,t.setDragPosition(e),h.wrapper.transition(0),t.track.transition(0),t.drag.transition(0),h.emit("onScrollbarDragMove",h))},dragEnd:function(e){var t=h.scrollbar;t.isTouched&&(t.isTouched=!1,h.params.scrollbarHide&&(clearTimeout(t.dragTimeout),t.dragTimeout=setTimeout(function(){t.track.css("opacity",0),t.track.transition(400)},1e3)),h.emit("onScrollbarDragEnd",h),h.params.scrollbarSnapOnRelease&&h.slideReset())},draggableEvents:!1!==h.params.simulateTouch||h.support.touch?h.touchEvents:h.touchEventsDesktop,enableDraggable:function(){var t=h.scrollbar,r=h.support.touch?t.track:document;e(t.track).on(t.draggableEvents.start,t.dragStart),e(r).on(t.draggableEvents.move,t.dragMove),e(r).on(t.draggableEvents.end,t.dragEnd)},disableDraggable:function(){var t=h.scrollbar,r=h.support.touch?t.track:document;e(t.track).off(t.draggableEvents.start,t.dragStart),e(r).off(t.draggableEvents.move,t.dragMove),e(r).off(t.draggableEvents.end,t.dragEnd)},set:function(){if(h.params.scrollbar){var t=h.scrollbar;t.track=e(h.params.scrollbar),h.params.uniqueNavElements&&"string"==typeof h.params.scrollbar&&t.track.length>1&&1===h.container.find(h.params.scrollbar).length&&(t.track=h.container.find(h.params.scrollbar)),t.drag=t.track.find(".swiper-scrollbar-drag"),0===t.drag.length&&(t.drag=e('<div class="swiper-scrollbar-drag"></div>'),t.track.append(t.drag)),t.drag[0].style.width="",t.drag[0].style.height="",t.trackSize=h.isHorizontal()?t.track[0].offsetWidth:t.track[0].offsetHeight,t.divider=h.size/h.virtualSize,t.moveDivider=t.divider*(t.trackSize/h.size),t.dragSize=t.trackSize*t.divider,h.isHorizontal()?t.drag[0].style.width=t.dragSize+"px":t.drag[0].style.height=t.dragSize+"px",t.divider>=1?t.track[0].style.display="none":t.track[0].style.display="",h.params.scrollbarHide&&(t.track[0].style.opacity=0)}},setTranslate:function(){if(h.params.scrollbar){var e,t=h.scrollbar,r=(h.translate,t.dragSize);e=(t.trackSize-t.dragSize)*h.progress,h.rtl&&h.isHorizontal()?(e=-e)>0?(r=t.dragSize-e,e=0):-e+t.dragSize>t.trackSize&&(r=t.trackSize+e):e<0?(r=t.dragSize+e,e=0):e+t.dragSize>t.trackSize&&(r=t.trackSize-e),h.isHorizontal()?(h.support.transforms3d?t.drag.transform("translate3d("+e+"px, 0, 0)"):t.drag.transform("translateX("+e+"px)"),t.drag[0].style.width=r+"px"):(h.support.transforms3d?t.drag.transform("translate3d(0px, "+e+"px, 0)"):t.drag.transform("translateY("+e+"px)"),t.drag[0].style.height=r+"px"),h.params.scrollbarHide&&(clearTimeout(t.timeout),t.track[0].style.opacity=1,t.timeout=setTimeout(function(){t.track[0].style.opacity=0,t.track.transition(400)},1e3))}},setTransition:function(e){h.params.scrollbar&&h.scrollbar.drag.transition(e)}},h.controller={LinearSpline:function(e,t){var r,n,i,a,s,o=function(e,t){for(n=-1,r=e.length;r-n>1;)e[i=r+n>>1]<=t?n=i:r=i;return r};this.x=e,this.y=t,this.lastIndex=e.length-1;this.x.length;this.interpolate=function(e){return e?(s=o(this.x,e),a=s-1,(e-this.x[a])*(this.y[s]-this.y[a])/(this.x[s]-this.x[a])+this.y[a]):0}},getInterpolateFunction:function(e){h.controller.spline||(h.controller.spline=h.params.loop?new h.controller.LinearSpline(h.slidesGrid,e.slidesGrid):new h.controller.LinearSpline(h.snapGrid,e.snapGrid))},setTranslate:function(e,t){var r,i,a=h.params.control;function s(t){e=t.rtl&&"horizontal"===t.params.direction?-h.translate:h.translate,"slide"===h.params.controlBy&&(h.controller.getInterpolateFunction(t),i=-h.controller.spline.interpolate(-e)),i&&"container"!==h.params.controlBy||(r=(t.maxTranslate()-t.minTranslate())/(h.maxTranslate()-h.minTranslate()),i=(e-h.minTranslate())*r+t.minTranslate()),h.params.controlInverse&&(i=t.maxTranslate()-i),t.updateProgress(i),t.setWrapperTranslate(i,!1,h),t.updateActiveIndex()}if(Array.isArray(a))for(var o=0;o<a.length;o++)a[o]!==t&&a[o]instanceof n&&s(a[o]);else a instanceof n&&t!==a&&s(a)},setTransition:function(e,t){var r,i=h.params.control;function a(t){t.setWrapperTransition(e,h),0!==e&&(t.onTransitionStart(),t.wrapper.transitionEnd(function(){i&&(t.params.loop&&"slide"===h.params.controlBy&&t.fixLoop(),t.onTransitionEnd())}))}if(Array.isArray(i))for(r=0;r<i.length;r++)i[r]!==t&&i[r]instanceof n&&a(i[r]);else i instanceof n&&t!==i&&a(i)}},h.hashnav={onHashCange:function(e,t){var r=document.location.hash.replace("#","");r!==h.slides.eq(h.activeIndex).attr("data-hash")&&h.slideTo(h.wrapper.children("."+h.params.slideClass+'[data-hash="'+r+'"]').index())},attachEvents:function(t){var r=t?"off":"on";e(window)[r]("hashchange",h.hashnav.onHashCange)},setHash:function(){if(h.hashnav.initialized&&h.params.hashnav)if(h.params.replaceState&&window.history&&window.history.replaceState)window.history.replaceState(null,null,"#"+h.slides.eq(h.activeIndex).attr("data-hash")||!1);else{var e=h.slides.eq(h.activeIndex),t=e.attr("data-hash")||e.attr("data-history");document.location.hash=t||""}},init:function(){if(h.params.hashnav&&!h.params.history){h.hashnav.initialized=!0;var e=document.location.hash.replace("#","");if(e)for(var t=0,r=h.slides.length;t<r;t++){var n=h.slides.eq(t);if((n.attr("data-hash")||n.attr("data-history"))===e&&!n.hasClass(h.params.slideDuplicateClass)){var i=n.index();h.slideTo(i,0,h.params.runCallbacksOnInit,!0)}}h.params.hashnavWatchState&&h.hashnav.attachEvents()}},destroy:function(){h.params.hashnavWatchState&&h.hashnav.attachEvents(!0)}},h.history={init:function(){if(h.params.history){if(!window.history||!window.history.pushState)return h.params.history=!1,void(h.params.hashnav=!0);h.history.initialized=!0,this.paths=this.getPathValues(),(this.paths.key||this.paths.value)&&(this.scrollToSlide(0,this.paths.value,h.params.runCallbacksOnInit),h.params.replaceState||window.addEventListener("popstate",this.setHistoryPopState))}},setHistoryPopState:function(){h.history.paths=h.history.getPathValues(),h.history.scrollToSlide(h.params.speed,h.history.paths.value,!1)},getPathValues:function(){var e=window.location.pathname.slice(1).split("/"),t=e.length;return{key:e[t-2],value:e[t-1]}},setHistory:function(e,t){if(h.history.initialized&&h.params.history){var r=h.slides.eq(t),n=this.slugify(r.attr("data-history"));window.location.pathname.includes(e)||(n=e+"/"+n),h.params.replaceState?window.history.replaceState(null,null,n):window.history.pushState(null,null,n)}},slugify:function(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},scrollToSlide:function(e,t,r){if(t)for(var n=0,i=h.slides.length;n<i;n++){var a=h.slides.eq(n);if(this.slugify(a.attr("data-history"))===t&&!a.hasClass(h.params.slideDuplicateClass)){var s=a.index();h.slideTo(s,e,r)}}else h.slideTo(0,e,r)}},h.disableKeyboardControl=function(){h.params.keyboardControl=!1,e(document).off("keydown",P)},h.enableKeyboardControl=function(){h.params.keyboardControl=!0,e(document).on("keydown",P)},h.mousewheel={event:!1,lastScrollTime:(new window.Date).getTime()},h.params.mousewheelControl&&(h.mousewheel.event=navigator.userAgent.indexOf("firefox")>-1?"DOMMouseScroll":function(){var e="onwheel"in document;if(!e){var t=document.createElement("div");t.setAttribute("onwheel","return;"),e="function"==typeof t.onwheel}return!e&&document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")&&(e=document.implementation.hasFeature("Events.wheel","3.0")),e}()?"wheel":"mousewheel"),h.disableMousewheelControl=function(){if(!h.mousewheel.event)return!1;var t=h.container;return"container"!==h.params.mousewheelEventsTarged&&(t=e(h.params.mousewheelEventsTarged)),t.off(h.mousewheel.event,M),h.params.mousewheelControl=!1,!0},h.enableMousewheelControl=function(){if(!h.mousewheel.event)return!1;var t=h.container;return"container"!==h.params.mousewheelEventsTarged&&(t=e(h.params.mousewheelEventsTarged)),t.on(h.mousewheel.event,M),h.params.mousewheelControl=!0,!0},h.parallax={setTranslate:function(){h.container.children("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){N(this,h.progress)}),h.slides.each(function(){var t=e(this);t.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){N(this,Math.min(Math.max(t[0].progress,-1),1))})})},setTransition:function(t){void 0===t&&(t=h.params.speed),h.container.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){var r=e(this),n=parseInt(r.attr("data-swiper-parallax-duration"),10)||t;0===t&&(n=0),r.transition(n)})}},h.zoom={scale:1,currentScale:1,isScaling:!1,gesture:{slide:void 0,slideWidth:void 0,slideHeight:void 0,image:void 0,imageWrap:void 0,zoomMax:h.params.zoomMax},image:{isTouched:void 0,isMoved:void 0,currentX:void 0,currentY:void 0,minX:void 0,minY:void 0,maxX:void 0,maxY:void 0,width:void 0,height:void 0,startX:void 0,startY:void 0,touchesStart:{},touchesCurrent:{}},velocity:{x:void 0,y:void 0,prevPositionX:void 0,prevPositionY:void 0,prevTime:void 0},getDistanceBetweenTouches:function(e){if(e.targetTouches.length<2)return 1;var t=e.targetTouches[0].pageX,r=e.targetTouches[0].pageY,n=e.targetTouches[1].pageX,i=e.targetTouches[1].pageY;return Math.sqrt(Math.pow(n-t,2)+Math.pow(i-r,2))},onGestureStart:function(t){var r=h.zoom;if(!h.support.gestures){if("touchstart"!==t.type||"touchstart"===t.type&&t.targetTouches.length<2)return;r.gesture.scaleStart=r.getDistanceBetweenTouches(t)}r.gesture.slide&&r.gesture.slide.length||(r.gesture.slide=e(this),0===r.gesture.slide.length&&(r.gesture.slide=h.slides.eq(h.activeIndex)),r.gesture.image=r.gesture.slide.find("img, svg, canvas"),r.gesture.imageWrap=r.gesture.image.parent("."+h.params.zoomContainerClass),r.gesture.zoomMax=r.gesture.imageWrap.attr("data-swiper-zoom")||h.params.zoomMax,0!==r.gesture.imageWrap.length)?(r.gesture.image.transition(0),r.isScaling=!0):r.gesture.image=void 0},onGestureChange:function(e){var t=h.zoom;if(!h.support.gestures){if("touchmove"!==e.type||"touchmove"===e.type&&e.targetTouches.length<2)return;t.gesture.scaleMove=t.getDistanceBetweenTouches(e)}t.gesture.image&&0!==t.gesture.image.length&&(h.support.gestures?t.scale=e.scale*t.currentScale:t.scale=t.gesture.scaleMove/t.gesture.scaleStart*t.currentScale,t.scale>t.gesture.zoomMax&&(t.scale=t.gesture.zoomMax-1+Math.pow(t.scale-t.gesture.zoomMax+1,.5)),t.scale<h.params.zoomMin&&(t.scale=h.params.zoomMin+1-Math.pow(h.params.zoomMin-t.scale+1,.5)),t.gesture.image.transform("translate3d(0,0,0) scale("+t.scale+")"))},onGestureEnd:function(e){var t=h.zoom;!h.support.gestures&&("touchend"!==e.type||"touchend"===e.type&&e.changedTouches.length<2)||t.gesture.image&&0!==t.gesture.image.length&&(t.scale=Math.max(Math.min(t.scale,t.gesture.zoomMax),h.params.zoomMin),t.gesture.image.transition(h.params.speed).transform("translate3d(0,0,0) scale("+t.scale+")"),t.currentScale=t.scale,t.isScaling=!1,1===t.scale&&(t.gesture.slide=void 0))},onTouchStart:function(e,t){var r=e.zoom;r.gesture.image&&0!==r.gesture.image.length&&(r.image.isTouched||("android"===e.device.os&&t.preventDefault(),r.image.isTouched=!0,r.image.touchesStart.x="touchstart"===t.type?t.targetTouches[0].pageX:t.pageX,r.image.touchesStart.y="touchstart"===t.type?t.targetTouches[0].pageY:t.pageY))},onTouchMove:function(e){var t=h.zoom;if(t.gesture.image&&0!==t.gesture.image.length&&(h.allowClick=!1,t.image.isTouched&&t.gesture.slide)){t.image.isMoved||(t.image.width=t.gesture.image[0].offsetWidth,t.image.height=t.gesture.image[0].offsetHeight,t.image.startX=h.getTranslate(t.gesture.imageWrap[0],"x")||0,t.image.startY=h.getTranslate(t.gesture.imageWrap[0],"y")||0,t.gesture.slideWidth=t.gesture.slide[0].offsetWidth,t.gesture.slideHeight=t.gesture.slide[0].offsetHeight,t.gesture.imageWrap.transition(0),h.rtl&&(t.image.startX=-t.image.startX),h.rtl&&(t.image.startY=-t.image.startY));var r=t.image.width*t.scale,n=t.image.height*t.scale;if(!(r<t.gesture.slideWidth&&n<t.gesture.slideHeight)){if(t.image.minX=Math.min(t.gesture.slideWidth/2-r/2,0),t.image.maxX=-t.image.minX,t.image.minY=Math.min(t.gesture.slideHeight/2-n/2,0),t.image.maxY=-t.image.minY,t.image.touchesCurrent.x="touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,t.image.touchesCurrent.y="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY,!t.image.isMoved&&!t.isScaling){if(h.isHorizontal()&&Math.floor(t.image.minX)===Math.floor(t.image.startX)&&t.image.touchesCurrent.x<t.image.touchesStart.x||Math.floor(t.image.maxX)===Math.floor(t.image.startX)&&t.image.touchesCurrent.x>t.image.touchesStart.x)return void(t.image.isTouched=!1);if(!h.isHorizontal()&&Math.floor(t.image.minY)===Math.floor(t.image.startY)&&t.image.touchesCurrent.y<t.image.touchesStart.y||Math.floor(t.image.maxY)===Math.floor(t.image.startY)&&t.image.touchesCurrent.y>t.image.touchesStart.y)return void(t.image.isTouched=!1)}e.preventDefault(),e.stopPropagation(),t.image.isMoved=!0,t.image.currentX=t.image.touchesCurrent.x-t.image.touchesStart.x+t.image.startX,t.image.currentY=t.image.touchesCurrent.y-t.image.touchesStart.y+t.image.startY,t.image.currentX<t.image.minX&&(t.image.currentX=t.image.minX+1-Math.pow(t.image.minX-t.image.currentX+1,.8)),t.image.currentX>t.image.maxX&&(t.image.currentX=t.image.maxX-1+Math.pow(t.image.currentX-t.image.maxX+1,.8)),t.image.currentY<t.image.minY&&(t.image.currentY=t.image.minY+1-Math.pow(t.image.minY-t.image.currentY+1,.8)),t.image.currentY>t.image.maxY&&(t.image.currentY=t.image.maxY-1+Math.pow(t.image.currentY-t.image.maxY+1,.8)),t.velocity.prevPositionX||(t.velocity.prevPositionX=t.image.touchesCurrent.x),t.velocity.prevPositionY||(t.velocity.prevPositionY=t.image.touchesCurrent.y),t.velocity.prevTime||(t.velocity.prevTime=Date.now()),t.velocity.x=(t.image.touchesCurrent.x-t.velocity.prevPositionX)/(Date.now()-t.velocity.prevTime)/2,t.velocity.y=(t.image.touchesCurrent.y-t.velocity.prevPositionY)/(Date.now()-t.velocity.prevTime)/2,Math.abs(t.image.touchesCurrent.x-t.velocity.prevPositionX)<2&&(t.velocity.x=0),Math.abs(t.image.touchesCurrent.y-t.velocity.prevPositionY)<2&&(t.velocity.y=0),t.velocity.prevPositionX=t.image.touchesCurrent.x,t.velocity.prevPositionY=t.image.touchesCurrent.y,t.velocity.prevTime=Date.now(),t.gesture.imageWrap.transform("translate3d("+t.image.currentX+"px, "+t.image.currentY+"px,0)")}}},onTouchEnd:function(e,t){var r=e.zoom;if(r.gesture.image&&0!==r.gesture.image.length){if(!r.image.isTouched||!r.image.isMoved)return r.image.isTouched=!1,void(r.image.isMoved=!1);r.image.isTouched=!1,r.image.isMoved=!1;var n=300,i=300,a=r.velocity.x*n,s=r.image.currentX+a,o=r.velocity.y*i,l=r.image.currentY+o;0!==r.velocity.x&&(n=Math.abs((s-r.image.currentX)/r.velocity.x)),0!==r.velocity.y&&(i=Math.abs((l-r.image.currentY)/r.velocity.y));var u=Math.max(n,i);r.image.currentX=s,r.image.currentY=l;var c=r.image.width*r.scale,d=r.image.height*r.scale;r.image.minX=Math.min(r.gesture.slideWidth/2-c/2,0),r.image.maxX=-r.image.minX,r.image.minY=Math.min(r.gesture.slideHeight/2-d/2,0),r.image.maxY=-r.image.minY,r.image.currentX=Math.max(Math.min(r.image.currentX,r.image.maxX),r.image.minX),r.image.currentY=Math.max(Math.min(r.image.currentY,r.image.maxY),r.image.minY),r.gesture.imageWrap.transition(u).transform("translate3d("+r.image.currentX+"px, "+r.image.currentY+"px,0)")}},onTransitionEnd:function(e){var t=e.zoom;t.gesture.slide&&e.previousIndex!==e.activeIndex&&(t.gesture.image.transform("translate3d(0,0,0) scale(1)"),t.gesture.imageWrap.transform("translate3d(0,0,0)"),t.gesture.slide=t.gesture.image=t.gesture.imageWrap=void 0,t.scale=t.currentScale=1)},toggleZoom:function(t,r){var n,i,a,s,o,l,u,c,d,h,f,p,g,m,v,_,y=t.zoom;(y.gesture.slide||(y.gesture.slide=t.clickedSlide?e(t.clickedSlide):t.slides.eq(t.activeIndex),y.gesture.image=y.gesture.slide.find("img, svg, canvas"),y.gesture.imageWrap=y.gesture.image.parent("."+t.params.zoomContainerClass)),y.gesture.image&&0!==y.gesture.image.length)&&(void 0===y.image.touchesStart.x&&r?(n="touchend"===r.type?r.changedTouches[0].pageX:r.pageX,i="touchend"===r.type?r.changedTouches[0].pageY:r.pageY):(n=y.image.touchesStart.x,i=y.image.touchesStart.y),y.scale&&1!==y.scale?(y.scale=y.currentScale=1,y.gesture.imageWrap.transition(300).transform("translate3d(0,0,0)"),y.gesture.image.transition(300).transform("translate3d(0,0,0) scale(1)"),y.gesture.slide=void 0):(y.scale=y.currentScale=y.gesture.imageWrap.attr("data-swiper-zoom")||t.params.zoomMax,r?(v=y.gesture.slide[0].offsetWidth,_=y.gesture.slide[0].offsetHeight,a=y.gesture.slide.offset().left+v/2-n,s=y.gesture.slide.offset().top+_/2-i,u=y.gesture.image[0].offsetWidth,c=y.gesture.image[0].offsetHeight,d=u*y.scale,h=c*y.scale,g=-(f=Math.min(v/2-d/2,0)),m=-(p=Math.min(_/2-h/2,0)),(o=a*y.scale)<f&&(o=f),o>g&&(o=g),(l=s*y.scale)<p&&(l=p),l>m&&(l=m)):(o=0,l=0),y.gesture.imageWrap.transition(300).transform("translate3d("+o+"px, "+l+"px,0)"),y.gesture.image.transition(300).transform("translate3d(0,0,0) scale("+y.scale+")")))},attachEvents:function(t){var r=t?"off":"on";if(h.params.zoom){h.slides;var n=!("touchstart"!==h.touchEvents.start||!h.support.passiveListener||!h.params.passiveListeners)&&{passive:!0,capture:!1};h.support.gestures?(h.slides[r]("gesturestart",h.zoom.onGestureStart,n),h.slides[r]("gesturechange",h.zoom.onGestureChange,n),h.slides[r]("gestureend",h.zoom.onGestureEnd,n)):"touchstart"===h.touchEvents.start&&(h.slides[r](h.touchEvents.start,h.zoom.onGestureStart,n),h.slides[r](h.touchEvents.move,h.zoom.onGestureChange,n),h.slides[r](h.touchEvents.end,h.zoom.onGestureEnd,n)),h[r]("touchStart",h.zoom.onTouchStart),h.slides.each(function(t,n){e(n).find("."+h.params.zoomContainerClass).length>0&&e(n)[r](h.touchEvents.move,h.zoom.onTouchMove)}),h[r]("touchEnd",h.zoom.onTouchEnd),h[r]("transitionEnd",h.zoom.onTransitionEnd),h.params.zoomToggle&&h.on("doubleTap",h.zoom.toggleZoom)}},init:function(){h.zoom.attachEvents()},destroy:function(){h.zoom.attachEvents(!0)}},h._plugins=[],h.plugins){var D=h.plugins[j](h,h.params[j]);D&&h._plugins.push(D)}return h.callPlugins=function(e){for(var t=0;t<h._plugins.length;t++)e in h._plugins[t]&&h._plugins[t][e](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},h.emitterEventListeners={},h.emit=function(e){var t;if(h.params[e]&&h.params[e](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),h.emitterEventListeners[e])for(t=0;t<h.emitterEventListeners[e].length;t++)h.emitterEventListeners[e][t](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);h.callPlugins&&h.callPlugins(e,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},h.on=function(e,t){return e=F(e),h.emitterEventListeners[e]||(h.emitterEventListeners[e]=[]),h.emitterEventListeners[e].push(t),h},h.off=function(e,t){var r;if(e=F(e),void 0===t)return h.emitterEventListeners[e]=[],h;if(h.emitterEventListeners[e]&&0!==h.emitterEventListeners[e].length){for(r=0;r<h.emitterEventListeners[e].length;r++)h.emitterEventListeners[e][r]===t&&h.emitterEventListeners[e].splice(r,1);return h}},h.once=function(e,t){e=F(e);var r=function(){t(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]),h.off(e,r)};return h.on(e,r),h},h.a11y={makeFocusable:function(e){return e.attr("tabIndex","0"),e},addRole:function(e,t){return e.attr("role",t),e},addLabel:function(e,t){return e.attr("aria-label",t),e},disable:function(e){return e.attr("aria-disabled",!0),e},enable:function(e){return e.attr("aria-disabled",!1),e},onEnterKey:function(t){13===t.keyCode&&(e(t.target).is(h.params.nextButton)?(h.onClickNext(t),h.isEnd?h.a11y.notify(h.params.lastSlideMessage):h.a11y.notify(h.params.nextSlideMessage)):e(t.target).is(h.params.prevButton)&&(h.onClickPrev(t),h.isBeginning?h.a11y.notify(h.params.firstSlideMessage):h.a11y.notify(h.params.prevSlideMessage)),e(t.target).is("."+h.params.bulletClass)&&e(t.target)[0].click())},liveRegion:e('<span class="'+h.params.notificationClass+'" aria-live="assertive" aria-atomic="true"></span>'),notify:function(e){var t=h.a11y.liveRegion;0!==t.length&&(t.html(""),t.html(e))},init:function(){h.params.nextButton&&h.nextButton&&h.nextButton.length>0&&(h.a11y.makeFocusable(h.nextButton),h.a11y.addRole(h.nextButton,"button"),h.a11y.addLabel(h.nextButton,h.params.nextSlideMessage)),h.params.prevButton&&h.prevButton&&h.prevButton.length>0&&(h.a11y.makeFocusable(h.prevButton),h.a11y.addRole(h.prevButton,"button"),h.a11y.addLabel(h.prevButton,h.params.prevSlideMessage)),e(h.container).append(h.a11y.liveRegion)},initPagination:function(){h.params.pagination&&h.params.paginationClickable&&h.bullets&&h.bullets.length&&h.bullets.each(function(){var t=e(this);h.a11y.makeFocusable(t),h.a11y.addRole(t,"button"),h.a11y.addLabel(t,h.params.paginationBulletMessage.replace(/{{index}}/,t.index()+1))})},destroy:function(){h.a11y.liveRegion&&h.a11y.liveRegion.length>0&&h.a11y.liveRegion.remove()}},h.init=function(){h.params.loop&&h.createLoop(),h.updateContainerSize(),h.updateSlidesSize(),h.updatePagination(),h.params.scrollbar&&h.scrollbar&&(h.scrollbar.set(),h.params.scrollbarDraggable&&h.scrollbar.enableDraggable()),"slide"!==h.params.effect&&h.effects[h.params.effect]&&(h.params.loop||h.updateProgress(),h.effects[h.params.effect].setTranslate()),h.params.loop?h.slideTo(h.params.initialSlide+h.loopedSlides,0,h.params.runCallbacksOnInit):(h.slideTo(h.params.initialSlide,0,h.params.runCallbacksOnInit),0===h.params.initialSlide&&(h.parallax&&h.params.parallax&&h.parallax.setTranslate(),h.lazy&&h.params.lazyLoading&&(h.lazy.load(),h.lazy.initialImageLoaded=!0))),h.attachEvents(),h.params.observer&&h.support.observer&&h.initObservers(),h.params.preloadImages&&!h.params.lazyLoading&&h.preloadImages(),h.params.zoom&&h.zoom&&h.zoom.init(),h.params.autoplay&&h.startAutoplay(),h.params.keyboardControl&&h.enableKeyboardControl&&h.enableKeyboardControl(),h.params.mousewheelControl&&h.enableMousewheelControl&&h.enableMousewheelControl(),h.params.hashnavReplaceState&&(h.params.replaceState=h.params.hashnavReplaceState),h.params.history&&h.history&&h.history.init(),h.params.hashnav&&h.hashnav&&h.hashnav.init(),h.params.a11y&&h.a11y&&h.a11y.init(),h.emit("onInit",h)},h.cleanupStyles=function(){h.container.removeClass(h.classNames.join(" ")).removeAttr("style"),h.wrapper.removeAttr("style"),h.slides&&h.slides.length&&h.slides.removeClass([h.params.slideVisibleClass,h.params.slideActiveClass,h.params.slideNextClass,h.params.slidePrevClass].join(" ")).removeAttr("style").removeAttr("data-swiper-column").removeAttr("data-swiper-row"),h.paginationContainer&&h.paginationContainer.length&&h.paginationContainer.removeClass(h.params.paginationHiddenClass),h.bullets&&h.bullets.length&&h.bullets.removeClass(h.params.bulletActiveClass),h.params.prevButton&&e(h.params.prevButton).removeClass(h.params.buttonDisabledClass),h.params.nextButton&&e(h.params.nextButton).removeClass(h.params.buttonDisabledClass),h.params.scrollbar&&h.scrollbar&&(h.scrollbar.track&&h.scrollbar.track.length&&h.scrollbar.track.removeAttr("style"),h.scrollbar.drag&&h.scrollbar.drag.length&&h.scrollbar.drag.removeAttr("style"))},h.destroy=function(e,t){h.detachEvents(),h.stopAutoplay(),h.params.scrollbar&&h.scrollbar&&h.params.scrollbarDraggable&&h.scrollbar.disableDraggable(),h.params.loop&&h.destroyLoop(),t&&h.cleanupStyles(),h.disconnectObservers(),h.params.zoom&&h.zoom&&h.zoom.destroy(),h.params.keyboardControl&&h.disableKeyboardControl&&h.disableKeyboardControl(),h.params.mousewheelControl&&h.disableMousewheelControl&&h.disableMousewheelControl(),h.params.a11y&&h.a11y&&h.a11y.destroy(),h.params.history&&!h.params.replaceState&&window.removeEventListener("popstate",h.history.setHistoryPopState),h.params.hashnav&&h.hashnav&&h.hashnav.destroy(),h.emit("onDestroy"),!1!==e&&(h=null)},h.init(),h}function R(e){return Math.floor(e)}function L(){var e=h.params.autoplay,t=h.slides.eq(h.activeIndex);t.attr("data-swiper-autoplay")&&(e=t.attr("data-swiper-autoplay")||h.params.autoplay),h.autoplayTimeoutId=setTimeout(function(){h.params.loop?(h.fixLoop(),h._slideNext(),h.emit("onAutoplay",h)):h.isEnd?r.autoplayStopOnLast?h.stopAutoplay():(h._slideTo(0),h.emit("onAutoplay",h)):(h._slideNext(),h.emit("onAutoplay",h))},e)}function I(t,r){var n=e(t.target);if(!n.is(r))if("string"==typeof r)n=n.parents(r);else if(r.nodeType){var i;return n.parents().each(function(e,t){t===r&&(i=r)}),i?r:void 0}if(0!==n.length)return n[0]}function O(e,t){t=t||{};var r=new(window.MutationObserver||window.WebkitMutationObserver)(function(e){e.forEach(function(e){h.onResize(!0),h.emit("onObserverUpdate",h,e)})});r.observe(e,{attributes:void 0===t.attributes||t.attributes,childList:void 0===t.childList||t.childList,characterData:void 0===t.characterData||t.characterData}),h.observers.push(r)}function P(e){e.originalEvent&&(e=e.originalEvent);var t=e.keyCode||e.charCode;if(!h.params.allowSwipeToNext&&(h.isHorizontal()&&39===t||!h.isHorizontal()&&40===t))return!1;if(!h.params.allowSwipeToPrev&&(h.isHorizontal()&&37===t||!h.isHorizontal()&&38===t))return!1;if(!(e.shiftKey||e.altKey||e.ctrlKey||e.metaKey||document.activeElement&&document.activeElement.nodeName&&("input"===document.activeElement.nodeName.toLowerCase()||"textarea"===document.activeElement.nodeName.toLowerCase()))){if(37===t||39===t||38===t||40===t){var r=!1;if(h.container.parents("."+h.params.slideClass).length>0&&0===h.container.parents("."+h.params.slideActiveClass).length)return;var n={left:window.pageXOffset,top:window.pageYOffset},i=window.innerWidth,a=window.innerHeight,s=h.container.offset();h.rtl&&(s.left=s.left-h.container[0].scrollLeft);for(var o=[[s.left,s.top],[s.left+h.width,s.top],[s.left,s.top+h.height],[s.left+h.width,s.top+h.height]],l=0;l<o.length;l++){var u=o[l];u[0]>=n.left&&u[0]<=n.left+i&&u[1]>=n.top&&u[1]<=n.top+a&&(r=!0)}if(!r)return}h.isHorizontal()?(37!==t&&39!==t||(e.preventDefault?e.preventDefault():e.returnValue=!1),(39===t&&!h.rtl||37===t&&h.rtl)&&h.slideNext(),(37===t&&!h.rtl||39===t&&h.rtl)&&h.slidePrev()):(38!==t&&40!==t||(e.preventDefault?e.preventDefault():e.returnValue=!1),40===t&&h.slideNext(),38===t&&h.slidePrev()),h.emit("onKeyPress",h,t)}}function M(e){e.originalEvent&&(e=e.originalEvent);var t,r,n,i,a,s=0,o=h.rtl?-1:1,l=(r=0,n=0,i=0,a=0,"detail"in(t=e)&&(n=t.detail),"wheelDelta"in t&&(n=-t.wheelDelta/120),"wheelDeltaY"in t&&(n=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(r=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(r=n,n=0),i=10*r,a=10*n,"deltaY"in t&&(a=t.deltaY),"deltaX"in t&&(i=t.deltaX),(i||a)&&t.deltaMode&&(1===t.deltaMode?(i*=40,a*=40):(i*=800,a*=800)),i&&!r&&(r=i<1?-1:1),a&&!n&&(n=a<1?-1:1),{spinX:r,spinY:n,pixelX:i,pixelY:a});if(h.params.mousewheelForceToAxis)if(h.isHorizontal()){if(!(Math.abs(l.pixelX)>Math.abs(l.pixelY)))return;s=l.pixelX*o}else{if(!(Math.abs(l.pixelY)>Math.abs(l.pixelX)))return;s=l.pixelY}else s=Math.abs(l.pixelX)>Math.abs(l.pixelY)?-l.pixelX*o:-l.pixelY;if(0!==s){if(h.params.mousewheelInvert&&(s=-s),h.params.freeMode){var u=h.getWrapperTranslate()+s*h.params.mousewheelSensitivity,c=h.isBeginning,d=h.isEnd;if(u>=h.minTranslate()&&(u=h.minTranslate()),u<=h.maxTranslate()&&(u=h.maxTranslate()),h.setWrapperTransition(0),h.setWrapperTranslate(u),h.updateProgress(),h.updateActiveIndex(),(!c&&h.isBeginning||!d&&h.isEnd)&&h.updateClasses(),h.params.freeModeSticky?(clearTimeout(h.mousewheel.timeout),h.mousewheel.timeout=setTimeout(function(){h.slideReset()},300)):h.params.lazyLoading&&h.lazy&&h.lazy.load(),h.emit("onScroll",h,e),h.params.autoplay&&h.params.autoplayDisableOnInteraction&&h.stopAutoplay(),0===u||u===h.maxTranslate())return}else{if((new window.Date).getTime()-h.mousewheel.lastScrollTime>60)if(s<0)if(h.isEnd&&!h.params.loop||h.animating){if(h.params.mousewheelReleaseOnEdges)return!0}else h.slideNext(),h.emit("onScroll",h,e);else if(h.isBeginning&&!h.params.loop||h.animating){if(h.params.mousewheelReleaseOnEdges)return!0}else h.slidePrev(),h.emit("onScroll",h,e);h.mousewheel.lastScrollTime=(new window.Date).getTime()}return e.preventDefault?e.preventDefault():e.returnValue=!1,!1}}function N(t,r){var n,i,a;t=e(t);var s=h.rtl?-1:1;n=t.attr("data-swiper-parallax")||"0",i=t.attr("data-swiper-parallax-x"),a=t.attr("data-swiper-parallax-y"),i||a?(i=i||"0",a=a||"0"):h.isHorizontal()?(i=n,a="0"):(a=n,i="0"),i=i.indexOf("%")>=0?parseInt(i,10)*r*s+"%":i*r*s+"px",a=a.indexOf("%")>=0?parseInt(a,10)*r+"%":a*r+"px",t.transform("translate3d("+i+", "+a+",0px)")}function F(e){return 0!==e.indexOf("on")&&(e=e[0]!==e[0].toUpperCase()?"on"+e[0].toUpperCase()+e.substring(1):"on"+e),e}};n.prototype={isSafari:(r=window.navigator.userAgent.toLowerCase(),r.indexOf("safari")>=0&&r.indexOf("chrome")<0&&r.indexOf("android")<0),isUiWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(window.navigator.userAgent),isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},browser:{ie:window.navigator.pointerEnabled||window.navigator.msPointerEnabled,ieTouch:window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints>1||window.navigator.pointerEnabled&&window.navigator.maxTouchPoints>1,lteIE9:(t=document.createElement("div"),t.innerHTML="\x3c!--[if lte IE 9]><i></i><![endif]--\x3e",1===t.getElementsByTagName("i").length)},device:function(){var e=window.navigator.userAgent,t=e.match(/(Android);?[\s\/]+([\d.]+)?/),r=e.match(/(iPad).*OS\s([\d_]+)/),n=e.match(/(iPod)(.*OS\s([\d_]+))?/),i=!r&&e.match(/(iPhone\sOS|iOS)\s([\d_]+)/);return{ios:r||i||n,android:t}}(),support:{touch:window.Modernizr&&!0===Modernizr.touch||!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),transforms3d:window.Modernizr&&!0===Modernizr.csstransforms3d||function(){var e=document.createElement("div").style;return"webkitPerspective"in e||"MozPerspective"in e||"OPerspective"in e||"MsPerspective"in e||"perspective"in e}(),flexbox:function(){for(var e=document.createElement("div").style,t="alignItems webkitAlignItems webkitBoxAlign msFlexAlign mozBoxAlign webkitFlexDirection msFlexDirection mozBoxDirection mozBoxOrient webkitBoxDirection webkitBoxOrient".split(" "),r=0;r<t.length;r++)if(t[r]in e)return!0}(),observer:"MutationObserver"in window||"WebkitMutationObserver"in window,passiveListener:function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveListener",null,t)}catch(e){}return e}(),gestures:"ongesturestart"in window},plugins:{}};for(var i,a=function(){var e=function(e){var t=0;for(t=0;t<e.length;t++)this[t]=e[t];return this.length=e.length,this},t=function(t,r){var n=[],i=0;if(t&&!r&&t instanceof e)return t;if(t)if("string"==typeof t){var a,s,o=t.trim();if(o.indexOf("<")>=0&&o.indexOf(">")>=0){var l="div";for(0===o.indexOf("<li")&&(l="ul"),0===o.indexOf("<tr")&&(l="tbody"),0!==o.indexOf("<td")&&0!==o.indexOf("<th")||(l="tr"),0===o.indexOf("<tbody")&&(l="table"),0===o.indexOf("<option")&&(l="select"),(s=document.createElement(l)).innerHTML=t,i=0;i<s.childNodes.length;i++)n.push(s.childNodes[i])}else for(a=r||"#"!==t[0]||t.match(/[ .<>:~]/)?(r||document).querySelectorAll(t):[document.getElementById(t.split("#")[1])],i=0;i<a.length;i++)a[i]&&n.push(a[i])}else if(t.nodeType||t===window||t===document)n.push(t);else if(t.length>0&&t[0].nodeType)for(i=0;i<t.length;i++)n.push(t[i]);return new e(n)};return e.prototype={addClass:function(e){if(void 0===e)return this;for(var t=e.split(" "),r=0;r<t.length;r++)for(var n=0;n<this.length;n++)this[n].classList.add(t[r]);return this},removeClass:function(e){for(var t=e.split(" "),r=0;r<t.length;r++)for(var n=0;n<this.length;n++)this[n].classList.remove(t[r]);return this},hasClass:function(e){return!!this[0]&&this[0].classList.contains(e)},toggleClass:function(e){for(var t=e.split(" "),r=0;r<t.length;r++)for(var n=0;n<this.length;n++)this[n].classList.toggle(t[r]);return this},attr:function(e,t){if(1===arguments.length&&"string"==typeof e)return this[0]?this[0].getAttribute(e):void 0;for(var r=0;r<this.length;r++)if(2===arguments.length)this[r].setAttribute(e,t);else for(var n in e)this[r][n]=e[n],this[r].setAttribute(n,e[n]);return this},removeAttr:function(e){for(var t=0;t<this.length;t++)this[t].removeAttribute(e);return this},data:function(e,t){if(void 0!==t){for(var r=0;r<this.length;r++){var n=this[r];n.dom7ElementDataStorage||(n.dom7ElementDataStorage={}),n.dom7ElementDataStorage[e]=t}return this}if(this[0]){var i=this[0].getAttribute("data-"+e);return i||(this[0].dom7ElementDataStorage&&e in this[0].dom7ElementDataStorage?this[0].dom7ElementDataStorage[e]:void 0)}},transform:function(e){for(var t=0;t<this.length;t++){var r=this[t].style;r.webkitTransform=r.MsTransform=r.msTransform=r.MozTransform=r.OTransform=r.transform=e}return this},transition:function(e){"string"!=typeof e&&(e+="ms");for(var t=0;t<this.length;t++){var r=this[t].style;r.webkitTransitionDuration=r.MsTransitionDuration=r.msTransitionDuration=r.MozTransitionDuration=r.OTransitionDuration=r.transitionDuration=e}return this},on:function(e,r,n,i){function a(e){var i=e.target;if(t(i).is(r))n.call(i,e);else for(var a=t(i).parents(),s=0;s<a.length;s++)t(a[s]).is(r)&&n.call(a[s],e)}var s,o,l=e.split(" ");for(s=0;s<this.length;s++)if("function"==typeof r||!1===r)for("function"==typeof r&&(n=arguments[1],i=arguments[2]||!1),o=0;o<l.length;o++)this[s].addEventListener(l[o],n,i);else for(o=0;o<l.length;o++)this[s].dom7LiveListeners||(this[s].dom7LiveListeners=[]),this[s].dom7LiveListeners.push({listener:n,liveListener:a}),this[s].addEventListener(l[o],a,i);return this},off:function(e,t,r,n){for(var i=e.split(" "),a=0;a<i.length;a++)for(var s=0;s<this.length;s++)if("function"==typeof t||!1===t)"function"==typeof t&&(r=arguments[1],n=arguments[2]||!1),this[s].removeEventListener(i[a],r,n);else if(this[s].dom7LiveListeners)for(var o=0;o<this[s].dom7LiveListeners.length;o++)this[s].dom7LiveListeners[o].listener===r&&this[s].removeEventListener(i[a],this[s].dom7LiveListeners[o].liveListener,n);return this},once:function(e,t,r,n){var i=this;function a(s){r(s),i.off(e,t,a,n)}"function"==typeof t&&(t=!1,r=arguments[1],n=arguments[2]),i.on(e,t,a,n)},trigger:function(e,t){for(var r=0;r<this.length;r++){var n;try{n=new window.CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0})}catch(r){(n=document.createEvent("Event")).initEvent(e,!0,!0),n.detail=t}this[r].dispatchEvent(n)}return this},transitionEnd:function(e){var t,r=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],n=this;function i(a){if(a.target===this)for(e.call(this,a),t=0;t<r.length;t++)n.off(r[t],i)}if(e)for(t=0;t<r.length;t++)n.on(r[t],i);return this},width:function(){return this[0]===window?window.innerWidth:this.length>0?parseFloat(this.css("width")):null},outerWidth:function(e){return this.length>0?e?this[0].offsetWidth+parseFloat(this.css("margin-right"))+parseFloat(this.css("margin-left")):this[0].offsetWidth:null},height:function(){return this[0]===window?window.innerHeight:this.length>0?parseFloat(this.css("height")):null},outerHeight:function(e){return this.length>0?e?this[0].offsetHeight+parseFloat(this.css("margin-top"))+parseFloat(this.css("margin-bottom")):this[0].offsetHeight:null},offset:function(){if(this.length>0){var e=this[0],t=e.getBoundingClientRect(),r=document.body,n=e.clientTop||r.clientTop||0,i=e.clientLeft||r.clientLeft||0,a=window.pageYOffset||e.scrollTop,s=window.pageXOffset||e.scrollLeft;return{top:t.top+a-n,left:t.left+s-i}}return null},css:function(e,t){var r;if(1===arguments.length){if("string"!=typeof e){for(r=0;r<this.length;r++)for(var n in e)this[r].style[n]=e[n];return this}if(this[0])return window.getComputedStyle(this[0],null).getPropertyValue(e)}if(2===arguments.length&&"string"==typeof e){for(r=0;r<this.length;r++)this[r].style[e]=t;return this}return this},each:function(e){for(var t=0;t<this.length;t++)e.call(this[t],t,this[t]);return this},html:function(e){if(void 0===e)return this[0]?this[0].innerHTML:void 0;for(var t=0;t<this.length;t++)this[t].innerHTML=e;return this},text:function(e){if(void 0===e)return this[0]?this[0].textContent.trim():null;for(var t=0;t<this.length;t++)this[t].textContent=e;return this},is:function(r){if(!this[0])return!1;var n,i;if("string"==typeof r){var a=this[0];if(a===document)return r===document;if(a===window)return r===window;if(a.matches)return a.matches(r);if(a.webkitMatchesSelector)return a.webkitMatchesSelector(r);if(a.mozMatchesSelector)return a.mozMatchesSelector(r);if(a.msMatchesSelector)return a.msMatchesSelector(r);for(n=t(r),i=0;i<n.length;i++)if(n[i]===this[0])return!0;return!1}if(r===document)return this[0]===document;if(r===window)return this[0]===window;if(r.nodeType||r instanceof e){for(n=r.nodeType?[r]:r,i=0;i<n.length;i++)if(n[i]===this[0])return!0;return!1}return!1},index:function(){if(this[0]){for(var e=this[0],t=0;null!==(e=e.previousSibling);)1===e.nodeType&&t++;return t}},eq:function(t){if(void 0===t)return this;var r,n=this.length;return new e(t>n-1?[]:t<0?(r=n+t)<0?[]:[this[r]]:[this[t]])},append:function(t){var r,n;for(r=0;r<this.length;r++)if("string"==typeof t){var i=document.createElement("div");for(i.innerHTML=t;i.firstChild;)this[r].appendChild(i.firstChild)}else if(t instanceof e)for(n=0;n<t.length;n++)this[r].appendChild(t[n]);else this[r].appendChild(t);return this},prepend:function(t){var r,n;for(r=0;r<this.length;r++)if("string"==typeof t){var i=document.createElement("div");for(i.innerHTML=t,n=i.childNodes.length-1;n>=0;n--)this[r].insertBefore(i.childNodes[n],this[r].childNodes[0])}else if(t instanceof e)for(n=0;n<t.length;n++)this[r].insertBefore(t[n],this[r].childNodes[0]);else this[r].insertBefore(t,this[r].childNodes[0]);return this},insertBefore:function(e){for(var r=t(e),n=0;n<this.length;n++)if(1===r.length)r[0].parentNode.insertBefore(this[n],r[0]);else if(r.length>1)for(var i=0;i<r.length;i++)r[i].parentNode.insertBefore(this[n].cloneNode(!0),r[i])},insertAfter:function(e){for(var r=t(e),n=0;n<this.length;n++)if(1===r.length)r[0].parentNode.insertBefore(this[n],r[0].nextSibling);else if(r.length>1)for(var i=0;i<r.length;i++)r[i].parentNode.insertBefore(this[n].cloneNode(!0),r[i].nextSibling)},next:function(r){return this.length>0?r?this[0].nextElementSibling&&t(this[0].nextElementSibling).is(r)?new e([this[0].nextElementSibling]):new e([]):this[0].nextElementSibling?new e([this[0].nextElementSibling]):new e([]):new e([])},nextAll:function(r){var n=[],i=this[0];if(!i)return new e([]);for(;i.nextElementSibling;){var a=i.nextElementSibling;r?t(a).is(r)&&n.push(a):n.push(a),i=a}return new e(n)},prev:function(r){return this.length>0?r?this[0].previousElementSibling&&t(this[0].previousElementSibling).is(r)?new e([this[0].previousElementSibling]):new e([]):this[0].previousElementSibling?new e([this[0].previousElementSibling]):new e([]):new e([])},prevAll:function(r){var n=[],i=this[0];if(!i)return new e([]);for(;i.previousElementSibling;){var a=i.previousElementSibling;r?t(a).is(r)&&n.push(a):n.push(a),i=a}return new e(n)},parent:function(e){for(var r=[],n=0;n<this.length;n++)e?t(this[n].parentNode).is(e)&&r.push(this[n].parentNode):r.push(this[n].parentNode);return t(t.unique(r))},parents:function(e){for(var r=[],n=0;n<this.length;n++)for(var i=this[n].parentNode;i;)e?t(i).is(e)&&r.push(i):r.push(i),i=i.parentNode;return t(t.unique(r))},find:function(t){for(var r=[],n=0;n<this.length;n++)for(var i=this[n].querySelectorAll(t),a=0;a<i.length;a++)r.push(i[a]);return new e(r)},children:function(r){for(var n=[],i=0;i<this.length;i++)for(var a=this[i].childNodes,s=0;s<a.length;s++)r?1===a[s].nodeType&&t(a[s]).is(r)&&n.push(a[s]):1===a[s].nodeType&&n.push(a[s]);return new e(t.unique(n))},remove:function(){for(var e=0;e<this.length;e++)this[e].parentNode&&this[e].parentNode.removeChild(this[e]);return this},add:function(){var e,r,n=this;for(e=0;e<arguments.length;e++){var i=t(arguments[e]);for(r=0;r<i.length;r++)n[n.length]=i[r],n.length++}return n}},t.fn=e.prototype,t.unique=function(e){for(var t=[],r=0;r<e.length;r++)-1===t.indexOf(e[r])&&t.push(e[r]);return t},t}(),s=["jQuery","Zepto","Dom7"],o=0;o<s.length;o++)window[s[o]]&&l(window[s[o]]);function l(e){e.fn.swiper=function(t){var r;return e(this).each(function(){var e=new n(this,t);r||(r=e)}),r}}(i=void 0===a?window.Dom7||window.Zepto||window.jQuery:a)&&("transitionEnd"in i.fn||(i.fn.transitionEnd=function(e){var t,r=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],n=this;function i(a){if(a.target===this)for(e.call(this,a),t=0;t<r.length;t++)n.off(r[t],i)}if(e)for(t=0;t<r.length;t++)n.on(r[t],i);return this}),"transform"in i.fn||(i.fn.transform=function(e){for(var t=0;t<this.length;t++){var r=this[t].style;r.webkitTransform=r.MsTransform=r.msTransform=r.MozTransform=r.OTransform=r.transform=e}return this}),"transition"in i.fn||(i.fn.transition=function(e){"string"!=typeof e&&(e+="ms");for(var t=0;t<this.length;t++){var r=this[t].style;r.webkitTransitionDuration=r.MsTransitionDuration=r.msTransitionDuration=r.MozTransitionDuration=r.OTransitionDuration=r.transitionDuration=e}return this}),"outerWidth"in i.fn||(i.fn.outerWidth=function(e){return this.length>0?e?this[0].offsetWidth+parseFloat(this.css("margin-right"))+parseFloat(this.css("margin-left")):this[0].offsetWidth:null})),window.Swiper=n}(),e.exports=window.Swiper},function(e,t,r){var n=r(22);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r(3)(n,i);n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(2)(!1)).push([e.i,"/**\n * Swiper 3.4.2\n * Most modern mobile touch slider and framework with hardware accelerated transitions\n * \n * http://www.idangero.us/swiper/\n * \n * Copyright 2017, Vladimir Kharlampidi\n * The iDangero.us\n * http://www.idangero.us/\n * \n * Licensed under MIT\n * \n * Released on: March 10, 2017\n */\n.swiper-container{margin-left:auto;margin-right:auto;position:relative;overflow:hidden;z-index:1}.swiper-container-no-flexbox .swiper-slide{float:left}.swiper-container-vertical>.swiper-wrapper{-webkit-box-orient:vertical;-moz-box-orient:vertical;-ms-flex-direction:column;-webkit-flex-direction:column;flex-direction:column}.swiper-wrapper{position:relative;width:100%;height:100%;z-index:1;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;-webkit-transition-property:-webkit-transform;-moz-transition-property:-moz-transform;-o-transition-property:-o-transform;-ms-transition-property:-ms-transform;transition-property:transform;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}.swiper-container-android .swiper-slide,.swiper-wrapper{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-o-transform:translate(0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.swiper-container-multirow>.swiper-wrapper{-webkit-box-lines:multiple;-moz-box-lines:multiple;-ms-flex-wrap:wrap;-webkit-flex-wrap:wrap;flex-wrap:wrap}.swiper-container-free-mode>.swiper-wrapper{-webkit-transition-timing-function:ease-out;-moz-transition-timing-function:ease-out;-ms-transition-timing-function:ease-out;-o-transition-timing-function:ease-out;transition-timing-function:ease-out;margin:0 auto}.swiper-slide{-webkit-flex-shrink:0;-ms-flex:0 0 auto;flex-shrink:0;width:100%;height:100%;position:relative}.swiper-container-autoheight,.swiper-container-autoheight .swiper-slide{height:auto}.swiper-container-autoheight .swiper-wrapper{-webkit-box-align:start;-ms-flex-align:start;-webkit-align-items:flex-start;align-items:flex-start;-webkit-transition-property:-webkit-transform,height;-moz-transition-property:-moz-transform;-o-transition-property:-o-transform;-ms-transition-property:-ms-transform;transition-property:transform,height}.swiper-container .swiper-notification{position:absolute;left:0;top:0;pointer-events:none;opacity:0;z-index:-1000}.swiper-wp8-horizontal{-ms-touch-action:pan-y;touch-action:pan-y}.swiper-wp8-vertical{-ms-touch-action:pan-x;touch-action:pan-x}.swiper-button-next,.swiper-button-prev{position:absolute;top:50%;width:27px;height:44px;margin-top:-22px;z-index:10;cursor:pointer;-moz-background-size:27px 44px;-webkit-background-size:27px 44px;background-size:27px 44px;background-position:center;background-repeat:no-repeat}.swiper-button-next.swiper-button-disabled,.swiper-button-prev.swiper-button-disabled{opacity:.35;cursor:auto;pointer-events:none}.swiper-button-prev,.swiper-container-rtl .swiper-button-next{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M0%2C22L22%2C0l2.1%2C2.1L4.2%2C22l19.9%2C19.9L22%2C44L0%2C22L0%2C22L0%2C22z'%20fill%3D'%23007aff'%2F%3E%3C%2Fsvg%3E\");left:10px;right:auto}.swiper-button-prev.swiper-button-black,.swiper-container-rtl .swiper-button-next.swiper-button-black{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M0%2C22L22%2C0l2.1%2C2.1L4.2%2C22l19.9%2C19.9L22%2C44L0%2C22L0%2C22L0%2C22z'%20fill%3D'%23000000'%2F%3E%3C%2Fsvg%3E\")}.swiper-button-prev.swiper-button-white,.swiper-container-rtl .swiper-button-next.swiper-button-white{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M0%2C22L22%2C0l2.1%2C2.1L4.2%2C22l19.9%2C19.9L22%2C44L0%2C22L0%2C22L0%2C22z'%20fill%3D'%23ffffff'%2F%3E%3C%2Fsvg%3E\")}.swiper-button-next,.swiper-container-rtl .swiper-button-prev{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M27%2C22L27%2C22L5%2C44l-2.1-2.1L22.8%2C22L2.9%2C2.1L5%2C0L27%2C22L27%2C22z'%20fill%3D'%23007aff'%2F%3E%3C%2Fsvg%3E\");right:10px;left:auto}.swiper-button-next.swiper-button-black,.swiper-container-rtl .swiper-button-prev.swiper-button-black{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M27%2C22L27%2C22L5%2C44l-2.1-2.1L22.8%2C22L2.9%2C2.1L5%2C0L27%2C22L27%2C22z'%20fill%3D'%23000000'%2F%3E%3C%2Fsvg%3E\")}.swiper-button-next.swiper-button-white,.swiper-container-rtl .swiper-button-prev.swiper-button-white{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M27%2C22L27%2C22L5%2C44l-2.1-2.1L22.8%2C22L2.9%2C2.1L5%2C0L27%2C22L27%2C22z'%20fill%3D'%23ffffff'%2F%3E%3C%2Fsvg%3E\")}.swiper-pagination{position:absolute;text-align:center;-webkit-transition:.3s;-moz-transition:.3s;-o-transition:.3s;transition:.3s;-webkit-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0);z-index:10}.swiper-pagination.swiper-pagination-hidden{opacity:0}.swiper-container-horizontal>.swiper-pagination-bullets,.swiper-pagination-custom,.swiper-pagination-fraction{bottom:10px;left:0;width:100%}.swiper-pagination-bullet{width:8px;height:8px;display:inline-block;border-radius:100%;background:#000;opacity:.2}button.swiper-pagination-bullet{border:none;margin:0;padding:0;box-shadow:none;-moz-appearance:none;-ms-appearance:none;-webkit-appearance:none;appearance:none}.swiper-pagination-clickable .swiper-pagination-bullet{cursor:pointer}.swiper-pagination-white .swiper-pagination-bullet{background:#fff}.swiper-pagination-bullet-active{opacity:1;background:#007aff}.swiper-pagination-white .swiper-pagination-bullet-active{background:#fff}.swiper-pagination-black .swiper-pagination-bullet-active{background:#000}.swiper-container-vertical>.swiper-pagination-bullets{right:10px;top:50%;-webkit-transform:translate3d(0,-50%,0);-moz-transform:translate3d(0,-50%,0);-o-transform:translate(0,-50%);-ms-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0)}.swiper-container-vertical>.swiper-pagination-bullets .swiper-pagination-bullet{margin:5px 0;display:block}.swiper-container-horizontal>.swiper-pagination-bullets .swiper-pagination-bullet{margin:0 5px}.swiper-pagination-progress{background:rgba(0,0,0,.25);position:absolute}.swiper-pagination-progress .swiper-pagination-progressbar{background:#007aff;position:absolute;left:0;top:0;width:100%;height:100%;-webkit-transform:scale(0);-ms-transform:scale(0);-o-transform:scale(0);transform:scale(0);-webkit-transform-origin:left top;-moz-transform-origin:left top;-ms-transform-origin:left top;-o-transform-origin:left top;transform-origin:left top}.swiper-container-rtl .swiper-pagination-progress .swiper-pagination-progressbar{-webkit-transform-origin:right top;-moz-transform-origin:right top;-ms-transform-origin:right top;-o-transform-origin:right top;transform-origin:right top}.swiper-container-horizontal>.swiper-pagination-progress{width:100%;height:4px;left:0;top:0}.swiper-container-vertical>.swiper-pagination-progress{width:4px;height:100%;left:0;top:0}.swiper-pagination-progress.swiper-pagination-white{background:rgba(255,255,255,.5)}.swiper-pagination-progress.swiper-pagination-white .swiper-pagination-progressbar{background:#fff}.swiper-pagination-progress.swiper-pagination-black .swiper-pagination-progressbar{background:#000}.swiper-container-3d{-webkit-perspective:1200px;-moz-perspective:1200px;-o-perspective:1200px;perspective:1200px}.swiper-container-3d .swiper-cube-shadow,.swiper-container-3d .swiper-slide,.swiper-container-3d .swiper-slide-shadow-bottom,.swiper-container-3d .swiper-slide-shadow-left,.swiper-container-3d .swiper-slide-shadow-right,.swiper-container-3d .swiper-slide-shadow-top,.swiper-container-3d .swiper-wrapper{-webkit-transform-style:preserve-3d;-moz-transform-style:preserve-3d;-ms-transform-style:preserve-3d;transform-style:preserve-3d}.swiper-container-3d .swiper-slide-shadow-bottom,.swiper-container-3d .swiper-slide-shadow-left,.swiper-container-3d .swiper-slide-shadow-right,.swiper-container-3d .swiper-slide-shadow-top{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}.swiper-container-3d .swiper-slide-shadow-left{background-image:-webkit-gradient(linear,left top,right top,from(rgba(0,0,0,.5)),to(rgba(0,0,0,0)));background-image:-webkit-linear-gradient(right,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:-moz-linear-gradient(right,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:-o-linear-gradient(right,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:linear-gradient(to left,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-container-3d .swiper-slide-shadow-right{background-image:-webkit-gradient(linear,right top,left top,from(rgba(0,0,0,.5)),to(rgba(0,0,0,0)));background-image:-webkit-linear-gradient(left,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:-moz-linear-gradient(left,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:-o-linear-gradient(left,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:linear-gradient(to right,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-container-3d .swiper-slide-shadow-top{background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.5)),to(rgba(0,0,0,0)));background-image:-webkit-linear-gradient(bottom,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:-moz-linear-gradient(bottom,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:-o-linear-gradient(bottom,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:linear-gradient(to top,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-container-3d .swiper-slide-shadow-bottom{background-image:-webkit-gradient(linear,left bottom,left top,from(rgba(0,0,0,.5)),to(rgba(0,0,0,0)));background-image:-webkit-linear-gradient(top,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:-moz-linear-gradient(top,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:-o-linear-gradient(top,rgba(0,0,0,.5),rgba(0,0,0,0));background-image:linear-gradient(to bottom,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-container-coverflow .swiper-wrapper,.swiper-container-flip .swiper-wrapper{-ms-perspective:1200px}.swiper-container-cube,.swiper-container-flip{overflow:visible}.swiper-container-cube .swiper-slide,.swiper-container-flip .swiper-slide{pointer-events:none;-webkit-backface-visibility:hidden;-moz-backface-visibility:hidden;-ms-backface-visibility:hidden;backface-visibility:hidden;z-index:1}.swiper-container-cube .swiper-slide .swiper-slide,.swiper-container-flip .swiper-slide .swiper-slide{pointer-events:none}.swiper-container-cube .swiper-slide-active,.swiper-container-cube .swiper-slide-active .swiper-slide-active,.swiper-container-flip .swiper-slide-active,.swiper-container-flip .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-container-cube .swiper-slide-shadow-bottom,.swiper-container-cube .swiper-slide-shadow-left,.swiper-container-cube .swiper-slide-shadow-right,.swiper-container-cube .swiper-slide-shadow-top,.swiper-container-flip .swiper-slide-shadow-bottom,.swiper-container-flip .swiper-slide-shadow-left,.swiper-container-flip .swiper-slide-shadow-right,.swiper-container-flip .swiper-slide-shadow-top{z-index:0;-webkit-backface-visibility:hidden;-moz-backface-visibility:hidden;-ms-backface-visibility:hidden;backface-visibility:hidden}.swiper-container-cube .swiper-slide{visibility:hidden;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0;width:100%;height:100%}.swiper-container-cube.swiper-container-rtl .swiper-slide{-webkit-transform-origin:100% 0;-moz-transform-origin:100% 0;-ms-transform-origin:100% 0;transform-origin:100% 0}.swiper-container-cube .swiper-slide-active,.swiper-container-cube .swiper-slide-next,.swiper-container-cube .swiper-slide-next+.swiper-slide,.swiper-container-cube .swiper-slide-prev{pointer-events:auto;visibility:visible}.swiper-container-cube .swiper-cube-shadow{position:absolute;left:0;bottom:0;width:100%;height:100%;background:#000;opacity:.6;-webkit-filter:blur(50px);filter:blur(50px);z-index:0}.swiper-container-fade.swiper-container-free-mode .swiper-slide{-webkit-transition-timing-function:ease-out;-moz-transition-timing-function:ease-out;-ms-transition-timing-function:ease-out;-o-transition-timing-function:ease-out;transition-timing-function:ease-out}.swiper-container-fade .swiper-slide{pointer-events:none;-webkit-transition-property:opacity;-moz-transition-property:opacity;-o-transition-property:opacity;transition-property:opacity}.swiper-container-fade .swiper-slide .swiper-slide{pointer-events:none}.swiper-container-fade .swiper-slide-active,.swiper-container-fade .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-zoom-container{width:100%;height:100%;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;-webkit-box-pack:center;-moz-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-moz-box-align:center;-ms-flex-align:center;-webkit-align-items:center;align-items:center;text-align:center}.swiper-zoom-container>canvas,.swiper-zoom-container>img,.swiper-zoom-container>svg{max-width:100%;max-height:100%;object-fit:contain}.swiper-scrollbar{border-radius:10px;position:relative;-ms-touch-action:none;background:rgba(0,0,0,.1)}.swiper-container-horizontal>.swiper-scrollbar{position:absolute;left:1%;bottom:3px;z-index:50;height:5px;width:98%}.swiper-container-vertical>.swiper-scrollbar{position:absolute;right:3px;top:1%;z-index:50;width:5px;height:98%}.swiper-scrollbar-drag{height:100%;width:100%;position:relative;background:rgba(0,0,0,.5);border-radius:10px;left:0;top:0}.swiper-scrollbar-cursor-drag{cursor:move}.swiper-lazy-preloader{width:42px;height:42px;position:absolute;left:50%;top:50%;margin-left:-21px;margin-top:-21px;z-index:10;-webkit-transform-origin:50%;-moz-transform-origin:50%;transform-origin:50%;-webkit-animation:swiper-preloader-spin 1s steps(12,end) infinite;-moz-animation:swiper-preloader-spin 1s steps(12,end) infinite;animation:swiper-preloader-spin 1s steps(12,end) infinite}.swiper-lazy-preloader:after{display:block;content:\"\";width:100%;height:100%;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20viewBox%3D'0%200%20120%20120'%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20xmlns%3Axlink%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink'%3E%3Cdefs%3E%3Cline%20id%3D'l'%20x1%3D'60'%20x2%3D'60'%20y1%3D'7'%20y2%3D'27'%20stroke%3D'%236c6c6c'%20stroke-width%3D'11'%20stroke-linecap%3D'round'%2F%3E%3C%2Fdefs%3E%3Cg%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(30%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(60%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(90%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(120%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(150%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.37'%20transform%3D'rotate(180%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.46'%20transform%3D'rotate(210%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.56'%20transform%3D'rotate(240%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.66'%20transform%3D'rotate(270%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.75'%20transform%3D'rotate(300%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.85'%20transform%3D'rotate(330%2060%2C60)'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\");background-position:50%;-webkit-background-size:100%;background-size:100%;background-repeat:no-repeat}.swiper-lazy-preloader-white:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20viewBox%3D'0%200%20120%20120'%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20xmlns%3Axlink%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink'%3E%3Cdefs%3E%3Cline%20id%3D'l'%20x1%3D'60'%20x2%3D'60'%20y1%3D'7'%20y2%3D'27'%20stroke%3D'%23fff'%20stroke-width%3D'11'%20stroke-linecap%3D'round'%2F%3E%3C%2Fdefs%3E%3Cg%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(30%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(60%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(90%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(120%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(150%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.37'%20transform%3D'rotate(180%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.46'%20transform%3D'rotate(210%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.56'%20transform%3D'rotate(240%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.66'%20transform%3D'rotate(270%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.75'%20transform%3D'rotate(300%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.85'%20transform%3D'rotate(330%2060%2C60)'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\")}@-webkit-keyframes swiper-preloader-spin{100%{-webkit-transform:rotate(360deg)}}@keyframes swiper-preloader-spin{100%{transform:rotate(360deg)}}",""])},function(e,t,r){"use strict";
/**!
 * Sortable 1.10.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){i(e,t,r[t])})}return e}function o(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function l(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r.r(t),r.d(t,"MultiDrag",function(){return _t}),r.d(t,"Sortable",function(){return Be}),r.d(t,"Swap",function(){return ot});function u(e){return!!navigator.userAgent.match(e)}var c=u(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),d=u(/Edge/i),h=u(/firefox/i),f=u(/safari/i)&&!u(/chrome/i)&&!u(/android/i),p=u(/iP(ad|od|hone)/i),g=u(/chrome/i)&&u(/android/i),m={capture:!1,passive:!1};function v(e,t,r){e.addEventListener(t,r,!c&&m)}function _(e,t,r){e.removeEventListener(t,r,!c&&m)}function y(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function b(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function w(e,t,r,n){if(e){r=r||document;do{if(null!=t&&(">"===t[0]?e.parentNode===r&&y(e,t):y(e,t))||n&&e===r)return e;if(e===r)break}while(e=b(e))}return null}var S,E=/\s+/g;function x(e,t,r){if(e&&t)if(e.classList)e.classList[r?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(E," ").replace(" "+t+" "," ");e.className=(n+(r?" "+t:"")).replace(E," ")}}function T(e,t,r){var n=e&&e.style;if(n){if(void 0===r)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(r=e.currentStyle),void 0===t?r:r[t];t in n||-1!==t.indexOf("webkit")||(t="-webkit-"+t),n[t]=r+("string"==typeof r?"":"px")}}function k(e,t){var r="";if("string"==typeof e)r=e;else do{var n=T(e,"transform");n&&"none"!==n&&(r=n+" "+r)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix;return i&&new i(r)}function A(e,t,r){if(e){var n=e.getElementsByTagName(t),i=0,a=n.length;if(r)for(;i<a;i++)r(n[i],i);return n}return[]}function C(){return c?document.documentElement:document.scrollingElement}function j(e,t,r,n,i){if(e.getBoundingClientRect||e===window){var a,s,o,l,u,d,h;if(e!==window&&e!==C()?(s=(a=e.getBoundingClientRect()).top,o=a.left,l=a.bottom,u=a.right,d=a.height,h=a.width):(s=0,o=0,l=window.innerHeight,u=window.innerWidth,d=window.innerHeight,h=window.innerWidth),(t||r)&&e!==window&&(i=i||e.parentNode,!c))do{if(i&&i.getBoundingClientRect&&("none"!==T(i,"transform")||r&&"static"!==T(i,"position"))){var f=i.getBoundingClientRect();s-=f.top+parseInt(T(i,"border-top-width")),o-=f.left+parseInt(T(i,"border-left-width")),l=s+a.height,u=o+a.width;break}}while(i=i.parentNode);if(n&&e!==window){var p=k(i||e),g=p&&p.a,m=p&&p.d;p&&(l=(s/=m)+(d/=m),u=(o/=g)+(h/=g))}return{top:s,left:o,bottom:l,right:u,width:h,height:d}}}function D(e,t,r){for(var n=P(e,!0),i=j(e)[t];n;){var a=j(n)[r];if(!("top"===r||"left"===r?i>=a:i<=a))return n;if(n===C())break;n=P(n,!1)}return!1}function R(e,t,r){for(var n=0,i=0,a=e.children;i<a.length;){if("none"!==a[i].style.display&&a[i]!==Be.ghost&&a[i]!==Be.dragged&&w(a[i],r.draggable,e,!1)){if(n===t)return a[i];n++}i++}return null}function L(e,t){for(var r=e.lastElementChild;r&&(r===Be.ghost||"none"===T(r,"display")||t&&!y(r,t));)r=r.previousElementSibling;return r||null}function I(e,t){var r=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Be.clone||t&&!y(e,t)||r++;return r}function O(e){var t=0,r=0,n=C();if(e)do{var i=k(e),a=i.a,s=i.d;t+=e.scrollLeft*a,r+=e.scrollTop*s}while(e!==n&&(e=e.parentNode));return[t,r]}function P(e,t){if(!e||!e.getBoundingClientRect)return C();var r=e,n=!1;do{if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var i=T(r);if(r.clientWidth<r.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||r.clientHeight<r.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!r.getBoundingClientRect||r===document.body)return C();if(n||t)return r;n=!0}}}while(r=r.parentNode);return C()}function M(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function N(e,t){return function(){if(!S){var r=arguments,n=this;1===r.length?e.call(n,r[0]):e.apply(n,r),S=setTimeout(function(){S=void 0},t)}}}function F(e,t,r){e.scrollLeft+=t,e.scrollTop+=r}function B(e){var t=window.Polymer,r=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):r?r(e).clone(!0)[0]:e.cloneNode(!0)}function U(e,t){T(e,"position","absolute"),T(e,"top",t.top),T(e,"left",t.left),T(e,"width",t.width),T(e,"height",t.height)}function G(e){T(e,"position",""),T(e,"top",""),T(e,"left",""),T(e,"width",""),T(e,"height","")}var z="Sortable"+(new Date).getTime();function H(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach(function(e){if("none"!==T(e,"display")&&e!==Be.ghost){t.push({target:e,rect:j(e)});var r=s({},t[t.length-1].rect);if(e.thisAnimationDuration){var n=k(e,!0);n&&(r.top-=n.f,r.left-=n.e)}e.fromRect=r}})},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var r in e)if(e.hasOwnProperty(r))for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[r][n])return Number(r);return-1}(t,{target:e}),1)},animateAll:function(r){var n=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof r&&r());var i=!1,a=0;t.forEach(function(e){var t=0,r=e.target,s=r.fromRect,o=j(r),l=r.prevFromRect,u=r.prevToRect,c=e.rect,d=k(r,!0);d&&(o.top-=d.f,o.left-=d.e),r.toRect=o,r.thisAnimationDuration&&M(l,o)&&!M(s,o)&&(c.top-o.top)/(c.left-o.left)==(s.top-o.top)/(s.left-o.left)&&(t=function(e,t,r,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-r.top,2)+Math.pow(t.left-r.left,2))*n.animation}(c,l,u,n.options)),M(o,s)||(r.prevFromRect=s,r.prevToRect=o,t||(t=n.options.animation),n.animate(r,c,o,t)),t&&(i=!0,a=Math.max(a,t),clearTimeout(r.animationResetTimer),r.animationResetTimer=setTimeout(function(){r.animationTime=0,r.prevFromRect=null,r.fromRect=null,r.prevToRect=null,r.thisAnimationDuration=null},t),r.thisAnimationDuration=t)}),clearTimeout(e),i?e=setTimeout(function(){"function"==typeof r&&r()},a):"function"==typeof r&&r(),t=[]},animate:function(e,t,r,n){if(n){T(e,"transition",""),T(e,"transform","");var i=k(this.el),a=i&&i.a,s=i&&i.d,o=(t.left-r.left)/(a||1),l=(t.top-r.top)/(s||1);e.animatingX=!!o,e.animatingY=!!l,T(e,"transform","translate3d("+o+"px,"+l+"px,0)"),function(e){e.offsetWidth}(e),T(e,"transition","transform "+n+"ms"+(this.options.easing?" "+this.options.easing:"")),T(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout(function(){T(e,"transition",""),T(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},n)}}}}var V=[],K={initializeByDefault:!0},W={mount:function(e){for(var t in K)!K.hasOwnProperty(t)||t in e||(e[t]=K[t]);V.push(e)},pluginEvent:function(e,t,r){var n=this;this.eventCanceled=!1,r.cancel=function(){n.eventCanceled=!0};var i=e+"Global";V.forEach(function(n){t[n.pluginName]&&(t[n.pluginName][i]&&t[n.pluginName][i](s({sortable:t},r)),t.options[n.pluginName]&&t[n.pluginName][e]&&t[n.pluginName][e](s({sortable:t},r)))})},initializePlugins:function(e,t,r,n){for(var i in V.forEach(function(n){var i=n.pluginName;if(e.options[i]||n.initializeByDefault){var s=new n(e,t,e.options);s.sortable=e,s.options=e.options,e[i]=s,a(r,s.defaults)}}),e.options)if(e.options.hasOwnProperty(i)){var s=this.modifyOption(e,i,e.options[i]);void 0!==s&&(e.options[i]=s)}},getEventProperties:function(e,t){var r={};return V.forEach(function(n){"function"==typeof n.eventProperties&&a(r,n.eventProperties.call(t[n.pluginName],e))}),r},modifyOption:function(e,t,r){var n;return V.forEach(function(i){e[i.pluginName]&&i.optionListeners&&"function"==typeof i.optionListeners[t]&&(n=i.optionListeners[t].call(e[i.pluginName],r))}),n}};function q(e){var t=e.sortable,r=e.rootEl,n=e.name,i=e.targetEl,a=e.cloneEl,o=e.toEl,l=e.fromEl,u=e.oldIndex,h=e.newIndex,f=e.oldDraggableIndex,p=e.newDraggableIndex,g=e.originalEvent,m=e.putSortable,v=e.extraEventProperties;if(t=t||r&&r[z]){var _,y=t.options,b="on"+n.charAt(0).toUpperCase()+n.substr(1);!window.CustomEvent||c||d?(_=document.createEvent("Event")).initEvent(n,!0,!0):_=new CustomEvent(n,{bubbles:!0,cancelable:!0}),_.to=o||r,_.from=l||r,_.item=i||r,_.clone=a,_.oldIndex=u,_.newIndex=h,_.oldDraggableIndex=f,_.newDraggableIndex=p,_.originalEvent=g,_.pullMode=m?m.lastPutMode:void 0;var w=s({},v,W.getEventProperties(n,t));for(var S in w)_[S]=w[S];r&&r.dispatchEvent(_),y[b]&&y[b].call(t,_)}}var X=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.evt,i=o(r,["evt"]);W.pluginEvent.bind(Be)(e,t,s({dragEl:$,parentEl:J,ghostEl:Q,rootEl:Z,nextEl:ee,lastDownEl:te,cloneEl:re,cloneHidden:ne,dragStarted:me,putSortable:ue,activeSortable:Be.active,originalEvent:n,oldIndex:ie,oldDraggableIndex:se,newIndex:ae,newDraggableIndex:oe,hideGhostForTarget:Pe,unhideGhostForTarget:Me,cloneNowHidden:function(){ne=!0},cloneNowShown:function(){ne=!1},dispatchSortableEvent:function(e){Y({sortable:t,name:e,originalEvent:n})}},i))};function Y(e){q(s({putSortable:ue,cloneEl:re,targetEl:$,rootEl:Z,oldIndex:ie,oldDraggableIndex:se,newIndex:ae,newDraggableIndex:oe},e))}if("undefined"==typeof window||!window.document)throw new Error("Sortable.js requires a window with a document");var $,J,Q,Z,ee,te,re,ne,ie,ae,se,oe,le,ue,ce,de,he,fe,pe,ge,me,ve,_e,ye,be,we=!1,Se=!1,Ee=[],xe=!1,Te=!1,ke=[],Ae=!1,Ce=[],je=p,De=d||c?"cssFloat":"float",Re=!g&&!p&&"draggable"in document.createElement("div"),Le=function(){if(c)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}(),Ie=function(e,t){var r=T(e),n=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),i=R(e,0,t),a=R(e,1,t),s=i&&T(i),o=a&&T(a),l=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+j(i).width,u=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+j(a).width;if("flex"===r.display)return"column"===r.flexDirection||"column-reverse"===r.flexDirection?"vertical":"horizontal";if("grid"===r.display)return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&s.float&&"none"!==s.float){var c="left"===s.float?"left":"right";return!a||"both"!==o.clear&&o.clear!==c?"horizontal":"vertical"}return i&&("block"===s.display||"flex"===s.display||"table"===s.display||"grid"===s.display||l>=n&&"none"===r[De]||a&&"none"===r[De]&&l+u>n)?"vertical":"horizontal"},Oe=function(e){function t(e,r){return function(n,i,a,s){var o=n.options.group.name&&i.options.group.name&&n.options.group.name===i.options.group.name;if(null==e&&(r||o))return!0;if(null==e||!1===e)return!1;if(r&&"clone"===e)return e;if("function"==typeof e)return t(e(n,i,a,s),r)(n,i,a,s);var l=(r?n:i).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var r={},i=e.group;i&&"object"==n(i)||(i={name:i}),r.name=i.name,r.checkPull=t(i.pull,!0),r.checkPut=t(i.put),r.revertClone=i.revertClone,e.group=r},Pe=function(){!Le&&Q&&T(Q,"display","none")},Me=function(){!Le&&Q&&T(Q,"display","")};document.addEventListener("click",function(e){if(Se)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Se=!1,!1},!0);var Ne=function(e){if($){e=e.touches?e.touches[0]:e;var t=(i=e.clientX,a=e.clientY,Ee.some(function(e){if(!L(e)){var t=j(e),r=e[z].options.emptyInsertThreshold,n=i>=t.left-r&&i<=t.right+r,o=a>=t.top-r&&a<=t.bottom+r;return r&&n&&o?s=e:void 0}}),s);if(t){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);r.target=r.rootEl=t,r.preventDefault=void 0,r.stopPropagation=void 0,t[z]._onDragOver(r)}}var i,a,s},Fe=function(e){$&&$.parentNode[z]._isOutsideThisEl(e.target)};function Be(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=a({},t),e[z]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ie(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Be.supportPointer&&"PointerEvent"in window,emptyInsertThreshold:5};for(var n in W.initializePlugins(this,e,r),r)!(n in t)&&(t[n]=r[n]);for(var i in Oe(t),this)"_"===i.charAt(0)&&"function"==typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&Re,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?v(e,"pointerdown",this._onTapStart):(v(e,"mousedown",this._onTapStart),v(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(v(e,"dragover",this),v(e,"dragenter",this)),Ee.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),a(this,H())}function Ue(e,t,r,n,i,a,s,o){var l,u,h=e[z],f=h.options.onMove;return!window.CustomEvent||c||d?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=r,l.draggedRect=n,l.related=i||t,l.relatedRect=a||j(t),l.willInsertAfter=o,l.originalEvent=s,e.dispatchEvent(l),f&&(u=f.call(h,l,s)),u}function Ge(e){e.draggable=!1}function ze(){Ae=!1}function He(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,r=t.length,n=0;r--;)n+=t.charCodeAt(r);return n.toString(36)}function Ve(e){return setTimeout(e,0)}function Ke(e){return clearTimeout(e)}Be.prototype={constructor:Be,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(ve=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,$):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,r=this.el,n=this.options,i=n.preventOnFilter,a=e.type,s=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,o=(s||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||o,u=n.filter;if(function(e){Ce.length=0;var t=e.getElementsByTagName("input"),r=t.length;for(;r--;){var n=t[r];n.checked&&Ce.push(n)}}(r),!$&&!(/mousedown|pointerdown/.test(a)&&0!==e.button||n.disabled||l.isContentEditable||(o=w(o,n.draggable,r,!1))&&o.animated||te===o)){if(ie=I(o),se=I(o,n.draggable),"function"==typeof u){if(u.call(this,e,o,this))return Y({sortable:t,rootEl:l,name:"filter",targetEl:o,toEl:r,fromEl:r}),X("filter",t,{evt:e}),void(i&&e.cancelable&&e.preventDefault())}else if(u&&(u=u.split(",").some(function(n){if(n=w(l,n.trim(),r,!1))return Y({sortable:t,rootEl:n,name:"filter",targetEl:o,fromEl:r,toEl:r}),X("filter",t,{evt:e}),!0})))return void(i&&e.cancelable&&e.preventDefault());n.handle&&!w(l,n.handle,r,!1)||this._prepareDragStart(e,s,o)}}},_prepareDragStart:function(e,t,r){var n,i=this,a=i.el,s=i.options,o=a.ownerDocument;if(r&&!$&&r.parentNode===a){var l=j(r);if(Z=a,J=($=r).parentNode,ee=$.nextSibling,te=r,le=s.group,Be.dragged=$,ce={target:$,clientX:(t||e).clientX,clientY:(t||e).clientY},pe=ce.clientX-l.left,ge=ce.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,$.style["will-change"]="all",n=function(){X("delayEnded",i,{evt:e}),Be.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!h&&i.nativeDraggable&&($.draggable=!0),i._triggerDragStart(e,t),Y({sortable:i,name:"choose",originalEvent:e}),x($,s.chosenClass,!0))},s.ignore.split(",").forEach(function(e){A($,e.trim(),Ge)}),v(o,"dragover",Ne),v(o,"mousemove",Ne),v(o,"touchmove",Ne),v(o,"mouseup",i._onDrop),v(o,"touchend",i._onDrop),v(o,"touchcancel",i._onDrop),h&&this.nativeDraggable&&(this.options.touchStartThreshold=4,$.draggable=!0),X("delayStart",this,{evt:e}),!s.delay||s.delayOnTouchOnly&&!t||this.nativeDraggable&&(d||c))n();else{if(Be.eventCanceled)return void this._onDrop();v(o,"mouseup",i._disableDelayedDrag),v(o,"touchend",i._disableDelayedDrag),v(o,"touchcancel",i._disableDelayedDrag),v(o,"mousemove",i._delayedDragTouchMoveHandler),v(o,"touchmove",i._delayedDragTouchMoveHandler),s.supportPointer&&v(o,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(n,s.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){$&&Ge($),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._disableDelayedDrag),_(e,"touchend",this._disableDelayedDrag),_(e,"touchcancel",this._disableDelayedDrag),_(e,"mousemove",this._delayedDragTouchMoveHandler),_(e,"touchmove",this._delayedDragTouchMoveHandler),_(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?v(document,"pointermove",this._onTouchMove):v(document,t?"touchmove":"mousemove",this._onTouchMove):(v($,"dragend",this),v(Z,"dragstart",this._onDragStart));try{document.selection?Ve(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(we=!1,Z&&$){X("dragStarted",this,{evt:t}),this.nativeDraggable&&v(document,"dragover",Fe);var r=this.options;!e&&x($,r.dragClass,!1),x($,r.ghostClass,!0),Be.active=this,e&&this._appendGhost(),Y({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(de){this._lastX=de.clientX,this._lastY=de.clientY,Pe();for(var e=document.elementFromPoint(de.clientX,de.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(de.clientX,de.clientY))!==t;)t=e;if($.parentNode[z]._isOutsideThisEl(e),t)do{if(t[z]){if(t[z]._onDragOver({clientX:de.clientX,clientY:de.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Me()}},_onTouchMove:function(e){if(ce){var t=this.options,r=t.fallbackTolerance,n=t.fallbackOffset,i=e.touches?e.touches[0]:e,a=Q&&k(Q),s=Q&&a&&a.a,o=Q&&a&&a.d,l=je&&be&&O(be),u=(i.clientX-ce.clientX+n.x)/(s||1)+(l?l[0]-ke[0]:0)/(s||1),c=(i.clientY-ce.clientY+n.y)/(o||1)+(l?l[1]-ke[1]:0)/(o||1);if(!Be.active&&!we){if(r&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(Q){a?(a.e+=u-(he||0),a.f+=c-(fe||0)):a={a:1,b:0,c:0,d:1,e:u,f:c};var d="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");T(Q,"webkitTransform",d),T(Q,"mozTransform",d),T(Q,"msTransform",d),T(Q,"transform",d),he=u,fe=c,de=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Q){var e=this.options.fallbackOnBody?document.body:Z,t=j($,!0,je,!0,e),r=this.options;if(je){for(be=e;"static"===T(be,"position")&&"none"===T(be,"transform")&&be!==document;)be=be.parentNode;be!==document.body&&be!==document.documentElement?(be===document&&(be=C()),t.top+=be.scrollTop,t.left+=be.scrollLeft):be=C(),ke=O(be)}x(Q=$.cloneNode(!0),r.ghostClass,!1),x(Q,r.fallbackClass,!0),x(Q,r.dragClass,!0),T(Q,"transition",""),T(Q,"transform",""),T(Q,"box-sizing","border-box"),T(Q,"margin",0),T(Q,"top",t.top),T(Q,"left",t.left),T(Q,"width",t.width),T(Q,"height",t.height),T(Q,"opacity","0.8"),T(Q,"position",je?"absolute":"fixed"),T(Q,"zIndex","100000"),T(Q,"pointerEvents","none"),Be.ghost=Q,e.appendChild(Q),T(Q,"transform-origin",pe/parseInt(Q.style.width)*100+"% "+ge/parseInt(Q.style.height)*100+"%")}},_onDragStart:function(e,t){var r=this,n=e.dataTransfer,i=r.options;X("dragStart",this,{evt:e}),Be.eventCanceled?this._onDrop():(X("setupClone",this),Be.eventCanceled||((re=B($)).draggable=!1,re.style["will-change"]="",this._hideClone(),x(re,this.options.chosenClass,!1),Be.clone=re),r.cloneId=Ve(function(){X("clone",r),Be.eventCanceled||(r.options.removeCloneOnHide||Z.insertBefore(re,$),r._hideClone(),Y({sortable:r,name:"clone"}))}),!t&&x($,i.dragClass,!0),t?(Se=!0,r._loopId=setInterval(r._emulateDragOver,50)):(_(document,"mouseup",r._onDrop),_(document,"touchend",r._onDrop),_(document,"touchcancel",r._onDrop),n&&(n.effectAllowed="move",i.setData&&i.setData.call(r,n,$)),v(document,"drop",r),T($,"transform","translateZ(0)")),we=!0,r._dragStartId=Ve(r._dragStarted.bind(r,t,e)),v(document,"selectstart",r),me=!0,f&&T(document.body,"user-select","none"))},_onDragOver:function(e){var t,r,n,i,a=this.el,o=e.target,l=this.options,u=l.group,c=Be.active,d=le===u,h=l.sort,f=ue||c,p=this,g=!1;if(!Ae){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),o=w(o,l.draggable,a,!0),M("dragOver"),Be.eventCanceled)return g;if($.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||p._ignoreWhileAnimating===o)return B(!1);if(Se=!1,c&&!l.disabled&&(d?h||(n=!Z.contains($)):ue===this||(this.lastPutMode=le.checkPull(this,c,$,e))&&u.checkPut(this,c,$,e))){if(i="vertical"===this._getDirection(e,o),t=j($),M("dragOverValid"),Be.eventCanceled)return g;if(n)return J=Z,N(),this._hideClone(),M("revert"),Be.eventCanceled||(ee?Z.insertBefore($,ee):Z.appendChild($)),B(!0);var m=L(a,l.draggable);if(!m||function(e,t,r){var n=j(L(r.el,r.options.draggable));return t?e.clientX>n.right+10||e.clientX<=n.right&&e.clientY>n.bottom&&e.clientX>=n.left:e.clientX>n.right&&e.clientY>n.top||e.clientX<=n.right&&e.clientY>n.bottom+10}(e,i,this)&&!m.animated){if(m===$)return B(!1);if(m&&a===e.target&&(o=m),o&&(r=j(o)),!1!==Ue(Z,a,$,t,o,r,e,!!o))return N(),a.appendChild($),J=a,U(),B(!0)}else if(o.parentNode===a){r=j(o);var v,_,y,b=$.parentNode!==a,S=!function(e,t,r){var n=r?e.left:e.top,i=r?e.right:e.bottom,a=r?e.width:e.height,s=r?t.left:t.top,o=r?t.right:t.bottom,l=r?t.width:t.height;return n===s||i===o||n+a/2===s+l/2}($.animated&&$.toRect||t,o.animated&&o.toRect||r,i),E=i?"top":"left",k=D(o,"top","top")||D($,"top","top"),A=k?k.scrollTop:void 0;if(ve!==o&&(_=r[E],xe=!1,Te=!S&&l.invertSwap||b),0!==(v=function(e,t,r,n,i,a,s,o){var l=n?e.clientY:e.clientX,u=n?r.height:r.width,c=n?r.top:r.left,d=n?r.bottom:r.right,h=!1;if(!s)if(o&&ye<u*i){if(!xe&&(1===_e?l>c+u*a/2:l<d-u*a/2)&&(xe=!0),xe)h=!0;else if(1===_e?l<c+ye:l>d-ye)return-_e}else if(l>c+u*(1-i)/2&&l<d-u*(1-i)/2)return function(e){return I($)<I(e)?1:-1}(t);if((h=h||s)&&(l<c+u*a/2||l>d-u*a/2))return l>c+u/2?1:-1;return 0}(e,o,r,i,S?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,Te,ve===o))){var C=I($);do{C-=v,y=J.children[C]}while(y&&("none"===T(y,"display")||y===Q))}if(0===v||y===o)return B(!1);ve=o,_e=v;var R=o.nextElementSibling,O=!1,P=Ue(Z,a,$,t,o,r,e,O=1===v);if(!1!==P)return 1!==P&&-1!==P||(O=1===P),Ae=!0,setTimeout(ze,30),N(),O&&!R?a.appendChild($):o.parentNode.insertBefore($,O?R:o),k&&F(k,0,A-k.scrollTop),J=$.parentNode,void 0===_||Te||(ye=Math.abs(_-j(o)[E])),U(),B(!0)}if(a.contains($))return B(!1)}return!1}function M(l,u){X(l,p,s({evt:e,isOwner:d,axis:i?"vertical":"horizontal",revert:n,dragRect:t,targetRect:r,canSort:h,fromSortable:f,target:o,completed:B,onMove:function(r,n){return Ue(Z,a,$,t,r,j(r),e,n)},changed:U},u))}function N(){M("dragOverAnimationCapture"),p.captureAnimationState(),p!==f&&f.captureAnimationState()}function B(t){return M("dragOverCompleted",{insertion:t}),t&&(d?c._hideClone():c._showClone(p),p!==f&&(x($,ue?ue.options.ghostClass:c.options.ghostClass,!1),x($,l.ghostClass,!0)),ue!==p&&p!==Be.active?ue=p:p===Be.active&&ue&&(ue=null),f===p&&(p._ignoreWhileAnimating=o),p.animateAll(function(){M("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(o===$&&!$.animated||o===a&&!o.animated)&&(ve=null),l.dragoverBubble||e.rootEl||o===document||($.parentNode[z]._isOutsideThisEl(e.target),!t&&Ne(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),g=!0}function U(){ae=I($),oe=I($,l.draggable),Y({sortable:p,name:"change",toEl:a,newIndex:ae,newDraggableIndex:oe,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){_(document,"mousemove",this._onTouchMove),_(document,"touchmove",this._onTouchMove),_(document,"pointermove",this._onTouchMove),_(document,"dragover",Ne),_(document,"mousemove",Ne),_(document,"touchmove",Ne)},_offUpEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._onDrop),_(e,"touchend",this._onDrop),_(e,"pointerup",this._onDrop),_(e,"touchcancel",this._onDrop),_(document,"selectstart",this)},_onDrop:function(e){var t=this.el,r=this.options;ae=I($),oe=I($,r.draggable),X("drop",this,{evt:e}),J=$&&$.parentNode,ae=I($),oe=I($,r.draggable),Be.eventCanceled?this._nulling():(we=!1,Te=!1,xe=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ke(this.cloneId),Ke(this._dragStartId),this.nativeDraggable&&(_(document,"drop",this),_(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),f&&T(document.body,"user-select",""),e&&(me&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),Q&&Q.parentNode&&Q.parentNode.removeChild(Q),(Z===J||ue&&"clone"!==ue.lastPutMode)&&re&&re.parentNode&&re.parentNode.removeChild(re),$&&(this.nativeDraggable&&_($,"dragend",this),Ge($),$.style["will-change"]="",me&&!we&&x($,ue?ue.options.ghostClass:this.options.ghostClass,!1),x($,this.options.chosenClass,!1),Y({sortable:this,name:"unchoose",toEl:J,newIndex:null,newDraggableIndex:null,originalEvent:e}),Z!==J?(ae>=0&&(Y({rootEl:J,name:"add",toEl:J,fromEl:Z,originalEvent:e}),Y({sortable:this,name:"remove",toEl:J,originalEvent:e}),Y({rootEl:J,name:"sort",toEl:J,fromEl:Z,originalEvent:e}),Y({sortable:this,name:"sort",toEl:J,originalEvent:e})),ue&&ue.save()):ae!==ie&&ae>=0&&(Y({sortable:this,name:"update",toEl:J,originalEvent:e}),Y({sortable:this,name:"sort",toEl:J,originalEvent:e})),Be.active&&(null!=ae&&-1!==ae||(ae=ie,oe=se),Y({sortable:this,name:"end",toEl:J,originalEvent:e}),this.save()))),this._nulling())},_nulling:function(){X("nulling",this),Z=$=J=Q=ee=re=te=ne=ce=de=me=ae=oe=ie=se=ve=_e=ue=le=Be.dragged=Be.ghost=Be.clone=Be.active=null,Ce.forEach(function(e){e.checked=!0}),Ce.length=he=fe=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":$&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],r=this.el.children,n=0,i=r.length,a=this.options;n<i;n++)w(e=r[n],a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||He(e));return t},sort:function(e){var t={},r=this.el;this.toArray().forEach(function(e,n){var i=r.children[n];w(i,this.options.draggable,r,!1)&&(t[e]=i)},this),e.forEach(function(e){t[e]&&(r.removeChild(t[e]),r.appendChild(t[e]))})},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return w(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var r=this.options;if(void 0===t)return r[e];var n=W.modifyOption(this,e,t);r[e]=void 0!==n?n:t,"group"===e&&Oe(r)},destroy:function(){X("destroy",this);var e=this.el;e[z]=null,_(e,"mousedown",this._onTapStart),_(e,"touchstart",this._onTapStart),_(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(_(e,"dragover",this),_(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),Ee.splice(Ee.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ne){if(X("hideClone",this),Be.eventCanceled)return;T(re,"display","none"),this.options.removeCloneOnHide&&re.parentNode&&re.parentNode.removeChild(re),ne=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(ne){if(X("showClone",this),Be.eventCanceled)return;Z.contains($)&&!this.options.group.revertClone?Z.insertBefore(re,$):ee?Z.insertBefore(re,ee):Z.appendChild(re),this.options.group.revertClone&&this.animate($,re),T(re,"display",""),ne=!1}}else this._hideClone()}},v(document,"touchmove",function(e){(Be.active||we)&&e.cancelable&&e.preventDefault()}),Be.utils={on:v,off:_,css:T,find:A,is:function(e,t){return!!w(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},throttle:N,closest:w,toggleClass:x,clone:B,index:I,nextTick:Ve,cancelNextTick:Ke,detectDirection:Ie,getChild:R},Be.get=function(e){return e[z]},Be.mount=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t[0].constructor===Array&&(t=t[0]),t.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Be.utils=s({},Be.utils,e.utils)),W.mount(e)})},Be.create=function(e,t){return new Be(e,t)},Be.version="1.10.0";var We,qe,Xe,Ye,$e,Je,Qe=[],Ze=!1;function et(){Qe.forEach(function(e){clearInterval(e.pid)}),Qe=[]}function tt(){clearInterval(Je)}var rt,nt=N(function(e,t,r,n){if(t.scroll){var i,a=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,o=t.scrollSensitivity,l=t.scrollSpeed,u=C(),c=!1;qe!==r&&(qe=r,et(),We=t.scroll,i=t.scrollFn,!0===We&&(We=P(r,!0)));var d=0,h=We;do{var f=h,p=j(f),g=p.top,m=p.bottom,v=p.left,_=p.right,y=p.width,b=p.height,w=void 0,S=void 0,E=f.scrollWidth,x=f.scrollHeight,k=T(f),A=f.scrollLeft,D=f.scrollTop;f===u?(w=y<E&&("auto"===k.overflowX||"scroll"===k.overflowX||"visible"===k.overflowX),S=b<x&&("auto"===k.overflowY||"scroll"===k.overflowY||"visible"===k.overflowY)):(w=y<E&&("auto"===k.overflowX||"scroll"===k.overflowX),S=b<x&&("auto"===k.overflowY||"scroll"===k.overflowY));var R=w&&(Math.abs(_-a)<=o&&A+y<E)-(Math.abs(v-a)<=o&&!!A),L=S&&(Math.abs(m-s)<=o&&D+b<x)-(Math.abs(g-s)<=o&&!!D);if(!Qe[d])for(var I=0;I<=d;I++)Qe[I]||(Qe[I]={});Qe[d].vx==R&&Qe[d].vy==L&&Qe[d].el===f||(Qe[d].el=f,Qe[d].vx=R,Qe[d].vy=L,clearInterval(Qe[d].pid),0==R&&0==L||(c=!0,Qe[d].pid=setInterval(function(){n&&0===this.layer&&Be.active._onTouchMove($e);var t=Qe[this.layer].vy?Qe[this.layer].vy*l:0,r=Qe[this.layer].vx?Qe[this.layer].vx*l:0;"function"==typeof i&&"continue"!==i.call(Be.dragged.parentNode[z],r,t,e,$e,Qe[this.layer].el)||F(Qe[this.layer].el,r,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&h!==u&&(h=P(h,!1)));Ze=c}},30),it=function(e){var t=e.originalEvent,r=e.putSortable,n=e.dragEl,i=e.activeSortable,a=e.dispatchSortableEvent,s=e.hideGhostForTarget,o=e.unhideGhostForTarget,l=r||i;s();var u=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,c=document.elementFromPoint(u.clientX,u.clientY);o(),l&&!l.el.contains(c)&&(a("spill"),this.onSpill({dragEl:n,putSortable:r}))};function at(){}function st(){}function ot(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(e){var t=e.dragEl;rt=t},dragOverValid:function(e){var t=e.completed,r=e.target,n=e.onMove,i=e.activeSortable,a=e.changed,s=e.cancel;if(i.options.swap){var o=this.sortable.el,l=this.options;if(r&&r!==o){var u=rt;!1!==n(r)?(x(r,l.swapClass,!0),rt=r):rt=null,u&&u!==rt&&x(u,l.swapClass,!1)}a(),t(!0),s()}},drop:function(e){var t=e.activeSortable,r=e.putSortable,n=e.dragEl,i=r||this.sortable,a=this.options;rt&&x(rt,a.swapClass,!1),rt&&(a.swap||r&&r.options.swap)&&n!==rt&&(i.captureAnimationState(),i!==t&&t.captureAnimationState(),function(e,t){var r,n,i=e.parentNode,a=t.parentNode;if(!i||!a||i.isEqualNode(t)||a.isEqualNode(e))return;r=I(e),n=I(t),i.isEqualNode(a)&&r<n&&n++;i.insertBefore(t,i.children[r]),a.insertBefore(e,a.children[n])}(n,rt),i.animateAll(),i!==t&&t.animateAll())},nulling:function(){rt=null}},a(e,{pluginName:"swap",eventProperties:function(){return{swapItem:rt}}})}at.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var n=R(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(t,n):this.sortable.el.appendChild(t),this.sortable.animateAll(),r&&r.animateAll()},drop:it},a(at,{pluginName:"revertOnSpill"}),st.prototype={onSpill:function(e){var t=e.dragEl,r=e.putSortable||this.sortable;r.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),r.animateAll()},drop:it},a(st,{pluginName:"removeOnSpill"});var lt,ut,ct,dt,ht,ft=[],pt=[],gt=!1,mt=!1,vt=!1;function _t(){function e(e){for(var t in this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this));e.options.supportPointer?v(document,"pointerup",this._deselectMultiDrag):(v(document,"mouseup",this._deselectMultiDrag),v(document,"touchend",this._deselectMultiDrag)),v(document,"keydown",this._checkKeyDown),v(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(t,r){var n="";ft.length&&ut===e?ft.forEach(function(e,t){n+=(t?", ":"")+e.textContent}):n=r.textContent,t.setData("Text",n)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){var t=e.dragEl;ct=t},delayEnded:function(){this.isMultiDrag=~ft.indexOf(ct)},setupClone:function(e){var t=e.sortable,r=e.cancel;if(this.isMultiDrag){for(var n=0;n<ft.length;n++)pt.push(B(ft[n])),pt[n].sortableIndex=ft[n].sortableIndex,pt[n].draggable=!1,pt[n].style["will-change"]="",x(pt[n],this.options.selectedClass,!1),ft[n]===ct&&x(pt[n],this.options.chosenClass,!1);t._hideClone(),r()}},clone:function(e){var t=e.sortable,r=e.rootEl,n=e.dispatchSortableEvent,i=e.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||ft.length&&ut===t&&(yt(!0,r),n("clone"),i()))},showClone:function(e){var t=e.cloneNowShown,r=e.rootEl,n=e.cancel;this.isMultiDrag&&(yt(!1,r),pt.forEach(function(e){T(e,"display","")}),t(),ht=!1,n())},hideClone:function(e){var t=this,r=(e.sortable,e.cloneNowHidden),n=e.cancel;this.isMultiDrag&&(pt.forEach(function(e){T(e,"display","none"),t.options.removeCloneOnHide&&e.parentNode&&e.parentNode.removeChild(e)}),r(),ht=!0,n())},dragStartGlobal:function(e){e.sortable;!this.isMultiDrag&&ut&&ut.multiDrag._deselectMultiDrag(),ft.forEach(function(e){e.sortableIndex=I(e)}),ft=ft.sort(function(e,t){return e.sortableIndex-t.sortableIndex}),vt=!0},dragStarted:function(e){var t=this,r=e.sortable;if(this.isMultiDrag){if(this.options.sort&&(r.captureAnimationState(),this.options.animation)){ft.forEach(function(e){e!==ct&&T(e,"position","absolute")});var n=j(ct,!1,!0,!0);ft.forEach(function(e){e!==ct&&U(e,n)}),mt=!0,gt=!0}r.animateAll(function(){mt=!1,gt=!1,t.options.animation&&ft.forEach(function(e){G(e)}),t.options.sort&&bt()})}},dragOver:function(e){var t=e.target,r=e.completed,n=e.cancel;mt&&~ft.indexOf(t)&&(r(!1),n())},revert:function(e){var t=e.fromSortable,r=e.rootEl,n=e.sortable,i=e.dragRect;ft.length>1&&(ft.forEach(function(e){n.addAnimationState({target:e,rect:mt?j(e):i}),G(e),e.fromRect=i,t.removeAnimationState(e)}),mt=!1,function(e,t){ft.forEach(function(r,n){var i=t.children[r.sortableIndex+(e?Number(n):0)];i?t.insertBefore(r,i):t.appendChild(r)})}(!this.options.removeCloneOnHide,r))},dragOverCompleted:function(e){var t=e.sortable,r=e.isOwner,n=e.insertion,i=e.activeSortable,a=e.parentEl,s=e.putSortable,o=this.options;if(n){if(r&&i._hideClone(),gt=!1,o.animation&&ft.length>1&&(mt||!r&&!i.options.sort&&!s)){var l=j(ct,!1,!0,!0);ft.forEach(function(e){e!==ct&&(U(e,l),a.appendChild(e))}),mt=!0}if(!r)if(mt||bt(),ft.length>1){var u=ht;i._showClone(t),i.options.animation&&!ht&&u&&pt.forEach(function(e){i.addAnimationState({target:e,rect:dt}),e.fromRect=dt,e.thisAnimationDuration=null})}else i._showClone(t)}},dragOverAnimationCapture:function(e){var t=e.dragRect,r=e.isOwner,n=e.activeSortable;if(ft.forEach(function(e){e.thisAnimationDuration=null}),n.options.animation&&!r&&n.multiDrag.isMultiDrag){dt=a({},t);var i=k(ct,!0);dt.top-=i.f,dt.left-=i.e}},dragOverAnimationComplete:function(){mt&&(mt=!1,bt())},drop:function(e){var t=e.originalEvent,r=e.rootEl,n=e.parentEl,i=e.sortable,a=e.dispatchSortableEvent,s=e.oldIndex,o=e.putSortable,l=o||this.sortable;if(t){var u=this.options,c=n.children;if(!vt)if(u.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),x(ct,u.selectedClass,!~ft.indexOf(ct)),~ft.indexOf(ct))ft.splice(ft.indexOf(ct),1),lt=null,q({sortable:i,rootEl:r,name:"deselect",targetEl:ct,originalEvt:t});else{if(ft.push(ct),q({sortable:i,rootEl:r,name:"select",targetEl:ct,originalEvt:t}),t.shiftKey&&lt&&i.el.contains(lt)){var d,h,f=I(lt),p=I(ct);if(~f&&~p&&f!==p)for(p>f?(h=f,d=p):(h=p,d=f+1);h<d;h++)~ft.indexOf(c[h])||(x(c[h],u.selectedClass,!0),ft.push(c[h]),q({sortable:i,rootEl:r,name:"select",targetEl:c[h],originalEvt:t}))}else lt=ct;ut=l}if(vt&&this.isMultiDrag){if((n[z].options.sort||n!==r)&&ft.length>1){var g=j(ct),m=I(ct,":not(."+this.options.selectedClass+")");if(!gt&&u.animation&&(ct.thisAnimationDuration=null),l.captureAnimationState(),!gt&&(u.animation&&(ct.fromRect=g,ft.forEach(function(e){if(e.thisAnimationDuration=null,e!==ct){var t=mt?j(e):g;e.fromRect=t,l.addAnimationState({target:e,rect:t})}})),bt(),ft.forEach(function(e){c[m]?n.insertBefore(e,c[m]):n.appendChild(e),m++}),s===I(ct))){var v=!1;ft.forEach(function(e){e.sortableIndex===I(e)||(v=!0)}),v&&a("update")}ft.forEach(function(e){G(e)}),l.animateAll()}ut=l}(r===n||o&&"clone"!==o.lastPutMode)&&pt.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})}},nullingGlobal:function(){this.isMultiDrag=vt=!1,pt.length=0},destroyGlobal:function(){this._deselectMultiDrag(),_(document,"pointerup",this._deselectMultiDrag),_(document,"mouseup",this._deselectMultiDrag),_(document,"touchend",this._deselectMultiDrag),_(document,"keydown",this._checkKeyDown),_(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(!vt&&ut===this.sortable&&!(e&&w(e.target,this.options.draggable,this.sortable.el,!1)||e&&0!==e.button))for(;ft.length;){var t=ft[0];x(t,this.options.selectedClass,!1),ft.shift(),q({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:t,originalEvt:e})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},a(e,{pluginName:"multiDrag",utils:{select:function(e){var t=e.parentNode[z];t&&t.options.multiDrag&&!~ft.indexOf(e)&&(ut&&ut!==t&&(ut.multiDrag._deselectMultiDrag(),ut=t),x(e,t.options.selectedClass,!0),ft.push(e))},deselect:function(e){var t=e.parentNode[z],r=ft.indexOf(e);t&&t.options.multiDrag&&~r&&(x(e,t.options.selectedClass,!1),ft.splice(r,1))}},eventProperties:function(){var e=this,t=[],r=[];return ft.forEach(function(n){var i;t.push({multiDragElement:n,index:n.sortableIndex}),i=mt&&n!==ct?-1:mt?I(n,":not(."+e.options.selectedClass+")"):I(n),r.push({multiDragElement:n,index:i})}),{items:l(ft),clones:[].concat(pt),oldIndicies:t,newIndicies:r}},optionListeners:{multiDragKey:function(e){return"ctrl"===(e=e.toLowerCase())?e="Control":e.length>1&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})}function yt(e,t){pt.forEach(function(r,n){var i=t.children[r.sortableIndex+(e?Number(n):0)];i?t.insertBefore(r,i):t.appendChild(r)})}function bt(){ft.forEach(function(e){e!==ct&&e.parentNode&&e.parentNode.removeChild(e)})}Be.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?v(document,"dragover",this._handleAutoScroll):this.options.supportPointer?v(document,"pointermove",this._handleFallbackAutoScroll):t.touches?v(document,"touchmove",this._handleFallbackAutoScroll):v(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?_(document,"dragover",this._handleAutoScroll):(_(document,"pointermove",this._handleFallbackAutoScroll),_(document,"touchmove",this._handleFallbackAutoScroll),_(document,"mousemove",this._handleFallbackAutoScroll)),tt(),et(),clearTimeout(S),S=void 0},nulling:function(){$e=qe=We=Ze=Je=Xe=Ye=null,Qe.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var r=this,n=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,a=document.elementFromPoint(n,i);if($e=e,t||d||c||f){nt(e,this.options,a,t);var s=P(a,!0);!Ze||Je&&n===Xe&&i===Ye||(Je&&tt(),Je=setInterval(function(){var a=P(document.elementFromPoint(n,i),!0);a!==s&&(s=a,et()),nt(e,r.options,a,t)},10),Xe=n,Ye=i)}else{if(!this.options.bubbleScroll||P(a,!0)===C())return void et();nt(e,this.options,P(a,!1),!1)}}},a(e,{pluginName:"scroll",initializeByDefault:!0})}),Be.mount(st,at),t.default=Be},function(e,t,r){var n;!function(r,i){var a=this;void 0===(n=function(){return function(e){"use strict";return t=[function(e,t){var r=t(23),n=t(23);e.debugMode=n.debugMode,e.verboseMode=n.verboseMode;var i=t(33),a=t(33);e.Set=a.Set;var s=t(30),o=t(30);e.Map=o.Map;var l=t(32),u=t(32);e.Promise=u.Promise,e.DeferredPromise=u.DeferredPromise;var c=t(37);e.webworker=c;var d=t(8);e.parts=d;var h=t(1);e.parser=h;var f=t(14);e.renderers=f;var p=t(24);e.ASS=p.ASS;var g=t(25);e.Attachment=g.Attachment,e.AttachmentType=g.AttachmentType;var m=t(26);e.Dialogue=m.Dialogue;var v=t(28);e.ScriptProperties=v.ScriptProperties;var _=t(29);e.Style=_.Style;var y=t(27);e.BorderStyle=y.BorderStyle,e.Format=y.Format,e.WrappingStyle=y.WrappingStyle,Object.defineProperties(e,{debugMode:{get:function(){return r.debugMode},set:r.setDebugMode},verboseMode:{get:function(){return r.verboseMode},set:r.setVerboseMode},Set:{get:function(){return i.Set},set:i.setImplementation},Map:{get:function(){return s.Map},set:s.setImplementation},Promise:{get:function(){return l.Promise},set:l.setImplementation}})},function(e,t){var r=t(3);e.parse=r.parse;var n=t(5);e.BrowserReadableStream=n.BrowserReadableStream,e.StringStream=n.StringStream,e.XhrStream=n.XhrStream;var i=t(4);e.StreamParser=i.StreamParser,e.SrtStreamParser=i.SrtStreamParser},function(e,t){var r=t(30);function n(e){var t=e.indexOf(":");return-1===t?null:{name:e.substr(0,t),value:e.substr(t+1).replace(/^\s+/,"")}}e.parseLineIntoProperty=n,e.parseLineIntoTypedTemplate=function(e,t){var i=n(e);if(null===i)return null;var a=i.value.split(",");a.length>t.length&&(a[t.length-1]=a.slice(t.length-1).join(","));var s=new r.Map;return t.forEach(function(e,t){s.set(e,a[t])}),{type:i.name,template:s}}},function(e,t){var r=t(8),n=t(23),i=new(t(30).Map);function a(e,t){var r=new s(e,t);if(null===r.result||r.result.end!==e.length)throw n.debugMode&&console.error("Parse failed. %s %s %o",t,e,r.result),new Error("Parse failed.");return r.result.value}e.parse=a;var s=function(){function e(e,t){this._input=e,this._parseTree=new d(null),this._result=i.get(t).call(this,this._parseTree)}return Object.defineProperty(e.prototype,"result",{get:function(){return this._result},enumerable:!0,configurable:!0}),e.prototype.parse_dialogueParts=function(e){var t,n=new d(e);for(n.value=[];this._haveMore();){var i=this.parse_enclosedTags(n);if(null!==i)(t=n.value).push.apply(t,i.value);else{var s=this.parse_newline(n)||this.parse_hardspace(n)||this.parse_text(n);if(null===s)return e.pop(),null;if(s.value instanceof r.Text&&n.value[n.value.length-1]instanceof r.Text){var o=n.value[n.value.length-1];n.value[n.value.length-1]=new r.Text(o.value+s.value.value)}else n.value.push(s.value)}}var l=!1;return n.value.forEach(function(e,t){e instanceof r.DrawingMode?l=0!==e.scale:e instanceof r.Text&&l&&(n.value[t]=new r.DrawingInstructions(a(e.value,"drawingInstructions")))}),n},e.prototype.parse_enclosedTags=function(e){var t=new d(e);if(t.value=[],null===this.read(t,"{"))return e.pop(),null;for(var n=this._peek();this._haveMore()&&"}"!==n;n=this._peek()){var i=null;if(null!==this.read(t,"\\")&&null===(i=this.parse_tag_alpha(t)||this.parse_tag_iclip(t)||this.parse_tag_xbord(t)||this.parse_tag_ybord(t)||this.parse_tag_xshad(t)||this.parse_tag_yshad(t)||this.parse_tag_blur(t)||this.parse_tag_bord(t)||this.parse_tag_clip(t)||this.parse_tag_fade(t)||this.parse_tag_fscx(t)||this.parse_tag_fscy(t)||this.parse_tag_move(t)||this.parse_tag_shad(t)||this.parse_tag_fad(t)||this.parse_tag_fax(t)||this.parse_tag_fay(t)||this.parse_tag_frx(t)||this.parse_tag_fry(t)||this.parse_tag_frz(t)||this.parse_tag_fsp(t)||this.parse_tag_fsplus(t)||this.parse_tag_fsminus(t)||this.parse_tag_org(t)||this.parse_tag_pbo(t)||this.parse_tag_pos(t)||this.parse_tag_an(t)||this.parse_tag_be(t)||this.parse_tag_fn(t)||this.parse_tag_fr(t)||this.parse_tag_fs(t)||this.parse_tag_kf(t)||this.parse_tag_ko(t)||this.parse_tag_1a(t)||this.parse_tag_1c(t)||this.parse_tag_2a(t)||this.parse_tag_2c(t)||this.parse_tag_3a(t)||this.parse_tag_3c(t)||this.parse_tag_4a(t)||this.parse_tag_4c(t)||this.parse_tag_a(t)||this.parse_tag_b(t)||this.parse_tag_c(t)||this.parse_tag_i(t)||this.parse_tag_k(t)||this.parse_tag_K(t)||this.parse_tag_p(t)||this.parse_tag_q(t)||this.parse_tag_r(t)||this.parse_tag_s(t)||this.parse_tag_t(t)||this.parse_tag_u(t))&&t.pop(),null===i&&(i=this.parse_comment(t)),null===i)return e.pop(),null;i.value instanceof r.Comment&&t.value[t.value.length-1]instanceof r.Comment?t.value[t.value.length-1]=new r.Comment(t.value[t.value.length-1].value+i.value.value):t.value.push(i.value)}return null===this.read(t,"}")?(e.pop(),null):t},e.prototype.parse_newline=function(e){var t=new d(e);return null===this.read(t,"\\N")?(e.pop(),null):(t.value=new r.NewLine,t)},e.prototype.parse_hardspace=function(e){var t=new d(e);return null===this.read(t,"\\h")?(e.pop(),null):(t.value=new r.Text(" "),t)},e.prototype.parse_text=function(e){var t=this._peek(),n=new d(e),i=new d(n,t);return n.value=new r.Text(i.value),n},e.prototype.parse_comment=function(e){var t=this._peek(),n=new d(e),i=new d(n,t);return n.value=new r.Comment(i.value),n},e.prototype.parse_tag_a=function(e){var t=new d(e);if(null===this.read(t,"a"))return e.pop(),null;var n=this._peek();switch(n){case"1":var i=this._peek(2);switch(i){case"10":case"11":n=i}break;case"2":case"3":case"5":case"6":case"7":case"9":break;default:return e.pop(),null}var a=null;switch(new d(t,n).value){case"1":a=1;break;case"2":a=2;break;case"3":a=3;break;case"5":a=7;break;case"6":a=8;break;case"7":a=9;break;case"9":a=4;break;case"10":a=5;break;case"11":a=6}return t.value=new r.Alignment(a),t},e.prototype.parse_tag_alpha=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_an=function(e){var t=new d(e);if(null===this.read(t,"an"))return e.pop(),null;var n=this._peek();if(n<"1"||n>"9")return e.pop(),null;var i=new d(t,n);return t.value=new r.Alignment(parseInt(i.value)),t},e.prototype.parse_tag_b=function(e){var t=new d(e);if(null===this.read(t,"b"))return e.pop(),null;var n=null,i=this._peek();return i>="1"&&i<="9"&&"00"===(i=this._peek(3)).substr(1)&&((n=new d(t,i)).value=parseInt(n.value)),null===n&&(n=this.parse_enableDisable(t)),t.value=null!==n?new r.Bold(n.value):new r.Bold(null),t},e.prototype.parse_tag_be=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_blur=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_bord=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_c=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_clip=function(e){return this._parse_tag_clip_or_iclip("clip",e)},e.prototype.parse_tag_fad=function(e){var t=new d(e);if(null===this.read(t,"fad"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var n=this.parse_decimal(t);if(null===n)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var i=this.parse_decimal(t);return null===i?(e.pop(),null):null===this.read(t,")")?(e.pop(),null):(t.value=new r.Fade(n.value/1e3,i.value/1e3),t)},e.prototype.parse_tag_fade=function(e){var t=new d(e);if(null===this.read(t,"fade"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var n=this.parse_decimal(t);if(null===n)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var i=this.parse_decimal(t);if(null===i)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var a=this.parse_decimal(t);if(null===a)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var s=this.parse_decimal(t);if(null===s)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var o=this.parse_decimal(t);if(null===o)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var l=this.parse_decimal(t);if(null===l)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var u=this.parse_decimal(t);return null===u?(e.pop(),null):null===this.read(t,")")?(e.pop(),null):(t.value=new r.ComplexFade(1-n.value/255,1-i.value/255,1-a.value/255,s.value/1e3,o.value/1e3,l.value/1e3,u.value/1e3),t)},e.prototype.parse_tag_fax=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_fay=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_fn=function(e){var t=new d(e);if(null===this.read(t,"fn"))return e.pop(),null;for(var n=new d(t,""),i=this._peek();this._haveMore()&&"\\"!==i&&"}"!==i;i=this._peek())n.value+=i;return n.value.length>0?t.value=new r.FontName(n.value):t.value=new r.FontName(null),t},e.prototype.parse_tag_fr=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_frx=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_fry=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_frz=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_fs=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_fsplus=function(e){var t=new d(e);if(null===this.read(t,"fs+"))return e.pop(),null;var n=this.parse_decimal(t);return null===n?(e.pop(),null):(t.value=new r.FontSizePlus(n.value),t)},e.prototype.parse_tag_fsminus=function(e){var t=new d(e);if(null===this.read(t,"fs-"))return e.pop(),null;var n=this.parse_decimal(t);return null===n?(e.pop(),null):(t.value=new r.FontSizeMinus(n.value),t)},e.prototype.parse_tag_fscx=function(e){var t=new d(e);if(null===this.read(t,"fscx"))return e.pop(),null;var n=this.parse_decimal(t);return t.value=null!==n?new r.FontScaleX(n.value/100):new r.FontScaleX(null),t},e.prototype.parse_tag_fscy=function(e){var t=new d(e);if(null===this.read(t,"fscy"))return e.pop(),null;var n=this.parse_decimal(t);return t.value=null!==n?new r.FontScaleY(n.value/100):new r.FontScaleY(null),t},e.prototype.parse_tag_fsp=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_i=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_iclip=function(e){return this._parse_tag_clip_or_iclip("iclip",e)},e.prototype.parse_tag_k=function(e){var t=new d(e);if(null===this.read(t,"k"))return e.pop(),null;var n=this.parse_decimal(t);return null===n?(e.pop(),null):(t.value=new r.ColorKaraoke(n.value/100),t)},e.prototype.parse_tag_K=function(e){var t=new d(e);if(null===this.read(t,"K"))return e.pop(),null;var n=this.parse_decimal(t);return null===n?(e.pop(),null):(t.value=new r.SweepingColorKaraoke(n.value/100),t)},e.prototype.parse_tag_kf=function(e){var t=new d(e);if(null===this.read(t,"kf"))return e.pop(),null;var n=this.parse_decimal(t);return null===n?(e.pop(),null):(t.value=new r.SweepingColorKaraoke(n.value/100),t)},e.prototype.parse_tag_ko=function(e){var t=new d(e);if(null===this.read(t,"ko"))return e.pop(),null;var n=this.parse_decimal(t);return null===n?(e.pop(),null):(t.value=new r.OutlineKaraoke(n.value/100),t)},e.prototype.parse_tag_move=function(e){var t=new d(e);if(null===this.read(t,"move"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var n=this.parse_decimal(t);if(null===n)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var i=this.parse_decimal(t);if(null===i)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var a=this.parse_decimal(t);if(null===a)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var s=this.parse_decimal(t);if(null===s)return e.pop(),null;var o=null,l=null;if(null!==this.read(t,",")){if(null===(o=this.parse_decimal(t)))return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;if(null===(l=this.parse_decimal(t)))return e.pop(),null}return null===this.read(t,")")?(e.pop(),null):(t.value=new r.Move(n.value,i.value,a.value,s.value,null!==o?o.value/1e3:null,null!==l?l.value/1e3:null),t)},e.prototype.parse_tag_org=function(e){var t=new d(e);if(null===this.read(t,"org"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var n=this.parse_decimal(t);if(null===n)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var i=this.parse_decimal(t);return null===i?(e.pop(),null):null===this.read(t,")")?(e.pop(),null):(t.value=new r.RotationOrigin(n.value,i.value),t)},e.prototype.parse_tag_p=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_pbo=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_pos=function(e){var t=new d(e);if(null===this.read(t,"pos"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var n=this.parse_decimal(t);if(null===n)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var i=this.parse_decimal(t);return null===i?(e.pop(),null):null===this.read(t,")")?(e.pop(),null):(t.value=new r.Position(n.value,i.value),t)},e.prototype.parse_tag_q=function(e){var t=new d(e);if(null===this.read(t,"q"))return e.pop(),null;var n=this._peek();if(n<"0"||n>"3")return e.pop(),null;var i=new d(t,n);return t.value=new r.WrappingStyle(parseInt(i.value)),t},e.prototype.parse_tag_r=function(e){var t=new d(e);if(null===this.read(t,"r"))return e.pop(),null;for(var n=new d(t,""),i=this._peek();this._haveMore()&&"\\"!==i&&"}"!==i;i=this._peek())n.value+=i;return n.value.length>0?t.value=new r.Reset(n.value):t.value=new r.Reset(null),t},e.prototype.parse_tag_s=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_shad=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_t=function(e){var t=new d(e);if(null===this.read(t,"t"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var n=null,i=null,a=null,s=this.parse_decimal(t);if(null!==s){if(null===this.read(t,","))return e.pop(),null;var o=this.parse_decimal(t);if(null!==o){if(n=s,i=o,null===this.read(t,","))return e.pop(),null;var l=this.parse_decimal(t);if(null!==l&&(a=l,null===this.read(t,",")))return e.pop(),null}else if(a=s,null===this.read(t,","))return e.pop(),null}for(var u=[],c=this._peek();this._haveMore()&&")"!==c&&"}"!==c;c=this._peek()){var h=null;if(null!==this.read(t,"\\")&&null===(h=this.parse_tag_alpha(t)||this.parse_tag_iclip(t)||this.parse_tag_xbord(t)||this.parse_tag_ybord(t)||this.parse_tag_xshad(t)||this.parse_tag_yshad(t)||this.parse_tag_blur(t)||this.parse_tag_bord(t)||this.parse_tag_clip(t)||this.parse_tag_fscx(t)||this.parse_tag_fscy(t)||this.parse_tag_shad(t)||this.parse_tag_fax(t)||this.parse_tag_fay(t)||this.parse_tag_frx(t)||this.parse_tag_fry(t)||this.parse_tag_frz(t)||this.parse_tag_fsp(t)||this.parse_tag_fsplus(t)||this.parse_tag_fsminus(t)||this.parse_tag_be(t)||this.parse_tag_fr(t)||this.parse_tag_fs(t)||this.parse_tag_1a(t)||this.parse_tag_1c(t)||this.parse_tag_2a(t)||this.parse_tag_2c(t)||this.parse_tag_3a(t)||this.parse_tag_3c(t)||this.parse_tag_4a(t)||this.parse_tag_4c(t)||this.parse_tag_c(t))&&t.pop(),null===h&&(h=this.parse_comment(t)),null===h)return e.pop(),null;h.value instanceof r.Comment&&u[u.length-1]instanceof r.Comment?u[u.length-1]=new r.Comment(u[u.length-1].value+h.value.value):u.push(h.value)}return this.read(t,")"),t.value=new r.Transform(null!==n?n.value/1e3:null,null!==i?i.value/1e3:null,null!==a?a.value/1e3:null,u),t},e.prototype.parse_tag_u=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_xbord=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_xshad=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_ybord=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_yshad=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_1a=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_1c=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_2a=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_2c=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_3a=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_3c=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_4a=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_4c=function(){throw new Error("Method not implemented.")},e.prototype.parse_drawingInstructions=function(e){var t=new d(e),n=null,i=[];for(t.value=[];this._haveMore();){for(;null!==this.read(t," "););if(!this._haveMore())break;if(null!==n){var a=this.parse_decimal(t);if(null!==a){i.push(a),"m"===n&&2===i.length?(t.value.push(new r.drawing.MoveInstruction(i[0].value,i[1].value)),i.splice(0,i.length)):"l"===n&&2===i.length?(t.value.push(new r.drawing.LineInstruction(i[0].value,i[1].value)),i.splice(0,i.length)):"b"===n&&6===i.length&&(t.value.push(new r.drawing.CubicBezierCurveInstruction(i[0].value,i[1].value,i[2].value,i[3].value,i[4].value,i[5].value)),i.splice(0,i.length));continue}}var s=this.parse_text(t);if(null===s)break;var o=s.value.value;switch(o){case"m":case"l":case"b":n=o,i.splice(0,i.length)}}for(;null!==this.read(t," "););return t},e.prototype.parse_decimalInt32=function(e){for(var t=new d(e),r=null!==this.read(t,"-"),n=new d(t,""),i=this._peek();this._haveMore()&&i>="0"&&i<="9";i=this._peek())n.value+=i;if(0===n.value.length)return e.pop(),null;var a=parseInt(n.value);return a>=4294967295?a=4294967295:r&&(a=-a),t.value=a,t},e.prototype.parse_hexInt32=function(e){for(var t=new d(e),r=null!==this.read(t,"-"),n=new d(t,""),i=this._peek();this._haveMore()&&(i>="0"&&i<="9"||i>="a"&&i<="f"||i>="A"&&i<="F");i=this._peek())n.value+=i;if(0===n.value.length)return e.pop(),null;var a=parseInt(n.value,16);return a>=4294967295?a=4294967295:r&&(a=-a),t.value=a,t},e.prototype.parse_decimalOrHexInt32=function(e){var t=new d(e),r=null!==this.read(t,"&H")||null!==this.read(t,"&h")?this.parse_hexInt32(t):this.parse_decimalInt32(t);return null===r?(e.pop(),null):(t.value=r.value,t)},e.prototype.parse_decimal=function(e){var t=new d(e),r=null!==this.read(t,"-"),n=this.parse_unsignedDecimal(t);return null===n?(e.pop(),null):(t.value=n.value,r&&(t.value=-t.value),t)},e.prototype.parse_unsignedDecimal=function(e){for(var t=new d(e),r=new d(t,""),n=null,i=this._peek();this._haveMore()&&i>="0"&&i<="9";i=this._peek())r.value+=i;if(0===r.value.length)return e.pop(),null;if(null!==this.read(t,".")){n=new d(t,"");for(i=this._peek();this._haveMore()&&i>="0"&&i<="9";i=this._peek())n.value+=i;if(0===n.value.length)return e.pop(),null}return t.value=parseFloat(r.value+(null!==n?"."+n.value:"")),t},e.prototype.parse_enableDisable=function(e){var t=this._peek();if("0"===t||"1"===t){var r=new d(e,t);return r.value="1"===r.value,r}return null},e.prototype.parse_color=function(e){for(var t=new d(e);null!==this.read(t,"&")||null!==this.read(t,"H"););var n=this.parse_hexInt32(t);if(null===n)return e.pop(),null;var i=n.value;for(t.value=new r.Color(255&i,i>>8&255,i>>16&255);null!==this.read(t,"&")||null!==this.read(t,"H"););return t},e.prototype.parse_alpha=function(e){for(var t=new d(e);null!==this.read(t,"&")||null!==this.read(t,"H"););var r=this.parse_hexInt32(t);if(null===r)return e.pop(),null;var n=r.value;for(t.value=1-(255&n)/255;null!==this.read(t,"&")||null!==this.read(t,"H"););return t},e.prototype.parse_colorWithAlpha=function(e){var t=new d(e),n=this.parse_decimalOrHexInt32(t);if(null===n)return e.pop(),null;var i=n.value;return t.value=new r.Color(255&i,i>>8&255,i>>16&255,1-(i>>24&255)/255),t},e.prototype.read=function(e,t){return this._peek(t.length)!==t?null:new d(e,t)},e.prototype._peek=function(e){return void 0===e&&(e=1),1===e?this._input[this._parseTree.end]:this._input.substr(this._parseTree.end,e)},e.prototype._haveMore=function(){return this._parseTree.end<this._input.length},e.prototype._parse_tag_clip_or_iclip=function(e,t){var n=new d(t);if(null===this.read(n,e))return t.pop(),null;if(null===this.read(n,"("))return t.pop(),null;var i=null,s=null,o=null,l=null,u=null,c=null,h=this.parse_decimal(n);if(null!==h){if(null===this.read(n,","))return t.pop(),null;var f=this.parse_decimal(n);null!==f?(i=h,o=f):u=h}if(null!==i&&null!==o){if(null===this.read(n,","))return t.pop(),null;if(s=this.parse_decimal(n),null===this.read(n,","))return t.pop(),null;l=this.parse_decimal(n),n.value=new r.RectangularClip(i.value,o.value,s.value,l.value,"clip"===e)}else{c=new d(n,"");for(var p=this._peek();this._haveMore()&&")"!==p&&"}"!==p;p=this._peek())c.value+=p;n.value=new r.VectorClip(null!==u?u.value:1,a(c.value,"drawingInstructions"),"clip"===e)}return null===this.read(n,")")?(t.pop(),null):n},e}();function o(e,t,r,n){s.prototype["parse_tag_"+e]=function(i){var a=new d(i);if(null===this.read(a,e))return i.pop(),null;var s=r.call(this,a);if(null!==s)a.value=new t(s.value);else{if(n)return i.pop(),null;a.value=new t(null)}return a}}o("alpha",r.Alpha,s.prototype.parse_alpha,!1),o("be",r.Blur,s.prototype.parse_decimal,!1),o("blur",r.GaussianBlur,s.prototype.parse_decimal,!1),o("bord",r.Border,s.prototype.parse_decimal,!1),o("c",r.PrimaryColor,s.prototype.parse_color,!1),o("fax",r.SkewX,s.prototype.parse_decimal,!1),o("fay",r.SkewY,s.prototype.parse_decimal,!1),o("fr",r.RotateZ,s.prototype.parse_decimal,!1),o("frx",r.RotateX,s.prototype.parse_decimal,!1),o("fry",r.RotateY,s.prototype.parse_decimal,!1),o("frz",r.RotateZ,s.prototype.parse_decimal,!1),o("fs",r.FontSize,s.prototype.parse_decimal,!1),o("fsp",r.LetterSpacing,s.prototype.parse_decimal,!1),o("i",r.Italic,s.prototype.parse_enableDisable,!1),o("p",r.DrawingMode,s.prototype.parse_decimal,!0),o("pbo",r.DrawingBaselineOffset,s.prototype.parse_decimal,!0),o("s",r.StrikeThrough,s.prototype.parse_enableDisable,!1),o("shad",r.Shadow,s.prototype.parse_decimal,!1),o("u",r.Underline,s.prototype.parse_enableDisable,!1),o("xbord",r.BorderX,s.prototype.parse_decimal,!1),o("xshad",r.ShadowX,s.prototype.parse_decimal,!1),o("ybord",r.BorderY,s.prototype.parse_decimal,!1),o("yshad",r.ShadowY,s.prototype.parse_decimal,!1),o("1a",r.PrimaryAlpha,s.prototype.parse_alpha,!1),o("1c",r.PrimaryColor,s.prototype.parse_color,!1),o("2a",r.SecondaryAlpha,s.prototype.parse_alpha,!1),o("2c",r.SecondaryColor,s.prototype.parse_color,!1),o("3a",r.OutlineAlpha,s.prototype.parse_alpha,!1),o("3c",r.OutlineColor,s.prototype.parse_color,!1),o("4a",r.ShadowAlpha,s.prototype.parse_alpha,!1),o("4c",r.ShadowColor,s.prototype.parse_color,!1);for(var l=0,u=Object.keys(s.prototype);l<u.length;l++){var c=u[l];0===c.indexOf("parse_")&&"function"==typeof s.prototype[c]&&i.set(c.substr("parse_".length),s.prototype[c])}var d=function(){function e(e,t){void 0===t&&(t=null),this._parent=e,this._children=[],null!==e&&e.children.push(this),this._start=null!==e?e.end:0,this._end=this._start,this.value=t}return Object.defineProperty(e.prototype,"start",{get:function(){return this._start},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,null!==this._value&&this._value.constructor===String&&0===this._children.length&&this._setEnd(this._start+this._value.length)},enumerable:!0,configurable:!0}),e.prototype.pop=function(){this._children.splice(this._children.length-1,1),this._children.length>0?this._setEnd(this._children[this._children.length-1].end):this._setEnd(this.start)},e.prototype._setEnd=function(e){this._end=e,null!==this._parent&&this._parent.end!==this._end&&this._parent._setEnd(this._end)},e}(),h=t(32),f=t(36);t(38).registerWorkerCommand(f.WorkerCommands.Parse,function(e){return new h.Promise(function(t){t(a(e.input,e.rule))})})},function(e,t){var r,n=t(23),i=t(24),a=t(29),s=t(26),o=t(25),l=t(30),u=t(32),c=t(2);!function(e){e[e.ScriptInfo=0]="ScriptInfo",e[e.Styles=1]="Styles",e[e.Events=2]="Events",e[e.Fonts=3]="Fonts",e[e.Graphics=4]="Graphics",e[e.Other=5]="Other",e[e.EOF=6]="EOF"}(r||(r={}));var d=function(){function e(e){var t=this;this._stream=e,this._ass=new i.ASS,this._minimalDeferred=new u.DeferredPromise,this._deferred=new u.DeferredPromise,this._shouldSwallowBom=!0,this._currentSection=r.ScriptInfo,this._currentAttachment=null,this._stream.nextLine().then(function(e){return t._onNextLine(e)},function(e){t._minimalDeferred.reject(e),t._deferred.reject(e)})}return Object.defineProperty(e.prototype,"minimalASS",{get:function(){return this._minimalDeferred.promise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ass",{get:function(){return this._deferred.promise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSection",{get:function(){return this._currentSection},set:function(e){if(null!==this._currentAttachment&&(this._ass.addAttachment(this._currentAttachment),this._currentAttachment=null),this._currentSection===r.ScriptInfo&&e!==r.ScriptInfo&&this._minimalDeferred.resolve(this._ass),e===r.EOF){var t=this._ass.properties;void 0===t.resolutionX||void 0===t.resolutionY?(this._minimalDeferred.reject("Malformed ASS script."),this._deferred.reject("Malformed ASS script.")):(this._minimalDeferred.resolve(this._ass),this._deferred.resolve(this._ass))}this._currentSection=e},enumerable:!0,configurable:!0}),e.prototype._onNextLine=function(e){var t=this;if(null!==e){if("\r"===e[e.length-1]&&(e=e.substr(0,e.length-1)),65279===e.charCodeAt(0)&&this._shouldSwallowBom&&(e=e.substr(1)),this._shouldSwallowBom=!1,""===e);else if(";"===e[0]&&null===this._currentAttachment);else if("[Script Info]"===e)this.currentSection=r.ScriptInfo;else if("[V4+ Styles]"===e||"[V4 Styles]"===e)this.currentSection=r.Styles;else if("[Events]"===e)this.currentSection=r.Events;else if("[Fonts]"===e)this.currentSection=r.Fonts;else if("[Graphics]"===e)this.currentSection=r.Graphics;else switch(null===this._currentAttachment&&"["===e[0]&&"]"===e[e.length-1]&&(this.currentSection=r.Other),this.currentSection){case r.ScriptInfo:var i=c.parseLineIntoProperty(e);if(null!==i)switch(i.name){case"PlayResX":this._ass.properties.resolutionX=parseInt(i.value);break;case"PlayResY":this._ass.properties.resolutionY=parseInt(i.value);break;case"WrapStyle":this._ass.properties.wrappingStyle=parseInt(i.value);break;case"ScaledBorderAndShadow":this._ass.properties.scaleBorderAndShadow="yes"===i.value}break;case r.Styles:if(null===this._ass.stylesFormatSpecifier){var a=c.parseLineIntoProperty(e);null!==a&&"Format"===a.name&&(this._ass.stylesFormatSpecifier=a.value.split(",").map(function(e){return e.trim()}))}else try{this._ass.addStyle(e)}catch(t){n.debugMode&&console.error("Could not parse style from line "+e+" - "+(t.stack||t))}break;case r.Events:if(null===this._ass.dialoguesFormatSpecifier){var s=c.parseLineIntoProperty(e);null!==s&&"Format"===s.name&&(this._ass.dialoguesFormatSpecifier=s.value.split(",").map(function(e){return e.trim()}))}else try{this._ass.addEvent(e)}catch(t){n.debugMode&&console.error("Could not parse event from line "+e+" - "+(t.stack||t))}break;case r.Fonts:case r.Graphics:var l=(this.currentSection===r.Fonts?/^fontname:(.+)/:/^filename:(.+)/).exec(e);if(null!==l)null!==this._currentAttachment&&(this._ass.addAttachment(this._currentAttachment),this._currentAttachment=null),this._currentAttachment=new o.Attachment(l[1].trim(),this.currentSection===r.Fonts?o.AttachmentType.Font:o.AttachmentType.Graphic);else if(null!==this._currentAttachment)try{this._currentAttachment.contents+=function(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r)-33;if(n<0||n>63)throw new Error("Out-of-range character code "+n+" at index "+r+" in string "+e);t+=n<26?String.fromCharCode("A".charCodeAt(0)+n):n<52?String.fromCharCode("a".charCodeAt(0)+n-26):n<62?String.fromCharCode("0".charCodeAt(0)+n-52):62===n?"+":"/"}return t}(e)}catch(e){n.debugMode&&console.error("Encountered error while reading font "+this._currentAttachment.filename+": %o",e),this._currentAttachment=null}break;case r.Other:break;default:throw new Error("Unhandled state "+this.currentSection)}this._stream.nextLine().then(function(e){return t._onNextLine(e)},function(e){t._minimalDeferred.reject(e),t._deferred.reject(e)})}else this.currentSection=r.EOF},e}();e.StreamParser=d;var h=function(){function e(e){var t=this;this._stream=e,this._ass=new i.ASS,this._deferred=new u.DeferredPromise,this._shouldSwallowBom=!0,this._currentDialogueNumber=null,this._currentDialogueStart=null,this._currentDialogueEnd=null,this._currentDialogueText=null,this._stream.nextLine().then(function(e){return t._onNextLine(e)},function(e){t._deferred.reject(e)}),this._ass.properties.resolutionX=1280,this._ass.properties.resolutionY=720,this._ass.properties.wrappingStyle=1,this._ass.properties.scaleBorderAndShadow=!0;var r=new a.Style(new l.Map([["Name","Default"],["FontSize","36"]]));this._ass.styles.set(r.name,r)}return Object.defineProperty(e.prototype,"ass",{get:function(){return this._deferred.promise},enumerable:!0,configurable:!0}),e.prototype._onNextLine=function(e){var t=this;if(null===e)return null!==this._currentDialogueNumber&&null!==this._currentDialogueStart&&null!==this._currentDialogueEnd&&null!==this._currentDialogueText&&this._ass.dialogues.push(new s.Dialogue(new l.Map([["Style","Default"],["Start",this._currentDialogueStart],["End",this._currentDialogueEnd],["Text",this._currentDialogueText]]),this._ass)),void this._deferred.resolve(this._ass);if("\r"===e[e.length-1]&&(e=e.substr(0,e.length-1)),65279===e.charCodeAt(0)&&this._shouldSwallowBom&&(e=e.substr(1)),this._shouldSwallowBom=!1,""===e)null!==this._currentDialogueNumber&&null!==this._currentDialogueStart&&null!==this._currentDialogueEnd&&null!==this._currentDialogueText&&this._ass.dialogues.push(new s.Dialogue(new l.Map([["Style","Default"],["Start",this._currentDialogueStart],["End",this._currentDialogueEnd],["Text",this._currentDialogueText]]),this._ass)),this._currentDialogueNumber=this._currentDialogueStart=this._currentDialogueEnd=this._currentDialogueText=null;else if(null===this._currentDialogueNumber)/^\d+$/.test(e)&&(this._currentDialogueNumber=e);else if(null===this._currentDialogueStart&&null===this._currentDialogueEnd){var r=/^(\d\d:\d\d:\d\d,\d\d\d) --> (\d\d:\d\d:\d\d,\d\d\d)/.exec(e);null!==r&&(this._currentDialogueStart=r[1].replace(",","."),this._currentDialogueEnd=r[2].replace(",","."))}else e=e.replace(/<b>/g,"{\\b1}").replace(/\{b\}/g,"{\\b1}").replace(/<\/b>/g,"{\\b0}").replace(/\{\/b\}/g,"{\\b0}").replace(/<i>/g,"{\\i1}").replace(/\{i\}/g,"{\\i1}").replace(/<\/i>/g,"{\\i0}").replace(/\{\/i\}/g,"{\\i0}").replace(/<u>/g,"{\\u1}").replace(/\{u\}/g,"{\\u1}").replace(/<\/u>/g,"{\\u0}").replace(/\{\/u\}/g,"{\\u0}").replace(/<font color="#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})">/g,function(e,t,r,n){return"{c&H"+n+r+t+"&}"}).replace(/<\/font>/g,"{\\c}"),null!==this._currentDialogueText?this._currentDialogueText+="\\N"+e:this._currentDialogueText=e;this._stream.nextLine().then(function(e){return t._onNextLine(e)},function(e){t._deferred.reject(e)})},e}();e.SrtStreamParser=h},function(t,r){var n=r(32),i=function(){function e(e){this._str=e,this._readTill=0}return e.prototype.nextLine=function(){var e=null;if(this._readTill<this._str.length){var t=this._str.indexOf("\n",this._readTill);-1!==t?(e=n.Promise.resolve(this._str.substring(this._readTill,t)),this._readTill=t+1):(e=n.Promise.resolve(this._str.substr(this._readTill)),this._readTill=this._str.length)}else e=n.Promise.resolve(null);return e},e}();t.StringStream=i;var a=function(){function e(e){var t=this;this._xhr=e,this._readTill=0,this._pendingDeferred=null,this._failedError=null,e.addEventListener("progress",function(){return t._onXhrProgress()},!1),e.addEventListener("load",function(){return t._onXhrLoad()},!1),e.addEventListener("error",function(e){return t._onXhrError(e)},!1)}return e.prototype.nextLine=function(){if(null!==this._pendingDeferred)throw new Error("XhrStream only supports one pending unfulfilled read at a time.");var e=this._pendingDeferred=new n.DeferredPromise;return this._tryResolveNextLine(),e.promise},e.prototype._onXhrProgress=function(){null!==this._pendingDeferred&&this._xhr.readyState!==XMLHttpRequest.DONE&&this._tryResolveNextLine()},e.prototype._onXhrLoad=function(){null!==this._pendingDeferred&&this._tryResolveNextLine()},e.prototype._onXhrError=function(e){this._failedError=e,null!==this._pendingDeferred&&this._tryResolveNextLine()},e.prototype._tryResolveNextLine=function(){if(null===this._failedError){var e=this._xhr.responseText,t=e.indexOf("\n",this._readTill);-1!==t?(this._pendingDeferred.resolve(e.substring(this._readTill,t)),this._readTill=t+1,this._pendingDeferred=null):this._xhr.readyState===XMLHttpRequest.DONE&&(null!==this._failedError?this._pendingDeferred.reject(this._failedError):this._readTill<e.length?(this._pendingDeferred.resolve(e.substr(this._readTill)),this._readTill=e.length):this._pendingDeferred.resolve(null),this._pendingDeferred=null)}else this._pendingDeferred.reject(this._failedError)},e}();t.XhrStream=a;var s=function(){function t(t,r){this._buffer="",this._pendingDeferred=null,this._reader=t.getReader(),this._decoder=new e.TextDecoder(r,{ignoreBOM:!0})}return t.prototype.nextLine=function(){if(null!==this._pendingDeferred)throw new Error("BrowserReadableStream only supports one pending unfulfilled read at a time.");var e=this._pendingDeferred=new n.DeferredPromise;return this._tryResolveNextLine(),e.promise},t.prototype._tryResolveNextLine=function(){var e=this,t=this._buffer.indexOf("\n");-1!==t?(this._pendingDeferred.resolve(this._buffer.substr(0,t)),this._buffer=this._buffer.substr(t+1),this._pendingDeferred=null):this._reader.read().then(function(t){var r=t.value;t.done?(0===e._buffer.length?e._pendingDeferred.resolve(null):(e._pendingDeferred.resolve(e._buffer),e._buffer=""),e._pendingDeferred=null):(e._buffer+=e._decoder.decode(r,{stream:!0}),e._tryResolveNextLine())})},t}();t.BrowserReadableStream=s},function(e,t){var r,n=t(34).__decorate,i=t(30),a=t(33);!function(e){e[e.Char=0]="Char",e[e.Uint16=1]="Uint16",e[e.Uint32=2]="Uint32"}(r||(r={}));var s=new i.Map,o=function(){function e(){}return n([h(r.Uint16)],e.prototype,"majorVersion",void 0),n([h(r.Uint16)],e.prototype,"minorVersion",void 0),n([h(r.Uint16)],e.prototype,"numTables",void 0),n([h(r.Uint16)],e.prototype,"searchRange",void 0),n([h(r.Uint16)],e.prototype,"entrySelector",void 0),n([h(r.Uint16)],e.prototype,"rangeShift",void 0),e=n([d],e)}(),l=function(){function e(){}return n([h(r.Char)],e.prototype,"c1",void 0),n([h(r.Char)],e.prototype,"c2",void 0),n([h(r.Char)],e.prototype,"c3",void 0),n([h(r.Char)],e.prototype,"c4",void 0),n([h(r.Uint32)],e.prototype,"checksum",void 0),n([h(r.Uint32)],e.prototype,"offset",void 0),n([h(r.Uint32)],e.prototype,"length",void 0),e=n([d],e)}(),u=function(){function e(){}return n([h(r.Uint16)],e.prototype,"formatSelector",void 0),n([h(r.Uint16)],e.prototype,"count",void 0),n([h(r.Uint16)],e.prototype,"stringOffset",void 0),e=n([d],e)}(),c=function(){function e(){}return n([h(r.Uint16)],e.prototype,"platformId",void 0),n([h(r.Uint16)],e.prototype,"encodingId",void 0),n([h(r.Uint16)],e.prototype,"languageId",void 0),n([h(r.Uint16)],e.prototype,"nameId",void 0),n([h(r.Uint16)],e.prototype,"length",void 0),n([h(r.Uint16)],e.prototype,"offset",void 0),e=n([d],e)}();function d(e){var t=e.__fields;return e.read=function(n){for(var i=new e,a=0;a<t.length;a++){var s=t[a],o=void 0;switch(s.type){case r.Char:o=String.fromCharCode(n.dataView.getInt8(n.position)),n.position+=1;break;case r.Uint16:o=n.dataView.getUint16(n.position),n.position+=2;break;case r.Uint32:o=n.dataView.getUint32(n.position),n.position+=4}i[s.field]=o}return i},e}function h(e){var t=s.get(e);return void 0===t&&(t=function(t,r){var n=t.constructor;void 0===n.__fields&&(n.__fields=[]),n.__fields.push({type:e,field:r})},s.set(e,t)),t}e.getTtfNames=function(e){for(var t=atob(e.contents),r=new Uint8Array(new ArrayBuffer(t.length)),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);var i={dataView:new DataView(r.buffer),position:0},s=o.read(i),d=null;for(n=0;n<s.numTables;n++){var h=l.read(i);if(h.c1+h.c2+h.c3+h.c4==="name"){d=h;break}}i.position=d.offset;var f=u.read(i),p=new a.Set;for(n=0;n<f.count;n++){var g=c.read(i);switch(g.nameId){case 1:case 4:case 6:var m=d.offset+f.stringOffset+g.offset,v=r.subarray(m,m+g.length);switch(g.platformId){case 1:for(var _="",y=0;y<v.length;y++)_+=String.fromCharCode(v[y]);p.add(_);break;case 3:var b="";for(y=0;y<v.length;y+=2)b+=String.fromCharCode((v[y]<<8)+v[y+1]);p.add(b)}}}return p}},function(e){var t=function(){function e(e,t){this._x=e,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e}();e.MoveInstruction=t;var r=function(){function e(e,t){this._x=e,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e}();e.LineInstruction=r;var n=function(){function e(e,t,r,n,i,a){this._x1=e,this._y1=t,this._x2=r,this._y2=n,this._x3=i,this._y3=a}return Object.defineProperty(e.prototype,"x1",{get:function(){return this._x1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this._y1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x2",{get:function(){return this._x2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y2",{get:function(){return this._y2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x3",{get:function(){return this._x3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y3",{get:function(){return this._y3},enumerable:!0,configurable:!0}),e}();e.CubicBezierCurveInstruction=n},function(e,t){var r=t(7);e.drawing=r;var n=function(){function e(e,t,r,n){void 0===n&&(n=1),this._red=e,this._green=t,this._blue=r,this._alpha=n}return Object.defineProperty(e.prototype,"red",{get:function(){return this._red},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"green",{get:function(){return this._green},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blue",{get:function(){return this._blue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},enumerable:!0,configurable:!0}),e.prototype.withAlpha=function(t){return null!==t?new e(this._red,this._green,this._blue,t):this},e.prototype.toString=function(){return"rgba("+this._red+", "+this._green+", "+this._blue+", "+this._alpha.toFixed(3)+")"},e.prototype.interpolate=function(t,r){return new e(this._red+r*(t.red-this._red),this._green+r*(t.green-this._green),this._blue+r*(t.blue-this._blue),this._alpha+r*(t.alpha-this._alpha))},e}();e.Color=n;var i=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.Comment=i;var a=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return"Text { value: "+this._value.replace(/\u00A0/g,"\\h")+" }"},e}();e.Text=a;var s=function(){};e.NewLine=s;var o=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.Italic=o;var l=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.Bold=l;var u=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.Underline=u;var c=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.StrikeThrough=c;var d=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.Border=d;var h=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.BorderX=h;var f=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.BorderY=f;var p=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.Shadow=p;var g=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.ShadowX=g;var m=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.ShadowY=m;var v=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.Blur=v;var _=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.GaussianBlur=_;var y=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.FontName=y;var b=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.FontSize=b;var w=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.FontSizePlus=w;var S=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.FontSizeMinus=S;var E=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.FontScaleX=E;var x=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.FontScaleY=x;var T=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.LetterSpacing=T;var k=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.RotateX=k;var A=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.RotateY=A;var C=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.RotateZ=C;var j=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.SkewX=j;var D=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.SkewY=D;var R=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.PrimaryColor=R;var L=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.SecondaryColor=L;var I=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.OutlineColor=I;var O=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.ShadowColor=O;var P=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.Alpha=P;var M=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.PrimaryAlpha=M;var N=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.SecondaryAlpha=N;var F=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.OutlineAlpha=F;var B=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.ShadowAlpha=B;var U=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.Alignment=U;var G=function(){function e(e){this._duration=e}return Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),e}();e.ColorKaraoke=G;var z=function(){function e(e){this._duration=e}return Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),e}();e.SweepingColorKaraoke=z;var H=function(){function e(e){this._duration=e}return Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),e}();e.OutlineKaraoke=H;var V=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.WrappingStyle=V;var K=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.Reset=K;var W=function(){function e(e,t){this._x=e,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e}();e.Position=W;var q=function(){function e(e,t,r,n,i,a){this._x1=e,this._y1=t,this._x2=r,this._y2=n,this._t1=i,this._t2=a}return Object.defineProperty(e.prototype,"x1",{get:function(){return this._x1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this._y1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x2",{get:function(){return this._x2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y2",{get:function(){return this._y2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t1",{get:function(){return this._t1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t2",{get:function(){return this._t2},enumerable:!0,configurable:!0}),e}();e.Move=q;var X=function(){function e(e,t){this._x=e,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e}();e.RotationOrigin=X;var Y=function(){function e(e,t){this._start=e,this._end=t}return Object.defineProperty(e.prototype,"start",{get:function(){return this._start},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),e}();e.Fade=Y;var $=function(){function e(e,t,r,n,i,a,s){this._a1=e,this._a2=t,this._a3=r,this._t1=n,this._t2=i,this._t3=a,this._t4=s}return Object.defineProperty(e.prototype,"a1",{get:function(){return this._a1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a2",{get:function(){return this._a2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a3",{get:function(){return this._a3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t1",{get:function(){return this._t1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t2",{get:function(){return this._t2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t3",{get:function(){return this._t3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t4",{get:function(){return this._t4},enumerable:!0,configurable:!0}),e}();e.ComplexFade=$;var J=function(){function e(e,t,r,n){this._start=e,this._end=t,this._accel=r,this._tags=n}return Object.defineProperty(e.prototype,"start",{get:function(){return this._start},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accel",{get:function(){return this._accel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tags",{get:function(){return this._tags},enumerable:!0,configurable:!0}),e}();e.Transform=J;var Q=function(){function e(e,t,r,n,i){this._x1=e,this._y1=t,this._x2=r,this._y2=n,this._inside=i}return Object.defineProperty(e.prototype,"x1",{get:function(){return this._x1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this._y1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x2",{get:function(){return this._x2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y2",{get:function(){return this._y2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inside",{get:function(){return this._inside},enumerable:!0,configurable:!0}),e}();e.RectangularClip=Q;var Z=function(){function e(e,t,r){this._scale=e,this._instructions=t,this._inside=r}return Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instructions",{get:function(){return this._instructions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inside",{get:function(){return this._inside},enumerable:!0,configurable:!0}),e}();e.VectorClip=Z;var ee=function(){function e(e){this._scale=e}return Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},enumerable:!0,configurable:!0}),e}();e.DrawingMode=ee;var te=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.DrawingBaselineOffset=te;var re=function(){function e(e){this._instructions=e}return Object.defineProperty(e.prototype,"instructions",{get:function(){return this._instructions},enumerable:!0,configurable:!0}),e}();e.DrawingInstructions=re;for(var ne=function(e,t){if(!e.prototype.hasOwnProperty("toString")){var r=Object.getOwnPropertyNames(e.prototype).filter(function(e){return"constructor"!==e});e.prototype.toString=function(){var e=this;return t+" { "+r.map(function(t){return t+": "+e[t]}).join(", ")+(r.length>0?" ":"")+"}"}}},ie=t(38),ae=0,se=Object.keys(e);ae<se.length;ae++){(ce=e[ue=se[ae]])instanceof Function&&(ne(ce,ue),ie.registerClassPrototype(ce.prototype))}for(var oe=0,le=Object.keys(r);oe<le.length;oe++){var ue,ce;(ce=r[ue=le[oe]])instanceof Function&&(ne(ce,"Drawing"+ue),ie.registerClassPrototype(ce.prototype))}},function(e,t){var r=t(23),n=t(11),i=function(){function e(e,t){this._getCurrentTime=e,this._autoPauseAfter=t,this._manualClock=new n.ManualClock,this._nextAnimationFrameRequestId=null,this._lastKnownExternalTime=null,this._lastKnownExternalTimeObtainedAt=null}return e.prototype.play=function(){this._manualClock.enabled&&(this._startTicking(),this._manualClock.play())},e.prototype.pause=function(){this._manualClock.enabled&&(null!==this._nextAnimationFrameRequestId?(this._stopTicking(),this._manualClock.pause()):r.debugMode&&console.warn("AutoClock.pause: Abnormal state detected. AutoClock._nextAnimationFrameRequestId should not have been null."))},e.prototype.seeking=function(){this._manualClock.seek(this._getCurrentTime())},Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._manualClock.currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._manualClock.enabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._manualClock.paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rate",{get:function(){return this._manualClock.rate},enumerable:!0,configurable:!0}),e.prototype.setRate=function(e){this._manualClock.setRate(e)},e.prototype.enable=function(){return!!this._manualClock.enable()&&(this._startTicking(),!0)},e.prototype.disable=function(){return!!this._manualClock.disable()&&(this._stopTicking(),!0)},e.prototype.toggle=function(){this._manualClock.enabled?this.disable():this.enable()},e.prototype.setEnabled=function(e){return e?this.enable():this.disable()},e.prototype.addEventListener=function(e,t){this._manualClock.addEventListener(e,t)},e.prototype._onTimerTick=function(e){var t=this;if(this._manualClock.enabled){var n=this._manualClock.currentTime,i=this._getCurrentTime();this._manualClock.paused?n!==i&&(this._lastKnownExternalTime=i,this._lastKnownExternalTimeObtainedAt=e,this._manualClock.tick(i)):null!==this._lastKnownExternalTime&&i===this._lastKnownExternalTime?e-this._lastKnownExternalTimeObtainedAt>this._autoPauseAfter?(this._lastKnownExternalTimeObtainedAt=null,this._manualClock.pause()):this._manualClock.tick((e-this._lastKnownExternalTimeObtainedAt)/1e3*this._manualClock.rate+this._lastKnownExternalTime):(this._lastKnownExternalTime=i,this._lastKnownExternalTimeObtainedAt=e,this._manualClock.tick(i)),this._nextAnimationFrameRequestId=requestAnimationFrame(function(e){return t._onTimerTick(e)})}else r.debugMode&&console.warn("AutoClock._onTimerTick: Called when disabled.")},e.prototype._startTicking=function(){var e=this;null===this._nextAnimationFrameRequestId&&(this._nextAnimationFrameRequestId=requestAnimationFrame(function(t){return e._onTimerTick(t)}))},e.prototype._stopTicking=function(){null!==this._nextAnimationFrameRequestId&&(cancelAnimationFrame(this._nextAnimationFrameRequestId),this._nextAnimationFrameRequestId=null)},e}();e.AutoClock=i},function(e){var t,r=function(){function e(){}return e.prototype.addEventListener=function(e,t){var r=this._eventListeners.get(e);void 0===r&&this._eventListeners.set(e,r=[]),r.push(t)},e.prototype._dispatchEvent=function(e,t){var r=this._eventListeners.get(e);if(void 0!==r)for(var n=0;n<r.length;n++){r[n].apply(this,t)}},e}();e.EventSource=r,(t=e.ClockEvent||(e.ClockEvent={}))[t.Play=0]="Play",t[t.Tick=1]="Tick",t[t.Pause=2]="Pause",t[t.Stop=3]="Stop",t[t.RateChange=4]="RateChange"},function(e,t){var r=t(31),n=t(30),i=t(10),a=function(){function e(){this._currentTime=-1,this._rate=1,this._enabled=!0,this._paused=!0,this._eventListeners=new n.Map}return e.prototype.play=function(){this._enabled&&this._paused&&(this._paused=!1,this._dispatchEvent(i.ClockEvent.Play,[]))},e.prototype.tick=function(e){this._enabled&&this._currentTime!==e&&(this.play(),this._currentTime=e,this._dispatchEvent(i.ClockEvent.Tick,[]))},e.prototype.seek=function(e){this._enabled&&(this.pause(),this._currentTime!==e&&(this.stop(),this.tick(e),this.pause()))},e.prototype.pause=function(){this._enabled&&(this._paused||(this._paused=!0,this._dispatchEvent(i.ClockEvent.Pause,[])))},e.prototype.stop=function(){this._dispatchEvent(i.ClockEvent.Stop,[])},Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rate",{get:function(){return this._rate},enumerable:!0,configurable:!0}),e.prototype.setRate=function(e){this._rate!==e&&(this._rate=e,this._dispatchEvent(i.ClockEvent.RateChange,[]))},e.prototype.enable=function(){return!this._enabled&&(this._enabled=!0,!0)},e.prototype.disable=function(){return!!this._enabled&&(this.pause(),this.stop(),this._enabled=!1,!0)},e.prototype.toggle=function(){this._enabled?this.disable():this.enable()},e.prototype.setEnabled=function(e){return e?this.enable():this.disable()},e}();e.ManualClock=a,r.mixin(a,[i.EventSource])},function(e,t){var r=t(9),n=function(){function e(e){var t=this;this._autoClock=new r.AutoClock(function(){return e.currentTime},100),e.addEventListener("playing",function(){return t._autoClock.play()},!1),e.addEventListener("pause",function(){return t._autoClock.pause()},!1),e.addEventListener("seeking",function(){return t._autoClock.seeking()},!1),e.addEventListener("ratechange",function(){return t._autoClock.setRate(e.playbackRate)},!1)}return Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._autoClock.currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._autoClock.enabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._autoClock.paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rate",{get:function(){return this._autoClock.rate},enumerable:!0,configurable:!0}),e.prototype.enable=function(){return this._autoClock.enable()},e.prototype.disable=function(){return this._autoClock.disable()},e.prototype.toggle=function(){this._autoClock.enabled?this.disable():this.enable()},e.prototype.setEnabled=function(e){return e?this.enable():this.disable()},e.prototype.addEventListener=function(e,t){this._autoClock.addEventListener(e,t)},e}();e.VideoClock=n},function(e,t){var r=t(34).__extends,n=t(12),i=function(e){function t(t,r,i){e.call(this,r,new n.VideoClock(t),document.createElement("div"),i),this._video=t,this._video.parentElement.replaceChild(this.libjassSubsWrapper,this._video),this.libjassSubsWrapper.insertBefore(this._video,this.libjassSubsWrapper.firstElementChild)}return r(t,e),t.prototype.resize=function(){var t=this._video.videoWidth,r=this._video.videoHeight,n=this._video.offsetWidth,i=this._video.offsetHeight,a=Math.min(n/t,i/r),s=t*a,o=r*a,l=(n-s)/2,u=(i-o)/2;e.prototype.resize.call(this,s,o,l,u)},t.prototype.resizeVideo=function(){console.warn("`DefaultRenderer.resizeVideo(width, height)` has been deprecated. Use `DefaultRenderer.resize()` instead."),this.resize()},t.prototype._ready=function(){this.resize(),e.prototype._ready.call(this)},t}(t(21).WebRenderer);e.DefaultRenderer=i},function(e,t){var r=t(10);e.ClockEvent=r.ClockEvent,e.EventSource=r.EventSource;var n=t(9);e.AutoClock=n.AutoClock;var i=t(11);e.ManualClock=i.ManualClock;var a=t(12);e.VideoClock=a.VideoClock;var s=t(13);e.DefaultRenderer=s.DefaultRenderer;var o=t(15);e.NullRenderer=o.NullRenderer;var l=t(21);e.WebRenderer=l.WebRenderer;var u=t(16);e.RendererSettings=u.RendererSettings},function(e,t){var r=t(10),n=t(16),i=t(23),a=function(){function e(t,i,a){var s=this;this._ass=t,this._clock=i,this._id=++e._lastRendererId,this._settings=n.RendererSettings.from(a),this._clock.addEventListener(r.ClockEvent.Play,function(){return s._onClockPlay()}),this._clock.addEventListener(r.ClockEvent.Tick,function(){return s._onClockTick()}),this._clock.addEventListener(r.ClockEvent.Pause,function(){return s._onClockPause()}),this._clock.addEventListener(r.ClockEvent.Stop,function(){return s._onClockStop()}),this._clock.addEventListener(r.ClockEvent.RateChange,function(){return s._onClockRateChange()})}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ass",{get:function(){return this._ass},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clock",{get:function(){return this._clock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"settings",{get:function(){return this._settings},enumerable:!0,configurable:!0}),e.prototype.preRender=function(){},e.prototype.draw=function(){},e.prototype.enable=function(){return this._clock.enable()},e.prototype.disable=function(){return this._clock.disable()},e.prototype.toggle=function(){this._clock.toggle()},e.prototype.setEnabled=function(e){return this._clock.setEnabled(e)},Object.defineProperty(e.prototype,"enabled",{get:function(){return this._clock.enabled},enumerable:!0,configurable:!0}),e.prototype._onClockPlay=function(){i.verboseMode&&console.log("NullRenderer._onClockPlay")},e.prototype._onClockTick=function(){var e=this._clock.currentTime;i.verboseMode&&console.log("NullRenderer._onClockTick: currentTime = "+e);for(var t=0,r=this._ass.dialogues;t<r.length;t++){var n=r[t];n.end>e&&(n.start<=e?this.draw(n):n.start<=e+this._settings.preRenderTime&&this.preRender(n))}},e.prototype._onClockPause=function(){i.verboseMode&&console.log("NullRenderer._onClockPause")},e.prototype._onClockStop=function(){i.verboseMode&&console.log("NullRenderer._onClockStop")},e.prototype._onClockRateChange=function(){i.verboseMode&&console.log("NullRenderer._onClockRateChange")},e._lastRendererId=-1,e}();e.NullRenderer=a},function(e,t){var r=t(30),n=function(){function e(){}return e.makeFontMapFromStyleElement=function(e){for(var t=new r.Map,n=e.sheet,a=0;a<n.cssRules.length;a++){var s=n.cssRules[a];if(i(s)){var o=s.style.getPropertyValue("font-family").match(/^["']?(.*?)["']?$/)[1],l=s.style.getPropertyValue("src");l||(l=s.cssText.split("\n").map(function(e){return e.match(/src:\s*([^;]+?)\s*;/)}).filter(function(e){return null!==e}).map(function(e){return e[1]})[0]),t.set(o,l)}}return t},e.from=function(t){null==t&&(t={});var r=t,n=r.fontMap,i=void 0===n?null:n,a=r.preRenderTime,s=void 0===a?5:a,o=r.preciseOutlines,l=void 0!==o&&o,u=r.enableSvg,c=void 0===u||u,d=r.fallbackFonts,h=void 0===d?'Arial, Helvetica, sans-serif, "Segoe UI Symbol"':d,f=r.useAttachedFonts,p=void 0!==f&&f,g=new e;return g.fontMap=i,g.preRenderTime=s,g.preciseOutlines=l,g.enableSvg=c,g.fallbackFonts=h,g.useAttachedFonts=p,g},e}();function i(e){return e.type===CSSRule.FONT_FACE_RULE}e.RendererSettings=n},function(e,t){var r=t(30),n=function(){function e(t,n){this._style=n,this._animationStyle="",this._animationDelays=new r.Map,this._numAnimations=0,this._id=t.id+"-"+e._nextId++,this._rate=t.clock.rate}return Object.defineProperty(e.prototype,"animationStyle",{get:function(){return this._animationStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationDelays",{get:function(){return this._animationDelays},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){for(var r=null,n=null,i=0;i<t.length;i++){var a=t[i];null===r&&(r=a.time),n=a.time}for(var s="",o=0;o<t.length;o++){a=t[o];s+="\t"+(100*(n-r==0?1:(a.time-r)/(n-r))).toFixed(3)+"% {\n",a.properties.forEach(function(e,t){s+="\t\t"+t+": "+e+";\n"}),s+="\t}\n"}var l="animation-"+this._id+"-"+this._numAnimations++;this._style.appendChild(document.createTextNode("@-webkit-keyframes "+l+" {\n"+s+"\n}")),this._style.appendChild(document.createTextNode("@keyframes "+l+" {\n"+s+"\n}")),""!==this._animationStyle&&(this._animationStyle+=","),this._animationStyle+=l+" "+((n-r)/this._rate).toFixed(3)+"s "+e,this._animationDelays.set(l,r)},e._nextId=0,e}();e.AnimationCollection=n},function(e,t){var r=t(8),n=function(){function e(e,t){this._outputScaleX=e,this._outputScaleY=t,this._scale=1,this._baselineOffset=0}return Object.defineProperty(e.prototype,"scale",{set:function(e){this._scale=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineOffset",{set:function(e){this._baselineOffset=e},enumerable:!0,configurable:!0}),e.prototype.toSVG=function(e,t){for(var n=Math.pow(2,this._scale-1),i=this._outputScaleX/n,a=this._outputScaleY/n,s=document.createElementNS("http://www.w3.org/2000/svg","path"),o=0,l=0,u=0,c=e.instructions;u<c.length;u++){var d=c[u];d instanceof r.drawing.MoveInstruction?(s.pathSegList.appendItem(s.createSVGPathSegMovetoAbs(d.x,d.y+this._baselineOffset)),o=Math.max(o,d.x),l=Math.max(l,d.y+this._baselineOffset)):d instanceof r.drawing.LineInstruction?(s.pathSegList.appendItem(s.createSVGPathSegLinetoAbs(d.x,d.y+this._baselineOffset)),o=Math.max(o,d.x),l=Math.max(l,d.y+this._baselineOffset)):d instanceof r.drawing.CubicBezierCurveInstruction&&(s.pathSegList.appendItem(s.createSVGPathSegCurvetoCubicAbs(d.x3,d.y3+this._baselineOffset,d.x1,d.y1+this._baselineOffset,d.x2,d.y2+this._baselineOffset)),o=Math.max(o,d.x1,d.x2,d.x3),l=Math.max(l,d.y1+this._baselineOffset,d.y2+this._baselineOffset,d.y3+this._baselineOffset))}var h=document.createElementNS("http://www.w3.org/2000/svg","svg");h.setAttribute("version","1.1"),h.width.baseVal.valueAsString=(o*i).toFixed(3)+"px",h.height.baseVal.valueAsString=(l*a).toFixed(3)+"px";var f=document.createElementNS("http://www.w3.org/2000/svg","g");return h.appendChild(f),f.setAttribute("transform","scale("+i.toFixed(3)+" "+a.toFixed(3)+")"),f.appendChild(s),s.setAttribute("fill",t.toString()),h},e}();e.DrawingStyles=n},function(e,t){var r=t(32);function n(e,t,r,n){var i='"'+e+'"';""!==r&&(i+=", "+r),n.style.fontFamily=i,n.style.fontSize=t+"px"}function i(e,t,i,a){return n(e,t,i,a),new r.Promise(function(e){return setTimeout(function(){return e(a.offsetHeight)},1e3)})}function a(e,t,r,i){return n(e,t,r,i),i.offsetHeight}function s(e,t){return[e,180/(t-e)]}e.calculateFontMetrics=function(e,t,r){return i(e,180,t,r).then(function(n){return i(e,360,t,r).then(function(e){return s(n,e)})})},e.fontSizeForLineHeight=function(e,t,r,n,i){var o=i.get(e);if(void 0===o){var l=a(e,180,r,n),u=a(e,360,r,n);i.set(e,o=s(l,u))}return function(e,t,r){return 180+(e-t)*r}(t,o[0],o[1])}},function(e){var t=function(){function e(e,t){this._time=e,this._properties=t}return Object.defineProperty(e.prototype,"time",{get:function(){return this._time},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties},enumerable:!0,configurable:!0}),e}();e.Keyframe=t},function(t,r){var n=r(34).__extends,i=r(17),a=r(18),s=r(19),o=r(20),l=r(22),u=r(10),c=r(15),d=r(6),h=r(8),f=r(23),p=r(25),g=r(27),m=r(31),v=r(30),_=r(32),y=/^(url|local)\(["']?(.+?)["']?\)$/,b=function(t){function r(r,n,i,a){var s=this;t.call(this,r,n,function(){if(!(i instanceof HTMLDivElement)){var e=a;a=i,i=e,console.warn("WebRenderer's constructor now takes libjassSubsWrapper as the third parameter and settings as the fourth parameter. Please update the caller.")}return a}()),this._libjassSubsWrapper=i,this._layerWrappers=[],this._layerAlignmentWrappers=[],this._fontMetricsCache=new v.Map,this._currentSubs=new v.Map,this._preRenderedSubs=new v.Map,this._eventListeners=new v.Map,this._libjassSubsWrapper.classList.add("libjass-wrapper"),this._subsWrapper=document.createElement("div"),this._libjassSubsWrapper.appendChild(this._subsWrapper),this._subsWrapper.className="libjass-subs",this._fontSizeElement=document.createElement("div"),this._libjassSubsWrapper.appendChild(this._fontSizeElement),this._fontSizeElement.className="libjass-font-measure",this._fontSizeElement.appendChild(document.createTextNode("M")),f.debugMode&&console.log("Preloading fonts...");var o=[],l=new v.Map,u=null===this.settings.fontMap?new v.Map:this.settings.fontMap,c=new v.Map;this.settings.useAttachedFonts&&r.attachments.forEach(function(e){if(e.type===p.AttachmentType.Font){var t=null;try{t=d.getTtfNames(e)}catch(e){return void console.error(e)}var r="data:application/x-font-ttf;base64,"+e.contents;t.forEach(function(e){var t=u.get(e);if(void 0!==t)if("string"!=typeof t)t.push(r);else{var n=c.get(e);void 0===n&&c.set(e,n=[]),n.push(r)}else u.set(e,[r])})}}),u.forEach(function(t,r){var n;if(e.document.fonts&&e.document.fonts.add){var i="string"==typeof t?t:t.map(function(e){return null!==e.match(y)?e:'url("'+e+'")'}).join(", ");if(void 0!==(m=c.get(r)))for(var a=0;a<m.length;a++){var u=m[a];i+=', url("'+u+'")'}var d,h=[];if(e.document.fonts.forEach(function(e){e.family!==r&&e.family!=='"'+r+'"'||h.push(e)}),0===h.length){var p=new FontFace(r,i),g=new FontFace('"'+r+'"',i);e.document.fonts.add(p),e.document.fonts.add(g),d=_.any([p.load(),g.load()])}else d=_.any(h.map(function(e){return e.load()}));n=s._calculateFontMetricsAfterFetch(r,d.catch(function(e){return console.warn("Fetching fonts for "+r+" at "+i+" failed: %o",e),null}))}else{var m,v=("string"==typeof t?t.split(/,/):t).map(function(e){return e.trim()}).map(function(e){var t=e.match(y);return null===t?e:"local"===t[1]?null:t[2]}).filter(function(e){return null!==e});void 0!==(m=c.get(r))&&(v=v.concat(m));var b=v.map(function(e){var t=l.get(e);return void 0===t&&(t=new _.Promise(function(t,r){var n=new XMLHttpRequest;n.addEventListener("load",function(){f.debugMode&&console.log("Preloaded "+e+"."),t(null)}),n.addEventListener("error",function(e){r(e)}),n.open("GET",e,!0),n.send()}),l.set(e,t)),t}),w=0===b.length?_.Promise.resolve(null):_.first(b).catch(function(e){return console.warn("Fetching fonts for "+r+" at "+v.join(", ")+" failed: %o",e),null});n=s._calculateFontMetricsAfterFetch(r,w)}o.push(n.then(function(e){return s._fontMetricsCache.set(r,e)}))}),_.Promise.all(o).then(function(){f.debugMode&&console.log("All fonts have been preloaded."),s._ready()})}return n(r,t),Object.defineProperty(r.prototype,"libjassSubsWrapper",{get:function(){return this._libjassSubsWrapper},enumerable:!0,configurable:!0}),r.prototype.resize=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0),this._removeAllSubs(),this._subsWrapper.style.width=e.toFixed(3)+"px",this._subsWrapper.style.height=t.toFixed(3)+"px",this._subsWrapper.style.left=r.toFixed(3)+"px",this._subsWrapper.style.top=n.toFixed(3)+"px",this._subsWrapperWidth=e,this._scaleX=e/this.ass.properties.resolutionX,this._scaleY=t/this.ass.properties.resolutionY,this._preRenderedSubs.clear(),-1!==this.clock.currentTime&&this._onClockTick()},r.prototype.preRender=function(e){var t=this,n=this._preRenderedSubs.get(e.id);if(n)return n;var s=this.clock.currentTime-e.start;if(e.containsTransformTag&&s<0)return null;var u=document.createElement("div");u.style.marginLeft=(this._scaleX*e.style.marginLeft).toFixed(3)+"px",u.style.marginRight=(this._scaleX*e.style.marginRight).toFixed(3)+"px",u.style.marginTop=u.style.marginBottom=(this._scaleY*e.style.marginVertical).toFixed(3)+"px",u.style.minWidth=(this._subsWrapperWidth-this._scaleX*(e.style.marginLeft+e.style.marginRight)).toFixed(3)+"px";var c=document.createElement("style");c.id="libjass-animation-styles-"+this.id+"-"+e.id,c.type="text/css";var d=new i.AnimationCollection(this,c),p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.setAttribute("version","1.1"),p.setAttribute("class","libjass-filters"),p.width.baseVal.valueAsString="0",p.height.baseVal.valueAsString="0";var m=document.createElementNS("http://www.w3.org/2000/svg","defs");p.appendChild(m);var _=null,y=new l.SpanStyles(this,e,this._scaleX,this._scaleY,this.settings,this._fontSizeElement,m,this._fontMetricsCache),b=null,w=!1,S=function(e){null!==_&&_.hasChildNodes()&&u.appendChild(y.setStylesOnSpan(_,b)),null!==b&&b.animationDelays.forEach(function(e,t){return d.animationDelays.set(t,e)}),e&&(w?u.appendChild(y.makeNewLine()):u.appendChild(document.createElement("br"))),_=document.createElement("span"),b=new i.AnimationCollection(t,c),w=e};S(!1);for(var E=new a.DrawingStyles(this._scaleX,this._scaleY),x=this.ass.properties.wrappingStyle,T=0,k=0,A=e.parts;k<A.length;k++){if((O=A[k])instanceof h.Italic)y.italic=O.value;else if(O instanceof h.Bold)y.bold=O.value;else if(O instanceof h.Underline)y.underline=O.value;else if(O instanceof h.StrikeThrough)y.strikeThrough=O.value;else if(O instanceof h.Border)y.outlineWidth=O.value,y.outlineHeight=O.value;else if(O instanceof h.BorderX)y.outlineWidth=O.value;else if(O instanceof h.BorderY)y.outlineHeight=O.value;else if(O instanceof h.Shadow)y.shadowDepthX=O.value,y.shadowDepthY=O.value;else if(O instanceof h.ShadowX)y.shadowDepthX=O.value;else if(O instanceof h.ShadowY)y.shadowDepthY=O.value;else if(O instanceof h.Blur)y.blur=O.value;else if(O instanceof h.GaussianBlur)y.gaussianBlur=O.value;else if(O instanceof h.FontName)y.fontName=O.value;else if(O instanceof h.FontSize)y.fontSize=O.value;else if(O instanceof h.FontSizePlus)y.fontSize+=O.value;else if(O instanceof h.FontSizeMinus)y.fontSize-=O.value;else if(O instanceof h.FontScaleX)y.fontScaleX=O.value;else if(O instanceof h.FontScaleY)y.fontScaleY=O.value;else if(O instanceof h.LetterSpacing)y.letterSpacing=O.value;else if(O instanceof h.RotateX)y.rotationX=O.value;else if(O instanceof h.RotateY)y.rotationY=O.value;else if(O instanceof h.RotateZ)y.rotationZ=O.value;else if(O instanceof h.SkewX)y.skewX=O.value;else if(O instanceof h.SkewY)y.skewY=O.value;else if(O instanceof h.PrimaryColor)y.primaryColor=O.value;else if(O instanceof h.SecondaryColor)y.secondaryColor=O.value;else if(O instanceof h.OutlineColor)y.outlineColor=O.value;else if(O instanceof h.ShadowColor)y.shadowColor=O.value;else if(O instanceof h.Alpha)y.primaryAlpha=O.value,y.secondaryAlpha=O.value,y.outlineAlpha=O.value,y.shadowAlpha=O.value;else if(O instanceof h.PrimaryAlpha)y.primaryAlpha=O.value;else if(O instanceof h.SecondaryAlpha)y.secondaryAlpha=O.value;else if(O instanceof h.OutlineAlpha)y.outlineAlpha=O.value;else if(O instanceof h.ShadowAlpha)y.shadowAlpha=O.value;else if(O instanceof h.Alignment);else if(O instanceof h.ColorKaraoke)S(!1),b.add("step-end",[new o.Keyframe(0,new v.Map([["color",y.secondaryColor.withAlpha(y.secondaryAlpha).toString()]])),new o.Keyframe(T,new v.Map([["color",y.primaryColor.withAlpha(y.primaryAlpha).toString()]]))]),T+=O.duration;else if(O instanceof h.WrappingStyle)x=O.value;else if(O instanceof h.Reset)y.reset(this.ass.styles.get(O.value));else if(O instanceof h.Position)u.style.position="absolute",u.style.left=(this._scaleX*O.x).toFixed(3)+"px",u.style.top=(this._scaleY*O.y).toFixed(3)+"px";else if(O instanceof h.Move)u.style.position="absolute",d.add("linear",[new o.Keyframe(0,new v.Map([["left",(this._scaleX*O.x1).toFixed(3)+"px"],["top",(this._scaleY*O.y1).toFixed(3)+"px"]])),new o.Keyframe(O.t1,new v.Map([["left",(this._scaleX*O.x1).toFixed(3)+"px"],["top",(this._scaleY*O.y1).toFixed(3)+"px"]])),new o.Keyframe(O.t2,new v.Map([["left",(this._scaleX*O.x2).toFixed(3)+"px"],["top",(this._scaleY*O.y2).toFixed(3)+"px"]])),new o.Keyframe(e.end-e.start,new v.Map([["left",(this._scaleX*O.x2).toFixed(3)+"px"],["top",(this._scaleY*O.y2).toFixed(3)+"px"]]))]);else if(O instanceof h.Fade)d.add("linear",[new o.Keyframe(0,new v.Map([["opacity","0"]])),new o.Keyframe(O.start,new v.Map([["opacity","1"]])),new o.Keyframe(e.end-e.start-O.end,new v.Map([["opacity","1"]])),new o.Keyframe(e.end-e.start,new v.Map([["opacity","0"]]))]);else if(O instanceof h.ComplexFade)d.add("linear",[new o.Keyframe(0,new v.Map([["opacity",O.a1.toFixed(3)]])),new o.Keyframe(O.t1,new v.Map([["opacity",O.a1.toFixed(3)]])),new o.Keyframe(O.t2,new v.Map([["opacity",O.a2.toFixed(3)]])),new o.Keyframe(O.t3,new v.Map([["opacity",O.a2.toFixed(3)]])),new o.Keyframe(O.t4,new v.Map([["opacity",O.a3.toFixed(3)]])),new o.Keyframe(e.end-e.start,new v.Map([["opacity",O.a3.toFixed(3)]]))]);else if(O instanceof h.Transform)for(var C=s<=O.start?0:s>=O.end?1:Math.pow((s-O.start)/(O.end-O.start),O.accel),j=0,D=O.tags;j<D.length;j++){var R=D[j];R instanceof h.Border?(y.outlineWidth+=C*(R.value-y.outlineWidth),y.outlineHeight+=C*(R.value-y.outlineHeight)):R instanceof h.BorderX?y.outlineWidth+=C*(R.value-y.outlineWidth):R instanceof h.BorderY?y.outlineHeight+=C*(R.value-y.outlineHeight):R instanceof h.Shadow?(y.shadowDepthX+=C*(R.value-y.shadowDepthX),y.shadowDepthY+=C*(R.value-y.shadowDepthY)):R instanceof h.ShadowX?y.shadowDepthX+=C*(R.value-y.shadowDepthX):R instanceof h.ShadowY?y.shadowDepthY+=C*(R.value-y.shadowDepthY):R instanceof h.Blur?y.blur+=C*(R.value-y.blur):R instanceof h.GaussianBlur?y.gaussianBlur+=C*(R.value-y.gaussianBlur):R instanceof h.FontSize?y.fontSize+=C*(R.value-y.fontSize):R instanceof h.FontSizePlus?y.fontSize+=C*R.value:R instanceof h.FontSizeMinus?y.fontSize-=C*R.value:R instanceof h.FontScaleX?y.fontScaleX+=C*(R.value-y.fontScaleX):R instanceof h.FontScaleY?y.fontScaleY+=C*(R.value-y.fontScaleY):R instanceof h.LetterSpacing?y.letterSpacing+=C*(R.value-y.letterSpacing):R instanceof h.RotateX?y.rotationX+=C*(R.value-y.rotationX):R instanceof h.RotateY?y.rotationY+=C*(R.value-y.rotationY):R instanceof h.RotateZ?y.rotationZ+=C*(R.value-y.rotationZ):R instanceof h.SkewX?y.skewX+=C*(R.value-y.skewX):R instanceof h.SkewY?y.skewY+=C*(R.value-y.skewY):R instanceof h.PrimaryColor?y.primaryColor=y.primaryColor.interpolate(R.value,C):R instanceof h.SecondaryColor?y.secondaryColor=y.secondaryColor.interpolate(R.value,C):R instanceof h.OutlineColor?y.outlineColor=y.outlineColor.interpolate(R.value,C):R instanceof h.ShadowColor?y.shadowColor=y.shadowColor.interpolate(R.value,C):R instanceof h.Alpha?(y.primaryAlpha+=C*(R.value-y.primaryAlpha),y.secondaryAlpha+=C*(R.value-y.secondaryAlpha),y.outlineAlpha+=C*(R.value-y.outlineAlpha),y.shadowAlpha+=C*(R.value-y.shadowAlpha)):R instanceof h.PrimaryAlpha?y.primaryAlpha+=C*(R.value-y.primaryAlpha):R instanceof h.SecondaryAlpha?y.secondaryAlpha+=C*(R.value-y.secondaryAlpha):R instanceof h.OutlineAlpha?y.outlineAlpha+=C*(R.value-y.outlineAlpha):R instanceof h.ShadowAlpha&&(y.shadowAlpha+=C*(R.value-y.shadowAlpha))}else O instanceof h.DrawingMode?0!==O.scale&&(E.scale=O.scale):O instanceof h.DrawingBaselineOffset?E.baselineOffset=O.value:O instanceof h.DrawingInstructions?(_.appendChild(E.toSVG(O,y.primaryColor.withAlpha(y.primaryAlpha))),S(!1)):O instanceof h.Text?(_.appendChild(document.createTextNode(O.value+"‌")),S(!1)):f.debugMode&&O instanceof h.Comment?(_.appendChild(document.createTextNode(O.value)),S(!1)):O instanceof h.NewLine&&S(!0)}for(var L=0,I=e.parts;L<I.length;L++){var O;if((O=I[L])instanceof h.Position||O instanceof h.Move){var P=r._transformOrigins[e.alignment],M="translate("+-P[0]+"%, "+-P[1]+"%) translate(-"+u.style.marginLeft+", -"+u.style.marginTop+")",N=P[0]+"% "+P[1]+"%";u.style.webkitTransform=M,u.style.webkitTransformOrigin=N,u.style.transform=M,u.style.transformOrigin=N;break}}switch(x){case g.WrappingStyle.EndOfLineWrapping:u.style.whiteSpace="pre-wrap";break;case g.WrappingStyle.NoLineWrapping:u.style.whiteSpace="pre";break;case g.WrappingStyle.SmartWrappingWithWiderTopLine:case g.WrappingStyle.SmartWrappingWithWiderBottomLine:u.style.whiteSpace="pre-wrap"}if(""!==u.style.position)switch(e.alignment){case 1:case 4:case 7:u.style.textAlign="left";break;case 2:case 5:case 8:u.style.textAlign="center";break;case 3:case 6:case 9:u.style.textAlign="right"}u.style.webkitAnimation=d.animationStyle,u.style.animation=d.animationStyle,u.setAttribute("data-dialogue-id",this.id+"-"+e.id),""!==c.textContent&&u.appendChild(c),m.hasChildNodes()&&u.appendChild(p);var F={sub:u,animationDelays:d.animationDelays};return e.containsTransformTag||this._preRenderedSubs.set(e.id,F),F},r.prototype.draw=function(e){var t=this;if(!this._currentSubs.has(e)||e.containsTransformTag){f.debugMode&&console.log(e.toString());var r=this._preRenderedSubs.get(e.id);void 0===r&&(r=this.preRender(e),f.debugMode&&console.log(e.toString()));var n=r.sub.cloneNode(!0),i=function(n){var i=n.style.animationName||n.style.webkitAnimationName;if(void 0!==i&&""!==i){var a=i.split(",").map(function(n){return n=n.trim(),((r.animationDelays.get(n)+e.start-t.clock.currentTime)/t.clock.rate).toFixed(3)+"s"}).join(", ");n.style.webkitAnimationDelay=a,n.style.animationDelay=a}};i(n);for(var a=n.querySelectorAll('[style*="animation:"]'),s=0;s<a.length;s++)i(a[s]);var o=e.layer,l="absolute"===n.style.position?0:e.alignment;if(void 0===this._layerWrappers[o]){(h=document.createElement("div")).className="layer layer"+o;for(var u=null,c=o+1;c<this._layerWrappers.length&&null===u;c++)void 0!==this._layerWrappers[c]&&(u=this._layerWrappers[c]);this._subsWrapper.insertBefore(h,u),this._layerWrappers[o]=h,this._layerAlignmentWrappers[o]=[]}if(void 0===this._layerAlignmentWrappers[o][l]){var d=document.createElement("div");d.className="an an"+l;for(var h=this._layerWrappers[o],p=(u=null,l+1);p<this._layerAlignmentWrappers[o].length&&null===u;p++)void 0!==this._layerAlignmentWrappers[o][p]&&(u=this._layerAlignmentWrappers[o][p]);h.insertBefore(d,u),this._layerAlignmentWrappers[o][l]=d}this._layerAlignmentWrappers[o][l].appendChild(n);var g=n.getElementsByTagName("style")[0];if(void 0!==g){var m=g.sheet;0===m.cssRules.length&&(m.cssText=g.textContent)}this._currentSubs.set(e,n)}},r.prototype._onClockPlay=function(){t.prototype._onClockPlay.call(this),this._removeAllSubs(),this._subsWrapper.style.display="",this._subsWrapper.classList.remove("paused")},r.prototype._onClockTick=function(){var e=this,r=this.clock.currentTime;this._currentSubs.forEach(function(t,n){(n.start>r||n.end<r||n.containsTransformTag)&&(e._currentSubs.delete(n),e._removeSub(t))}),t.prototype._onClockTick.call(this)},r.prototype._onClockPause=function(){t.prototype._onClockPause.call(this),this._subsWrapper.classList.add("paused")},r.prototype._onClockStop=function(){t.prototype._onClockStop.call(this),this._subsWrapper.style.display="none"},r.prototype._onClockRateChange=function(){t.prototype._onClockRateChange.call(this),this._preRenderedSubs.clear()},r.prototype._ready=function(){this._dispatchEvent("ready",[])},r.prototype._calculateFontMetricsAfterFetch=function(e,t){var r=this;return t.then(function(){var t=r._fontSizeElement.cloneNode(!0);return r._libjassSubsWrapper.appendChild(t),_.lastly(s.calculateFontMetrics(e,r.settings.fallbackFonts,t),function(){r._libjassSubsWrapper.removeChild(t)})})},r.prototype._removeSub=function(e){e.parentNode.removeChild(e)},r.prototype._removeAllSubs=function(){var e=this;this._currentSubs.forEach(function(t){return e._removeSub(t)}),this._currentSubs.clear()},r._transformOrigins=[null,[0,100],[50,100],[100,100],[0,50],[50,50],[100,50],[0,0],[50,0],[100,0]],r}(c.NullRenderer);t.WebRenderer=b,m.mixin(b,[u.EventSource])},function(e,t){var r=t(19),n=function(){function e(e,t,r,n,i,a,s,o){this._scaleX=r,this._scaleY=n,this._settings=i,this._fontSizeElement=a,this._svgDefsElement=s,this._fontMetricsCache=o,this._nextFilterId=0,this._id=e.id+"-"+t.id,this._defaultStyle=t.style,this.reset(null)}return e.prototype.reset=function(e){null==e&&(e=this._defaultStyle),this.italic=e.italic,this.bold=e.bold,this.underline=e.underline,this.strikeThrough=e.strikeThrough,this.outlineWidth=e.outlineThickness,this.outlineHeight=e.outlineThickness,this.shadowDepthX=e.shadowDepth,this.shadowDepthY=e.shadowDepth,this.fontName=e.fontName,this.fontSize=e.fontSize,this.fontScaleX=e.fontScaleX,this.fontScaleY=e.fontScaleY,this.letterSpacing=e.letterSpacing,this._rotationX=null,this._rotationY=null,this._rotationZ=e.rotationZ,this._skewX=null,this._skewY=null,this.primaryColor=e.primaryColor,this.secondaryColor=e.secondaryColor,this.outlineColor=e.outlineColor,this.shadowColor=e.shadowColor,this.primaryAlpha=e.primaryColor.alpha,this.secondaryAlpha=e.secondaryColor.alpha,this.outlineAlpha=e.outlineColor.alpha,this.shadowAlpha=e.shadowColor.alpha,this.blur=null,this.gaussianBlur=null},e.prototype.setStylesOnSpan=function(t,n){var i=t.childNodes[0]instanceof Text,a="";this._italic&&(a+="italic "),!0===this._bold?a+="bold ":!1!==this._bold&&(a+=this._bold+" ");var s=(this._scaleY*r.fontSizeForLineHeight(this._fontName,this._fontSize*(i?this._fontScaleX:1),this._settings.fallbackFonts,this._fontSizeElement,this._fontMetricsCache)).toFixed(3),o=(this._scaleY*this._fontSize).toFixed(3),l=this._fontName;switch(l){case"cursive":case"fantasy":case"monospace":case"sans-serif":case"serif":break;default:l='"'+l+'"'}""!==this._settings.fallbackFonts&&(l+=", "+this._settings.fallbackFonts),t.style.font=""+a+s+"px/"+o+"px "+l;var u="";this._underline&&(u="underline"),this._strikeThrough&&(u+=" line-through"),t.style.textDecoration=u.trim();var c="";if(i?this._fontScaleY!==this._fontScaleX&&(c+="scaleY("+(this._fontScaleY/this._fontScaleX).toFixed(3)+") "):(1!==this._fontScaleX&&(c+="scaleX("+this._fontScaleX+") "),1!==this._fontScaleY&&(c+="scaleY("+this._fontScaleY+") ")),null!==this._rotationY&&(c+="rotateY("+this._rotationY+"deg) "),null!==this._rotationX&&(c+="rotateX("+this._rotationX+"deg) "),0!==this._rotationZ&&(c+="rotateZ("+-1*this._rotationZ+"deg) "),null!==this._skewX||null!==this._skewY){var d=e._valueOrDefault(this._skewX,0);c+="matrix(1, "+e._valueOrDefault(this._skewY,0)+", "+d+", 1, 0, 0) "}""!==c&&(t.style.webkitTransform=c,t.style.webkitTransformOrigin="50% 50%",t.style.transform=c,t.style.transformOrigin="50% 50%",t.style.display="inline-block"),t.style.letterSpacing=(this._scaleX*this._letterSpacing).toFixed(3)+"px";var h=this._scaleX*this._outlineWidth,f=this._scaleY*this._outlineHeight,p=document.createElement("span");p.appendChild(t);var g=this._primaryColor.withAlpha(this._primaryAlpha),m=this._outlineColor.withAlpha(this._outlineAlpha),v=this._shadowColor.withAlpha(this._shadowAlpha);if(this._settings.enableSvg||(0!==h||0!==f)&&m.alpha!==g.alpha||(0!==this._shadowDepthX||0!==this._shadowDepthY)&&v.alpha!==g.alpha||(g=this._primaryColor.withAlpha(1),m=this._outlineColor.withAlpha(1),v=this._shadowColor.withAlpha(1),t.style.opacity=this._primaryAlpha.toFixed(3)),t.style.color=g.toString(),this._settings.enableSvg?this._setSvgOutlineOnSpan(p,h,f,m,this._primaryAlpha):this._setTextShadowOutlineOnSpan(t,h,f,m),0!==this._shadowDepthX||0!==this._shadowDepthY){var _=v.toString()+" "+(this._shadowDepthX*this._scaleX).toFixed(3)+"px "+(this._shadowDepthY*this._scaleY).toFixed(3)+"px 0px";""===t.style.textShadow?t.style.textShadow=_:t.style.textShadow+=", "+_}return 0===this._rotationX&&0===this._rotationY||(p.style.display="inline-block"),t.style.webkitAnimation=n.animationStyle,t.style.animation=n.animationStyle,p},e.prototype._setSvgOutlineOnSpan=function(e,t,r,n,i){var a="svg-filter-"+this._id+"-"+this._nextFilterId++,s=document.createElementNS("http://www.w3.org/2000/svg","filter");if(s.id=a,s.x.baseVal.valueAsString="-50%",s.width.baseVal.valueAsString="200%",s.y.baseVal.valueAsString="-50%",s.height.baseVal.valueAsString="200%",t>0||r>0){var o=0,l=!this._settings.preciseOutlines&&this._gaussianBlur>0?this._gaussianBlur:1;!function(e){if(t<=r)if(t>0){var n;for(n=0;n<=t;n+=l)e(n,r/t*Math.sqrt(t*t-n*n));n!==t+l&&e(t,0)}else e(0,r);else if(r>0){var i;for(i=0;i<=r;i+=l)e(t/r*Math.sqrt(r*r-i*i),i);i!==r+l&&e(0,r)}else e(t,0)}(function(e,t){var r=document.createElementNS("http://www.w3.org/2000/svg","feMorphology");s.appendChild(r),r.in1.baseVal="source",r.operator.baseVal=SVGFEMorphologyElement.SVG_MORPHOLOGY_OPERATOR_DILATE,r.radiusX.baseVal=e,r.radiusY.baseVal=t,r.result.baseVal="outline"+o,o++});var u=document.createElementNS("http://www.w3.org/2000/svg","feComponentTransfer");s.insertBefore(u,s.firstElementChild),u.in1.baseVal="SourceAlpha",u.result.baseVal="source";var c=document.createElementNS("http://www.w3.org/2000/svg","feFuncA");u.appendChild(c),c.type.baseVal=SVGComponentTransferFunctionElement.SVG_FECOMPONENTTRANSFER_TYPE_LINEAR,c.slope.baseVal=0===i?1:1/i,c.intercept.baseVal=0;var d=document.createElementNS("http://www.w3.org/2000/svg","feMerge");s.appendChild(d);for(var h=0;h<o;h++){var f=document.createElementNS("http://www.w3.org/2000/svg","feMergeNode");d.appendChild(f),f.in1.baseVal="outline"+h}var p=document.createElementNS("http://www.w3.org/2000/svg","feComponentTransfer");s.appendChild(p),p.setAttribute("color-interpolation-filters","sRGB");var g=document.createElementNS("http://www.w3.org/2000/svg","feFuncR");p.appendChild(g),g.type.baseVal=SVGComponentTransferFunctionElement.SVG_FECOMPONENTTRANSFER_TYPE_LINEAR,g.slope.baseVal=0,g.intercept.baseVal=n.red/255*n.alpha;var m=document.createElementNS("http://www.w3.org/2000/svg","feFuncG");p.appendChild(m),m.type.baseVal=SVGComponentTransferFunctionElement.SVG_FECOMPONENTTRANSFER_TYPE_LINEAR,m.slope.baseVal=0,m.intercept.baseVal=n.green/255*n.alpha;var v=document.createElementNS("http://www.w3.org/2000/svg","feFuncB");p.appendChild(v),v.type.baseVal=SVGComponentTransferFunctionElement.SVG_FECOMPONENTTRANSFER_TYPE_LINEAR,v.slope.baseVal=0,v.intercept.baseVal=n.blue/255*n.alpha;var _=document.createElementNS("http://www.w3.org/2000/svg","feFuncA");if(p.appendChild(_),_.type.baseVal=SVGComponentTransferFunctionElement.SVG_FECOMPONENTTRANSFER_TYPE_LINEAR,_.slope.baseVal=n.alpha,_.intercept.baseVal=0,this._gaussianBlur>0){var y=document.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");s.appendChild(y),y.stdDeviationX.baseVal=this._gaussianBlur,y.stdDeviationY.baseVal=this._gaussianBlur}for(h=0;h<this._blur;h++){var b=document.createElementNS("http://www.w3.org/2000/svg","feConvolveMatrix");s.appendChild(b),b.setAttribute("kernelMatrix","1 2 1 2 4 2 1 2 1"),b.edgeMode.baseVal=SVGFEConvolveMatrixElement.SVG_EDGEMODE_NONE}var w=document.createElementNS("http://www.w3.org/2000/svg","feComposite");s.appendChild(w),w.in2.baseVal="source",w.operator.baseVal=SVGFECompositeElement.SVG_FECOMPOSITE_OPERATOR_OUT;var S=document.createElementNS("http://www.w3.org/2000/svg","feMerge");s.appendChild(S);var E=document.createElementNS("http://www.w3.org/2000/svg","feMergeNode");S.appendChild(E);var x=document.createElementNS("http://www.w3.org/2000/svg","feMergeNode");S.appendChild(x),x.in1.baseVal="SourceGraphic"}else{if(this._gaussianBlur>0){y=document.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");s.appendChild(y),y.stdDeviationX.baseVal=this._gaussianBlur,y.stdDeviationY.baseVal=this._gaussianBlur}for(h=0;h<this._blur;h++){b=document.createElementNS("http://www.w3.org/2000/svg","feConvolveMatrix");s.appendChild(b),b.setAttribute("kernelMatrix","1 2 1 2 4 2 1 2 1"),b.edgeMode.baseVal=SVGFEConvolveMatrixElement.SVG_EDGEMODE_NONE}}s.childElementCount>0&&(this._svgDefsElement.appendChild(s),e.style.webkitFilter='url("#'+a+'")',e.style.filter='url("#'+a+'")')},e.prototype._setTextShadowOutlineOnSpan=function(e,t,r,n){var i=this;if(t>0||r>0){var a="";!function(e){for(var n=0;n<=t;n++)for(var i=0===t?r:r*Math.sqrt(1-n*n/(t*t)),a=0;a<=i;a++)e(n,a),0!==n&&e(-n,a),0!==a&&e(n,-a),0!==n&&0!==a&&e(-n,-a)}(function(e,t){a+=", "+n.toString()+" "+e+"px "+t+"px "+i._gaussianBlur.toFixed(3)+"px"}),e.style.textShadow=a.substr(", ".length)}},e.prototype.makeNewLine=function(){var e=document.createElement("br");return e.style.lineHeight=(this._scaleY*this._fontSize).toFixed(3)+"px",e},Object.defineProperty(e.prototype,"italic",{set:function(t){this._italic=e._valueOrDefault(t,this._defaultStyle.italic)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{set:function(t){this._bold=e._valueOrDefault(t,this._defaultStyle.bold)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{set:function(t){this._underline=e._valueOrDefault(t,this._defaultStyle.underline)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikeThrough",{set:function(t){this._strikeThrough=e._valueOrDefault(t,this._defaultStyle.strikeThrough)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(t){this._outlineWidth=e._valueOrDefault(t,this._defaultStyle.outlineThickness)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineHeight",{get:function(){return this._outlineWidth},set:function(t){this._outlineHeight=e._valueOrDefault(t,this._defaultStyle.outlineThickness)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowDepthX",{get:function(){return this._shadowDepthX},set:function(t){this._shadowDepthX=e._valueOrDefault(t,this._defaultStyle.shadowDepth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowDepthY",{get:function(){return this._shadowDepthY},set:function(t){this._shadowDepthY=e._valueOrDefault(t,this._defaultStyle.shadowDepth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blur",{get:function(){return this._blur},set:function(t){this._blur=e._valueOrDefault(t,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gaussianBlur",{get:function(){return this._gaussianBlur},set:function(t){this._gaussianBlur=e._valueOrDefault(t,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{set:function(t){this._fontName=e._valueOrDefault(t,this._defaultStyle.fontName)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize=e._valueOrDefault(t,this._defaultStyle.fontSize)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontScaleX",{get:function(){return this._fontScaleX},set:function(t){this._fontScaleX=e._valueOrDefault(t,this._defaultStyle.fontScaleX)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontScaleY",{get:function(){return this._fontScaleY},set:function(t){this._fontScaleY=e._valueOrDefault(t,this._defaultStyle.fontScaleY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing=e._valueOrDefault(t,this._defaultStyle.letterSpacing)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationX",{get:function(){return this._rotationX},set:function(e){this._rotationX=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationY",{get:function(){return this._rotationY},set:function(e){this._rotationY=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationZ",{get:function(){return this._rotationZ},set:function(t){this._rotationZ=e._valueOrDefault(t,this._defaultStyle.rotationZ)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skewX",{get:function(){return this._skewX},set:function(e){this._skewX=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skewY",{get:function(){return this._skewY},set:function(e){this._skewY=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"primaryColor",{get:function(){return this._primaryColor},set:function(t){this._primaryColor=e._valueOrDefault(t,this._defaultStyle.primaryColor)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryColor",{get:function(){return this._secondaryColor},set:function(t){this._secondaryColor=e._valueOrDefault(t,this._defaultStyle.secondaryColor)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(t){this._outlineColor=e._valueOrDefault(t,this._defaultStyle.outlineColor)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowColor",{get:function(){return this._shadowColor},set:function(t){this._shadowColor=e._valueOrDefault(t,this._defaultStyle.shadowColor)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"primaryAlpha",{get:function(){return this._primaryAlpha},set:function(t){this._primaryAlpha=e._valueOrDefault(t,this._defaultStyle.primaryColor.alpha)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryAlpha",{get:function(){return this._secondaryAlpha},set:function(t){this._secondaryAlpha=e._valueOrDefault(t,this._defaultStyle.secondaryColor.alpha)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineAlpha",{get:function(){return this._outlineAlpha},set:function(t){this._outlineAlpha=e._valueOrDefault(t,this._defaultStyle.outlineColor.alpha)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowAlpha",{get:function(){return this._shadowAlpha},set:function(t){this._shadowAlpha=e._valueOrDefault(t,this._defaultStyle.shadowColor.alpha)},enumerable:!0,configurable:!0}),e._valueOrDefault=function(e,t){return null!==e?e:t},e}();e.SpanStyles=n},function(e){e.debugMode=!1,e.verboseMode=!1,e.setDebugMode=function(t){e.debugMode=t},e.setVerboseMode=function(t){e.verboseMode=t}},function(t,r){var n=r(26),i=r(29),a=r(28),s=r(27),o=r(23),l=r(1),u=r(2),c=r(30),d=r(32),h=function(){function t(){if(this._properties=new a.ScriptProperties,this._styles=new c.Map,this._dialogues=[],this._attachments=[],this._stylesFormatSpecifier=null,this._dialoguesFormatSpecifier=null,1===arguments.length)throw new Error("Constructor `new ASS(rawASS)` has been deprecated. Use `ASS.fromString(rawASS)` instead.");this._styles.set("Default",new i.Style(new c.Map([["Name","Default"]])))}return Object.defineProperty(t.prototype,"properties",{get:function(){return this._properties},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"styles",{get:function(){return this._styles},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogues",{get:function(){return this._dialogues},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attachments",{get:function(){return this._attachments},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stylesFormatSpecifier",{get:function(){return this._stylesFormatSpecifier},set:function(e){this._stylesFormatSpecifier=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialoguesFormatSpecifier",{get:function(){return this._dialoguesFormatSpecifier},set:function(e){this._dialoguesFormatSpecifier=e},enumerable:!0,configurable:!0}),t.prototype.addStyle=function(e){var t=u.parseLineIntoTypedTemplate(e,this._stylesFormatSpecifier);if(null!==t&&"Style"===t.type){var r=t.template;if(o.verboseMode){var n="";r.forEach(function(e,t){return n+=t+" = "+e+", "}),console.log("Read style: "+n)}var a=new i.Style(r);this._styles.set(a.name,a)}},t.prototype.addEvent=function(e){var t=u.parseLineIntoTypedTemplate(e,this._dialoguesFormatSpecifier);if(null!==t&&"Dialogue"===t.type){var r=t.template;if(o.verboseMode){var i="";r.forEach(function(e,t){return i+=t+" = "+e+", "}),console.log("Read dialogue: "+i)}this.dialogues.push(new n.Dialogue(r,this))}},t.prototype.addAttachment=function(e){this._attachments.push(e)},t.fromString=function(e,r){return void 0===r&&(r=s.Format.ASS),t.fromStream(new l.StringStream(e),r)},t.fromStream=function(e,t){switch(void 0===t&&(t=s.Format.ASS),t){case s.Format.ASS:return new l.StreamParser(e).ass;case s.Format.SRT:return new l.SrtStreamParser(e).ass;default:throw new Error("Illegal value of type: "+t)}},t.fromUrl=function(r,n){return void 0===n&&(n=s.Format.ASS),("function"==typeof e.fetch&&"function"==typeof e.ReadableStream&&"function"==typeof e.ReadableStream.prototype.getReader&&"function"==typeof e.TextDecoder?e.fetch(r).then(function(e){if(!1===e.ok||void 0===e.ok&&(e.status<200||e.status>299))throw new Error("HTTP request for "+r+" failed with status code "+e.status);return t.fromReadableStream(e.body,"utf-8",n)}):d.Promise.reject(new Error("Not supported."))).catch(function(e){console.warn("fetch() failed, falling back to XHR: %o",e);var i=new XMLHttpRequest,a=t.fromStream(new l.XhrStream(i),n);return i.open("GET",r,!0),i.send(),a})},t.fromReadableStream=function(e,r,n){return void 0===r&&(r="utf-8"),void 0===n&&(n=s.Format.ASS),t.fromStream(new l.BrowserReadableStream(e,r),n)},t}();t.ASS=h},function(e){var t;(t=e.AttachmentType||(e.AttachmentType={}))[t.Font=0]="Font",t[t.Graphic=1]="Graphic";var r=function(){function e(e,t){this._filename=e,this._type=t,this._contents=""}return Object.defineProperty(e.prototype,"filename",{get:function(){return this._filename},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contents",{get:function(){return this._contents},set:function(e){this._contents=e},enumerable:!0,configurable:!0}),e}();e.Attachment=r},function(e,t){var r=t(27),n=t(3),i=t(8),a=t(23),s=t(30),o=function(){function e(t,n){this._parts=null,this._containsTransformTag=!1;var i=new s.Map;t.forEach(function(e,t){i.set(t.toLowerCase(),e)}),t=i,this._id=++e._lastDialogueId;var o=t.get("style");if(null!=o&&o.constructor===String&&null!==(o=o.replace(/^\*+/,"")).match(/^Default$/i)&&(o="Default"),this._style=n.styles.get(o),void 0===this._style&&(a.debugMode&&console.warn("Unrecognized style "+o+'. Falling back to "Default"'),this._style=n.styles.get("Default")),void 0===this._style)throw new Error("Unrecognized style "+o);if(this._start=e._toTime(t.get("start")),this._end=e._toTime(t.get("end")),this._layer=Math.max(r.valueOrDefault(t,"layer",parseInt,function(e){return!isNaN(e)},"0"),0),this._rawPartsString=t.get("text"),void 0===this._rawPartsString||null===this._rawPartsString||this._rawPartsString.constructor!==String)throw new Error("Dialogue doesn't have any text.")}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this._start},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alignment",{get:function(){return null===this._parts&&this._parsePartsString(),this._alignment},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layer",{get:function(){return this._layer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parts",{get:function(){return null===this._parts&&this._parsePartsString(),this._parts},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containsTransformTag",{get:function(){return null===this._parts&&this._parsePartsString(),this._containsTransformTag},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return"#"+this._id+" ["+this._start.toFixed(3)+"-"+this._end.toFixed(3)+"] "+(null!==this._parts?this._parts.join(", "):this._rawPartsString)},e.prototype._parsePartsString=function(){var e=this;if(this._parts=n.parse(this._rawPartsString,"dialogueParts"),this._alignment=this._style.alignment,this._parts.forEach(function(t,r){t instanceof i.Alignment?e._alignment=t.value:t instanceof i.Move?null!==t.t1&&null!==t.t2||(e._parts[r]=new i.Move(t.x1,t.y1,t.x2,t.y2,0,e._end-e._start)):t instanceof i.Transform&&(null!==t.start&&null!==t.end&&null!==t.accel||(e._parts[r]=new i.Transform(null===t.start?0:t.start,null===t.end?e._end-e._start:t.end,null===t.accel?1:t.accel,t.tags)),e._containsTransformTag=!0)}),a.debugMode){var t=this._parts.filter(function(e){return e instanceof i.Comment&&-1!==e.value.indexOf("\\")});t.length>0&&console.warn("Possible incorrect parse:\n"+this._rawPartsString+"\nwas parsed as\n"+this.toString()+"\nThe possibly incorrect parses are:\n"+t.join("\n"))}},e._toTime=function(e){return e.split(":").reduce(function(e,t){return 60*e+parseFloat(t)},0)},e._lastDialogueId=-1,e}();e.Dialogue=o},function(e){var t,r,n;(t=e.Format||(e.Format={}))[t.ASS=0]="ASS",t[t.SRT=1]="SRT",(r=e.WrappingStyle||(e.WrappingStyle={}))[r.SmartWrappingWithWiderTopLine=0]="SmartWrappingWithWiderTopLine",r[r.SmartWrappingWithWiderBottomLine=3]="SmartWrappingWithWiderBottomLine",r[r.EndOfLineWrapping=1]="EndOfLineWrapping",r[r.NoLineWrapping=2]="NoLineWrapping",(n=e.BorderStyle||(e.BorderStyle={}))[n.Outline=1]="Outline",n[n.OpaqueBox=3]="OpaqueBox",e.valueOrDefault=function(e,t,r,n,i){var a=e.get(t);if(void 0===a)return r(i);try{var s=r(a);if(null!==n&&!n(s))throw new Error("Validation failed.");return s}catch(e){throw new Error("Property "+t+" has invalid value "+a+" - "+e.stack)}}},function(e){var t=function(){function e(){}return Object.defineProperty(e.prototype,"resolutionX",{get:function(){return this._resolutionX},set:function(e){this._resolutionX=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resolutionY",{get:function(){return this._resolutionY},set:function(e){this._resolutionY=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wrappingStyle",{get:function(){return this._wrappingStyle},set:function(e){this._wrappingStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleBorderAndShadow",{get:function(){return this._scaleBorderAndShadow},set:function(e){this._scaleBorderAndShadow=e},enumerable:!0,configurable:!0}),e}();e.ScriptProperties=t},function(e,t){var r=t(27),n=t(3),i=t(30),a=function(){function e(e){var t=new i.Map;if(e.forEach(function(e,r){t.set(r.toLowerCase(),e)}),e=t,this._name=e.get("name"),void 0===this._name||null===this._name||this._name.constructor!==String)throw new Error("Style doesn't have a name.");this._name=this._name.replace(/^\*+/,""),this._italic=!!r.valueOrDefault(e,"italic",parseFloat,function(e){return!isNaN(e)},"0"),this._bold=!!r.valueOrDefault(e,"bold",parseFloat,function(e){return!isNaN(e)},"0"),this._underline=!!r.valueOrDefault(e,"underline",parseFloat,function(e){return!isNaN(e)},"0"),this._strikeThrough=!!r.valueOrDefault(e,"strikeout",parseFloat,function(e){return!isNaN(e)},"0"),this._fontName=r.valueOrDefault(e,"fontname",function(e){return e},function(e){return e.constructor===String},"sans-serif"),this._fontSize=r.valueOrDefault(e,"fontsize",parseFloat,function(e){return!isNaN(e)},"18"),this._fontScaleX=r.valueOrDefault(e,"scalex",parseFloat,function(e){return e>=0},"100")/100,this._fontScaleY=r.valueOrDefault(e,"scaley",parseFloat,function(e){return e>=0},"100")/100,this._letterSpacing=r.valueOrDefault(e,"spacing",parseFloat,function(e){return e>=0},"0"),this._rotationZ=r.valueOrDefault(e,"angle",parseFloat,function(e){return!isNaN(e)},"0"),this._primaryColor=r.valueOrDefault(e,"primarycolour",function(e){return n.parse(e,"colorWithAlpha")},null,"&H00FFFFFF"),this._secondaryColor=r.valueOrDefault(e,"secondarycolour",function(e){return n.parse(e,"colorWithAlpha")},null,"&H00FFFF00"),this._outlineColor=r.valueOrDefault(e,"outlinecolour",function(e){return n.parse(e,"colorWithAlpha")},null,"&H00000000"),this._shadowColor=r.valueOrDefault(e,"backcolour",function(e){return n.parse(e,"colorWithAlpha")},null,"&H80000000"),this._outlineThickness=r.valueOrDefault(e,"outline",parseFloat,function(e){return e>=0},"2"),this._borderStyle=r.valueOrDefault(e,"borderstyle",parseInt,function(e){return r.BorderStyle[r.BorderStyle[e]]===e},"1"),this._shadowDepth=r.valueOrDefault(e,"shadow",parseFloat,function(e){return e>=0},"3"),this._alignment=r.valueOrDefault(e,"alignment",parseInt,function(e){return e>=1&&e<=9},"2"),this._marginLeft=r.valueOrDefault(e,"marginl",parseFloat,function(e){return!isNaN(e)},"20"),this._marginRight=r.valueOrDefault(e,"marginr",parseFloat,function(e){return!isNaN(e)},"20"),this._marginVertical=r.valueOrDefault(e,"marginv",parseFloat,function(e){return!isNaN(e)},"20")}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this._italic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{get:function(){return this._bold},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this._underline},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikeThrough",{get:function(){return this._strikeThrough},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontScaleX",{get:function(){return this._fontScaleX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontScaleY",{get:function(){return this._fontScaleY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationZ",{get:function(){return this._rotationZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"primaryColor",{get:function(){return this._primaryColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryColor",{get:function(){return this._secondaryColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineColor",{get:function(){return this._outlineColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowColor",{get:function(){return this._shadowColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineThickness",{get:function(){return this._outlineThickness},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borderStyle",{get:function(){return this._borderStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowDepth",{get:function(){return this._shadowDepth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alignment",{get:function(){return this._alignment},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marginLeft",{get:function(){return this._marginLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marginRight",{get:function(){return this._marginRight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marginVertical",{get:function(){return this._marginVertical},enumerable:!0,configurable:!0}),e}();e.Style=a},function(t){t.Map=e.Map;var r=function(){function e(e){if(this.clear(),void 0!==e){if(!Array.isArray(e))throw new Error("Non-array iterables are not supported by the SimpleMap constructor.");for(var t=0;t<e.length;t++){var r=e[t];this.set(r[0],r[1])}}}return e.prototype.get=function(e){var t=this._keyToProperty(e);if(null!==t)return this._values[t]},e.prototype.has=function(e){var t=this._keyToProperty(e);return null!==t&&t in this._keys},e.prototype.set=function(e,t){var r=this._keyToProperty(e);if(null===r)throw new Error("This Map implementation only supports Number and String keys, or keys with an id property.");return r in this._keys||this._size++,this._keys[r]=e,this._values[r]=t,this},e.prototype.delete=function(e){var t=this._keyToProperty(e);if(null===t)return!1;var r=t in this._keys;return r&&(delete this._keys[t],delete this._values[t],this._size--),r},e.prototype.clear=function(){this._keys=Object.create(null),this._values=Object.create(null),this._size=0},e.prototype.forEach=function(e,t){for(var r=0,n=Object.keys(this._keys);r<n.length;r++){var i=n[r];e.call(t,this._values[i],this._keys[i],this)}},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),e.prototype._keyToProperty=function(e){return"number"==typeof e?"#"+e:"string"==typeof e?"'"+e:void 0!==e.id?"!"+e.id:null},e}();(void 0===t.Map||"function"!=typeof t.Map.prototype.forEach||function(){try{return 2!==new t.Map([[1,"foo"],[2,"bar"]]).size}catch(e){return!0}}())&&(t.Map=r),t.setImplementation=function(e){t.Map=null!==e?e:r}},function(e){e.mixin=function(e,t){for(var r=0;r<t.length;r++)for(var n=t[r],i=0,a=Object.getOwnPropertyNames(n.prototype);i<a.length;i++){var s=a[i];e.prototype[s]=n.prototype[s]}}},function(t){t.Promise=e.Promise;var r,n=function(){var t=e.MutationObserver||e.WebkitMutationObserver;if(void 0!==e.process&&"function"==typeof e.process.nextTick)return function(t){e.process.nextTick(t)};if(void 0!==t){var r=[],n=!1,i=document.createElement("div");return new t(function(){for(var e=r.splice(0,r.length),t=0;t<e.length;t++){(0,e[t])()}n=!1,r.length>0&&(i.classList.toggle("foo"),n=!0)}).observe(i,{attributes:!0}),function(e){r.push(e),n||(i.classList.toggle("foo"),n=!0)}}return function(e){return setTimeout(e,0)}}(),i=function(){function e(e){if(this._state=r.PENDING,this._fulfillReactions=[],this._rejectReactions=[],this._fulfilledValue=null,this._rejectedReason=null,"function"!=typeof e)throw new TypeError('typeof executor !== "function"');var t=this._createResolvingFunctions(),n=t.resolve,i=t.reject;try{e(n,i)}catch(e){i(e)}}return e.prototype.then=function(e,t){var n=new a;"function"!=typeof e&&(e=function(e){return e}),"function"!=typeof t&&(t=function(e){throw e});var i={capabilities:n,handler:e},s={capabilities:n,handler:t};switch(this._state){case r.PENDING:this._fulfillReactions.push(i),this._rejectReactions.push(s);break;case r.FULFILLED:this._enqueueFulfilledReactionJob(i,this._fulfilledValue);break;case r.REJECTED:this._enqueueRejectedReactionJob(s,this._rejectedReason)}return n.promise},e.prototype.catch=function(e){return this.then(null,e)},e.resolve=function(r){return r instanceof e?r:new t.Promise(function(e){return e(r)})},e.reject=function(e){return new t.Promise(function(t,r){return r(e)})},e.all=function(e){return new t.Promise(function(r,n){var i=[],a=e.length;0!==a?e.forEach(function(e,s){return t.Promise.resolve(e).then(function(e){i[s]=e,0===--a&&r(i)},n)}):r(i)})},e.race=function(e){return new t.Promise(function(r,n){for(var i=0;i<e.length;i++){var a=e[i];t.Promise.resolve(a).then(r,n)}})},e.prototype._createResolvingFunctions=function(){var e=this,t=!1;return{resolve:function(r){if(!t)if(t=!0,r!==e)if(null===r||"object"!=typeof r&&"function"!=typeof r)e._fulfill(r);else{try{var i=r.then}catch(t){return void e._reject(t)}"function"==typeof i?n(function(){return e._resolveWithThenable(r,i)}):e._fulfill(r)}else e._reject(new TypeError("resolution === this"))},reject:function(r){t||(t=!0,e._reject(r))}}},e.prototype._resolveWithThenable=function(e,t){var r=this._createResolvingFunctions(),n=r.resolve,i=r.reject;try{t.call(e,n,i)}catch(e){i(e)}},e.prototype._fulfill=function(e){var t=this._fulfillReactions;this._fulfilledValue=e,this._fulfillReactions=void 0,this._rejectReactions=void 0,this._state=r.FULFILLED;for(var n=0;n<t.length;n++){var i=t[n];this._enqueueFulfilledReactionJob(i,e)}},e.prototype._reject=function(e){var t=this._rejectReactions;this._rejectedReason=e,this._fulfillReactions=void 0,this._rejectReactions=void 0,this._state=r.REJECTED;for(var n=0;n<t.length;n++){var i=t[n];this._enqueueRejectedReactionJob(i,e)}},e.prototype._enqueueFulfilledReactionJob=function(e,t){n(function(){var r,n=e.capabilities,i=n.resolve,a=n.reject,s=e.handler;try{r=s(t)}catch(e){return void a(e)}i(r)})},e.prototype._enqueueRejectedReactionJob=function(e,t){n(function(){var r,n=e.capabilities,i=n.resolve,a=n.reject,s=e.handler;try{r=s(t)}catch(e){return void a(e)}i(r)})},e}();void 0===t.Promise&&(t.Promise=i),function(e){e[e.PENDING=0]="PENDING",e[e.FULFILLED=1]="FULFILLED",e[e.REJECTED=2]="REJECTED"}(r||(r={})),t.setImplementation=function(e){t.Promise=null!==e?e:i};var a=function(){function e(){var e=this;this._promise=new t.Promise(function(t,r){Object.defineProperties(e,{resolve:{value:t,enumerable:!0},reject:{value:r,enumerable:!0}})})}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!0,configurable:!0}),e}();t.DeferredPromise=a,t.first=function(e){return function e(r,n){if(0===r.length)return t.Promise.reject(n);var i=r[0];var a=r.slice(1);return i.catch(function(t){return e(a,n.concat(t))})}(e,[])},t.any=function(e){return new t.Promise(function(r,n){return t.Promise.all(e.map(function(e){return e.then(r,function(e){return e})})).then(n)})},t.lastly=function(e,t){return e.then(function(e){return t(),e},function(e){throw t(),e})}},function(t){t.Set=e.Set;var r=function(){function e(e){if(this.clear(),void 0!==e){if(!Array.isArray(e))throw new Error("Non-array iterables are not supported by the SimpleSet constructor.");for(var t=0;t<e.length;t++){var r=e[t];this.add(r)}}}return e.prototype.add=function(e){var t=this._toProperty(e);if(null===t)throw new Error("This Set implementation only supports Number and String values.");return t in this._elements||this._size++,this._elements[t]=e,this},e.prototype.clear=function(){this._elements=Object.create(null),this._size=0},e.prototype.has=function(e){var t=this._toProperty(e);return null!==t&&t in this._elements},e.prototype.forEach=function(e,t){for(var r=0,n=Object.keys(this._elements);r<n.length;r++){var i=n[r],a=this._elements[i];e.call(t,a,a,this)}},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),e.prototype._toProperty=function(e){return"number"==typeof e?"#"+e:"string"==typeof e?"'"+e:null},e}();(void 0===t.Set||"function"!=typeof t.Set.prototype.forEach||function(){try{return 2!==new t.Set([1,2]).size}catch(e){return!0}}())&&(t.Set=r),t.setImplementation=function(e){t.Set=null!==e?e:r}},function(e){e.__extends=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},e.__decorate=function(e,t,r){if(arguments.length<3)return function(e,t){for(var r=0;r<e.length;r++){var n=e[r];t=n(t)||t}return t}(e.reverse(),t);!function(e,t,r){for(var n=0;n<e.length;n++){(0,e[n])(t,r)}}(e.reverse(),t,r)}},function(e,t){var r=t(30),n=t(32),i=t(36),a=t(38),s=function(){function e(e){var t=this;this._comm=e,this._pendingRequests=new r.Map,this._comm.addEventListener("message",function(e){return t._onMessage(e.data)},!1)}return e.prototype.request=function(t,r){var i=new n.DeferredPromise,s=++e._lastRequestId;this._pendingRequests.set(s,i);var o={requestId:s,command:t,parameters:r};return this._comm.postMessage(a.serialize(o)),i.promise},e.prototype.cancelRequest=function(e){var t=this._pendingRequests.get(e);void 0!==t&&(this._pendingRequests.delete(e),t.reject(new Error("Cancelled.")))},e.prototype._respond=function(e){var t=e.requestId,r=e.error,n=e.result;r instanceof Error&&(r={message:r.message,stack:r.stack}),this._comm.postMessage(a.serialize({command:i.WorkerCommands.Response,requestId:t,error:r,result:n}))},e.prototype._onMessage=function(e){var t=this,r=a.deserialize(e);if(r.command===i.WorkerCommands.Response){var n=r,s=this._pendingRequests.get(n.requestId);void 0!==s&&(this._pendingRequests.delete(n.requestId),null===n.error?s.resolve(n.result):s.reject(n.error))}else{var o=r,l=o.requestId,u=a.getWorkerCommandHandler(o.command);if(void 0===u)return void this._respond({requestId:l,error:new Error("No handler registered for command "+o.command),result:null});u(o.parameters).then(function(e){return{requestId:l,error:null,result:e}},function(e){return{requestId:l,error:e,result:null}}).then(function(e){return t._respond(e)})}},e._lastRequestId=-1,e}();e.WorkerChannelImpl=s,a.registerWorkerCommand(i.WorkerCommands.Ping,function(){return new n.Promise(function(e){return e(null)})})},function(e){var t;(t=e.WorkerCommands||(e.WorkerCommands={}))[t.Response=0]="Response",t[t.Parse=1]="Parse",t[t.Ping=2]="Ping"},function(t,r){var n=r(35),i=r(36);t.WorkerCommands=i.WorkerCommands,t.supported="undefined"!=typeof Worker;var a="undefined"!=typeof document&&void 0!==document.currentScript?document.currentScript:null;t.createWorker=function(e){return void 0===e&&(e=a.src),new n.WorkerChannelImpl(new Worker(e))},"undefined"!=typeof WorkerGlobalScope&&e instanceof WorkerGlobalScope&&new n.WorkerChannelImpl(e)},function(e,t){var r=t(30),n=new r.Map,i=new r.Map;e.registerWorkerCommand=function(e,t){n.set(e,t)},e.getWorkerCommandHandler=function(e){return n.get(e)},e.registerClassPrototype=function(e){e._classTag=i.size,i.set(e._classTag,e)},e.serialize=function(e){return JSON.stringify(e,function(e,t){return t&&void 0!==t._classTag&&(t._classTag=t._classTag),t})},e.deserialize=function(e){return JSON.parse(e,function(e,t){if(t&&void 0!==t._classTag){for(var r=Object.create(i.get(t._classTag)),n=0,a=Object.keys(t);n<a.length;n++){var s=a[n];"_classTag"!==s&&(r[s]=t[s])}t=r}return t})}}],r=Object.create(null),function e(n){if(r[n])return r[n];var i=r[n]=Object.create(null);return t[n](i,e),i}(0);var t,r}(a)}.apply(t,[]))||(e.exports=n)}()},function(e,t,r){var n=r(26);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r(3)(n,i);n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(2)(!1)).push([e.i,'/**\n * libjass\n *\n * https://github.com/Arnavion/libjass\n *\n * Copyright 2013 Arnav Singh\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n.libjass-wrapper {\n\tposition: relative;\n\toverflow: hidden;\n}\n\n.libjass-subs {\n\tposition: absolute;\n\toverflow: hidden;\n}\n\n.libjass-subs, .libjass-subs * {\n\tpointer-events: none;\n\t-webkit-animation-fill-mode: both !important;\n\tanimation-fill-mode: both !important;\n}\n\n.libjass-subs.paused * {\n\t-webkit-animation-play-state: paused !important;\n\tanimation-play-state: paused !important;\n}\n\n.libjass-subs .an {\n\tposition: absolute;\n}\n\n.libjass-subs .an1, .libjass-subs .an2, .libjass-subs .an3 {\n\tbottom: 0;\n}\n\n.libjass-subs .an4, .libjass-subs .an5, .libjass-subs .an6 {\n\tdisplay: table;\n\twidth: 100%;\n\theight: 100%;\n}\n\n.libjass-subs .an4 > *, .libjass-subs .an5 > *, .libjass-subs .an6 > * {\n\tdisplay: table-cell;\n\tvertical-align: middle;\n}\n\n.libjass-subs .an7, .libjass-subs .an8, .libjass-subs .an9 {\n\ttop: 0;\n}\n\n.libjass-subs .an1, .libjass-subs .an4, .libjass-subs .an7 {\n\ttext-align: left;\n}\n\n.libjass-subs .an2, .libjass-subs .an5, .libjass-subs .an8 {\n\ttext-align: center;\n}\n\n.libjass-subs .an3, .libjass-subs .an6, .libjass-subs .an9 {\n\ttext-align: right;\n}\n\n.libjass-subs {\n\tline-height: 0;\n}\n\n/* Filter wrapper span */\n.libjass-subs div[data-dialogue-id] > span {\n\t-webkit-perspective-origin: center;\n\t-webkit-perspective: 400px;\n\tperspective-origin: center;\n\tperspective: 400px;\n}\n\n.libjass-font-measure {\n\tposition: absolute;\n\tvisibility: hidden;\n\tborder: 0;\n\tmargin: 0;\n\tpadding: 0;\n\tline-height: normal;\n}\n\n.libjass-filters {\n\tdisplay: block;\n}\n',""])},function(e,t,r){"use strict";r.r(t);class n{static install(){Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Object.assign=Object.assign||function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");let t=Object(e);for(let e=1;e<arguments.length;e++){let r=arguments[e];if(null!=r)for(let e in r)r.hasOwnProperty(e)&&(t[e]=r[e])}return t},"function"!=typeof self.Promise&&r(6).polyfill()}}n.install();var i=n,a=r(0),s=r.n(a);class o{static e(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);let r=`[${e}] > ${t}`;o.ENABLE_CALLBACK&&o.emitter.emit("log","error",r),o.ENABLE_ERROR&&(console.error?console.error(r):console.warn?console.warn(r):console.log(r))}static i(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);let r=`[${e}] > ${t}`;o.ENABLE_CALLBACK&&o.emitter.emit("log","info",r),o.ENABLE_INFO&&(console.info?console.info(r):console.log(r))}static w(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);let r=`[${e}] > ${t}`;o.ENABLE_CALLBACK&&o.emitter.emit("log","warn",r),o.ENABLE_WARN&&(console.warn?console.warn(r):console.log(r))}static d(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);let r=`[${e}] > ${t}`;o.ENABLE_CALLBACK&&o.emitter.emit("log","debug",r),o.ENABLE_DEBUG&&(console.debug?console.debug(r):console.log(r))}static v(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);let r=`[${e}] > ${t}`;o.ENABLE_CALLBACK&&o.emitter.emit("log","verbose",r),o.ENABLE_VERBOSE&&console.log(r)}}o.GLOBAL_TAG="flv.js",o.FORCE_GLOBAL_TAG=!1,o.ENABLE_ERROR=!0,o.ENABLE_INFO=!0,o.ENABLE_WARN=!0,o.ENABLE_DEBUG=!0,o.ENABLE_VERBOSE=!0,o.ENABLE_CALLBACK=!1,o.emitter=new s.a;var l=o;var u=class{constructor(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}reset(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0}addBytes(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())}get currentKBps(){this.addBytes(0);let e=(this._now()-this._lastCheckpoint)/1e3;return 0==e&&(e=1),this._intervalBytes/e/1024}get lastSecondKBps(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0}get averageKBps(){let e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024}};class c{constructor(e){this._message=e}get name(){return"RuntimeException"}get message(){return this._message}toString(){return this.name+": "+this.message}}class d extends c{constructor(e){super(e)}get name(){return"IllegalStateException"}}class h extends c{constructor(e){super(e)}get name(){return"InvalidArgumentException"}}class f extends c{constructor(e){super(e)}get name(){return"NotImplementedException"}}const p={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},g={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"};class m{constructor(e){this._type=e||"undefined",this._status=p.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}destroy(){this._status=p.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}isWorking(){return this._status===p.kConnecting||this._status===p.kBuffering}get type(){return this._type}get status(){return this._status}get needStashBuffer(){return this._needStash}get onContentLengthKnown(){return this._onContentLengthKnown}set onContentLengthKnown(e){this._onContentLengthKnown=e}get onURLRedirect(){return this._onURLRedirect}set onURLRedirect(e){this._onURLRedirect=e}get onDataArrival(){return this._onDataArrival}set onDataArrival(e){this._onDataArrival=e}get onError(){return this._onError}set onError(e){this._onError=e}get onComplete(){return this._onComplete}set onComplete(e){this._onComplete=e}open(e,t){throw new f("Unimplemented abstract function!")}abort(){throw new f("Unimplemented abstract function!")}}let v={};!function(){let e=self.navigator.userAgent.toLowerCase(),t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(e)||[],r=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(android)/.exec(e)||/(windows)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||[],n={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",majorVersion:t[4]||t[2]||"0",platform:r[0]||""},i={};if(n.browser){i[n.browser]=!0;let e=n.majorVersion.split(".");i.version={major:parseInt(n.majorVersion,10),string:n.version},e.length>1&&(i.version.minor=parseInt(e[1],10)),e.length>2&&(i.version.build=parseInt(e[2],10))}if(n.platform&&(i[n.platform]=!0),(i.chrome||i.opr||i.safari)&&(i.webkit=!0),i.rv||i.iemobile){i.rv&&delete i.rv;let e="msie";n.browser=e,i[e]=!0}if(i.edge){delete i.edge;let e="msedge";n.browser=e,i[e]=!0}if(i.opr){let e="opera";n.browser=e,i[e]=!0}if(i.safari&&i.android){let e="android";n.browser=e,i[e]=!0}i.name=n.browser,i.platform=n.platform;for(let e in v)v.hasOwnProperty(e)&&delete v[e];Object.assign(v,i)}();var _=v;var y=class extends m{static isSupported(){try{let e=_.msedge&&_.version.minor>=15048,t=!_.msedge||e;return self.fetch&&self.ReadableStream&&t}catch(e){return!1}}constructor(e,t){super("fetch-stream-loader"),this.TAG="FetchStreamLoader",this._seekHandler=e,this._config=t,this._needStash=!0,this._requestAbort=!1,this._contentLength=null,this._receivedLength=0}destroy(){this.isWorking()&&this.abort(),super.destroy()}open(e,t){this._dataSource=e,this._range=t;let r=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(r=e.redirectedURL);let n=this._seekHandler.getConfig(r,t),i=new self.Headers;if("object"==typeof n.headers){let e=n.headers;for(let t in e)e.hasOwnProperty(t)&&i.append(t,e[t])}let a={method:"GET",headers:i,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if("object"==typeof this._config.headers)for(let e in this._config.headers)i.append(e,this._config.headers[e]);!1===e.cors&&(a.mode="same-origin"),e.withCredentials&&(a.credentials="include"),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),this._status=p.kConnecting,self.fetch(n.url,a).then(e=>{if(this._requestAbort)return this._requestAbort=!1,void(this._status=p.kIdle);if(e.ok&&e.status>=200&&e.status<=299){if(e.url!==n.url&&this._onURLRedirect){let t=this._seekHandler.removeURLParameters(e.url);this._onURLRedirect(t)}let t=e.headers.get("Content-Length");return null!=t&&(this._contentLength=parseInt(t),0!==this._contentLength&&this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)),this._pump.call(this,e.body.getReader())}if(this._status=p.kError,!this._onError)throw new c("FetchStreamLoader: Http code invalid, "+e.status+" "+e.statusText);this._onError(g.HTTP_STATUS_CODE_INVALID,{code:e.status,msg:e.statusText})}).catch(e=>{if(this._status=p.kError,!this._onError)throw e;this._onError(g.EXCEPTION,{code:-1,msg:e.message})})}abort(){this._requestAbort=!0}_pump(e){return e.read().then(t=>{if(t.done)if(null!==this._contentLength&&this._receivedLength<this._contentLength){this._status=p.kError;let e=g.EARLY_EOF,t={code:-1,msg:"Fetch stream meet Early-EOF"};if(!this._onError)throw new c(t.msg);this._onError(e,t)}else this._status=p.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1);else{if(!0===this._requestAbort)return this._requestAbort=!1,this._status=p.kComplete,e.cancel();this._status=p.kBuffering;let r=t.value.buffer,n=this._range.from+this._receivedLength;this._receivedLength+=r.byteLength,this._onDataArrival&&this._onDataArrival(r,n,this._receivedLength),this._pump(e)}}).catch(e=>{if(11===e.code&&_.msedge)return;this._status=p.kError;let t=0,r=null;if(19!==e.code&&"network error"!==e.message||!(null===this._contentLength||null!==this._contentLength&&this._receivedLength<this._contentLength)?(t=g.EXCEPTION,r={code:e.code,msg:e.message}):(t=g.EARLY_EOF,r={code:e.code,msg:"Fetch stream meet Early-EOF"}),!this._onError)throw new c(r.msg);this._onError(t,r)})}};var b=class extends m{static isSupported(){try{let e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===e.responseType}catch(e){return l.w("MozChunkedLoader",e.message),!1}}constructor(e,t){super("xhr-moz-chunked-loader"),this.TAG="MozChunkedLoader",this._seekHandler=e,this._config=t,this._needStash=!0,this._xhr=null,this._requestAbort=!1,this._contentLength=null,this._receivedLength=0}destroy(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),super.destroy()}open(e,t){this._dataSource=e,this._range=t;let r=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(r=e.redirectedURL);let n=this._seekHandler.getConfig(r,t);this._requestURL=n.url;let i=this._xhr=new XMLHttpRequest;if(i.open("GET",n.url,!0),i.responseType="moz-chunked-arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onloadend=this._onLoadEnd.bind(this),i.onerror=this._onXhrError.bind(this),e.withCredentials&&(i.withCredentials=!0),"object"==typeof n.headers){let e=n.headers;for(let t in e)e.hasOwnProperty(t)&&i.setRequestHeader(t,e[t])}if("object"==typeof this._config.headers){let e=this._config.headers;for(let t in e)e.hasOwnProperty(t)&&i.setRequestHeader(t,e[t])}this._status=p.kConnecting,i.send()}abort(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=p.kComplete}_onReadyStateChange(e){let t=e.target;if(2===t.readyState){if(null!=t.responseURL&&t.responseURL!==this._requestURL&&this._onURLRedirect){let e=this._seekHandler.removeURLParameters(t.responseURL);this._onURLRedirect(e)}if(0!==t.status&&(t.status<200||t.status>299)){if(this._status=p.kError,!this._onError)throw new c("MozChunkedLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(g.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}else this._status=p.kBuffering}}_onProgress(e){if(this._status===p.kError)return;null===this._contentLength&&null!==e.total&&0!==e.total&&(this._contentLength=e.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));let t=e.target.response,r=this._range.from+this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,r,this._receivedLength)}_onLoadEnd(e){!0!==this._requestAbort?this._status!==p.kError&&(this._status=p.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1}_onXhrError(e){this._status=p.kError;let t=0,r=null;if(this._contentLength&&e.loaded<this._contentLength?(t=g.EARLY_EOF,r={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(t=g.EXCEPTION,r={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new c(r.msg);this._onError(t,r)}};var w=class extends m{static isSupported(){try{let e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="arraybuffer","arraybuffer"===e.responseType}catch(e){return l.w("RangeLoader",e.message),!1}}constructor(e,t){super("xhr-range-loader"),this.TAG="RangeLoader",this._seekHandler=e,this._config=t,this._needStash=!1,this._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],this._currentChunkSizeKB=384,this._currentSpeedNormalized=0,this._zeroSpeedChunkCount=0,this._xhr=null,this._speedSampler=new u,this._requestAbort=!1,this._waitForTotalLength=!1,this._totalLengthReceived=!1,this._currentRequestURL=null,this._currentRedirectedURL=null,this._currentRequestRange=null,this._totalLength=null,this._contentLength=null,this._receivedLength=0,this._lastTimeLoaded=0}destroy(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),super.destroy()}get currentSpeed(){return this._speedSampler.lastSecondKBps}open(e,t){this._dataSource=e,this._range=t,this._status=p.kConnecting;let r=!1;null!=this._dataSource.filesize&&0!==this._dataSource.filesize&&(r=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||r?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))}_openSubRange(){let e=1024*this._currentChunkSizeKB,t=this._range.from+this._receivedLength,r=t+e;null!=this._contentLength&&r-this._range.from>=this._contentLength&&(r=this._range.from+this._contentLength-1),this._currentRequestRange={from:t,to:r},this._internalOpen(this._dataSource,this._currentRequestRange)}_internalOpen(e,t){this._lastTimeLoaded=0;let r=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?r=this._currentRedirectedURL:null!=e.redirectedURL&&(r=e.redirectedURL));let n=this._seekHandler.getConfig(r,t);this._currentRequestURL=n.url;let i=this._xhr=new XMLHttpRequest;if(i.open("GET",n.url,!0),i.responseType="arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onload=this._onLoad.bind(this),i.onerror=this._onXhrError.bind(this),e.withCredentials&&(i.withCredentials=!0),"object"==typeof n.headers){let e=n.headers;for(let t in e)e.hasOwnProperty(t)&&i.setRequestHeader(t,e[t])}if("object"==typeof this._config.headers){let e=this._config.headers;for(let t in e)e.hasOwnProperty(t)&&i.setRequestHeader(t,e[t])}i.send()}abort(){this._requestAbort=!0,this._internalAbort(),this._status=p.kComplete}_internalAbort(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)}_onReadyStateChange(e){let t=e.target;if(2===t.readyState){if(null!=t.responseURL){let e=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&e!==this._currentRedirectedURL&&(this._currentRedirectedURL=e,this._onURLRedirect&&this._onURLRedirect(e))}if(t.status>=200&&t.status<=299){if(this._waitForTotalLength)return;this._status=p.kBuffering}else{if(this._status=p.kError,!this._onError)throw new c("RangeLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(g.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}}}_onProgress(e){if(this._status===p.kError)return;if(null===this._contentLength){let t=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,t=!0;let r=e.total;this._internalAbort(),null!=r&0!==r&&(this._totalLength=r)}if(-1===this._range.to?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,t)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}let t=e.loaded-this._lastTimeLoaded;this._lastTimeLoaded=e.loaded,this._speedSampler.addBytes(t)}_normalizeSpeed(e){let t=this._chunkSizeKBList,r=t.length-1,n=0,i=0,a=r;if(e<t[0])return t[0];for(;i<=a;){if((n=i+Math.floor((a-i)/2))===r||e>=t[n]&&e<t[n+1])return t[n];t[n]<e?i=n+1:a=n-1}}_onLoad(e){if(this._status===p.kError)return;if(this._waitForTotalLength)return void(this._waitForTotalLength=!1);this._lastTimeLoaded=0;let t=this._speedSampler.lastSecondKBps;if(0===t&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(t=this._speedSampler.currentKBps)),0!==t){let e=this._normalizeSpeed(t);this._currentSpeedNormalized!==e&&(this._currentSpeedNormalized=e,this._currentChunkSizeKB=e)}let r=e.target.response,n=this._range.from+this._receivedLength;this._receivedLength+=r.byteLength;let i=!1;null!=this._contentLength&&this._receivedLength<this._contentLength?this._openSubRange():i=!0,this._onDataArrival&&this._onDataArrival(r,n,this._receivedLength),i&&(this._status=p.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}_onXhrError(e){this._status=p.kError;let t=0,r=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(t=g.EARLY_EOF,r={code:-1,msg:"RangeLoader meet Early-Eof"}):(t=g.EXCEPTION,r={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new c(r.msg);this._onError(t,r)}};var S=class extends m{static isSupported(){try{return void 0!==self.WebSocket}catch(e){return!1}}constructor(){super("websocket-loader"),this.TAG="WebSocketLoader",this._needStash=!0,this._ws=null,this._requestAbort=!1,this._receivedLength=0}destroy(){this._ws&&this.abort(),super.destroy()}open(e){try{let t=this._ws=new self.WebSocket(e.url);t.binaryType="arraybuffer",t.onopen=this._onWebSocketOpen.bind(this),t.onclose=this._onWebSocketClose.bind(this),t.onmessage=this._onWebSocketMessage.bind(this),t.onerror=this._onWebSocketError.bind(this),this._status=p.kConnecting}catch(e){this._status=p.kError;let t={code:e.code,msg:e.message};if(!this._onError)throw new c(t.msg);this._onError(g.EXCEPTION,t)}}abort(){let e=this._ws;!e||0!==e.readyState&&1!==e.readyState||(this._requestAbort=!0,e.close()),this._ws=null,this._status=p.kComplete}_onWebSocketOpen(e){this._status=p.kBuffering}_onWebSocketClose(e){!0!==this._requestAbort?(this._status=p.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1}_onWebSocketMessage(e){if(e.data instanceof ArrayBuffer)this._dispatchArrayBuffer(e.data);else if(e.data instanceof Blob){let t=new FileReader;t.onload=()=>{this._dispatchArrayBuffer(t.result)},t.readAsArrayBuffer(e.data)}else{this._status=p.kError;let t={code:-1,msg:"Unsupported WebSocket message type: "+e.data.constructor.name};if(!this._onError)throw new c(t.msg);this._onError(g.EXCEPTION,t)}}_dispatchArrayBuffer(e){let t=e,r=this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,r,this._receivedLength)}_onWebSocketError(e){this._status=p.kError;let t={code:e.code,msg:e.message};if(!this._onError)throw new c(t.msg);this._onError(g.EXCEPTION,t)}};var E=class{constructor(e){this._zeroStart=e||!1}getConfig(e,t){let r={};if(0!==t.from||-1!==t.to){let e;e=-1!==t.to?`bytes=${t.from.toString()}-${t.to.toString()}`:`bytes=${t.from.toString()}-`,r.Range=e}else this._zeroStart&&(r.Range="bytes=0-");return{url:e,headers:r}}removeURLParameters(e){return e}};var x=class{constructor(e,t){this._startName=e,this._endName=t}getConfig(e,t){let r=e;if(0!==t.from||-1!==t.to){let e=!0;-1===r.indexOf("?")&&(r+="?",e=!1),e&&(r+="&"),r+=`${this._startName}=${t.from.toString()}`,-1!==t.to&&(r+=`&${this._endName}=${t.to.toString()}`)}return{url:r,headers:{}}}removeURLParameters(e){let t=e.split("?")[0],r=void 0,n=e.indexOf("?");-1!==n&&(r=e.substring(n+1));let i="";if(null!=r&&r.length>0){let e=r.split("&");for(let t=0;t<e.length;t++){let r=e[t].split("="),n=t>0;r[0]!==this._startName&&r[0]!==this._endName&&(n&&(i+="&"),i+=e[t])}}return 0===i.length?t:t+"?"+i}};var T=class{constructor(e,t,r){this.TAG="IOController",this._config=t,this._extraData=r,this._stashInitialSize=393216,null!=t.stashInitialSize&&t.stashInitialSize>0&&(this._stashInitialSize=t.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,!1===t.enableStashBuffer&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new u,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}destroy(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null}isWorking(){return this._loader&&this._loader.isWorking()&&!this._paused}isPaused(){return this._paused}get status(){return this._loader.status}get extraData(){return this._extraData}set extraData(e){this._extraData=e}get onDataArrival(){return this._onDataArrival}set onDataArrival(e){this._onDataArrival=e}get onSeeked(){return this._onSeeked}set onSeeked(e){this._onSeeked=e}get onError(){return this._onError}set onError(e){this._onError=e}get onComplete(){return this._onComplete}set onComplete(e){this._onComplete=e}get onRedirect(){return this._onRedirect}set onRedirect(e){this._onRedirect=e}get onRecoveredEarlyEof(){return this._onRecoveredEarlyEof}set onRecoveredEarlyEof(e){this._onRecoveredEarlyEof=e}get currentURL(){return this._dataSource.url}get hasRedirect(){return null!=this._redirectedURL||null!=this._dataSource.redirectedURL}get currentRedirectedURL(){return this._redirectedURL||this._dataSource.redirectedURL}get currentSpeed(){return this._loaderClass===w?this._loader.currentSpeed:this._speedSampler.lastSecondKBps}get loaderType(){return this._loader.type}_selectSeekHandler(){let e=this._config;if("range"===e.seekType)this._seekHandler=new E(this._config.rangeLoadZeroStart);else if("param"===e.seekType){let t=e.seekParamStart||"bstart",r=e.seekParamEnd||"bend";this._seekHandler=new x(t,r)}else{if("custom"!==e.seekType)throw new h(`Invalid seekType in config: ${e.seekType}`);if("function"!=typeof e.customSeekHandler)throw new h("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}}_selectLoader(){if(null!=this._config.customLoader)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=S;else if(y.isSupported())this._loaderClass=y;else if(b.isSupported())this._loaderClass=b;else{if(!w.isSupported())throw new c("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=w}}_createLoader(){this._loader=new this._loaderClass(this._seekHandler,this._config),!1===this._loader.needStashBuffer&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)}open(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))}abort(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)}pause(){this.isWorking()&&(this._loader.abort(),0!==this._stashUsed?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)}resume(){if(this._paused){this._paused=!1;let e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}}seek(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)}_internalSeek(e,t){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(t),this._loader.destroy(),this._loader=null;let r={from:e,to:-1};this._currentRange={from:r.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,r),this._onSeeked&&this._onSeeked()}updateUrl(e){if(!e||"string"!=typeof e||0===e.length)throw new h("Url must be a non-empty string!");this._dataSource.url=e}_expandBuffer(e){let t=this._stashSize;for(;t+1048576<e;)t*=2;if((t+=1048576)===this._bufferSize)return;let r=new ArrayBuffer(t);if(this._stashUsed>0){let e=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(r,0,t).set(e,0)}this._stashBuffer=r,this._bufferSize=t}_normalizeSpeed(e){let t=this._speedNormalizeList,r=t.length-1,n=0,i=0,a=r;if(e<t[0])return t[0];for(;i<=a;){if((n=i+Math.floor((a-i)/2))===r||e>=t[n]&&e<t[n+1])return t[n];t[n]<e?i=n+1:a=n-1}}_adjustStashSize(e){let t=0;(t=this._config.isLive?e:e<512?e:e>=512&&e<=1024?Math.floor(1.5*e):2*e)>8192&&(t=8192);let r=1024*t+1048576;this._bufferSize<r&&this._expandBuffer(r),this._stashSize=1024*t}_dispatchChunks(e,t){return this._currentRange.to=t+e.byteLength-1,this._onDataArrival(e,t)}_onURLRedirect(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)}_onContentLengthKnown(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)}_onLoaderChunkArrival(e,t,r){if(!this._onDataArrival)throw new d("IOController: No existing consumer (onDataArrival) callback!");if(this._paused)return;this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);let n=this._speedSampler.lastSecondKBps;if(0!==n){let e=this._normalizeSpeed(n);this._speedNormalized!==e&&(this._speedNormalized=e,this._adjustStashSize(e))}if(this._enableStash)if(0===this._stashUsed&&0===this._stashByteStart&&(this._stashByteStart=t),this._stashUsed+e.byteLength<=this._stashSize){new Uint8Array(this._stashBuffer,0,this._stashSize).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{let r=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){let t=this._stashBuffer.slice(0,this._stashUsed),n=this._dispatchChunks(t,this._stashByteStart);if(n<t.byteLength){if(n>0){let e=new Uint8Array(t,n);r.set(e,0),this._stashUsed=e.byteLength,this._stashByteStart+=n}}else this._stashUsed=0,this._stashByteStart+=n;this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),r=new Uint8Array(this._stashBuffer,0,this._bufferSize)),r.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{let n=this._dispatchChunks(e,t);if(n<e.byteLength){let i=e.byteLength-n;i>this._bufferSize&&(this._expandBuffer(i),r=new Uint8Array(this._stashBuffer,0,this._bufferSize)),r.set(new Uint8Array(e,n),0),this._stashUsed+=i,this._stashByteStart=t+n}}}else if(0===this._stashUsed){let r=this._dispatchChunks(e,t);if(r<e.byteLength){let n=e.byteLength-r;n>this._bufferSize&&this._expandBuffer(n),new Uint8Array(this._stashBuffer,0,this._bufferSize).set(new Uint8Array(e,r),0),this._stashUsed+=n,this._stashByteStart=t+r}}else{this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength);let t=new Uint8Array(this._stashBuffer,0,this._bufferSize);t.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;let r=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(r<this._stashUsed&&r>0){let e=new Uint8Array(this._stashBuffer,r);t.set(e,0)}this._stashUsed-=r,this._stashByteStart+=r}}_flushStashBuffer(e){if(this._stashUsed>0){let t=this._stashBuffer.slice(0,this._stashUsed),r=this._dispatchChunks(t,this._stashByteStart),n=t.byteLength-r;if(r<t.byteLength){if(!e){if(r>0){let e=new Uint8Array(this._stashBuffer,0,this._bufferSize),n=new Uint8Array(t,r);e.set(n,0),this._stashUsed=n.byteLength,this._stashByteStart+=r}return 0}l.w(this.TAG,`${n} bytes unconsumed data remain when flush buffer, dropped`)}return this._stashUsed=0,this._stashByteStart=0,n}return 0}_onLoaderComplete(e,t){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)}_onLoaderError(e,t){switch(l.e(this.TAG,`Loader error, code = ${t.code}, msg = ${t.msg}`),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=g.UNRECOVERABLE_EARLY_EOF),e){case g.EARLY_EOF:if(!this._config.isLive&&this._totalLength){let e=this._currentRange.to+1;return void(e<this._totalLength&&(l.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(e,!1)))}e=g.UNRECOVERABLE_EARLY_EOF;break;case g.UNRECOVERABLE_EARLY_EOF:case g.CONNECTING_TIMEOUT:case g.HTTP_STATUS_CODE_INVALID:case g.EXCEPTION:}if(!this._onError)throw new c("IOException: "+t.msg);this._onError(e,t)}};const k={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function A(){return Object.assign({},k)}class C{static supportMSEH264Playback(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}static supportNetworkStreamIO(){let e=new T({},A()),t=e.loaderType;return e.destroy(),"fetch-stream-loader"==t||"xhr-moz-chunked-loader"==t}static getNetworkLoaderTypeName(){let e=new T({},A()),t=e.loaderType;return e.destroy(),t}static supportNativeMediaPlayback(e){null==C.videoElement&&(C.videoElement=window.document.createElement("video"));let t=C.videoElement.canPlayType(e);return"probably"===t||"maybe"==t}static getFeatureList(){let e={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return e.mseFlvPlayback=C.supportMSEH264Playback(),e.networkStreamIO=C.supportNetworkStreamIO(),e.networkLoaderName=C.getNetworkLoaderTypeName(),e.mseLiveFlvPlayback=e.mseFlvPlayback&&e.networkStreamIO,e.nativeMP4H264Playback=C.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),e.nativeWebmVP8Playback=C.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),e.nativeWebmVP9Playback=C.supportNativeMediaPlayback('video/webm; codecs="vp9"'),e}}var j=C;var D={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};class R{static get forceGlobalTag(){return l.FORCE_GLOBAL_TAG}static set forceGlobalTag(e){l.FORCE_GLOBAL_TAG=e,R._notifyChange()}static get globalTag(){return l.GLOBAL_TAG}static set globalTag(e){l.GLOBAL_TAG=e,R._notifyChange()}static get enableAll(){return l.ENABLE_VERBOSE&&l.ENABLE_DEBUG&&l.ENABLE_INFO&&l.ENABLE_WARN&&l.ENABLE_ERROR}static set enableAll(e){l.ENABLE_VERBOSE=e,l.ENABLE_DEBUG=e,l.ENABLE_INFO=e,l.ENABLE_WARN=e,l.ENABLE_ERROR=e,R._notifyChange()}static get enableDebug(){return l.ENABLE_DEBUG}static set enableDebug(e){l.ENABLE_DEBUG=e,R._notifyChange()}static get enableVerbose(){return l.ENABLE_VERBOSE}static set enableVerbose(e){l.ENABLE_VERBOSE=e,R._notifyChange()}static get enableInfo(){return l.ENABLE_INFO}static set enableInfo(e){l.ENABLE_INFO=e,R._notifyChange()}static get enableWarn(){return l.ENABLE_WARN}static set enableWarn(e){l.ENABLE_WARN=e,R._notifyChange()}static get enableError(){return l.ENABLE_ERROR}static set enableError(e){l.ENABLE_ERROR=e,R._notifyChange()}static getConfig(){return{globalTag:l.GLOBAL_TAG,forceGlobalTag:l.FORCE_GLOBAL_TAG,enableVerbose:l.ENABLE_VERBOSE,enableDebug:l.ENABLE_DEBUG,enableInfo:l.ENABLE_INFO,enableWarn:l.ENABLE_WARN,enableError:l.ENABLE_ERROR,enableCallback:l.ENABLE_CALLBACK}}static applyConfig(e){l.GLOBAL_TAG=e.globalTag,l.FORCE_GLOBAL_TAG=e.forceGlobalTag,l.ENABLE_VERBOSE=e.enableVerbose,l.ENABLE_DEBUG=e.enableDebug,l.ENABLE_INFO=e.enableInfo,l.ENABLE_WARN=e.enableWarn,l.ENABLE_ERROR=e.enableError,l.ENABLE_CALLBACK=e.enableCallback}static _notifyChange(){let e=R.emitter;if(e.listenerCount("change")>0){let t=R.getConfig();e.emit("change",t)}}static registerListener(e){R.emitter.addListener("change",e)}static removeListener(e){R.emitter.removeListener("change",e)}static addLogListener(e){l.emitter.addListener("log",e),l.emitter.listenerCount("log")>0&&(l.ENABLE_CALLBACK=!0,R._notifyChange())}static removeLogListener(e){l.emitter.removeListener("log",e),0===l.emitter.listenerCount("log")&&(l.ENABLE_CALLBACK=!1,R._notifyChange())}}R.emitter=new s.a;var L=R;var I=class{constructor(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}isComplete(){let e=!1===this.hasAudio||!0===this.hasAudio&&null!=this.audioCodec&&null!=this.audioSampleRate&&null!=this.audioChannelCount,t=!1===this.hasVideo||!0===this.hasVideo&&null!=this.videoCodec&&null!=this.width&&null!=this.height&&null!=this.fps&&null!=this.profile&&null!=this.level&&null!=this.refFrames&&null!=this.chromaFormat&&null!=this.sarNum&&null!=this.sarDen;return null!=this.mimeType&&null!=this.duration&&null!=this.metadata&&null!=this.hasKeyframesIndex&&e&&t}isSeekable(){return!0===this.hasKeyframesIndex}getNearestKeyframe(e){if(null==this.keyframesIndex)return null;let t=this.keyframesIndex,r=this._search(t.times,e);return{index:r,milliseconds:t.times[r],fileposition:t.filepositions[r]}}_search(e,t){let r=0,n=e.length-1,i=0,a=0,s=n;for(t<e[0]&&(r=0,a=s+1);a<=s;){if((i=a+Math.floor((s-a)/2))===n||t>=e[i]&&t<e[i+1]){r=i;break}e[i]<t?a=i+1:s=i-1}return r}};function O(e,t,r){let n=e;if(t+r<n.length){for(;r--;)if(128!=(192&n[++t]))return!1;return!0}return!1}var P=function(e){let t=[],r=e,n=0,i=e.length;for(;n<i;)if(r[n]<128)t.push(String.fromCharCode(r[n])),++n;else{if(r[n]<192);else if(r[n]<224){if(O(r,n,1)){let e=(31&r[n])<<6|63&r[n+1];if(e>=128){t.push(String.fromCharCode(65535&e)),n+=2;continue}}}else if(r[n]<240){if(O(r,n,2)){let e=(15&r[n])<<12|(63&r[n+1])<<6|63&r[n+2];if(e>=2048&&55296!=(63488&e)){t.push(String.fromCharCode(65535&e)),n+=3;continue}}}else if(r[n]<248&&O(r,n,3)){let e=(7&r[n])<<18|(63&r[n+1])<<12|(63&r[n+2])<<6|63&r[n+3];if(e>65536&&e<1114112){e-=65536,t.push(String.fromCharCode(e>>>10|55296)),t.push(String.fromCharCode(1023&e|56320)),n+=4;continue}}t.push(String.fromCharCode(65533)),++n}return t.join("")};let M=function(){let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}();class N{static parseScriptData(e,t,r){let n={};try{let i=N.parseValue(e,t,r),a=N.parseValue(e,t+i.size,r-i.size);n[i.data]=a.data}catch(e){l.e("AMF",e.toString())}return n}static parseObject(e,t,r){if(r<3)throw new d("Data not enough when parse ScriptDataObject");let n=N.parseString(e,t,r),i=N.parseValue(e,t+n.size,r-n.size),a=i.objectEnd;return{data:{name:n.data,value:i.data},size:n.size+i.size,objectEnd:a}}static parseVariable(e,t,r){return N.parseObject(e,t,r)}static parseString(e,t,r){if(r<2)throw new d("Data not enough when parse String");let n,i=new DataView(e,t,r).getUint16(0,!M);return{data:n=i>0?P(new Uint8Array(e,t+2,i)):"",size:2+i}}static parseLongString(e,t,r){if(r<4)throw new d("Data not enough when parse LongString");let n,i=new DataView(e,t,r).getUint32(0,!M);return{data:n=i>0?P(new Uint8Array(e,t+4,i)):"",size:4+i}}static parseDate(e,t,r){if(r<10)throw new d("Data size invalid when parse Date");let n=new DataView(e,t,r),i=n.getFloat64(0,!M),a=n.getInt16(8,!M);return{data:new Date(i+=60*a*1e3),size:10}}static parseValue(e,t,r){if(r<1)throw new d("Data not enough when parse Value");let n,i=new DataView(e,t,r),a=1,s=i.getUint8(0),o=!1;try{switch(s){case 0:n=i.getFloat64(1,!M),a+=8;break;case 1:n=!!i.getUint8(1),a+=1;break;case 2:{let i=N.parseString(e,t+1,r-1);n=i.data,a+=i.size;break}case 3:{n={};let s=0;for(9==(16777215&i.getUint32(r-4,!M))&&(s=3);a<r-4;){let i=N.parseObject(e,t+a,r-a-s);if(i.objectEnd)break;n[i.data.name]=i.data.value,a+=i.size}if(a<=r-3){9===(16777215&i.getUint32(a-1,!M))&&(a+=3)}break}case 8:{n={},a+=4;let s=0;for(9==(16777215&i.getUint32(r-4,!M))&&(s=3);a<r-8;){let i=N.parseVariable(e,t+a,r-a-s);if(i.objectEnd)break;n[i.data.name]=i.data.value,a+=i.size}if(a<=r-3){9===(16777215&i.getUint32(a-1,!M))&&(a+=3)}break}case 9:n=void 0,a=1,o=!0;break;case 10:{n=[];let s=i.getUint32(1,!M);a+=4;for(let i=0;i<s;i++){let i=N.parseValue(e,t+a,r-a);n.push(i.data),a+=i.size}break}case 11:{let i=N.parseDate(e,t+1,r-1);n=i.data,a+=i.size;break}case 12:{let i=N.parseString(e,t+1,r-1);n=i.data,a+=i.size;break}default:a=r,l.w("AMF","Unsupported AMF value type "+s)}}catch(e){l.e("AMF",e.toString())}return{data:n,size:a,objectEnd:o}}}var F=N;var B=class{constructor(e){this.TAG="ExpGolomb",this._buffer=e,this._buffer_index=0,this._total_bytes=e.byteLength,this._total_bits=8*e.byteLength,this._current_word=0,this._current_word_bits_left=0}destroy(){this._buffer=null}_fillCurrentWord(){let e=this._total_bytes-this._buffer_index;if(e<=0)throw new d("ExpGolomb: _fillCurrentWord() but no bytes available");let t=Math.min(4,e),r=new Uint8Array(4);r.set(this._buffer.subarray(this._buffer_index,this._buffer_index+t)),this._current_word=new DataView(r.buffer).getUint32(0,!1),this._buffer_index+=t,this._current_word_bits_left=8*t}readBits(e){if(e>32)throw new h("ExpGolomb: readBits() bits exceeded max 32bits!");if(e<=this._current_word_bits_left){let t=this._current_word>>>32-e;return this._current_word<<=e,this._current_word_bits_left-=e,t}let t=this._current_word_bits_left?this._current_word:0;t>>>=32-this._current_word_bits_left;let r=e-this._current_word_bits_left;this._fillCurrentWord();let n=Math.min(r,this._current_word_bits_left),i=this._current_word>>>32-n;return this._current_word<<=n,this._current_word_bits_left-=n,t=t<<n|i}readBool(){return 1===this.readBits(1)}readByte(){return this.readBits(8)}_skipLeadingZero(){let e;for(e=0;e<this._current_word_bits_left;e++)if(0!=(this._current_word&2147483648>>>e))return this._current_word<<=e,this._current_word_bits_left-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()}readUEG(){let e=this._skipLeadingZero();return this.readBits(e+1)-1}readSEG(){let e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)}};class U{static _ebsp2rbsp(e){let t=e,r=t.byteLength,n=new Uint8Array(r),i=0;for(let e=0;e<r;e++)e>=2&&3===t[e]&&0===t[e-1]&&0===t[e-2]||(n[i]=t[e],i++);return new Uint8Array(n.buffer,0,i)}static parseSPS(e){let t=U._ebsp2rbsp(e),r=new B(t);r.readByte();let n=r.readByte();r.readByte();let i=r.readByte();r.readUEG();let a=U.getProfileString(n),s=U.getLevelString(i),o=1,l=420,u=[0,420,422,444],c=8;if((100===n||110===n||122===n||244===n||44===n||83===n||86===n||118===n||128===n||138===n||144===n)&&(3===(o=r.readUEG())&&r.readBits(1),o<=3&&(l=u[o]),c=r.readUEG()+8,r.readUEG(),r.readBits(1),r.readBool())){let e=3!==o?8:12;for(let t=0;t<e;t++)r.readBool()&&(t<6?U._skipScalingList(r,16):U._skipScalingList(r,64))}r.readUEG();let d=r.readUEG();if(0===d)r.readUEG();else if(1===d){r.readBits(1),r.readSEG(),r.readSEG();let e=r.readUEG();for(let t=0;t<e;t++)r.readSEG()}let h=r.readUEG();r.readBits(1);let f=r.readUEG(),p=r.readUEG(),g=r.readBits(1);0===g&&r.readBits(1),r.readBits(1);let m=0,v=0,_=0,y=0;r.readBool()&&(m=r.readUEG(),v=r.readUEG(),_=r.readUEG(),y=r.readUEG());let b=1,w=1,S=0,E=!0,x=0,T=0;if(r.readBool()){if(r.readBool()){let e=r.readByte(),t=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],n=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];e>0&&e<16?(b=t[e-1],w=n[e-1]):255===e&&(b=r.readByte()<<8|r.readByte(),w=r.readByte()<<8|r.readByte())}if(r.readBool()&&r.readBool(),r.readBool()&&(r.readBits(4),r.readBool()&&r.readBits(24)),r.readBool()&&(r.readUEG(),r.readUEG()),r.readBool()){let e=r.readBits(32),t=r.readBits(32);E=r.readBool(),S=(x=t)/(T=2*e)}}let k=1;1===b&&1===w||(k=b/w);let A=0,C=0;if(0===o)A=1,C=2-g;else{A=3===o?1:2,C=(1===o?2:1)*(2-g)}let j=16*(f+1),D=16*(p+1)*(2-g);j-=(m+v)*A,D-=(_+y)*C;let R=Math.ceil(j*k);return r.destroy(),r=null,{profile_string:a,level_string:s,bit_depth:c,ref_frames:h,chroma_format:l,chroma_format_string:U.getChromaFormatString(l),frame_rate:{fixed:E,fps:S,fps_den:T,fps_num:x},sar_ratio:{width:b,height:w},codec_size:{width:j,height:D},present_size:{width:R,height:D}}}static _skipScalingList(e,t){let r=8,n=8,i=0;for(let a=0;a<t;a++)0!==n&&(n=(r+(i=e.readSEG())+256)%256),r=0===n?r:n}static getProfileString(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}}static getLevelString(e){return(e/10).toFixed(1)}static getChromaFormatString(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}}}var G=U;var z={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};class H{constructor(e,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=e.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=e.hasAudioTrack,this._hasVideo=e.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new I,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}()}destroy(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null}static probe(e){let t=new Uint8Array(e),r={match:!1};if(70!==t[0]||76!==t[1]||86!==t[2]||1!==t[3])return r;let n=(4&t[4])>>>2!=0,i=0!=(1&t[4]),a=(s=t)[o=5]<<24|s[o+1]<<16|s[o+2]<<8|s[o+3];var s,o;return a<9?r:{match:!0,consumed:a,dataOffset:a,hasAudioTrack:n,hasVideoTrack:i}}bindDataSource(e){return e.onDataArrival=this.parseChunks.bind(this),this}get onTrackMetadata(){return this._onTrackMetadata}set onTrackMetadata(e){this._onTrackMetadata=e}get onMediaInfo(){return this._onMediaInfo}set onMediaInfo(e){this._onMediaInfo=e}get onMetaDataArrived(){return this._onMetaDataArrived}set onMetaDataArrived(e){this._onMetaDataArrived=e}get onScriptDataArrived(){return this._onScriptDataArrived}set onScriptDataArrived(e){this._onScriptDataArrived=e}get onError(){return this._onError}set onError(e){this._onError=e}get onDataAvailable(){return this._onDataAvailable}set onDataAvailable(e){this._onDataAvailable=e}get timestampBase(){return this._timestampBase}set timestampBase(e){this._timestampBase=e}get overridedDuration(){return this._duration}set overridedDuration(e){this._durationOverrided=!0,this._duration=e,this._mediaInfo.duration=e}set overridedHasAudio(e){this._hasAudioFlagOverrided=!0,this._hasAudio=e,this._mediaInfo.hasAudio=e}set overridedHasVideo(e){this._hasVideoFlagOverrided=!0,this._hasVideo=e,this._mediaInfo.hasVideo=e}resetMediaInfo(){this._mediaInfo=new I}_isInitialMetadataDispatched(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched}parseChunks(e,t){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new d("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");let r=0,n=this._littleEndian;if(0===t){if(!(e.byteLength>13))return 0;r=H.probe(e).dataOffset}if(this._firstParse){this._firstParse=!1,t+r!==this._dataOffset&&l.w(this.TAG,"First time parsing but chunk byteStart invalid!"),0!==new DataView(e,r).getUint32(0,!n)&&l.w(this.TAG,"PrevTagSize0 !== 0 !!!"),r+=4}for(;r<e.byteLength;){this._dispatch=!0;let i=new DataView(e,r);if(r+11+4>e.byteLength)break;let a=i.getUint8(0),s=16777215&i.getUint32(0,!n);if(r+11+s+4>e.byteLength)break;if(8!==a&&9!==a&&18!==a){l.w(this.TAG,`Unsupported tag type ${a}, skipped`),r+=11+s+4;continue}let o=i.getUint8(4),u=i.getUint8(5),c=i.getUint8(6)|u<<8|o<<16|i.getUint8(7)<<24;0!==(16777215&i.getUint32(7,!n))&&l.w(this.TAG,"Meet tag which has StreamID != 0!");let d=r+11;switch(a){case 8:this._parseAudioData(e,d,s,c);break;case 9:this._parseVideoData(e,d,s,c,t+r);break;case 18:this._parseScriptData(e,d,s)}let h=i.getUint32(11+s,!n);h!==11+s&&l.w(this.TAG,`Invalid PrevTagSize ${h}`),r+=11+s+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),r}_parseScriptData(e,t,r){let n=F.parseScriptData(e,t,r);if(n.hasOwnProperty("onMetaData")){if(null==n.onMetaData||"object"!=typeof n.onMetaData)return void l.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&l.w(this.TAG,"Found another onMetaData tag!"),this._metadata=n;let e=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},e)),"boolean"==typeof e.hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=e.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),"boolean"==typeof e.hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=e.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),"number"==typeof e.audiodatarate&&(this._mediaInfo.audioDataRate=e.audiodatarate),"number"==typeof e.videodatarate&&(this._mediaInfo.videoDataRate=e.videodatarate),"number"==typeof e.width&&(this._mediaInfo.width=e.width),"number"==typeof e.height&&(this._mediaInfo.height=e.height),"number"==typeof e.duration){if(!this._durationOverrided){let t=Math.floor(e.duration*this._timescale);this._duration=t,this._mediaInfo.duration=t}}else this._mediaInfo.duration=0;if("number"==typeof e.framerate){let t=Math.floor(1e3*e.framerate);if(t>0){let e=t/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=e,this._referenceFrameRate.fps_num=t,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=e}}if("object"==typeof e.keyframes){this._mediaInfo.hasKeyframesIndex=!0;let t=e.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(t),e.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=e,l.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(n).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},n))}_parseKeyframesIndex(e){let t=[],r=[];for(let n=1;n<e.times.length;n++){let i=this._timestampBase+Math.floor(1e3*e.times[n]);t.push(i),r.push(e.filepositions[n])}return{times:t,filepositions:r}}_parseAudioData(e,t,r,n){if(r<=1)return void l.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");if(!0===this._hasAudioFlagOverrided&&!1===this._hasAudio)return;this._littleEndian;let i=new DataView(e,t,r).getUint8(0),a=i>>>4;if(2!==a&&10!==a)return void this._onError(z.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+a);let s=0,o=(12&i)>>>2;if(!(o>=0&&o<=4))return void this._onError(z.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+o);s=this._flvSoundRateTable[o];let u=1&i,c=this._audioMetadata,d=this._audioTrack;if(c||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(c=this._audioMetadata={}).type="audio",c.id=d.id,c.timescale=this._timescale,c.duration=this._duration,c.audioSampleRate=s,c.channelCount=0===u?1:2),10===a){let i=this._parseAACAudioData(e,t+1,r-1);if(null==i)return;if(0===i.packetType){c.config&&l.w(this.TAG,"Found another AudioSpecificConfig!");let e=i.data;c.audioSampleRate=e.samplingRate,c.channelCount=e.channelCount,c.codec=e.codec,c.originalCodec=e.originalCodec,c.config=e.config,c.refSampleDuration=1024/c.audioSampleRate*c.timescale,l.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",c);let t=this._mediaInfo;t.audioCodec=c.originalCodec,t.audioSampleRate=c.audioSampleRate,t.audioChannelCount=c.channelCount,t.hasVideo?null!=t.videoCodec&&(t.mimeType='video/x-flv; codecs="'+t.videoCodec+","+t.audioCodec+'"'):t.mimeType='video/x-flv; codecs="'+t.audioCodec+'"',t.isComplete()&&this._onMediaInfo(t)}else if(1===i.packetType){let e=this._timestampBase+n,t={unit:i.data,length:i.data.byteLength,dts:e,pts:e};d.samples.push(t),d.length+=i.data.length}else l.e(this.TAG,`Flv: Unsupported AAC data type ${i.packetType}`)}else if(2===a){if(!c.codec){let n=this._parseMP3AudioData(e,t+1,r-1,!0);if(null==n)return;c.audioSampleRate=n.samplingRate,c.channelCount=n.channelCount,c.codec=n.codec,c.originalCodec=n.originalCodec,c.refSampleDuration=1152/c.audioSampleRate*c.timescale,l.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",c);let i=this._mediaInfo;i.audioCodec=c.codec,i.audioSampleRate=c.audioSampleRate,i.audioChannelCount=c.channelCount,i.audioDataRate=n.bitRate,i.hasVideo?null!=i.videoCodec&&(i.mimeType='video/x-flv; codecs="'+i.videoCodec+","+i.audioCodec+'"'):i.mimeType='video/x-flv; codecs="'+i.audioCodec+'"',i.isComplete()&&this._onMediaInfo(i)}let i=this._parseMP3AudioData(e,t+1,r-1,!1);if(null==i)return;let a=this._timestampBase+n,s={unit:i,length:i.byteLength,dts:a,pts:a};d.samples.push(s),d.length+=i.length}}_parseAACAudioData(e,t,r){if(r<=1)return void l.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");let n={},i=new Uint8Array(e,t,r);return n.packetType=i[0],0===i[0]?n.data=this._parseAACAudioSpecificConfig(e,t+1,r-1):n.data=i.subarray(1),n}_parseAACAudioSpecificConfig(e,t,r){let n=new Uint8Array(e,t,r),i=null,a=0,s=0,o=null,l=0,u=null;if(a=s=n[0]>>>3,(l=(7&n[0])<<1|n[1]>>>7)<0||l>=this._mpegSamplingRates.length)return void this._onError(z.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");let c=this._mpegSamplingRates[l],d=(120&n[1])>>>3;if(d<0||d>=8)return void this._onError(z.FORMAT_ERROR,"Flv: AAC invalid channel configuration");5===a&&(u=(7&n[1])<<1|n[2]>>>7,o=(124&n[2])>>>2);let h=self.navigator.userAgent.toLowerCase();return-1!==h.indexOf("firefox")?l>=6?(a=5,i=new Array(4),u=l-3):(a=2,i=new Array(2),u=l):-1!==h.indexOf("android")?(a=2,i=new Array(2),u=l):(a=5,u=l,i=new Array(4),l>=6?u=l-3:1===d&&(a=2,i=new Array(2),u=l)),i[0]=a<<3,i[0]|=(15&l)>>>1,i[1]=(15&l)<<7,i[1]|=(15&d)<<3,5===a&&(i[1]|=(15&u)>>>1,i[2]=(1&u)<<7,i[2]|=8,i[3]=0),{config:i,samplingRate:c,channelCount:d,codec:"mp4a.40."+a,originalCodec:"mp4a.40."+s}}_parseMP3AudioData(e,t,r,n){if(r<4)return void l.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");this._littleEndian;let i=new Uint8Array(e,t,r),a=null;if(n){if(255!==i[0])return;let e=i[1]>>>3&3,t=(6&i[1])>>1,r=(240&i[2])>>>4,n=(12&i[2])>>>2,s=3!==(i[3]>>>6&3)?2:1,o=0,l=0,u=34,c="mp3";switch(e){case 0:o=this._mpegAudioV25SampleRateTable[n];break;case 2:o=this._mpegAudioV20SampleRateTable[n];break;case 3:o=this._mpegAudioV10SampleRateTable[n]}switch(t){case 1:u=34,r<this._mpegAudioL3BitRateTable.length&&(l=this._mpegAudioL3BitRateTable[r]);break;case 2:u=33,r<this._mpegAudioL2BitRateTable.length&&(l=this._mpegAudioL2BitRateTable[r]);break;case 3:u=32,r<this._mpegAudioL1BitRateTable.length&&(l=this._mpegAudioL1BitRateTable[r])}a={bitRate:l,samplingRate:o,channelCount:s,codec:c,originalCodec:c}}else a=i;return a}_parseVideoData(e,t,r,n,i){if(r<=1)return void l.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");if(!0===this._hasVideoFlagOverrided&&!1===this._hasVideo)return;let a=new Uint8Array(e,t,r)[0],s=(240&a)>>>4,o=15&a;7===o?this._parseAVCVideoPacket(e,t+1,r-1,n,i,s):this._onError(z.CODEC_UNSUPPORTED,`Flv: Unsupported codec in video frame: ${o}`)}_parseAVCVideoPacket(e,t,r,n,i,a){if(r<4)return void l.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");let s=this._littleEndian,o=new DataView(e,t,r),u=o.getUint8(0),c=(16777215&o.getUint32(0,!s))<<8>>8;if(0===u)this._parseAVCDecoderConfigurationRecord(e,t+4,r-4);else if(1===u)this._parseAVCVideoData(e,t+4,r-4,n,i,a,c);else if(2!==u)return void this._onError(z.FORMAT_ERROR,`Flv: Invalid video packet type ${u}`)}_parseAVCDecoderConfigurationRecord(e,t,r){if(r<7)return void l.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");let n=this._videoMetadata,i=this._videoTrack,a=this._littleEndian,s=new DataView(e,t,r);n?void 0!==n.avcc&&l.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(n=this._videoMetadata={}).type="video",n.id=i.id,n.timescale=this._timescale,n.duration=this._duration);let o=s.getUint8(0),u=s.getUint8(1);s.getUint8(2),s.getUint8(3);if(1!==o||0===u)return void this._onError(z.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");if(this._naluLengthSize=1+(3&s.getUint8(4)),3!==this._naluLengthSize&&4!==this._naluLengthSize)return void this._onError(z.FORMAT_ERROR,`Flv: Strange NaluLengthSizeMinusOne: ${this._naluLengthSize-1}`);let c=31&s.getUint8(5);if(0===c)return void this._onError(z.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");c>1&&l.w(this.TAG,`Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ${c}`);let d=6;for(let r=0;r<c;r++){let i=s.getUint16(d,!a);if(d+=2,0===i)continue;let o=new Uint8Array(e,t+d,i);d+=i;let l=G.parseSPS(o);if(0!==r)continue;n.codecWidth=l.codec_size.width,n.codecHeight=l.codec_size.height,n.presentWidth=l.present_size.width,n.presentHeight=l.present_size.height,n.profile=l.profile_string,n.level=l.level_string,n.bitDepth=l.bit_depth,n.chromaFormat=l.chroma_format,n.sarRatio=l.sar_ratio,n.frameRate=l.frame_rate,!1!==l.frame_rate.fixed&&0!==l.frame_rate.fps_num&&0!==l.frame_rate.fps_den||(n.frameRate=this._referenceFrameRate);let u=n.frameRate.fps_den,c=n.frameRate.fps_num;n.refSampleDuration=n.timescale*(u/c);let h=o.subarray(1,4),f="avc1.";for(let e=0;e<3;e++){let t=h[e].toString(16);t.length<2&&(t="0"+t),f+=t}n.codec=f;let p=this._mediaInfo;p.width=n.codecWidth,p.height=n.codecHeight,p.fps=n.frameRate.fps,p.profile=n.profile,p.level=n.level,p.refFrames=l.ref_frames,p.chromaFormat=l.chroma_format_string,p.sarNum=n.sarRatio.width,p.sarDen=n.sarRatio.height,p.videoCodec=f,p.hasAudio?null!=p.audioCodec&&(p.mimeType='video/x-flv; codecs="'+p.videoCodec+","+p.audioCodec+'"'):p.mimeType='video/x-flv; codecs="'+p.videoCodec+'"',p.isComplete()&&this._onMediaInfo(p)}let h=s.getUint8(d);if(0!==h){h>1&&l.w(this.TAG,`Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ${h}`),d++;for(let e=0;e<h;e++){let e=s.getUint16(d,!a);d+=2,0!==e&&(d+=e)}n.avcc=new Uint8Array(r),n.avcc.set(new Uint8Array(e,t,r),0),l.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",n)}else this._onError(z.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}_parseAVCVideoData(e,t,r,n,i,a,s){let o=this._littleEndian,u=new DataView(e,t,r),c=[],d=0,h=0;const f=this._naluLengthSize;let p=this._timestampBase+n,g=1===a;for(;h<r;){if(h+4>=r){l.w(this.TAG,`Malformed Nalu near timestamp ${p}, offset = ${h}, dataSize = ${r}`);break}let n=u.getUint32(h,!o);if(3===f&&(n>>>=8),n>r-f)return void l.w(this.TAG,`Malformed Nalus near timestamp ${p}, NaluSize > DataSize!`);let i=31&u.getUint8(h+f);5===i&&(g=!0);let a=new Uint8Array(e,t+h,f+n),s={type:i,data:a};c.push(s),d+=a.byteLength,h+=f+n}if(c.length){let e=this._videoTrack,t={units:c,length:d,isKeyframe:g,dts:p,cts:s,pts:p+s};g&&(t.fileposition=i),e.samples.push(t),e.length+=d}}}var V=H;class K{static init(){K.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(let e in K.types)K.types.hasOwnProperty(e)&&(K.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);let e=K.constants={};e.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),e.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),e.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSC=e.STCO=e.STTS,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),e.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),e.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}static box(e){let t=8,r=null,n=Array.prototype.slice.call(arguments,1),i=n.length;for(let e=0;e<i;e++)t+=n[e].byteLength;(r=new Uint8Array(t))[0]=t>>>24&255,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r.set(e,4);let a=8;for(let e=0;e<i;e++)r.set(n[e],a),a+=n[e].byteLength;return r}static generateInitSegment(e){let t=K.box(K.types.ftyp,K.constants.FTYP),r=K.moov(e),n=new Uint8Array(t.byteLength+r.byteLength);return n.set(t,0),n.set(r,t.byteLength),n}static moov(e){let t=K.mvhd(e.timescale,e.duration),r=K.trak(e),n=K.mvex(e);return K.box(K.types.moov,t,r,n)}static mvhd(e,t){return K.box(K.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}static trak(e){return K.box(K.types.trak,K.tkhd(e),K.mdia(e))}static tkhd(e){let t=e.id,r=e.duration,n=e.presentWidth,i=e.presentHeight;return K.box(K.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>>8&255,255&n,0,0,i>>>8&255,255&i,0,0]))}static mdia(e){return K.box(K.types.mdia,K.mdhd(e),K.hdlr(e),K.minf(e))}static mdhd(e){let t=e.timescale,r=e.duration;return K.box(K.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,r>>>24&255,r>>>16&255,r>>>8&255,255&r,85,196,0,0]))}static hdlr(e){let t=null;return t="audio"===e.type?K.constants.HDLR_AUDIO:K.constants.HDLR_VIDEO,K.box(K.types.hdlr,t)}static minf(e){let t=null;return t="audio"===e.type?K.box(K.types.smhd,K.constants.SMHD):K.box(K.types.vmhd,K.constants.VMHD),K.box(K.types.minf,t,K.dinf(),K.stbl(e))}static dinf(){return K.box(K.types.dinf,K.box(K.types.dref,K.constants.DREF))}static stbl(e){return K.box(K.types.stbl,K.stsd(e),K.box(K.types.stts,K.constants.STTS),K.box(K.types.stsc,K.constants.STSC),K.box(K.types.stsz,K.constants.STSZ),K.box(K.types.stco,K.constants.STCO))}static stsd(e){return"audio"===e.type?"mp3"===e.codec?K.box(K.types.stsd,K.constants.STSD_PREFIX,K.mp3(e)):K.box(K.types.stsd,K.constants.STSD_PREFIX,K.mp4a(e)):K.box(K.types.stsd,K.constants.STSD_PREFIX,K.avc1(e))}static mp3(e){let t=e.channelCount,r=e.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,r>>>8&255,255&r,0,0]);return K.box(K.types[".mp3"],n)}static mp4a(e){let t=e.channelCount,r=e.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,r>>>8&255,255&r,0,0]);return K.box(K.types.mp4a,n,K.esds(e))}static esds(e){let t=e.config||[],r=t.length,n=new Uint8Array([0,0,0,0,3,23+r,0,1,0,4,15+r,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([r]).concat(t).concat([6,1,2]));return K.box(K.types.esds,n)}static avc1(e){let t=e.avcc,r=e.codecWidth,n=e.codecHeight,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r>>>8&255,255&r,n>>>8&255,255&n,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return K.box(K.types.avc1,i,K.box(K.types.avcC,t))}static mvex(e){return K.box(K.types.mvex,K.trex(e))}static trex(e){let t=e.id,r=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return K.box(K.types.trex,r)}static moof(e,t){return K.box(K.types.moof,K.mfhd(e.sequenceNumber),K.traf(e,t))}static mfhd(e){let t=new Uint8Array([0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e]);return K.box(K.types.mfhd,t)}static traf(e,t){let r=e.id,n=K.box(K.types.tfhd,new Uint8Array([0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r])),i=K.box(K.types.tfdt,new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t])),a=K.sdtp(e),s=K.trun(e,a.byteLength+16+16+8+16+8+8);return K.box(K.types.traf,n,i,s,a)}static sdtp(e){let t=e.samples||[],r=t.length,n=new Uint8Array(4+r);for(let e=0;e<r;e++){let r=t[e].flags;n[e+4]=r.isLeading<<6|r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy}return K.box(K.types.sdtp,n)}static trun(e,t){let r=e.samples||[],n=r.length,i=12+16*n,a=new Uint8Array(i);t+=8+i,a.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0);for(let e=0;e<n;e++){let t=r[e].duration,n=r[e].size,i=r[e].flags,s=r[e].cts;a.set([t>>>24&255,t>>>16&255,t>>>8&255,255&t,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i.isLeading<<2|i.dependsOn,i.isDependedOn<<6|i.hasRedundancy<<4|i.isNonSync,0,0,s>>>24&255,s>>>16&255,s>>>8&255,255&s],12+16*e)}return K.box(K.types.trun,a)}static mdat(e){return K.box(K.types.mdat,e)}}K.init();var W=K;var q=class{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}};class X{constructor(e,t,r,n,i){this.dts=e,this.pts=t,this.duration=r,this.originalDts=n,this.isSyncPoint=i,this.fileposition=null}}class Y{constructor(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}appendSyncPoint(e){e.isSyncPoint=!0,this.syncPoints.push(e)}}class ${constructor(){this._list=[]}clear(){this._list=[]}appendArray(e){let t=this._list;0!==e.length&&(t.length>0&&e[0].originalDts<t[t.length-1].originalDts&&this.clear(),Array.prototype.push.apply(t,e))}getLastSyncPointBeforeDts(e){if(0==this._list.length)return null;let t=this._list,r=0,n=t.length-1,i=0,a=0,s=n;for(e<t[0].dts&&(r=0,a=s+1);a<=s;){if((i=a+Math.floor((s-a)/2))===n||e>=t[i].dts&&e<t[i+1].dts){r=i;break}t[i].dts<e?a=i+1:s=i-1}return this._list[r]}}class J{constructor(e){this._type=e,this._list=[],this._lastAppendLocation=-1}get type(){return this._type}get length(){return this._list.length}isEmpty(){return 0===this._list.length}clear(){this._list=[],this._lastAppendLocation=-1}_searchNearestSegmentBefore(e){let t=this._list;if(0===t.length)return-2;let r=t.length-1,n=0,i=0,a=r,s=0;if(e<t[0].originalBeginDts)return s=-1;for(;i<=a;){if((n=i+Math.floor((a-i)/2))===r||e>t[n].lastSample.originalDts&&e<t[n+1].originalBeginDts){s=n;break}t[n].originalBeginDts<e?i=n+1:a=n-1}return s}_searchNearestSegmentAfter(e){return this._searchNearestSegmentBefore(e)+1}append(e){let t=this._list,r=e,n=this._lastAppendLocation,i=0;-1!==n&&n<t.length&&r.originalBeginDts>=t[n].lastSample.originalDts&&(n===t.length-1||n<t.length-1&&r.originalBeginDts<t[n+1].originalBeginDts)?i=n+1:t.length>0&&(i=this._searchNearestSegmentBefore(r.originalBeginDts)+1),this._lastAppendLocation=i,this._list.splice(i,0,r)}getLastSegmentBefore(e){let t=this._searchNearestSegmentBefore(e);return t>=0?this._list[t]:null}getLastSampleBefore(e){let t=this.getLastSegmentBefore(e);return null!=t?t.lastSample:null}getLastSyncPointBefore(e){let t=this._searchNearestSegmentBefore(e),r=this._list[t].syncPoints;for(;0===r.length&&t>0;)t--,r=this._list[t].syncPoints;return r.length>0?r[r.length-1]:null}}var Q=class{constructor(e){this.TAG="MP4Remuxer",this._config=e,this._isLive=!0===e.isLive,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new J("audio"),this._videoSegmentInfoList=new J("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!_.chrome||!(_.version.major<50||50===_.version.major&&_.version.build<2661)),this._fillSilentAfterSeek=_.msedge||_.msie,this._mp3UseMpegAudio=!_.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}destroy(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null}bindDataSource(e){return e.onDataAvailable=this.remux.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this}get onInitSegment(){return this._onInitSegment}set onInitSegment(e){this._onInitSegment=e}get onMediaSegment(){return this._onMediaSegment}set onMediaSegment(e){this._onMediaSegment=e}insertDiscontinuity(){this._audioNextDts=this._videoNextDts=void 0}seek(e){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()}remux(e,t){if(!this._onMediaSegment)throw new d("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(e,t),this._remuxVideo(t),this._remuxAudio(e)}_onTrackMetadataReceived(e,t){let r=null,n="mp4",i=t.codec;if("audio"===e)this._audioMeta=t,"mp3"===t.codec&&this._mp3UseMpegAudio?(n="mpeg",i="",r=new Uint8Array):r=W.generateInitSegment(t);else{if("video"!==e)return;this._videoMeta=t,r=W.generateInitSegment(t)}if(!this._onInitSegment)throw new d("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(e,{type:e,data:r.buffer,codec:i,container:`${e}/${n}`,mediaDuration:t.duration})}_calculateDtsBase(e,t){this._dtsBaseInited||(e.samples&&e.samples.length&&(this._audioDtsBase=e.samples[0].dts),t.samples&&t.samples.length&&(this._videoDtsBase=t.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)}flushStashedSamples(){let e=this._videoStashedLastSample,t=this._audioStashedLastSample,r={type:"video",id:1,sequenceNumber:0,samples:[],length:0};null!=e&&(r.samples.push(e),r.length=e.length);let n={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};null!=t&&(n.samples.push(t),n.length=t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(r,!0),this._remuxAudio(n,!0)}_remuxAudio(e,t){if(null==this._audioMeta)return;let r=e,n=r.samples,i=void 0,a=-1,s=-1,o=this._audioMeta.refSampleDuration,u="mp3"===this._audioMeta.codec&&this._mp3UseMpegAudio,c=this._dtsBaseInited&&void 0===this._audioNextDts,d=!1;if(!n||0===n.length)return;if(1===n.length&&!t)return;let h=0,f=null,p=0;u?(h=0,p=r.length):(h=8,p=8+r.length);let g=null;if(n.length>1&&(p-=(g=n.pop()).length),null!=this._audioStashedLastSample){let e=this._audioStashedLastSample;this._audioStashedLastSample=null,n.unshift(e),p+=e.length}null!=g&&(this._audioStashedLastSample=g);let m=n[0].dts-this._dtsBase;if(this._audioNextDts)i=m-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())i=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._audioMeta.originalCodec&&(d=!0);else{let e=this._audioSegmentInfoList.getLastSampleBefore(m);if(null!=e){let t=m-(e.originalDts+e.duration);t<=3&&(t=0),i=m-(e.dts+e.duration+t)}else i=0}if(d){let e=m-i,t=this._videoSegmentInfoList.getLastSegmentBefore(m);if(null!=t&&t.beginDts<e){let r=q.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(r){let i=t.beginDts,a=e-t.beginDts;l.v(this.TAG,`InsertPrefixSilentAudio: dts: ${i}, duration: ${a}`),n.unshift({unit:r,dts:i,pts:i}),p+=r.byteLength}}else d=!1}let v=[];for(let e=0;e<n.length;e++){let t=n[e],r=t.unit,s=t.dts-this._dtsBase,u=s-i;-1===a&&(a=u);let c=0;if(e!==n.length-1){c=n[e+1].dts-this._dtsBase-i-u}else if(null!=g){c=g.dts-this._dtsBase-i-u}else c=v.length>=1?v[v.length-1].duration:Math.floor(o);let d=!1,h=null;if(c>1.5*o&&"mp3"!==this._audioMeta.codec&&this._fillAudioTimestampGap&&!_.safari){d=!0;let e=Math.abs(c-o),t=Math.ceil(e/o),n=u+o;l.w(this.TAG,"Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\n"+`dts: ${u+c} ms, expected: ${u+Math.round(o)} ms, `+`delta: ${Math.round(e)} ms, generate: ${t} frames`);let i=q.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);null==i&&(l.w(this.TAG,"Unable to generate silent frame for "+`${this._audioMeta.originalCodec} with ${this._audioMeta.channelCount} channels, repeat last frame`),i=r),h=[];for(let e=0;e<t;e++){let e=Math.round(n);if(h.length>0){let t=h[h.length-1];t.duration=e-t.dts}let t={dts:e,pts:e,cts:0,unit:i,size:i.byteLength,duration:0,originalDts:s,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};h.push(t),p+=t.size,n+=o}let a=h[h.length-1];a.duration=u+c-a.dts,c=Math.round(o)}v.push({dts:u,pts:u,cts:0,unit:t.unit,size:t.unit.byteLength,duration:c,originalDts:s,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),d&&v.push.apply(v,h)}u?f=new Uint8Array(p):((f=new Uint8Array(p))[0]=p>>>24&255,f[1]=p>>>16&255,f[2]=p>>>8&255,f[3]=255&p,f.set(W.types.mdat,4));for(let e=0;e<v.length;e++){let t=v[e].unit;f.set(t,h),h+=t.byteLength}let y=v[v.length-1];s=y.dts+y.duration,this._audioNextDts=s;let b=new Y;b.beginDts=a,b.endDts=s,b.beginPts=a,b.endPts=s,b.originalBeginDts=v[0].originalDts,b.originalEndDts=y.originalDts+y.duration,b.firstSample=new X(v[0].dts,v[0].pts,v[0].duration,v[0].originalDts,!1),b.lastSample=new X(y.dts,y.pts,y.duration,y.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(b),r.samples=v,r.sequenceNumber++;let w=null;w=u?new Uint8Array:W.moof(r,a),r.samples=[],r.length=0;let S={type:"audio",data:this._mergeBoxes(w,f).buffer,sampleCount:v.length,info:b};u&&c&&(S.timestampOffset=a),this._onMediaSegment("audio",S)}_remuxVideo(e,t){if(null==this._videoMeta)return;let r=e,n=r.samples,i=void 0,a=-1,s=-1,o=-1,l=-1;if(!n||0===n.length)return;if(1===n.length&&!t)return;let u=8,c=null,d=8+e.length,h=null;if(n.length>1&&(d-=(h=n.pop()).length),null!=this._videoStashedLastSample){let e=this._videoStashedLastSample;this._videoStashedLastSample=null,n.unshift(e),d+=e.length}null!=h&&(this._videoStashedLastSample=h);let f=n[0].dts-this._dtsBase;if(this._videoNextDts)i=f-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())i=0;else{let e=this._videoSegmentInfoList.getLastSampleBefore(f);if(null!=e){let t=f-(e.originalDts+e.duration);t<=3&&(t=0),i=f-(e.dts+e.duration+t)}else i=0}let p=new Y,g=[];for(let e=0;e<n.length;e++){let t=n[e],r=t.dts-this._dtsBase,s=t.isKeyframe,l=r-i,u=t.cts,c=l+u;-1===a&&(a=l,o=c);let d=0;if(e!==n.length-1){d=n[e+1].dts-this._dtsBase-i-l}else if(null!=h){d=h.dts-this._dtsBase-i-l}else d=g.length>=1?g[g.length-1].duration:Math.floor(this._videoMeta.refSampleDuration);if(s){let e=new X(l,c,d,t.dts,!0);e.fileposition=t.fileposition,p.appendSyncPoint(e)}g.push({dts:l,pts:c,cts:u,units:t.units,size:t.length,isKeyframe:s,duration:d,originalDts:r,flags:{isLeading:0,dependsOn:s?2:1,isDependedOn:s?1:0,hasRedundancy:0,isNonSync:s?0:1}})}(c=new Uint8Array(d))[0]=d>>>24&255,c[1]=d>>>16&255,c[2]=d>>>8&255,c[3]=255&d,c.set(W.types.mdat,4);for(let e=0;e<g.length;e++){let t=g[e].units;for(;t.length;){let e=t.shift().data;c.set(e,u),u+=e.byteLength}}let m=g[g.length-1];if(s=m.dts+m.duration,l=m.pts+m.duration,this._videoNextDts=s,p.beginDts=a,p.endDts=s,p.beginPts=o,p.endPts=l,p.originalBeginDts=g[0].originalDts,p.originalEndDts=m.originalDts+m.duration,p.firstSample=new X(g[0].dts,g[0].pts,g[0].duration,g[0].originalDts,g[0].isKeyframe),p.lastSample=new X(m.dts,m.pts,m.duration,m.originalDts,m.isKeyframe),this._isLive||this._videoSegmentInfoList.append(p),r.samples=g,r.sequenceNumber++,this._forceFirstIDR){let e=g[0].flags;e.dependsOn=2,e.isNonSync=0}let v=W.moof(r,a);r.samples=[],r.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(v,c).buffer,sampleCount:g.length,info:p})}_mergeBoxes(e,t){let r=new Uint8Array(e.byteLength+t.byteLength);return r.set(e,0),r.set(t,e.byteLength),r}};var Z={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};var ee=class{constructor(e,t){this.TAG="TransmuxingController",this._emitter=new s.a,this._config=t,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),"boolean"!=typeof e.cors&&(e.cors=!0),"boolean"!=typeof e.withCredentials&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;let r=0;this._mediaDataSource.segments.forEach(n=>{n.timestampBase=r,r+=n.duration,n.cors=e.cors,n.withCredentials=e.withCredentials,t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy)}),isNaN(r)||this._mediaDataSource.duration===r||(this._mediaDataSource.duration=r),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}destroy(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null}on(e,t){this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}start(){this._loadSegment(0),this._enableStatisticsReporter()}_loadSegment(e,t){this._currentSegmentIndex=e;let r=this._mediaDataSource.segments[e],n=this._ioctl=new T(r,this._config,e);n.onError=this._onIOException.bind(this),n.onSeeked=this._onIOSeeked.bind(this),n.onComplete=this._onIOComplete.bind(this),n.onRedirect=this._onIORedirect.bind(this),n.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),t?this._demuxer.bindDataSource(this._ioctl):n.onDataArrival=this._onInitChunkArrival.bind(this),n.open(t)}stop(){this._internalAbort(),this._disableStatisticsReporter()}_internalAbort(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)}pause(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())}resume(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())}seek(e){if(null==this._mediaInfo||!this._mediaInfo.isSeekable())return;let t=this._searchSegmentIndexContains(e);if(t===this._currentSegmentIndex){let r=this._mediaInfo.segments[t];if(null==r)this._pendingSeekTime=e;else{let t=r.getNearestKeyframe(e);this._remuxer.seek(t.milliseconds),this._ioctl.seek(t.fileposition),this._pendingResolveSeekPoint=t.milliseconds}}else{let r=this._mediaInfo.segments[t];if(null==r)this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(t);else{let n=r.getNearestKeyframe(e);this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[t].timestampBase,this._loadSegment(t,n.fileposition),this._pendingResolveSeekPoint=n.milliseconds,this._reportSegmentMediaInfo(t)}}this._enableStatisticsReporter()}_searchSegmentIndexContains(e){let t=this._mediaDataSource.segments,r=t.length-1;for(let n=0;n<t.length;n++)if(e<t[n].timestampBase){r=n-1;break}return r}_onInitChunkArrival(e,t){let r=null,n=0;if(t>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,n=this._demuxer.parseChunks(e,t);else if((r=V.probe(e)).match){this._demuxer=new V(r,this._config),this._remuxer||(this._remuxer=new Q(this._config));let i=this._mediaDataSource;null==i.duration||isNaN(i.duration)||(this._demuxer.overridedDuration=i.duration),"boolean"==typeof i.hasAudio&&(this._demuxer.overridedHasAudio=i.hasAudio),"boolean"==typeof i.hasVideo&&(this._demuxer.overridedHasVideo=i.hasVideo),this._demuxer.timestampBase=i.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),n=this._demuxer.parseChunks(e,t)}else r=null,l.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(()=>{this._internalAbort()}),this._emitter.emit(Z.DEMUX_ERROR,z.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),n=0;return n}_onMediaInfo(e){null==this._mediaInfo&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,I.prototype));let t=Object.assign({},e);Object.setPrototypeOf(t,I.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=t,this._reportSegmentMediaInfo(this._currentSegmentIndex),null!=this._pendingSeekTime&&Promise.resolve().then(()=>{let e=this._pendingSeekTime;this._pendingSeekTime=null,this.seek(e)})}_onMetaDataArrived(e){this._emitter.emit(Z.METADATA_ARRIVED,e)}_onScriptDataArrived(e){this._emitter.emit(Z.SCRIPTDATA_ARRIVED,e)}_onIOSeeked(){this._remuxer.insertDiscontinuity()}_onIOComplete(e){let t=e+1;t<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(t)):(this._remuxer.flushStashedSamples(),this._emitter.emit(Z.LOADING_COMPLETE),this._disableStatisticsReporter())}_onIORedirect(e){let t=this._ioctl.extraData;this._mediaDataSource.segments[t].redirectedURL=e}_onIORecoveredEarlyEof(){this._emitter.emit(Z.RECOVERED_EARLY_EOF)}_onIOException(e,t){l.e(this.TAG,`IOException: type = ${e}, code = ${t.code}, msg = ${t.msg}`),this._emitter.emit(Z.IO_ERROR,e,t),this._disableStatisticsReporter()}_onDemuxException(e,t){l.e(this.TAG,`DemuxException: type = ${e}, info = ${t}`),this._emitter.emit(Z.DEMUX_ERROR,e,t)}_onRemuxerInitSegmentArrival(e,t){this._emitter.emit(Z.INIT_SEGMENT,e,t)}_onRemuxerMediaSegmentArrival(e,t){if(null==this._pendingSeekTime&&(this._emitter.emit(Z.MEDIA_SEGMENT,e,t),null!=this._pendingResolveSeekPoint&&"video"===e)){let e=t.info.syncPoints,r=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,_.safari&&e.length>0&&e[0].originalDts===r&&(r=e[0].pts),this._emitter.emit(Z.RECOMMEND_SEEKPOINT,r)}}_enableStatisticsReporter(){null==this._statisticsReporter&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))}_disableStatisticsReporter(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}_reportSegmentMediaInfo(e){let t=this._mediaInfo.segments[e],r=Object.assign({},t);r.duration=this._mediaInfo.duration,r.segmentCount=this._mediaInfo.segmentCount,delete r.segments,delete r.keyframesIndex,this._emitter.emit(Z.MEDIA_INFO,r)}_reportStatisticsInfo(){let e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(Z.STATISTICS_INFO,e)}};var te=function(e){let t=null,r=function(t,r){e.postMessage({msg:"logcat_callback",data:{type:t,logcat:r}})}.bind(this);i.install(),e.addEventListener("message",function(n){switch(n.data.cmd){case"init":(t=new ee(n.data.param[0],n.data.param[1])).on(Z.IO_ERROR,function(t,r){e.postMessage({msg:Z.IO_ERROR,data:{type:t,info:r}})}.bind(this)),t.on(Z.DEMUX_ERROR,function(t,r){e.postMessage({msg:Z.DEMUX_ERROR,data:{type:t,info:r}})}.bind(this)),t.on(Z.INIT_SEGMENT,function(t,r){let n={msg:Z.INIT_SEGMENT,data:{type:t,data:r}};e.postMessage(n,[r.data])}.bind(this)),t.on(Z.MEDIA_SEGMENT,function(t,r){let n={msg:Z.MEDIA_SEGMENT,data:{type:t,data:r}};e.postMessage(n,[r.data])}.bind(this)),t.on(Z.LOADING_COMPLETE,function(){let t={msg:Z.LOADING_COMPLETE};e.postMessage(t)}.bind(this)),t.on(Z.RECOVERED_EARLY_EOF,function(){let t={msg:Z.RECOVERED_EARLY_EOF};e.postMessage(t)}.bind(this)),t.on(Z.MEDIA_INFO,function(t){let r={msg:Z.MEDIA_INFO,data:t};e.postMessage(r)}.bind(this)),t.on(Z.METADATA_ARRIVED,function(t){let r={msg:Z.METADATA_ARRIVED,data:t};e.postMessage(r)}.bind(this)),t.on(Z.SCRIPTDATA_ARRIVED,function(t){let r={msg:Z.SCRIPTDATA_ARRIVED,data:t};e.postMessage(r)}.bind(this)),t.on(Z.STATISTICS_INFO,function(t){let r={msg:Z.STATISTICS_INFO,data:t};e.postMessage(r)}.bind(this)),t.on(Z.RECOMMEND_SEEKPOINT,function(t){e.postMessage({msg:Z.RECOMMEND_SEEKPOINT,data:t})}.bind(this));break;case"destroy":t&&(t.destroy(),t=null),e.postMessage({msg:"destroyed"});break;case"start":t.start();break;case"stop":t.stop();break;case"seek":t.seek(n.data.param);break;case"pause":t.pause();break;case"resume":t.resume();break;case"logging_config":{let e=n.data.param;L.applyConfig(e),!0===e.enableCallback?L.addLogListener(r):L.removeLogListener(r);break}}})};var re=class{constructor(e,t){if(this.TAG="Transmuxer",this._emitter=new s.a,t.enableWorker&&"undefined"!=typeof Worker)try{let n=r(8);this._worker=n(te),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[e,t]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},L.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:L.getConfig()})}catch(r){l.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new ee(e,t)}else this._controller=new ee(e,t);if(this._controller){let e=this._controller;e.on(Z.IO_ERROR,this._onIOError.bind(this)),e.on(Z.DEMUX_ERROR,this._onDemuxError.bind(this)),e.on(Z.INIT_SEGMENT,this._onInitSegment.bind(this)),e.on(Z.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),e.on(Z.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),e.on(Z.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),e.on(Z.MEDIA_INFO,this._onMediaInfo.bind(this)),e.on(Z.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),e.on(Z.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),e.on(Z.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),e.on(Z.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}destroy(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),L.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null}on(e,t){this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}hasWorker(){return null!=this._worker}open(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()}close(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()}seek(e){this._worker?this._worker.postMessage({cmd:"seek",param:e}):this._controller.seek(e)}pause(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()}resume(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()}_onInitSegment(e,t){Promise.resolve().then(()=>{this._emitter.emit(Z.INIT_SEGMENT,e,t)})}_onMediaSegment(e,t){Promise.resolve().then(()=>{this._emitter.emit(Z.MEDIA_SEGMENT,e,t)})}_onLoadingComplete(){Promise.resolve().then(()=>{this._emitter.emit(Z.LOADING_COMPLETE)})}_onRecoveredEarlyEof(){Promise.resolve().then(()=>{this._emitter.emit(Z.RECOVERED_EARLY_EOF)})}_onMediaInfo(e){Promise.resolve().then(()=>{this._emitter.emit(Z.MEDIA_INFO,e)})}_onMetaDataArrived(e){Promise.resolve().then(()=>{this._emitter.emit(Z.METADATA_ARRIVED,e)})}_onScriptDataArrived(e){Promise.resolve().then(()=>{this._emitter.emit(Z.SCRIPTDATA_ARRIVED,e)})}_onStatisticsInfo(e){Promise.resolve().then(()=>{this._emitter.emit(Z.STATISTICS_INFO,e)})}_onIOError(e,t){Promise.resolve().then(()=>{this._emitter.emit(Z.IO_ERROR,e,t)})}_onDemuxError(e,t){Promise.resolve().then(()=>{this._emitter.emit(Z.DEMUX_ERROR,e,t)})}_onRecommendSeekpoint(e){Promise.resolve().then(()=>{this._emitter.emit(Z.RECOMMEND_SEEKPOINT,e)})}_onLoggingConfigChanged(e){this._worker&&this._worker.postMessage({cmd:"logging_config",param:e})}_onWorkerMessage(e){let t=e.data,r=t.data;if("destroyed"===t.msg||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(t.msg){case Z.INIT_SEGMENT:case Z.MEDIA_SEGMENT:this._emitter.emit(t.msg,r.type,r.data);break;case Z.LOADING_COMPLETE:case Z.RECOVERED_EARLY_EOF:this._emitter.emit(t.msg);break;case Z.MEDIA_INFO:Object.setPrototypeOf(r,I.prototype),this._emitter.emit(t.msg,r);break;case Z.METADATA_ARRIVED:case Z.SCRIPTDATA_ARRIVED:case Z.STATISTICS_INFO:this._emitter.emit(t.msg,r);break;case Z.IO_ERROR:case Z.DEMUX_ERROR:this._emitter.emit(t.msg,r.type,r.info);break;case Z.RECOMMEND_SEEKPOINT:this._emitter.emit(t.msg,r);break;case"logcat_callback":l.emitter.emit("log",r.type,r.logcat)}}};var ne={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};var ie=class{constructor(e){this.TAG="MSEController",this._config=e,this._emitter=new s.a,this._config.isLive&&null==this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new $}destroy(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null}on(e,t){this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}attachMediaElement(e){if(this._mediaSource)throw new d("MediaSource has been attached to an HTMLMediaElement!");let t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=e,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),e.src=this._mediaSourceObjectURL}detachMediaElement(){if(this._mediaSource){let e=this._mediaSource;for(let t in this._sourceBuffers){let r=this._pendingSegments[t];r.splice(0,r.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;let n=this._sourceBuffers[t];if(n){if("closed"!==e.readyState){try{e.removeSourceBuffer(n)}catch(e){l.e(this.TAG,e.message)}n.removeEventListener("error",this.e.onSourceBufferError),n.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if("open"===e.readyState)try{e.endOfStream()}catch(e){l.e(this.TAG,e.message)}e.removeEventListener("sourceopen",this.e.onSourceOpen),e.removeEventListener("sourceended",this.e.onSourceEnded),e.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)}appendInitSegment(e,t){if(!this._mediaSource||"open"!==this._mediaSource.readyState)return this._pendingSourceBufferInit.push(e),void this._pendingSegments[e.type].push(e);let r=e,n=`${r.container}`;r.codec&&r.codec.length>0&&(n+=`;codecs=${r.codec}`);let i=!1;if(l.v(this.TAG,"Received Initialization Segment, mimeType: "+n),this._lastInitSegments[r.type]=r,n!==this._mimeTypes[r.type]){if(this._mimeTypes[r.type])l.v(this.TAG,`Notice: ${r.type} mimeType changed, origin: ${this._mimeTypes[r.type]}, target: ${n}`);else{i=!0;try{let e=this._sourceBuffers[r.type]=this._mediaSource.addSourceBuffer(n);e.addEventListener("error",this.e.onSourceBufferError),e.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(e){return l.e(this.TAG,e.message),void this._emitter.emit(ne.ERROR,{code:e.code,msg:e.message})}}this._mimeTypes[r.type]=n}t||this._pendingSegments[r.type].push(r),i||this._sourceBuffers[r.type]&&!this._sourceBuffers[r.type].updating&&this._doAppendSegments(),_.safari&&"audio/mpeg"===r.container&&r.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=r.mediaDuration/1e3,this._updateMediaSourceDuration())}appendMediaSegment(e){let t=e;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();let r=this._sourceBuffers[t.type];!r||r.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()}seek(e){for(let e in this._sourceBuffers){if(!this._sourceBuffers[e])continue;let t=this._sourceBuffers[e];if("open"===this._mediaSource.readyState)try{t.abort()}catch(e){l.e(this.TAG,e.message)}this._idrList.clear();let r=this._pendingSegments[e];if(r.splice(0,r.length),"closed"!==this._mediaSource.readyState){for(let r=0;r<t.buffered.length;r++){let n=t.buffered.start(r),i=t.buffered.end(r);this._pendingRemoveRanges[e].push({start:n,end:i})}if(t.updating||this._doRemoveRanges(),_.safari){let r=this._lastInitSegments[e];r&&(this._pendingSegments[e].push(r),t.updating||this._doAppendSegments())}}}}endOfStream(){let e=this._mediaSource,t=this._sourceBuffers;e&&"open"===e.readyState?t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,e.endOfStream()):e&&"closed"===e.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0)}getNearestKeyframe(e){return this._idrList.getLastSyncPointBeforeDts(e)}_needCleanupSourceBuffer(){if(!this._config.autoCleanupSourceBuffer)return!1;let e=this._mediaElement.currentTime;for(let t in this._sourceBuffers){let r=this._sourceBuffers[t];if(r){let t=r.buffered;if(t.length>=1&&e-t.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1}_doCleanupSourceBuffer(){let e=this._mediaElement.currentTime;for(let t in this._sourceBuffers){let r=this._sourceBuffers[t];if(r){let n=r.buffered,i=!1;for(let r=0;r<n.length;r++){let a=n.start(r),s=n.end(r);if(a<=e&&e<s+3){if(e-a>=this._config.autoCleanupMaxBackwardDuration){i=!0;let r=e-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:a,end:r})}}else s<e&&(i=!0,this._pendingRemoveRanges[t].push({start:a,end:s}))}i&&!r.updating&&this._doRemoveRanges()}}}_updateMediaSourceDuration(){let e=this._sourceBuffers;if(0===this._mediaElement.readyState||"open"!==this._mediaSource.readyState)return;if(e.video&&e.video.updating||e.audio&&e.audio.updating)return;let t=this._mediaSource.duration,r=this._pendingMediaDuration;r>0&&(isNaN(t)||r>t)&&(l.v(this.TAG,`Update MediaSource duration from ${t} to ${r}`),this._mediaSource.duration=r),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}_doRemoveRanges(){for(let e in this._pendingRemoveRanges){if(!this._sourceBuffers[e]||this._sourceBuffers[e].updating)continue;let t=this._sourceBuffers[e],r=this._pendingRemoveRanges[e];for(;r.length&&!t.updating;){let e=r.shift();t.remove(e.start,e.end)}}}_doAppendSegments(){let e=this._pendingSegments;for(let t in e)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating&&e[t].length>0){let r=e[t].shift();if(r.timestampOffset){let e=this._sourceBuffers[t].timestampOffset,n=r.timestampOffset/1e3;Math.abs(e-n)>.1&&(l.v(this.TAG,`Update MPEG audio timestampOffset from ${e} to ${n}`),this._sourceBuffers[t].timestampOffset=n),delete r.timestampOffset}if(!r.data||0===r.data.byteLength)continue;try{this._sourceBuffers[t].appendBuffer(r.data),this._isBufferFull=!1,"video"===t&&r.hasOwnProperty("info")&&this._idrList.appendArray(r.info.syncPoints)}catch(e){this._pendingSegments[t].unshift(r),22===e.code?(this._isBufferFull||this._emitter.emit(ne.BUFFER_FULL),this._isBufferFull=!0):(l.e(this.TAG,e.message),this._emitter.emit(ne.ERROR,{code:e.code,msg:e.message}))}}}_onSourceOpen(){if(l.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0){let e=this._pendingSourceBufferInit;for(;e.length;){let t=e.shift();this.appendInitSegment(t,!0)}}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(ne.SOURCE_OPEN)}_onSourceEnded(){l.v(this.TAG,"MediaSource onSourceEnded")}_onSourceClose(){l.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))}_hasPendingSegments(){let e=this._pendingSegments;return e.video.length>0||e.audio.length>0}_hasPendingRemoveRanges(){let e=this._pendingRemoveRanges;return e.video.length>0||e.audio.length>0}_onSourceBufferUpdateEnd(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(ne.UPDATE_END)}_onSourceBufferError(e){l.e(this.TAG,`SourceBuffer Error: ${e}`)}};const ae={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},se={NETWORK_EXCEPTION:g.EXCEPTION,NETWORK_STATUS_CODE_INVALID:g.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:g.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:g.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:z.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:z.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:z.CODEC_UNSUPPORTED};var oe=class{constructor(e,t){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new s.a,this._config=A(),"object"==typeof t&&Object.assign(this._config,t),"flv"!==e.type.toLowerCase())throw new h("FlvPlayer requires an flv MediaDataSource input!");!0===e.isLive&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=e,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;let r=_.chrome&&(_.version.major<50||50===_.version.major&&_.version.build<2661);this._alwaysSeekKeyframe=!!(r||_.msedge||_.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}destroy(){null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null}on(e,t){e===D.MEDIA_INFO?null!=this._mediaInfo&&Promise.resolve().then(()=>{this._emitter.emit(D.MEDIA_INFO,this.mediaInfo)}):e===D.STATISTICS_INFO&&null!=this._statisticsInfo&&Promise.resolve().then(()=>{this._emitter.emit(D.STATISTICS_INFO,this.statisticsInfo)}),this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}attachMediaElement(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),e.addEventListener("seeking",this.e.onvSeeking),e.addEventListener("canplay",this.e.onvCanPlay),e.addEventListener("stalled",this.e.onvStalled),e.addEventListener("progress",this.e.onvProgress),this._msectl=new ie(this._config),this._msectl.on(ne.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(ne.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(ne.SOURCE_OPEN,()=>{this._mseSourceOpened=!0,this._hasPendingLoad&&(this._hasPendingLoad=!1,this.load())}),this._msectl.on(ne.ERROR,e=>{this._emitter.emit(D.ERROR,ae.MEDIA_ERROR,se.MEDIA_MSE_ERROR,e)}),this._msectl.attachMediaElement(e),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}}detachMediaElement(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)}load(){if(!this._mediaElement)throw new d("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new d("FlvPlayer.load() has been called, please call unload() first!");this._hasPendingLoad||(this._config.deferLoadAfterSourceOpen&&!1===this._mseSourceOpened?this._hasPendingLoad=!0:(this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new re(this._mediaDataSource,this._config),this._transmuxer.on(Z.INIT_SEGMENT,(e,t)=>{this._msectl.appendInitSegment(t)}),this._transmuxer.on(Z.MEDIA_SEGMENT,(e,t)=>{if(this._msectl.appendMediaSegment(t),this._config.lazyLoad&&!this._config.isLive){let e=this._mediaElement.currentTime;t.info.endDts>=1e3*(e+this._config.lazyLoadMaxDuration)&&null==this._progressChecker&&(l.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}}),this._transmuxer.on(Z.LOADING_COMPLETE,()=>{this._msectl.endOfStream(),this._emitter.emit(D.LOADING_COMPLETE)}),this._transmuxer.on(Z.RECOVERED_EARLY_EOF,()=>{this._emitter.emit(D.RECOVERED_EARLY_EOF)}),this._transmuxer.on(Z.IO_ERROR,(e,t)=>{this._emitter.emit(D.ERROR,ae.NETWORK_ERROR,e,t)}),this._transmuxer.on(Z.DEMUX_ERROR,(e,t)=>{this._emitter.emit(D.ERROR,ae.MEDIA_ERROR,e,{code:-1,msg:t})}),this._transmuxer.on(Z.MEDIA_INFO,e=>{this._mediaInfo=e,this._emitter.emit(D.MEDIA_INFO,Object.assign({},e))}),this._transmuxer.on(Z.METADATA_ARRIVED,e=>{this._emitter.emit(D.METADATA_ARRIVED,e)}),this._transmuxer.on(Z.SCRIPTDATA_ARRIVED,e=>{this._emitter.emit(D.SCRIPTDATA_ARRIVED,e)}),this._transmuxer.on(Z.STATISTICS_INFO,e=>{this._statisticsInfo=this._fillStatisticsInfo(e),this._emitter.emit(D.STATISTICS_INFO,Object.assign({},this._statisticsInfo))}),this._transmuxer.on(Z.RECOMMEND_SEEKPOINT,e=>{this._mediaElement&&!this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e/1e3)}),this._transmuxer.open()))}unload(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)}play(){return this._mediaElement.play()}pause(){this._mediaElement.pause()}get type(){return this._type}get buffered(){return this._mediaElement.buffered}get duration(){return this._mediaElement.duration}get volume(){return this._mediaElement.volume}set volume(e){this._mediaElement.volume=e}get muted(){return this._mediaElement.muted}set muted(e){this._mediaElement.muted=e}get currentTime(){return this._mediaElement?this._mediaElement.currentTime:0}set currentTime(e){this._mediaElement?this._internalSeek(e):this._pendingSeekTime=e}get mediaInfo(){return Object.assign({},this._mediaInfo)}get statisticsInfo(){return null==this._statisticsInfo&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)}_fillStatisticsInfo(e){if(e.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return e;let t=!0,r=0,n=0;if(this._mediaElement.getVideoPlaybackQuality){let e=this._mediaElement.getVideoPlaybackQuality();r=e.totalVideoFrames,n=e.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(r=this._mediaElement.webkitDecodedFrameCount,n=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=r,e.droppedFrames=n),e}_onmseUpdateEnd(){if(!this._config.lazyLoad||this._config.isLive)return;let e=this._mediaElement.buffered,t=this._mediaElement.currentTime,r=0,n=0;for(let i=0;i<e.length;i++){let a=e.start(i),s=e.end(i);if(a<=t&&t<s){r=a,n=s;break}}n>=t+this._config.lazyLoadMaxDuration&&null==this._progressChecker&&(l.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}_onmseBufferFull(){l.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),null==this._progressChecker&&this._suspendTransmuxer()}_suspendTransmuxer(){this._transmuxer&&(this._transmuxer.pause(),null==this._progressChecker&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))}_checkProgressAndResume(){let e=this._mediaElement.currentTime,t=this._mediaElement.buffered,r=!1;for(let n=0;n<t.length;n++){let i=t.start(n),a=t.end(n);if(e>=i&&e<a){e>=a-this._config.lazyLoadRecoverDuration&&(r=!0);break}}r&&(window.clearInterval(this._progressChecker),this._progressChecker=null,r&&(l.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))}_isTimepointBuffered(e){let t=this._mediaElement.buffered;for(let r=0;r<t.length;r++){let n=t.start(r),i=t.end(r);if(e>=n&&e<i)return!0}return!1}_internalSeek(e){let t=this._isTimepointBuffered(e),r=!1,n=0;if(e<1&&this._mediaElement.buffered.length>0){let t=this._mediaElement.buffered.start(0);(t<1&&e<t||_.safari)&&(r=!0,n=_.safari?.1:t)}if(r)this._requestSetTime=!0,this._mediaElement.currentTime=n;else if(t){if(this._alwaysSeekKeyframe){let t=this._msectl.getNearestKeyframe(Math.floor(1e3*e));this._requestSetTime=!0,this._mediaElement.currentTime=null!=t?t.dts/1e3:e}else this._requestSetTime=!0,this._mediaElement.currentTime=e;null!=this._progressChecker&&this._checkProgressAndResume()}else null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e)}_checkAndApplyUnbufferedSeekpoint(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){let e=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(e)||(null!=this._progressChecker&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}_checkAndResumeStuckPlayback(e){let t=this._mediaElement;if(e||!this._receivedCanPlay||t.readyState<2){let e=t.buffered;e.length>0&&t.currentTime<e.start(0)&&(l.w(this.TAG,`Playback seems stuck at ${t.currentTime}, seek to ${e.start(0)}`),this._requestSetTime=!0,this._mediaElement.currentTime=e.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)}_onvLoadedMetadata(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)}_onvSeeking(e){let t=this._mediaElement.currentTime,r=this._mediaElement.buffered;if(this._requestSetTime)this._requestSetTime=!1;else{if(t<1&&r.length>0){let e=r.start(0);if(e<1&&t<e||_.safari)return this._requestSetTime=!0,void(this._mediaElement.currentTime=_.safari?.1:e)}if(this._isTimepointBuffered(t)){if(this._alwaysSeekKeyframe){let e=this._msectl.getNearestKeyframe(Math.floor(1e3*t));null!=e&&(this._requestSetTime=!0,this._mediaElement.currentTime=e.dts/1e3)}null!=this._progressChecker&&this._checkProgressAndResume()}else this._seekpointRecord={seekPoint:t,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}}_onvCanPlay(e){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)}_onvStalled(e){this._checkAndResumeStuckPlayback(!0)}_onvProgress(e){this._checkAndResumeStuckPlayback()}};var le=class{constructor(e,t){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new s.a,this._config=A(),"object"==typeof t&&Object.assign(this._config,t),"flv"===e.type.toLowerCase())throw new h("NativePlayer does't support flv MediaDataSource input!");if(e.hasOwnProperty("segments"))throw new h(`NativePlayer(${e.type}) doesn't support multipart playback!`);this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=e,this._mediaElement=null}destroy(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null}on(e,t){e===D.MEDIA_INFO?null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then(()=>{this._emitter.emit(D.MEDIA_INFO,this.mediaInfo)}):e===D.STATISTICS_INFO&&null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then(()=>{this._emitter.emit(D.STATISTICS_INFO,this.statisticsInfo)}),this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}attachMediaElement(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}}detachMediaElement(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}load(){if(!this._mediaElement)throw new d("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)}unload(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}play(){return this._mediaElement.play()}pause(){this._mediaElement.pause()}get type(){return this._type}get buffered(){return this._mediaElement.buffered}get duration(){return this._mediaElement.duration}get volume(){return this._mediaElement.volume}set volume(e){this._mediaElement.volume=e}get muted(){return this._mediaElement.muted}set muted(e){this._mediaElement.muted=e}get currentTime(){return this._mediaElement?this._mediaElement.currentTime:0}set currentTime(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e}get mediaInfo(){let e={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e}get statisticsInfo(){let e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;let t=!0,r=0,n=0;if(this._mediaElement.getVideoPlaybackQuality){let e=this._mediaElement.getVideoPlaybackQuality();r=e.totalVideoFrames,n=e.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(r=this._mediaElement.webkitDecodedFrameCount,n=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=r,e.droppedFrames=n),e}_onvLoadedMetadata(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(D.MEDIA_INFO,this.mediaInfo)}_reportStatisticsInfo(){this._emitter.emit(D.STATISTICS_INFO,this.statisticsInfo)}};i.install();let ue={createPlayer:function(e,t){let r=e;if(null==r||"object"!=typeof r)throw new h("MediaDataSource must be an javascript object!");if(!r.hasOwnProperty("type"))throw new h("MediaDataSource must has type field to indicate video file type!");switch(r.type){case"flv":return new oe(r,t);default:return new le(r,t)}},isSupported:function(){return j.supportMSEH264Playback()},getFeatureList:function(){return j.getFeatureList()}};ue.BaseLoader=m,ue.LoaderStatus=p,ue.LoaderErrors=g,ue.Events=D,ue.ErrorTypes=ae,ue.ErrorDetails=se,ue.FlvPlayer=oe,ue.NativePlayer=le,ue.LoggingControl=L,Object.defineProperty(ue,"version",{enumerable:!0,get:function(){return"__VERSION__"}});t.default=ue}])});